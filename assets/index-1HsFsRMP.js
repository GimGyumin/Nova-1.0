(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function ik(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var zI={exports:{}},pd={},qI={exports:{}},ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var su=Symbol.for("react.element"),ok=Symbol.for("react.portal"),ak=Symbol.for("react.fragment"),lk=Symbol.for("react.strict_mode"),uk=Symbol.for("react.profiler"),ck=Symbol.for("react.provider"),hk=Symbol.for("react.context"),dk=Symbol.for("react.forward_ref"),fk=Symbol.for("react.suspense"),pk=Symbol.for("react.memo"),mk=Symbol.for("react.lazy"),ov=Symbol.iterator;function gk(n){return n===null||typeof n!="object"?null:(n=ov&&n[ov]||n["@@iterator"],typeof n=="function"?n:null)}var WI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},KI=Object.assign,GI={};function Jo(n,e,t){this.props=n,this.context=e,this.refs=GI,this.updater=t||WI}Jo.prototype.isReactComponent={};Jo.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Jo.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function HI(){}HI.prototype=Jo.prototype;function og(n,e,t){this.props=n,this.context=e,this.refs=GI,this.updater=t||WI}var ag=og.prototype=new HI;ag.constructor=og;KI(ag,Jo.prototype);ag.isPureReactComponent=!0;var av=Array.isArray,QI=Object.prototype.hasOwnProperty,lg={current:null},JI={key:!0,ref:!0,__self:!0,__source:!0};function XI(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)QI.call(e,r)&&!JI.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var u=Array(a),c=0;c<a;c++)u[c]=arguments[c+2];s.children=u}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:su,type:n,key:i,ref:o,props:s,_owner:lg.current}}function _k(n,e){return{$$typeof:su,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function ug(n){return typeof n=="object"&&n!==null&&n.$$typeof===su}function yk(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var lv=/\/+/g;function Sf(n,e){return typeof n=="object"&&n!==null&&n.key!=null?yk(""+n.key):e.toString(36)}function xc(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case su:case ok:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+Sf(o,0):r,av(s)?(t="",n!=null&&(t=n.replace(lv,"$&/")+"/"),xc(s,e,t,"",function(c){return c})):s!=null&&(ug(s)&&(s=_k(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(lv,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",av(n))for(var a=0;a<n.length;a++){i=n[a];var u=r+Sf(i,a);o+=xc(i,e,t,u,s)}else if(u=gk(n),typeof u=="function")for(n=u.call(n),a=0;!(i=n.next()).done;)i=i.value,u=r+Sf(i,a++),o+=xc(i,e,t,u,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Hu(n,e,t){if(n==null)return n;var r=[],s=0;return xc(n,r,"","",function(i){return e.call(t,i,s++)}),r}function vk(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var zt={current:null},bc={transition:null},wk={ReactCurrentDispatcher:zt,ReactCurrentBatchConfig:bc,ReactCurrentOwner:lg};function YI(){throw Error("act(...) is not supported in production builds of React.")}ye.Children={map:Hu,forEach:function(n,e,t){Hu(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Hu(n,function(){e++}),e},toArray:function(n){return Hu(n,function(e){return e})||[]},only:function(n){if(!ug(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ye.Component=Jo;ye.Fragment=ak;ye.Profiler=uk;ye.PureComponent=og;ye.StrictMode=lk;ye.Suspense=fk;ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wk;ye.act=YI;ye.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=KI({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=lg.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(u in e)QI.call(e,u)&&!JI.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=t;else if(1<u){a=Array(u);for(var c=0;c<u;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:su,type:n.type,key:s,ref:i,props:r,_owner:o}};ye.createContext=function(n){return n={$$typeof:hk,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:ck,_context:n},n.Consumer=n};ye.createElement=XI;ye.createFactory=function(n){var e=XI.bind(null,n);return e.type=n,e};ye.createRef=function(){return{current:null}};ye.forwardRef=function(n){return{$$typeof:dk,render:n}};ye.isValidElement=ug;ye.lazy=function(n){return{$$typeof:mk,_payload:{_status:-1,_result:n},_init:vk}};ye.memo=function(n,e){return{$$typeof:pk,type:n,compare:e===void 0?null:e}};ye.startTransition=function(n){var e=bc.transition;bc.transition={};try{n()}finally{bc.transition=e}};ye.unstable_act=YI;ye.useCallback=function(n,e){return zt.current.useCallback(n,e)};ye.useContext=function(n){return zt.current.useContext(n)};ye.useDebugValue=function(){};ye.useDeferredValue=function(n){return zt.current.useDeferredValue(n)};ye.useEffect=function(n,e){return zt.current.useEffect(n,e)};ye.useId=function(){return zt.current.useId()};ye.useImperativeHandle=function(n,e,t){return zt.current.useImperativeHandle(n,e,t)};ye.useInsertionEffect=function(n,e){return zt.current.useInsertionEffect(n,e)};ye.useLayoutEffect=function(n,e){return zt.current.useLayoutEffect(n,e)};ye.useMemo=function(n,e){return zt.current.useMemo(n,e)};ye.useReducer=function(n,e,t){return zt.current.useReducer(n,e,t)};ye.useRef=function(n){return zt.current.useRef(n)};ye.useState=function(n){return zt.current.useState(n)};ye.useSyncExternalStore=function(n,e,t){return zt.current.useSyncExternalStore(n,e,t)};ye.useTransition=function(){return zt.current.useTransition()};ye.version="18.3.1";qI.exports=ye;var W=qI.exports;const ZI=ik(W);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ik=W,Ek=Symbol.for("react.element"),Tk=Symbol.for("react.fragment"),Sk=Object.prototype.hasOwnProperty,Ak=Ik.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xk={key:!0,ref:!0,__self:!0,__source:!0};function eE(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Sk.call(e,r)&&!xk.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Ek,type:n,key:i,ref:o,props:s,_owner:Ak.current}}pd.Fragment=Tk;pd.jsx=eE;pd.jsxs=eE;zI.exports=pd;var g=zI.exports,vp={},tE={exports:{}},dn={},nE={exports:{}},rE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(K,oe){var ee=K.length;K.push(oe);e:for(;0<ee;){var pe=ee-1>>>1,Ce=K[pe];if(0<s(Ce,oe))K[pe]=oe,K[ee]=Ce,ee=pe;else break e}}function t(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var oe=K[0],ee=K.pop();if(ee!==oe){K[0]=ee;e:for(var pe=0,Ce=K.length,pn=Ce>>>1;pe<pn;){var Ze=2*(pe+1)-1,mn=K[Ze],dt=Ze+1,Ke=K[dt];if(0>s(mn,ee))dt<Ce&&0>s(Ke,mn)?(K[pe]=Ke,K[dt]=ee,pe=dt):(K[pe]=mn,K[Ze]=ee,pe=Ze);else if(dt<Ce&&0>s(Ke,ee))K[pe]=Ke,K[dt]=ee,pe=dt;else break e}}return oe}function s(K,oe){var ee=K.sortIndex-oe.sortIndex;return ee!==0?ee:K.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],c=[],d=1,f=null,m=3,_=!1,E=!1,k=!1,N=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(K){for(var oe=t(c);oe!==null;){if(oe.callback===null)r(c);else if(oe.startTime<=K)r(c),oe.sortIndex=oe.expirationTime,e(u,oe);else break;oe=t(c)}}function R(K){if(k=!1,S(K),!E)if(t(u)!==null)E=!0,kn(j);else{var oe=t(c);oe!==null&&Cn(R,oe.startTime-K)}}function j(K,oe){E=!1,k&&(k=!1,x(v),v=-1),_=!0;var ee=m;try{for(S(oe),f=t(u);f!==null&&(!(f.expirationTime>oe)||K&&!b());){var pe=f.callback;if(typeof pe=="function"){f.callback=null,m=f.priorityLevel;var Ce=pe(f.expirationTime<=oe);oe=n.unstable_now(),typeof Ce=="function"?f.callback=Ce:f===t(u)&&r(u),S(oe)}else r(u);f=t(u)}if(f!==null)var pn=!0;else{var Ze=t(c);Ze!==null&&Cn(R,Ze.startTime-oe),pn=!1}return pn}finally{f=null,m=ee,_=!1}}var M=!1,w=null,v=-1,T=5,A=-1;function b(){return!(n.unstable_now()-A<T)}function P(){if(w!==null){var K=n.unstable_now();A=K;var oe=!0;try{oe=w(!0,K)}finally{oe?C():(M=!1,w=null)}}else M=!1}var C;if(typeof y=="function")C=function(){y(P)};else if(typeof MessageChannel<"u"){var Ne=new MessageChannel,je=Ne.port2;Ne.port1.onmessage=P,C=function(){je.postMessage(null)}}else C=function(){N(P,0)};function kn(K){w=K,M||(M=!0,C())}function Cn(K,oe){v=N(function(){K(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(K){K.callback=null},n.unstable_continueExecution=function(){E||_||(E=!0,kn(j))},n.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<K?Math.floor(1e3/K):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(K){switch(m){case 1:case 2:case 3:var oe=3;break;default:oe=m}var ee=m;m=oe;try{return K()}finally{m=ee}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(K,oe){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ee=m;m=K;try{return oe()}finally{m=ee}},n.unstable_scheduleCallback=function(K,oe,ee){var pe=n.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?pe+ee:pe):ee=pe,K){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=ee+Ce,K={id:d++,callback:oe,priorityLevel:K,startTime:ee,expirationTime:Ce,sortIndex:-1},ee>pe?(K.sortIndex=ee,e(c,K),t(u)===null&&K===t(c)&&(k?(x(v),v=-1):k=!0,Cn(R,ee-pe))):(K.sortIndex=Ce,e(u,K),E||_||(E=!0,kn(j))),K},n.unstable_shouldYield=b,n.unstable_wrapCallback=function(K){var oe=m;return function(){var ee=m;m=oe;try{return K.apply(this,arguments)}finally{m=ee}}}})(rE);nE.exports=rE;var bk=nE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kk=W,un=bk;function z(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sE=new Set,xl={};function bi(n,e){xo(n,e),xo(n+"Capture",e)}function xo(n,e){for(xl[n]=e,n=0;n<e.length;n++)sE.add(e[n])}var Sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wp=Object.prototype.hasOwnProperty,Ck=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uv={},cv={};function Rk(n){return wp.call(cv,n)?!0:wp.call(uv,n)?!1:Ck.test(n)?cv[n]=!0:(uv[n]=!0,!1)}function Pk(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Nk(n,e,t,r){if(e===null||typeof e>"u"||Pk(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qt(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){bt[n]=new qt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];bt[e]=new qt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){bt[n]=new qt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){bt[n]=new qt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){bt[n]=new qt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){bt[n]=new qt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){bt[n]=new qt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){bt[n]=new qt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){bt[n]=new qt(n,5,!1,n.toLowerCase(),null,!1,!1)});var cg=/[\-:]([a-z])/g;function hg(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(cg,hg);bt[e]=new qt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(cg,hg);bt[e]=new qt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(cg,hg);bt[e]=new qt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){bt[n]=new qt(n,1,!1,n.toLowerCase(),null,!1,!1)});bt.xlinkHref=new qt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){bt[n]=new qt(n,1,!1,n.toLowerCase(),null,!0,!0)});function dg(n,e,t,r){var s=bt.hasOwnProperty(e)?bt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Nk(e,t,s,r)&&(t=null),r||s===null?Rk(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Nr=kk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qu=Symbol.for("react.element"),no=Symbol.for("react.portal"),ro=Symbol.for("react.fragment"),fg=Symbol.for("react.strict_mode"),Ip=Symbol.for("react.profiler"),iE=Symbol.for("react.provider"),oE=Symbol.for("react.context"),pg=Symbol.for("react.forward_ref"),Ep=Symbol.for("react.suspense"),Tp=Symbol.for("react.suspense_list"),mg=Symbol.for("react.memo"),Qr=Symbol.for("react.lazy"),aE=Symbol.for("react.offscreen"),hv=Symbol.iterator;function Aa(n){return n===null||typeof n!="object"?null:(n=hv&&n[hv]||n["@@iterator"],typeof n=="function"?n:null)}var We=Object.assign,Af;function Fa(n){if(Af===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Af=e&&e[1]||""}return`
`+Af+n}var xf=!1;function bf(n,e){if(!n||xf)return"";xf=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var u=`
`+s[o].replace(" at new "," at ");return n.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",n.displayName)),u}while(1<=o&&0<=a);break}}}finally{xf=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Fa(n):""}function Dk(n){switch(n.tag){case 5:return Fa(n.type);case 16:return Fa("Lazy");case 13:return Fa("Suspense");case 19:return Fa("SuspenseList");case 0:case 2:case 15:return n=bf(n.type,!1),n;case 11:return n=bf(n.type.render,!1),n;case 1:return n=bf(n.type,!0),n;default:return""}}function Sp(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case ro:return"Fragment";case no:return"Portal";case Ip:return"Profiler";case fg:return"StrictMode";case Ep:return"Suspense";case Tp:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case oE:return(n.displayName||"Context")+".Consumer";case iE:return(n._context.displayName||"Context")+".Provider";case pg:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case mg:return e=n.displayName||null,e!==null?e:Sp(n.type)||"Memo";case Qr:e=n._payload,n=n._init;try{return Sp(n(e))}catch{}}return null}function Ok(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sp(e);case 8:return e===fg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function vs(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function lE(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Vk(n){var e=lE(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Ju(n){n._valueTracker||(n._valueTracker=Vk(n))}function uE(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=lE(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function ch(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Ap(n,e){var t=e.checked;return We({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function dv(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=vs(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function cE(n,e){e=e.checked,e!=null&&dg(n,"checked",e,!1)}function xp(n,e){cE(n,e);var t=vs(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?bp(n,e.type,t):e.hasOwnProperty("defaultValue")&&bp(n,e.type,vs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function fv(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function bp(n,e,t){(e!=="number"||ch(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Ua=Array.isArray;function go(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+vs(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function kp(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return We({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function pv(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(z(92));if(Ua(t)){if(1<t.length)throw Error(z(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:vs(t)}}function hE(n,e){var t=vs(e.value),r=vs(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function mv(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function dE(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cp(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?dE(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Xu,fE=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Xu=Xu||document.createElement("div"),Xu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xu.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function bl(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var rl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mk=["Webkit","ms","Moz","O"];Object.keys(rl).forEach(function(n){Mk.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),rl[e]=rl[n]})});function pE(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||rl.hasOwnProperty(n)&&rl[n]?(""+e).trim():e+"px"}function mE(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=pE(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var Lk=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rp(n,e){if(e){if(Lk[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function Pp(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Np=null;function gg(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Dp=null,_o=null,yo=null;function gv(n){if(n=au(n)){if(typeof Dp!="function")throw Error(z(280));var e=n.stateNode;e&&(e=vd(e),Dp(n.stateNode,n.type,e))}}function gE(n){_o?yo?yo.push(n):yo=[n]:_o=n}function _E(){if(_o){var n=_o,e=yo;if(yo=_o=null,gv(n),e)for(n=0;n<e.length;n++)gv(e[n])}}function yE(n,e){return n(e)}function vE(){}var kf=!1;function wE(n,e,t){if(kf)return n(e,t);kf=!0;try{return yE(n,e,t)}finally{kf=!1,(_o!==null||yo!==null)&&(vE(),_E())}}function kl(n,e){var t=n.stateNode;if(t===null)return null;var r=vd(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(z(231,e,typeof t));return t}var Op=!1;if(Sr)try{var xa={};Object.defineProperty(xa,"passive",{get:function(){Op=!0}}),window.addEventListener("test",xa,xa),window.removeEventListener("test",xa,xa)}catch{Op=!1}function jk(n,e,t,r,s,i,o,a,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(d){this.onError(d)}}var sl=!1,hh=null,dh=!1,Vp=null,Fk={onError:function(n){sl=!0,hh=n}};function Uk(n,e,t,r,s,i,o,a,u){sl=!1,hh=null,jk.apply(Fk,arguments)}function $k(n,e,t,r,s,i,o,a,u){if(Uk.apply(this,arguments),sl){if(sl){var c=hh;sl=!1,hh=null}else throw Error(z(198));dh||(dh=!0,Vp=c)}}function ki(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function IE(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function _v(n){if(ki(n)!==n)throw Error(z(188))}function Bk(n){var e=n.alternate;if(!e){if(e=ki(n),e===null)throw Error(z(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return _v(s),n;if(i===r)return _v(s),e;i=i.sibling}throw Error(z(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error(z(189))}}if(t.alternate!==r)throw Error(z(190))}if(t.tag!==3)throw Error(z(188));return t.stateNode.current===t?n:e}function EE(n){return n=Bk(n),n!==null?TE(n):null}function TE(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=TE(n);if(e!==null)return e;n=n.sibling}return null}var SE=un.unstable_scheduleCallback,yv=un.unstable_cancelCallback,zk=un.unstable_shouldYield,qk=un.unstable_requestPaint,Ye=un.unstable_now,Wk=un.unstable_getCurrentPriorityLevel,_g=un.unstable_ImmediatePriority,AE=un.unstable_UserBlockingPriority,fh=un.unstable_NormalPriority,Kk=un.unstable_LowPriority,xE=un.unstable_IdlePriority,md=null,rr=null;function Gk(n){if(rr&&typeof rr.onCommitFiberRoot=="function")try{rr.onCommitFiberRoot(md,n,void 0,(n.current.flags&128)===128)}catch{}}var Fn=Math.clz32?Math.clz32:Jk,Hk=Math.log,Qk=Math.LN2;function Jk(n){return n>>>=0,n===0?32:31-(Hk(n)/Qk|0)|0}var Yu=64,Zu=4194304;function $a(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function ph(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=$a(a):(i&=o,i!==0&&(r=$a(i)))}else o=t&~s,o!==0?r=$a(o):i!==0&&(r=$a(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Fn(e),s=1<<t,r|=n[t],e&=~s;return r}function Xk(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yk(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-Fn(i),a=1<<o,u=s[o];u===-1?(!(a&t)||a&r)&&(s[o]=Xk(a,e)):u<=e&&(n.expiredLanes|=a),i&=~a}}function Mp(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function bE(){var n=Yu;return Yu<<=1,!(Yu&4194240)&&(Yu=64),n}function Cf(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function iu(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Fn(e),n[e]=t}function Zk(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-Fn(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function yg(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Fn(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var Ae=0;function kE(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var CE,vg,RE,PE,NE,Lp=!1,ec=[],os=null,as=null,ls=null,Cl=new Map,Rl=new Map,Xr=[],eC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vv(n,e){switch(n){case"focusin":case"focusout":os=null;break;case"dragenter":case"dragleave":as=null;break;case"mouseover":case"mouseout":ls=null;break;case"pointerover":case"pointerout":Cl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rl.delete(e.pointerId)}}function ba(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=au(e),e!==null&&vg(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function tC(n,e,t,r,s){switch(e){case"focusin":return os=ba(os,n,e,t,r,s),!0;case"dragenter":return as=ba(as,n,e,t,r,s),!0;case"mouseover":return ls=ba(ls,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return Cl.set(i,ba(Cl.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Rl.set(i,ba(Rl.get(i)||null,n,e,t,r,s)),!0}return!1}function DE(n){var e=Xs(n.target);if(e!==null){var t=ki(e);if(t!==null){if(e=t.tag,e===13){if(e=IE(t),e!==null){n.blockedOn=e,NE(n.priority,function(){RE(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function kc(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=jp(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Np=r,t.target.dispatchEvent(r),Np=null}else return e=au(t),e!==null&&vg(e),n.blockedOn=t,!1;e.shift()}return!0}function wv(n,e,t){kc(n)&&t.delete(e)}function nC(){Lp=!1,os!==null&&kc(os)&&(os=null),as!==null&&kc(as)&&(as=null),ls!==null&&kc(ls)&&(ls=null),Cl.forEach(wv),Rl.forEach(wv)}function ka(n,e){n.blockedOn===e&&(n.blockedOn=null,Lp||(Lp=!0,un.unstable_scheduleCallback(un.unstable_NormalPriority,nC)))}function Pl(n){function e(s){return ka(s,n)}if(0<ec.length){ka(ec[0],n);for(var t=1;t<ec.length;t++){var r=ec[t];r.blockedOn===n&&(r.blockedOn=null)}}for(os!==null&&ka(os,n),as!==null&&ka(as,n),ls!==null&&ka(ls,n),Cl.forEach(e),Rl.forEach(e),t=0;t<Xr.length;t++)r=Xr[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Xr.length&&(t=Xr[0],t.blockedOn===null);)DE(t),t.blockedOn===null&&Xr.shift()}var vo=Nr.ReactCurrentBatchConfig,mh=!0;function rC(n,e,t,r){var s=Ae,i=vo.transition;vo.transition=null;try{Ae=1,wg(n,e,t,r)}finally{Ae=s,vo.transition=i}}function sC(n,e,t,r){var s=Ae,i=vo.transition;vo.transition=null;try{Ae=4,wg(n,e,t,r)}finally{Ae=s,vo.transition=i}}function wg(n,e,t,r){if(mh){var s=jp(n,e,t,r);if(s===null)Ff(n,e,r,gh,t),vv(n,r);else if(tC(s,n,e,t,r))r.stopPropagation();else if(vv(n,r),e&4&&-1<eC.indexOf(n)){for(;s!==null;){var i=au(s);if(i!==null&&CE(i),i=jp(n,e,t,r),i===null&&Ff(n,e,r,gh,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else Ff(n,e,r,null,t)}}var gh=null;function jp(n,e,t,r){if(gh=null,n=gg(r),n=Xs(n),n!==null)if(e=ki(n),e===null)n=null;else if(t=e.tag,t===13){if(n=IE(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return gh=n,null}function OE(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wk()){case _g:return 1;case AE:return 4;case fh:case Kk:return 16;case xE:return 536870912;default:return 16}default:return 16}}var rs=null,Ig=null,Cc=null;function VE(){if(Cc)return Cc;var n,e=Ig,t=e.length,r,s="value"in rs?rs.value:rs.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return Cc=s.slice(n,1<r?1-r:void 0)}function Rc(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function tc(){return!0}function Iv(){return!1}function fn(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?tc:Iv,this.isPropagationStopped=Iv,this}return We(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=tc)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=tc)},persist:function(){},isPersistent:tc}),e}var Xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eg=fn(Xo),ou=We({},Xo,{view:0,detail:0}),iC=fn(ou),Rf,Pf,Ca,gd=We({},ou,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tg,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ca&&(Ca&&n.type==="mousemove"?(Rf=n.screenX-Ca.screenX,Pf=n.screenY-Ca.screenY):Pf=Rf=0,Ca=n),Rf)},movementY:function(n){return"movementY"in n?n.movementY:Pf}}),Ev=fn(gd),oC=We({},gd,{dataTransfer:0}),aC=fn(oC),lC=We({},ou,{relatedTarget:0}),Nf=fn(lC),uC=We({},Xo,{animationName:0,elapsedTime:0,pseudoElement:0}),cC=fn(uC),hC=We({},Xo,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),dC=fn(hC),fC=We({},Xo,{data:0}),Tv=fn(fC),pC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _C(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=gC[n])?!!e[n]:!1}function Tg(){return _C}var yC=We({},ou,{key:function(n){if(n.key){var e=pC[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Rc(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?mC[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tg,charCode:function(n){return n.type==="keypress"?Rc(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Rc(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),vC=fn(yC),wC=We({},gd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sv=fn(wC),IC=We({},ou,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tg}),EC=fn(IC),TC=We({},Xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),SC=fn(TC),AC=We({},gd,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),xC=fn(AC),bC=[9,13,27,32],Sg=Sr&&"CompositionEvent"in window,il=null;Sr&&"documentMode"in document&&(il=document.documentMode);var kC=Sr&&"TextEvent"in window&&!il,ME=Sr&&(!Sg||il&&8<il&&11>=il),Av=" ",xv=!1;function LE(n,e){switch(n){case"keyup":return bC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jE(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var so=!1;function CC(n,e){switch(n){case"compositionend":return jE(e);case"keypress":return e.which!==32?null:(xv=!0,Av);case"textInput":return n=e.data,n===Av&&xv?null:n;default:return null}}function RC(n,e){if(so)return n==="compositionend"||!Sg&&LE(n,e)?(n=VE(),Cc=Ig=rs=null,so=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ME&&e.locale!=="ko"?null:e.data;default:return null}}var PC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!PC[n.type]:e==="textarea"}function FE(n,e,t,r){gE(r),e=_h(e,"onChange"),0<e.length&&(t=new Eg("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var ol=null,Nl=null;function NC(n){JE(n,0)}function _d(n){var e=ao(n);if(uE(e))return n}function DC(n,e){if(n==="change")return e}var UE=!1;if(Sr){var Df;if(Sr){var Of="oninput"in document;if(!Of){var kv=document.createElement("div");kv.setAttribute("oninput","return;"),Of=typeof kv.oninput=="function"}Df=Of}else Df=!1;UE=Df&&(!document.documentMode||9<document.documentMode)}function Cv(){ol&&(ol.detachEvent("onpropertychange",$E),Nl=ol=null)}function $E(n){if(n.propertyName==="value"&&_d(Nl)){var e=[];FE(e,Nl,n,gg(n)),wE(NC,e)}}function OC(n,e,t){n==="focusin"?(Cv(),ol=e,Nl=t,ol.attachEvent("onpropertychange",$E)):n==="focusout"&&Cv()}function VC(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return _d(Nl)}function MC(n,e){if(n==="click")return _d(e)}function LC(n,e){if(n==="input"||n==="change")return _d(e)}function jC(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Bn=typeof Object.is=="function"?Object.is:jC;function Dl(n,e){if(Bn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!wp.call(e,s)||!Bn(n[s],e[s]))return!1}return!0}function Rv(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Pv(n,e){var t=Rv(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Rv(t)}}function BE(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?BE(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function zE(){for(var n=window,e=ch();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=ch(n.document)}return e}function Ag(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function FC(n){var e=zE(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&BE(t.ownerDocument.documentElement,t)){if(r!==null&&Ag(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=Pv(t,i);var o=Pv(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var UC=Sr&&"documentMode"in document&&11>=document.documentMode,io=null,Fp=null,al=null,Up=!1;function Nv(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Up||io==null||io!==ch(r)||(r=io,"selectionStart"in r&&Ag(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),al&&Dl(al,r)||(al=r,r=_h(Fp,"onSelect"),0<r.length&&(e=new Eg("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=io)))}function nc(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var oo={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Vf={},qE={};Sr&&(qE=document.createElement("div").style,"AnimationEvent"in window||(delete oo.animationend.animation,delete oo.animationiteration.animation,delete oo.animationstart.animation),"TransitionEvent"in window||delete oo.transitionend.transition);function yd(n){if(Vf[n])return Vf[n];if(!oo[n])return n;var e=oo[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in qE)return Vf[n]=e[t];return n}var WE=yd("animationend"),KE=yd("animationiteration"),GE=yd("animationstart"),HE=yd("transitionend"),QE=new Map,Dv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xs(n,e){QE.set(n,e),bi(e,[n])}for(var Mf=0;Mf<Dv.length;Mf++){var Lf=Dv[Mf],$C=Lf.toLowerCase(),BC=Lf[0].toUpperCase()+Lf.slice(1);xs($C,"on"+BC)}xs(WE,"onAnimationEnd");xs(KE,"onAnimationIteration");xs(GE,"onAnimationStart");xs("dblclick","onDoubleClick");xs("focusin","onFocus");xs("focusout","onBlur");xs(HE,"onTransitionEnd");xo("onMouseEnter",["mouseout","mouseover"]);xo("onMouseLeave",["mouseout","mouseover"]);xo("onPointerEnter",["pointerout","pointerover"]);xo("onPointerLeave",["pointerout","pointerover"]);bi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bi("onBeforeInput",["compositionend","keypress","textInput","paste"]);bi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ba="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zC=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ba));function Ov(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,$k(r,e,void 0,n),n.currentTarget=null}function JE(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],u=a.instance,c=a.currentTarget;if(a=a.listener,u!==i&&s.isPropagationStopped())break e;Ov(s,a,c),i=u}else for(o=0;o<r.length;o++){if(a=r[o],u=a.instance,c=a.currentTarget,a=a.listener,u!==i&&s.isPropagationStopped())break e;Ov(s,a,c),i=u}}}if(dh)throw n=Vp,dh=!1,Vp=null,n}function Me(n,e){var t=e[Wp];t===void 0&&(t=e[Wp]=new Set);var r=n+"__bubble";t.has(r)||(XE(e,n,2,!1),t.add(r))}function jf(n,e,t){var r=0;e&&(r|=4),XE(t,n,r,e)}var rc="_reactListening"+Math.random().toString(36).slice(2);function Ol(n){if(!n[rc]){n[rc]=!0,sE.forEach(function(t){t!=="selectionchange"&&(zC.has(t)||jf(t,!1,n),jf(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[rc]||(e[rc]=!0,jf("selectionchange",!1,e))}}function XE(n,e,t,r){switch(OE(e)){case 1:var s=rC;break;case 4:s=sC;break;default:s=wg}t=s.bind(null,e,t,n),s=void 0,!Op||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function Ff(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Xs(a),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}a=a.parentNode}}r=r.return}wE(function(){var c=i,d=gg(t),f=[];e:{var m=QE.get(n);if(m!==void 0){var _=Eg,E=n;switch(n){case"keypress":if(Rc(t)===0)break e;case"keydown":case"keyup":_=vC;break;case"focusin":E="focus",_=Nf;break;case"focusout":E="blur",_=Nf;break;case"beforeblur":case"afterblur":_=Nf;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=Ev;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=aC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=EC;break;case WE:case KE:case GE:_=cC;break;case HE:_=SC;break;case"scroll":_=iC;break;case"wheel":_=xC;break;case"copy":case"cut":case"paste":_=dC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Sv}var k=(e&4)!==0,N=!k&&n==="scroll",x=k?m!==null?m+"Capture":null:m;k=[];for(var y=c,S;y!==null;){S=y;var R=S.stateNode;if(S.tag===5&&R!==null&&(S=R,x!==null&&(R=kl(y,x),R!=null&&k.push(Vl(y,R,S)))),N)break;y=y.return}0<k.length&&(m=new _(m,E,null,t,d),f.push({event:m,listeners:k}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",_=n==="mouseout"||n==="pointerout",m&&t!==Np&&(E=t.relatedTarget||t.fromElement)&&(Xs(E)||E[Ar]))break e;if((_||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,_?(E=t.relatedTarget||t.toElement,_=c,E=E?Xs(E):null,E!==null&&(N=ki(E),E!==N||E.tag!==5&&E.tag!==6)&&(E=null)):(_=null,E=c),_!==E)){if(k=Ev,R="onMouseLeave",x="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(k=Sv,R="onPointerLeave",x="onPointerEnter",y="pointer"),N=_==null?m:ao(_),S=E==null?m:ao(E),m=new k(R,y+"leave",_,t,d),m.target=N,m.relatedTarget=S,R=null,Xs(d)===c&&(k=new k(x,y+"enter",E,t,d),k.target=S,k.relatedTarget=N,R=k),N=R,_&&E)t:{for(k=_,x=E,y=0,S=k;S;S=ji(S))y++;for(S=0,R=x;R;R=ji(R))S++;for(;0<y-S;)k=ji(k),y--;for(;0<S-y;)x=ji(x),S--;for(;y--;){if(k===x||x!==null&&k===x.alternate)break t;k=ji(k),x=ji(x)}k=null}else k=null;_!==null&&Vv(f,m,_,k,!1),E!==null&&N!==null&&Vv(f,N,E,k,!0)}}e:{if(m=c?ao(c):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var j=DC;else if(bv(m))if(UE)j=LC;else{j=VC;var M=OC}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(j=MC);if(j&&(j=j(n,c))){FE(f,j,t,d);break e}M&&M(n,m,c),n==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&bp(m,"number",m.value)}switch(M=c?ao(c):window,n){case"focusin":(bv(M)||M.contentEditable==="true")&&(io=M,Fp=c,al=null);break;case"focusout":al=Fp=io=null;break;case"mousedown":Up=!0;break;case"contextmenu":case"mouseup":case"dragend":Up=!1,Nv(f,t,d);break;case"selectionchange":if(UC)break;case"keydown":case"keyup":Nv(f,t,d)}var w;if(Sg)e:{switch(n){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else so?LE(n,t)&&(v="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(v="onCompositionStart");v&&(ME&&t.locale!=="ko"&&(so||v!=="onCompositionStart"?v==="onCompositionEnd"&&so&&(w=VE()):(rs=d,Ig="value"in rs?rs.value:rs.textContent,so=!0)),M=_h(c,v),0<M.length&&(v=new Tv(v,n,null,t,d),f.push({event:v,listeners:M}),w?v.data=w:(w=jE(t),w!==null&&(v.data=w)))),(w=kC?CC(n,t):RC(n,t))&&(c=_h(c,"onBeforeInput"),0<c.length&&(d=new Tv("onBeforeInput","beforeinput",null,t,d),f.push({event:d,listeners:c}),d.data=w))}JE(f,e)})}function Vl(n,e,t){return{instance:n,listener:e,currentTarget:t}}function _h(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=kl(n,t),i!=null&&r.unshift(Vl(n,i,s)),i=kl(n,e),i!=null&&r.push(Vl(n,i,s))),n=n.return}return r}function ji(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Vv(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,u=a.alternate,c=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&c!==null&&(a=c,s?(u=kl(t,i),u!=null&&o.unshift(Vl(t,u,a))):s||(u=kl(t,i),u!=null&&o.push(Vl(t,u,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var qC=/\r\n?/g,WC=/\u0000|\uFFFD/g;function Mv(n){return(typeof n=="string"?n:""+n).replace(qC,`
`).replace(WC,"")}function sc(n,e,t){if(e=Mv(e),Mv(n)!==e&&t)throw Error(z(425))}function yh(){}var $p=null,Bp=null;function zp(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var qp=typeof setTimeout=="function"?setTimeout:void 0,KC=typeof clearTimeout=="function"?clearTimeout:void 0,Lv=typeof Promise=="function"?Promise:void 0,GC=typeof queueMicrotask=="function"?queueMicrotask:typeof Lv<"u"?function(n){return Lv.resolve(null).then(n).catch(HC)}:qp;function HC(n){setTimeout(function(){throw n})}function Uf(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),Pl(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);Pl(e)}function us(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function jv(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Yo=Math.random().toString(36).slice(2),Zn="__reactFiber$"+Yo,Ml="__reactProps$"+Yo,Ar="__reactContainer$"+Yo,Wp="__reactEvents$"+Yo,QC="__reactListeners$"+Yo,JC="__reactHandles$"+Yo;function Xs(n){var e=n[Zn];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ar]||t[Zn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=jv(n);n!==null;){if(t=n[Zn])return t;n=jv(n)}return e}n=t,t=n.parentNode}return null}function au(n){return n=n[Zn]||n[Ar],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ao(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(z(33))}function vd(n){return n[Ml]||null}var Kp=[],lo=-1;function bs(n){return{current:n}}function Le(n){0>lo||(n.current=Kp[lo],Kp[lo]=null,lo--)}function De(n,e){lo++,Kp[lo]=n.current,n.current=e}var ws={},Mt=bs(ws),Qt=bs(!1),hi=ws;function bo(n,e){var t=n.type.contextTypes;if(!t)return ws;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function Jt(n){return n=n.childContextTypes,n!=null}function vh(){Le(Qt),Le(Mt)}function Fv(n,e,t){if(Mt.current!==ws)throw Error(z(168));De(Mt,e),De(Qt,t)}function YE(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(z(108,Ok(n)||"Unknown",s));return We({},t,r)}function wh(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ws,hi=Mt.current,De(Mt,n),De(Qt,Qt.current),!0}function Uv(n,e,t){var r=n.stateNode;if(!r)throw Error(z(169));t?(n=YE(n,e,hi),r.__reactInternalMemoizedMergedChildContext=n,Le(Qt),Le(Mt),De(Mt,n)):Le(Qt),De(Qt,t)}var mr=null,wd=!1,$f=!1;function ZE(n){mr===null?mr=[n]:mr.push(n)}function XC(n){wd=!0,ZE(n)}function ks(){if(!$f&&mr!==null){$f=!0;var n=0,e=Ae;try{var t=mr;for(Ae=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}mr=null,wd=!1}catch(s){throw mr!==null&&(mr=mr.slice(n+1)),SE(_g,ks),s}finally{Ae=e,$f=!1}}return null}var uo=[],co=0,Ih=null,Eh=0,_n=[],yn=0,di=null,_r=1,yr="";function Us(n,e){uo[co++]=Eh,uo[co++]=Ih,Ih=n,Eh=e}function eT(n,e,t){_n[yn++]=_r,_n[yn++]=yr,_n[yn++]=di,di=n;var r=_r;n=yr;var s=32-Fn(r)-1;r&=~(1<<s),t+=1;var i=32-Fn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,_r=1<<32-Fn(e)+s|t<<s|r,yr=i+n}else _r=1<<i|t<<s|r,yr=n}function xg(n){n.return!==null&&(Us(n,1),eT(n,1,0))}function bg(n){for(;n===Ih;)Ih=uo[--co],uo[co]=null,Eh=uo[--co],uo[co]=null;for(;n===di;)di=_n[--yn],_n[yn]=null,yr=_n[--yn],_n[yn]=null,_r=_n[--yn],_n[yn]=null}var ln=null,sn=null,Ue=!1,Mn=null;function tT(n,e){var t=wn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function $v(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,ln=n,sn=us(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,ln=n,sn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=di!==null?{id:_r,overflow:yr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=wn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,ln=n,sn=null,!0):!1;default:return!1}}function Gp(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Hp(n){if(Ue){var e=sn;if(e){var t=e;if(!$v(n,e)){if(Gp(n))throw Error(z(418));e=us(t.nextSibling);var r=ln;e&&$v(n,e)?tT(r,t):(n.flags=n.flags&-4097|2,Ue=!1,ln=n)}}else{if(Gp(n))throw Error(z(418));n.flags=n.flags&-4097|2,Ue=!1,ln=n}}}function Bv(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;ln=n}function ic(n){if(n!==ln)return!1;if(!Ue)return Bv(n),Ue=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!zp(n.type,n.memoizedProps)),e&&(e=sn)){if(Gp(n))throw nT(),Error(z(418));for(;e;)tT(n,e),e=us(e.nextSibling)}if(Bv(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(z(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){sn=us(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}sn=null}}else sn=ln?us(n.stateNode.nextSibling):null;return!0}function nT(){for(var n=sn;n;)n=us(n.nextSibling)}function ko(){sn=ln=null,Ue=!1}function kg(n){Mn===null?Mn=[n]:Mn.push(n)}var YC=Nr.ReactCurrentBatchConfig;function Ra(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(z(309));var r=t.stateNode}if(!r)throw Error(z(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(z(284));if(!t._owner)throw Error(z(290,n))}return n}function oc(n,e){throw n=Object.prototype.toString.call(e),Error(z(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function zv(n){var e=n._init;return e(n._payload)}function rT(n){function e(x,y){if(n){var S=x.deletions;S===null?(x.deletions=[y],x.flags|=16):S.push(y)}}function t(x,y){if(!n)return null;for(;y!==null;)e(x,y),y=y.sibling;return null}function r(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function s(x,y){return x=fs(x,y),x.index=0,x.sibling=null,x}function i(x,y,S){return x.index=S,n?(S=x.alternate,S!==null?(S=S.index,S<y?(x.flags|=2,y):S):(x.flags|=2,y)):(x.flags|=1048576,y)}function o(x){return n&&x.alternate===null&&(x.flags|=2),x}function a(x,y,S,R){return y===null||y.tag!==6?(y=Hf(S,x.mode,R),y.return=x,y):(y=s(y,S),y.return=x,y)}function u(x,y,S,R){var j=S.type;return j===ro?d(x,y,S.props.children,R,S.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Qr&&zv(j)===y.type)?(R=s(y,S.props),R.ref=Ra(x,y,S),R.return=x,R):(R=Lc(S.type,S.key,S.props,null,x.mode,R),R.ref=Ra(x,y,S),R.return=x,R)}function c(x,y,S,R){return y===null||y.tag!==4||y.stateNode.containerInfo!==S.containerInfo||y.stateNode.implementation!==S.implementation?(y=Qf(S,x.mode,R),y.return=x,y):(y=s(y,S.children||[]),y.return=x,y)}function d(x,y,S,R,j){return y===null||y.tag!==7?(y=ii(S,x.mode,R,j),y.return=x,y):(y=s(y,S),y.return=x,y)}function f(x,y,S){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Hf(""+y,x.mode,S),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Qu:return S=Lc(y.type,y.key,y.props,null,x.mode,S),S.ref=Ra(x,null,y),S.return=x,S;case no:return y=Qf(y,x.mode,S),y.return=x,y;case Qr:var R=y._init;return f(x,R(y._payload),S)}if(Ua(y)||Aa(y))return y=ii(y,x.mode,S,null),y.return=x,y;oc(x,y)}return null}function m(x,y,S,R){var j=y!==null?y.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return j!==null?null:a(x,y,""+S,R);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Qu:return S.key===j?u(x,y,S,R):null;case no:return S.key===j?c(x,y,S,R):null;case Qr:return j=S._init,m(x,y,j(S._payload),R)}if(Ua(S)||Aa(S))return j!==null?null:d(x,y,S,R,null);oc(x,S)}return null}function _(x,y,S,R,j){if(typeof R=="string"&&R!==""||typeof R=="number")return x=x.get(S)||null,a(y,x,""+R,j);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Qu:return x=x.get(R.key===null?S:R.key)||null,u(y,x,R,j);case no:return x=x.get(R.key===null?S:R.key)||null,c(y,x,R,j);case Qr:var M=R._init;return _(x,y,S,M(R._payload),j)}if(Ua(R)||Aa(R))return x=x.get(S)||null,d(y,x,R,j,null);oc(y,R)}return null}function E(x,y,S,R){for(var j=null,M=null,w=y,v=y=0,T=null;w!==null&&v<S.length;v++){w.index>v?(T=w,w=null):T=w.sibling;var A=m(x,w,S[v],R);if(A===null){w===null&&(w=T);break}n&&w&&A.alternate===null&&e(x,w),y=i(A,y,v),M===null?j=A:M.sibling=A,M=A,w=T}if(v===S.length)return t(x,w),Ue&&Us(x,v),j;if(w===null){for(;v<S.length;v++)w=f(x,S[v],R),w!==null&&(y=i(w,y,v),M===null?j=w:M.sibling=w,M=w);return Ue&&Us(x,v),j}for(w=r(x,w);v<S.length;v++)T=_(w,x,v,S[v],R),T!==null&&(n&&T.alternate!==null&&w.delete(T.key===null?v:T.key),y=i(T,y,v),M===null?j=T:M.sibling=T,M=T);return n&&w.forEach(function(b){return e(x,b)}),Ue&&Us(x,v),j}function k(x,y,S,R){var j=Aa(S);if(typeof j!="function")throw Error(z(150));if(S=j.call(S),S==null)throw Error(z(151));for(var M=j=null,w=y,v=y=0,T=null,A=S.next();w!==null&&!A.done;v++,A=S.next()){w.index>v?(T=w,w=null):T=w.sibling;var b=m(x,w,A.value,R);if(b===null){w===null&&(w=T);break}n&&w&&b.alternate===null&&e(x,w),y=i(b,y,v),M===null?j=b:M.sibling=b,M=b,w=T}if(A.done)return t(x,w),Ue&&Us(x,v),j;if(w===null){for(;!A.done;v++,A=S.next())A=f(x,A.value,R),A!==null&&(y=i(A,y,v),M===null?j=A:M.sibling=A,M=A);return Ue&&Us(x,v),j}for(w=r(x,w);!A.done;v++,A=S.next())A=_(w,x,v,A.value,R),A!==null&&(n&&A.alternate!==null&&w.delete(A.key===null?v:A.key),y=i(A,y,v),M===null?j=A:M.sibling=A,M=A);return n&&w.forEach(function(P){return e(x,P)}),Ue&&Us(x,v),j}function N(x,y,S,R){if(typeof S=="object"&&S!==null&&S.type===ro&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Qu:e:{for(var j=S.key,M=y;M!==null;){if(M.key===j){if(j=S.type,j===ro){if(M.tag===7){t(x,M.sibling),y=s(M,S.props.children),y.return=x,x=y;break e}}else if(M.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Qr&&zv(j)===M.type){t(x,M.sibling),y=s(M,S.props),y.ref=Ra(x,M,S),y.return=x,x=y;break e}t(x,M);break}else e(x,M);M=M.sibling}S.type===ro?(y=ii(S.props.children,x.mode,R,S.key),y.return=x,x=y):(R=Lc(S.type,S.key,S.props,null,x.mode,R),R.ref=Ra(x,y,S),R.return=x,x=R)}return o(x);case no:e:{for(M=S.key;y!==null;){if(y.key===M)if(y.tag===4&&y.stateNode.containerInfo===S.containerInfo&&y.stateNode.implementation===S.implementation){t(x,y.sibling),y=s(y,S.children||[]),y.return=x,x=y;break e}else{t(x,y);break}else e(x,y);y=y.sibling}y=Qf(S,x.mode,R),y.return=x,x=y}return o(x);case Qr:return M=S._init,N(x,y,M(S._payload),R)}if(Ua(S))return E(x,y,S,R);if(Aa(S))return k(x,y,S,R);oc(x,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,y!==null&&y.tag===6?(t(x,y.sibling),y=s(y,S),y.return=x,x=y):(t(x,y),y=Hf(S,x.mode,R),y.return=x,x=y),o(x)):t(x,y)}return N}var Co=rT(!0),sT=rT(!1),Th=bs(null),Sh=null,ho=null,Cg=null;function Rg(){Cg=ho=Sh=null}function Pg(n){var e=Th.current;Le(Th),n._currentValue=e}function Qp(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function wo(n,e){Sh=n,Cg=ho=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Ht=!0),n.firstContext=null)}function xn(n){var e=n._currentValue;if(Cg!==n)if(n={context:n,memoizedValue:e,next:null},ho===null){if(Sh===null)throw Error(z(308));ho=n,Sh.dependencies={lanes:0,firstContext:n}}else ho=ho.next=n;return e}var Ys=null;function Ng(n){Ys===null?Ys=[n]:Ys.push(n)}function iT(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,Ng(e)):(t.next=s.next,s.next=t),e.interleaved=t,xr(n,r)}function xr(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Jr=!1;function Dg(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oT(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Er(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function cs(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Ee&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,xr(n,t)}return s=r.interleaved,s===null?(e.next=e,Ng(r)):(e.next=s.next,s.next=e),r.interleaved=e,xr(n,t)}function Pc(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,yg(n,t)}}function qv(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Ah(n,e,t,r){var s=n.updateQueue;Jr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var u=a,c=u.next;u.next=null,o===null?i=c:o.next=c,o=u;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=u))}if(i!==null){var f=s.baseState;o=0,d=c=u=null,a=i;do{var m=a.lane,_=a.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=n,k=a;switch(m=e,_=t,k.tag){case 1:if(E=k.payload,typeof E=="function"){f=E.call(_,f,m);break e}f=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=k.payload,m=typeof E=="function"?E.call(_,f,m):E,m==null)break e;f=We({},f,m);break e;case 2:Jr=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else _={eventTime:_,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=_,u=f):d=d.next=_,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(d===null&&(u=f),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);pi|=o,n.lanes=o,n.memoizedState=f}}function Wv(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(z(191,s));s.call(r)}}}var lu={},sr=bs(lu),Ll=bs(lu),jl=bs(lu);function Zs(n){if(n===lu)throw Error(z(174));return n}function Og(n,e){switch(De(jl,e),De(Ll,n),De(sr,lu),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cp(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Cp(e,n)}Le(sr),De(sr,e)}function Ro(){Le(sr),Le(Ll),Le(jl)}function aT(n){Zs(jl.current);var e=Zs(sr.current),t=Cp(e,n.type);e!==t&&(De(Ll,n),De(sr,t))}function Vg(n){Ll.current===n&&(Le(sr),Le(Ll))}var Be=bs(0);function xh(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Bf=[];function Mg(){for(var n=0;n<Bf.length;n++)Bf[n]._workInProgressVersionPrimary=null;Bf.length=0}var Nc=Nr.ReactCurrentDispatcher,zf=Nr.ReactCurrentBatchConfig,fi=0,qe=null,lt=null,_t=null,bh=!1,ll=!1,Fl=0,ZC=0;function Rt(){throw Error(z(321))}function Lg(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Bn(n[t],e[t]))return!1;return!0}function jg(n,e,t,r,s,i){if(fi=i,qe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Nc.current=n===null||n.memoizedState===null?rR:sR,n=t(r,s),ll){i=0;do{if(ll=!1,Fl=0,25<=i)throw Error(z(301));i+=1,_t=lt=null,e.updateQueue=null,Nc.current=iR,n=t(r,s)}while(ll)}if(Nc.current=kh,e=lt!==null&&lt.next!==null,fi=0,_t=lt=qe=null,bh=!1,e)throw Error(z(300));return n}function Fg(){var n=Fl!==0;return Fl=0,n}function Jn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _t===null?qe.memoizedState=_t=n:_t=_t.next=n,_t}function bn(){if(lt===null){var n=qe.alternate;n=n!==null?n.memoizedState:null}else n=lt.next;var e=_t===null?qe.memoizedState:_t.next;if(e!==null)_t=e,lt=n;else{if(n===null)throw Error(z(310));lt=n,n={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},_t===null?qe.memoizedState=_t=n:_t=_t.next=n}return _t}function Ul(n,e){return typeof e=="function"?e(n):e}function qf(n){var e=bn(),t=e.queue;if(t===null)throw Error(z(311));t.lastRenderedReducer=n;var r=lt,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,u=null,c=i;do{var d=c.lane;if((fi&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(a=u=f,o=r):u=u.next=f,qe.lanes|=d,pi|=d}c=c.next}while(c!==null&&c!==i);u===null?o=r:u.next=a,Bn(r,e.memoizedState)||(Ht=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,qe.lanes|=i,pi|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Wf(n){var e=bn(),t=e.queue;if(t===null)throw Error(z(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);Bn(i,e.memoizedState)||(Ht=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function lT(){}function uT(n,e){var t=qe,r=bn(),s=e(),i=!Bn(r.memoizedState,s);if(i&&(r.memoizedState=s,Ht=!0),r=r.queue,Ug(dT.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||_t!==null&&_t.memoizedState.tag&1){if(t.flags|=2048,$l(9,hT.bind(null,t,r,s,e),void 0,null),vt===null)throw Error(z(349));fi&30||cT(t,e,s)}return s}function cT(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=qe.updateQueue,e===null?(e={lastEffect:null,stores:null},qe.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function hT(n,e,t,r){e.value=t,e.getSnapshot=r,fT(e)&&pT(n)}function dT(n,e,t){return t(function(){fT(e)&&pT(n)})}function fT(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Bn(n,t)}catch{return!0}}function pT(n){var e=xr(n,1);e!==null&&Un(e,n,1,-1)}function Kv(n){var e=Jn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ul,lastRenderedState:n},e.queue=n,n=n.dispatch=nR.bind(null,qe,n),[e.memoizedState,n]}function $l(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=qe.updateQueue,e===null?(e={lastEffect:null,stores:null},qe.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function mT(){return bn().memoizedState}function Dc(n,e,t,r){var s=Jn();qe.flags|=n,s.memoizedState=$l(1|e,t,void 0,r===void 0?null:r)}function Id(n,e,t,r){var s=bn();r=r===void 0?null:r;var i=void 0;if(lt!==null){var o=lt.memoizedState;if(i=o.destroy,r!==null&&Lg(r,o.deps)){s.memoizedState=$l(e,t,i,r);return}}qe.flags|=n,s.memoizedState=$l(1|e,t,i,r)}function Gv(n,e){return Dc(8390656,8,n,e)}function Ug(n,e){return Id(2048,8,n,e)}function gT(n,e){return Id(4,2,n,e)}function _T(n,e){return Id(4,4,n,e)}function yT(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function vT(n,e,t){return t=t!=null?t.concat([n]):null,Id(4,4,yT.bind(null,e,n),t)}function $g(){}function wT(n,e){var t=bn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Lg(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function IT(n,e){var t=bn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Lg(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function ET(n,e,t){return fi&21?(Bn(t,e)||(t=bE(),qe.lanes|=t,pi|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Ht=!0),n.memoizedState=t)}function eR(n,e){var t=Ae;Ae=t!==0&&4>t?t:4,n(!0);var r=zf.transition;zf.transition={};try{n(!1),e()}finally{Ae=t,zf.transition=r}}function TT(){return bn().memoizedState}function tR(n,e,t){var r=ds(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},ST(n))AT(e,t);else if(t=iT(n,e,t,r),t!==null){var s=$t();Un(t,n,r,s),xT(t,e,r)}}function nR(n,e,t){var r=ds(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(ST(n))AT(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,Bn(a,o)){var u=e.interleaved;u===null?(s.next=s,Ng(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}t=iT(n,e,s,r),t!==null&&(s=$t(),Un(t,n,r,s),xT(t,e,r))}}function ST(n){var e=n.alternate;return n===qe||e!==null&&e===qe}function AT(n,e){ll=bh=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function xT(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,yg(n,t)}}var kh={readContext:xn,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useInsertionEffect:Rt,useLayoutEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useMutableSource:Rt,useSyncExternalStore:Rt,useId:Rt,unstable_isNewReconciler:!1},rR={readContext:xn,useCallback:function(n,e){return Jn().memoizedState=[n,e===void 0?null:e],n},useContext:xn,useEffect:Gv,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Dc(4194308,4,yT.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Dc(4194308,4,n,e)},useInsertionEffect:function(n,e){return Dc(4,2,n,e)},useMemo:function(n,e){var t=Jn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Jn();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=tR.bind(null,qe,n),[r.memoizedState,n]},useRef:function(n){var e=Jn();return n={current:n},e.memoizedState=n},useState:Kv,useDebugValue:$g,useDeferredValue:function(n){return Jn().memoizedState=n},useTransition:function(){var n=Kv(!1),e=n[0];return n=eR.bind(null,n[1]),Jn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=qe,s=Jn();if(Ue){if(t===void 0)throw Error(z(407));t=t()}else{if(t=e(),vt===null)throw Error(z(349));fi&30||cT(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,Gv(dT.bind(null,r,i,n),[n]),r.flags|=2048,$l(9,hT.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=Jn(),e=vt.identifierPrefix;if(Ue){var t=yr,r=_r;t=(r&~(1<<32-Fn(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Fl++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=ZC++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},sR={readContext:xn,useCallback:wT,useContext:xn,useEffect:Ug,useImperativeHandle:vT,useInsertionEffect:gT,useLayoutEffect:_T,useMemo:IT,useReducer:qf,useRef:mT,useState:function(){return qf(Ul)},useDebugValue:$g,useDeferredValue:function(n){var e=bn();return ET(e,lt.memoizedState,n)},useTransition:function(){var n=qf(Ul)[0],e=bn().memoizedState;return[n,e]},useMutableSource:lT,useSyncExternalStore:uT,useId:TT,unstable_isNewReconciler:!1},iR={readContext:xn,useCallback:wT,useContext:xn,useEffect:Ug,useImperativeHandle:vT,useInsertionEffect:gT,useLayoutEffect:_T,useMemo:IT,useReducer:Wf,useRef:mT,useState:function(){return Wf(Ul)},useDebugValue:$g,useDeferredValue:function(n){var e=bn();return lt===null?e.memoizedState=n:ET(e,lt.memoizedState,n)},useTransition:function(){var n=Wf(Ul)[0],e=bn().memoizedState;return[n,e]},useMutableSource:lT,useSyncExternalStore:uT,useId:TT,unstable_isNewReconciler:!1};function Nn(n,e){if(n&&n.defaultProps){e=We({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Jp(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:We({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Ed={isMounted:function(n){return(n=n._reactInternals)?ki(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=$t(),s=ds(n),i=Er(r,s);i.payload=e,t!=null&&(i.callback=t),e=cs(n,i,s),e!==null&&(Un(e,n,s,r),Pc(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=$t(),s=ds(n),i=Er(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=cs(n,i,s),e!==null&&(Un(e,n,s,r),Pc(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=$t(),r=ds(n),s=Er(t,r);s.tag=2,e!=null&&(s.callback=e),e=cs(n,s,r),e!==null&&(Un(e,n,r,t),Pc(e,n,r))}};function Hv(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Dl(t,r)||!Dl(s,i):!0}function bT(n,e,t){var r=!1,s=ws,i=e.contextType;return typeof i=="object"&&i!==null?i=xn(i):(s=Jt(e)?hi:Mt.current,r=e.contextTypes,i=(r=r!=null)?bo(n,s):ws),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ed,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function Qv(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Ed.enqueueReplaceState(e,e.state,null)}function Xp(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},Dg(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=xn(i):(i=Jt(e)?hi:Mt.current,s.context=bo(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Jp(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ed.enqueueReplaceState(s,s.state,null),Ah(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Po(n,e){try{var t="",r=e;do t+=Dk(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function Kf(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Yp(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var oR=typeof WeakMap=="function"?WeakMap:Map;function kT(n,e,t){t=Er(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Rh||(Rh=!0,lm=r),Yp(n,e)},t}function CT(n,e,t){t=Er(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){Yp(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){Yp(n,e),typeof r!="function"&&(hs===null?hs=new Set([this]):hs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function Jv(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new oR;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=wR.bind(null,n,e,t),e.then(n,n))}function Xv(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Yv(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Er(-1,1),e.tag=2,cs(t,e,1))),t.lanes|=1),n)}var aR=Nr.ReactCurrentOwner,Ht=!1;function Ft(n,e,t,r){e.child=n===null?sT(e,null,t,r):Co(e,n.child,t,r)}function Zv(n,e,t,r,s){t=t.render;var i=e.ref;return wo(e,s),r=jg(n,e,t,r,i,s),t=Fg(),n!==null&&!Ht?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,br(n,e,s)):(Ue&&t&&xg(e),e.flags|=1,Ft(n,e,r,s),e.child)}function ew(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!Qg(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,RT(n,e,i,r,s)):(n=Lc(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:Dl,t(o,r)&&n.ref===e.ref)return br(n,e,s)}return e.flags|=1,n=fs(i,r),n.ref=e.ref,n.return=e,e.child=n}function RT(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(Dl(i,r)&&n.ref===e.ref)if(Ht=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(Ht=!0);else return e.lanes=n.lanes,br(n,e,s)}return Zp(n,e,t,r,s)}function PT(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(po,nn),nn|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,De(po,nn),nn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,De(po,nn),nn|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,De(po,nn),nn|=r;return Ft(n,e,s,t),e.child}function NT(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Zp(n,e,t,r,s){var i=Jt(t)?hi:Mt.current;return i=bo(e,i),wo(e,s),t=jg(n,e,t,r,i,s),r=Fg(),n!==null&&!Ht?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,br(n,e,s)):(Ue&&r&&xg(e),e.flags|=1,Ft(n,e,t,s),e.child)}function tw(n,e,t,r,s){if(Jt(t)){var i=!0;wh(e)}else i=!1;if(wo(e,s),e.stateNode===null)Oc(n,e),bT(e,t,r),Xp(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var u=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=xn(c):(c=Jt(t)?hi:Mt.current,c=bo(e,c));var d=t.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||u!==c)&&Qv(e,o,r,c),Jr=!1;var m=e.memoizedState;o.state=m,Ah(e,r,o,s),u=e.memoizedState,a!==r||m!==u||Qt.current||Jr?(typeof d=="function"&&(Jp(e,t,d,r),u=e.memoizedState),(a=Jr||Hv(e,t,a,r,m,u,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,oT(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Nn(e.type,a),o.props=c,f=e.pendingProps,m=o.context,u=t.contextType,typeof u=="object"&&u!==null?u=xn(u):(u=Jt(t)?hi:Mt.current,u=bo(e,u));var _=t.getDerivedStateFromProps;(d=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==u)&&Qv(e,o,r,u),Jr=!1,m=e.memoizedState,o.state=m,Ah(e,r,o,s);var E=e.memoizedState;a!==f||m!==E||Qt.current||Jr?(typeof _=="function"&&(Jp(e,t,_,r),E=e.memoizedState),(c=Jr||Hv(e,t,c,r,m,E,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),r=!1)}return em(n,e,t,r,i,s)}function em(n,e,t,r,s,i){NT(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Uv(e,t,!1),br(n,e,i);r=e.stateNode,aR.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Co(e,n.child,null,i),e.child=Co(e,null,a,i)):Ft(n,e,a,i),e.memoizedState=r.state,s&&Uv(e,t,!0),e.child}function DT(n){var e=n.stateNode;e.pendingContext?Fv(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Fv(n,e.context,!1),Og(n,e.containerInfo)}function nw(n,e,t,r,s){return ko(),kg(s),e.flags|=256,Ft(n,e,t,r),e.child}var tm={dehydrated:null,treeContext:null,retryLane:0};function nm(n){return{baseLanes:n,cachePool:null,transitions:null}}function OT(n,e,t){var r=e.pendingProps,s=Be.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),De(Be,s&1),n===null)return Hp(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ad(o,r,0,null),n=ii(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=nm(t),e.memoizedState=tm,n):Bg(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return lR(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=fs(s,u),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=fs(a,i):(i=ii(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?nm(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=tm,r}return i=n.child,n=i.sibling,r=fs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Bg(n,e){return e=Ad({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function ac(n,e,t,r){return r!==null&&kg(r),Co(e,n.child,null,t),n=Bg(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function lR(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=Kf(Error(z(422))),ac(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Ad({mode:"visible",children:r.children},s,0,null),i=ii(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Co(e,n.child,null,o),e.child.memoizedState=nm(o),e.memoizedState=tm,i);if(!(e.mode&1))return ac(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(z(419)),r=Kf(i,r,void 0),ac(n,e,o,r)}if(a=(o&n.childLanes)!==0,Ht||a){if(r=vt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,xr(n,s),Un(r,n,s,-1))}return Hg(),r=Kf(Error(z(421))),ac(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=IR.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,sn=us(s.nextSibling),ln=e,Ue=!0,Mn=null,n!==null&&(_n[yn++]=_r,_n[yn++]=yr,_n[yn++]=di,_r=n.id,yr=n.overflow,di=e),e=Bg(e,r.children),e.flags|=4096,e)}function rw(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Qp(n.return,e,t)}function Gf(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function VT(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Ft(n,e,r.children,t),r=Be.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&rw(n,t,e);else if(n.tag===19)rw(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(De(Be,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&xh(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),Gf(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&xh(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}Gf(e,!0,t,null,i);break;case"together":Gf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Oc(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function br(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),pi|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(z(153));if(e.child!==null){for(n=e.child,t=fs(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=fs(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function uR(n,e,t){switch(e.tag){case 3:DT(e),ko();break;case 5:aT(e);break;case 1:Jt(e.type)&&wh(e);break;case 4:Og(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;De(Th,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(De(Be,Be.current&1),e.flags|=128,null):t&e.child.childLanes?OT(n,e,t):(De(Be,Be.current&1),n=br(n,e,t),n!==null?n.sibling:null);De(Be,Be.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return VT(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),De(Be,Be.current),r)break;return null;case 22:case 23:return e.lanes=0,PT(n,e,t)}return br(n,e,t)}var MT,rm,LT,jT;MT=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};rm=function(){};LT=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,Zs(sr.current);var i=null;switch(t){case"input":s=Ap(n,s),r=Ap(n,r),i=[];break;case"select":s=We({},s,{value:void 0}),r=We({},r,{value:void 0}),i=[];break;case"textarea":s=kp(n,s),r=kp(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=yh)}Rp(t,r);var o;t=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(xl.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==a&&(u!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in u)u.hasOwnProperty(o)&&a[o]!==u[o]&&(t||(t={}),t[o]=u[o])}else t||(i||(i=[]),i.push(c,t)),t=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(xl.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Me("scroll",n),i||a===u||(i=[])):(i=i||[]).push(c,u))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};jT=function(n,e,t,r){t!==r&&(e.flags|=4)};function Pa(n,e){if(!Ue)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Pt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function cR(n,e,t){var r=e.pendingProps;switch(bg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pt(e),null;case 1:return Jt(e.type)&&vh(),Pt(e),null;case 3:return r=e.stateNode,Ro(),Le(Qt),Le(Mt),Mg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(ic(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Mn!==null&&(hm(Mn),Mn=null))),rm(n,e),Pt(e),null;case 5:Vg(e);var s=Zs(jl.current);if(t=e.type,n!==null&&e.stateNode!=null)LT(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return Pt(e),null}if(n=Zs(sr.current),ic(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[Zn]=e,r[Ml]=i,n=(e.mode&1)!==0,t){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(s=0;s<Ba.length;s++)Me(Ba[s],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":dv(r,i),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Me("invalid",r);break;case"textarea":pv(r,i),Me("invalid",r)}Rp(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&sc(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&sc(r.textContent,a,n),s=["children",""+a]):xl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Me("scroll",r)}switch(t){case"input":Ju(r),fv(r,i,!0);break;case"textarea":Ju(r),mv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=yh)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=dE(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Zn]=e,n[Ml]=r,MT(n,e,!1,!1),e.stateNode=n;e:{switch(o=Pp(t,r),t){case"dialog":Me("cancel",n),Me("close",n),s=r;break;case"iframe":case"object":case"embed":Me("load",n),s=r;break;case"video":case"audio":for(s=0;s<Ba.length;s++)Me(Ba[s],n);s=r;break;case"source":Me("error",n),s=r;break;case"img":case"image":case"link":Me("error",n),Me("load",n),s=r;break;case"details":Me("toggle",n),s=r;break;case"input":dv(n,r),s=Ap(n,r),Me("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=We({},r,{value:void 0}),Me("invalid",n);break;case"textarea":pv(n,r),s=kp(n,r),Me("invalid",n);break;default:s=r}Rp(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var u=a[i];i==="style"?mE(n,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&fE(n,u)):i==="children"?typeof u=="string"?(t!=="textarea"||u!=="")&&bl(n,u):typeof u=="number"&&bl(n,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(xl.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Me("scroll",n):u!=null&&dg(n,i,u,o))}switch(t){case"input":Ju(n),fv(n,r,!1);break;case"textarea":Ju(n),mv(n);break;case"option":r.value!=null&&n.setAttribute("value",""+vs(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?go(n,!!r.multiple,i,!1):r.defaultValue!=null&&go(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=yh)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Pt(e),null;case 6:if(n&&e.stateNode!=null)jT(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(t=Zs(jl.current),Zs(sr.current),ic(e)){if(r=e.stateNode,t=e.memoizedProps,r[Zn]=e,(i=r.nodeValue!==t)&&(n=ln,n!==null))switch(n.tag){case 3:sc(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&sc(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Zn]=e,e.stateNode=r}return Pt(e),null;case 13:if(Le(Be),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ue&&sn!==null&&e.mode&1&&!(e.flags&128))nT(),ko(),e.flags|=98560,i=!1;else if(i=ic(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(z(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(z(317));i[Zn]=e}else ko(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Pt(e),i=!1}else Mn!==null&&(hm(Mn),Mn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Be.current&1?ut===0&&(ut=3):Hg())),e.updateQueue!==null&&(e.flags|=4),Pt(e),null);case 4:return Ro(),rm(n,e),n===null&&Ol(e.stateNode.containerInfo),Pt(e),null;case 10:return Pg(e.type._context),Pt(e),null;case 17:return Jt(e.type)&&vh(),Pt(e),null;case 19:if(Le(Be),i=e.memoizedState,i===null)return Pt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Pa(i,!1);else{if(ut!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=xh(n),o!==null){for(e.flags|=128,Pa(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return De(Be,Be.current&1|2),e.child}n=n.sibling}i.tail!==null&&Ye()>No&&(e.flags|=128,r=!0,Pa(i,!1),e.lanes=4194304)}else{if(!r)if(n=xh(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Pa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ue)return Pt(e),null}else 2*Ye()-i.renderingStartTime>No&&t!==1073741824&&(e.flags|=128,r=!0,Pa(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ye(),e.sibling=null,t=Be.current,De(Be,r?t&1|2:t&1),e):(Pt(e),null);case 22:case 23:return Gg(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?nn&1073741824&&(Pt(e),e.subtreeFlags&6&&(e.flags|=8192)):Pt(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function hR(n,e){switch(bg(e),e.tag){case 1:return Jt(e.type)&&vh(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Ro(),Le(Qt),Le(Mt),Mg(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Vg(e),null;case 13:if(Le(Be),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(z(340));ko()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Le(Be),null;case 4:return Ro(),null;case 10:return Pg(e.type._context),null;case 22:case 23:return Gg(),null;case 24:return null;default:return null}}var lc=!1,Ot=!1,dR=typeof WeakSet=="function"?WeakSet:Set,X=null;function fo(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Qe(n,e,r)}else t.current=null}function sm(n,e,t){try{t()}catch(r){Qe(n,e,r)}}var sw=!1;function fR(n,e){if($p=mh,n=zE(),Ag(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,u=-1,c=0,d=0,f=n,m=null;t:for(;;){for(var _;f!==t||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(u=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(_=f.firstChild)!==null;)m=f,f=_;for(;;){if(f===n)break t;if(m===t&&++c===s&&(a=o),m===i&&++d===r&&(u=o),(_=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=_}t=a===-1||u===-1?null:{start:a,end:u}}else t=null}t=t||{start:0,end:0}}else t=null;for(Bp={focusedElem:n,selectionRange:t},mh=!1,X=e;X!==null;)if(e=X,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,X=n;else for(;X!==null;){e=X;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var k=E.memoizedProps,N=E.memoizedState,x=e.stateNode,y=x.getSnapshotBeforeUpdate(e.elementType===e.type?k:Nn(e.type,k),N);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(R){Qe(e,e.return,R)}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}return E=sw,sw=!1,E}function ul(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&sm(e,t,i)}s=s.next}while(s!==r)}}function Td(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function im(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function FT(n){var e=n.alternate;e!==null&&(n.alternate=null,FT(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Zn],delete e[Ml],delete e[Wp],delete e[QC],delete e[JC])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function UT(n){return n.tag===5||n.tag===3||n.tag===4}function iw(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||UT(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function om(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=yh));else if(r!==4&&(n=n.child,n!==null))for(om(n,e,t),n=n.sibling;n!==null;)om(n,e,t),n=n.sibling}function am(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(am(n,e,t),n=n.sibling;n!==null;)am(n,e,t),n=n.sibling}var It=null,On=!1;function Br(n,e,t){for(t=t.child;t!==null;)$T(n,e,t),t=t.sibling}function $T(n,e,t){if(rr&&typeof rr.onCommitFiberUnmount=="function")try{rr.onCommitFiberUnmount(md,t)}catch{}switch(t.tag){case 5:Ot||fo(t,e);case 6:var r=It,s=On;It=null,Br(n,e,t),It=r,On=s,It!==null&&(On?(n=It,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):It.removeChild(t.stateNode));break;case 18:It!==null&&(On?(n=It,t=t.stateNode,n.nodeType===8?Uf(n.parentNode,t):n.nodeType===1&&Uf(n,t),Pl(n)):Uf(It,t.stateNode));break;case 4:r=It,s=On,It=t.stateNode.containerInfo,On=!0,Br(n,e,t),It=r,On=s;break;case 0:case 11:case 14:case 15:if(!Ot&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&sm(t,e,o),s=s.next}while(s!==r)}Br(n,e,t);break;case 1:if(!Ot&&(fo(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Qe(t,e,a)}Br(n,e,t);break;case 21:Br(n,e,t);break;case 22:t.mode&1?(Ot=(r=Ot)||t.memoizedState!==null,Br(n,e,t),Ot=r):Br(n,e,t);break;default:Br(n,e,t)}}function ow(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new dR),e.forEach(function(r){var s=ER.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function Pn(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:It=a.stateNode,On=!1;break e;case 3:It=a.stateNode.containerInfo,On=!0;break e;case 4:It=a.stateNode.containerInfo,On=!0;break e}a=a.return}if(It===null)throw Error(z(160));$T(i,o,s),It=null,On=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){Qe(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)BT(e,n),e=e.sibling}function BT(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Pn(e,n),Hn(n),r&4){try{ul(3,n,n.return),Td(3,n)}catch(k){Qe(n,n.return,k)}try{ul(5,n,n.return)}catch(k){Qe(n,n.return,k)}}break;case 1:Pn(e,n),Hn(n),r&512&&t!==null&&fo(t,t.return);break;case 5:if(Pn(e,n),Hn(n),r&512&&t!==null&&fo(t,t.return),n.flags&32){var s=n.stateNode;try{bl(s,"")}catch(k){Qe(n,n.return,k)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,u=n.updateQueue;if(n.updateQueue=null,u!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&cE(s,i),Pp(a,o);var c=Pp(a,i);for(o=0;o<u.length;o+=2){var d=u[o],f=u[o+1];d==="style"?mE(s,f):d==="dangerouslySetInnerHTML"?fE(s,f):d==="children"?bl(s,f):dg(s,d,f,c)}switch(a){case"input":xp(s,i);break;case"textarea":hE(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?go(s,!!i.multiple,_,!1):m!==!!i.multiple&&(i.defaultValue!=null?go(s,!!i.multiple,i.defaultValue,!0):go(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ml]=i}catch(k){Qe(n,n.return,k)}}break;case 6:if(Pn(e,n),Hn(n),r&4){if(n.stateNode===null)throw Error(z(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(k){Qe(n,n.return,k)}}break;case 3:if(Pn(e,n),Hn(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Pl(e.containerInfo)}catch(k){Qe(n,n.return,k)}break;case 4:Pn(e,n),Hn(n);break;case 13:Pn(e,n),Hn(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Wg=Ye())),r&4&&ow(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(Ot=(c=Ot)||d,Pn(e,n),Ot=c):Pn(e,n),Hn(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!d&&n.mode&1)for(X=n,d=n.child;d!==null;){for(f=X=d;X!==null;){switch(m=X,_=m.child,m.tag){case 0:case 11:case 14:case 15:ul(4,m,m.return);break;case 1:fo(m,m.return);var E=m.stateNode;if(typeof E.componentWillUnmount=="function"){r=m,t=m.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(k){Qe(r,t,k)}}break;case 5:fo(m,m.return);break;case 22:if(m.memoizedState!==null){lw(f);continue}}_!==null?(_.return=m,X=_):lw(f)}d=d.sibling}e:for(d=null,f=n;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,u=f.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=pE("display",o))}catch(k){Qe(n,n.return,k)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(k){Qe(n,n.return,k)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Pn(e,n),Hn(n),r&4&&ow(n);break;case 21:break;default:Pn(e,n),Hn(n)}}function Hn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(UT(t)){var r=t;break e}t=t.return}throw Error(z(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(bl(s,""),r.flags&=-33);var i=iw(n);am(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=iw(n);om(n,a,o);break;default:throw Error(z(161))}}catch(u){Qe(n,n.return,u)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function pR(n,e,t){X=n,zT(n)}function zT(n,e,t){for(var r=(n.mode&1)!==0;X!==null;){var s=X,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||lc;if(!o){var a=s.alternate,u=a!==null&&a.memoizedState!==null||Ot;a=lc;var c=Ot;if(lc=o,(Ot=u)&&!c)for(X=s;X!==null;)o=X,u=o.child,o.tag===22&&o.memoizedState!==null?uw(s):u!==null?(u.return=o,X=u):uw(s);for(;i!==null;)X=i,zT(i),i=i.sibling;X=s,lc=a,Ot=c}aw(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,X=i):aw(n)}}function aw(n){for(;X!==null;){var e=X;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ot||Td(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ot)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:Nn(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Wv(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Wv(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&t.focus();break;case"img":u.src&&(t.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Pl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}Ot||e.flags&512&&im(e)}catch(m){Qe(e,e.return,m)}}if(e===n){X=null;break}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}}function lw(n){for(;X!==null;){var e=X;if(e===n){X=null;break}var t=e.sibling;if(t!==null){t.return=e.return,X=t;break}X=e.return}}function uw(n){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Td(4,e)}catch(u){Qe(e,t,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Qe(e,s,u)}}var i=e.return;try{im(e)}catch(u){Qe(e,i,u)}break;case 5:var o=e.return;try{im(e)}catch(u){Qe(e,o,u)}}}catch(u){Qe(e,e.return,u)}if(e===n){X=null;break}var a=e.sibling;if(a!==null){a.return=e.return,X=a;break}X=e.return}}var mR=Math.ceil,Ch=Nr.ReactCurrentDispatcher,zg=Nr.ReactCurrentOwner,Sn=Nr.ReactCurrentBatchConfig,Ee=0,vt=null,tt=null,xt=0,nn=0,po=bs(0),ut=0,Bl=null,pi=0,Sd=0,qg=0,cl=null,Kt=null,Wg=0,No=1/0,pr=null,Rh=!1,lm=null,hs=null,uc=!1,ss=null,Ph=0,hl=0,um=null,Vc=-1,Mc=0;function $t(){return Ee&6?Ye():Vc!==-1?Vc:Vc=Ye()}function ds(n){return n.mode&1?Ee&2&&xt!==0?xt&-xt:YC.transition!==null?(Mc===0&&(Mc=bE()),Mc):(n=Ae,n!==0||(n=window.event,n=n===void 0?16:OE(n.type)),n):1}function Un(n,e,t,r){if(50<hl)throw hl=0,um=null,Error(z(185));iu(n,t,r),(!(Ee&2)||n!==vt)&&(n===vt&&(!(Ee&2)&&(Sd|=t),ut===4&&Yr(n,xt)),Xt(n,r),t===1&&Ee===0&&!(e.mode&1)&&(No=Ye()+500,wd&&ks()))}function Xt(n,e){var t=n.callbackNode;Yk(n,e);var r=ph(n,n===vt?xt:0);if(r===0)t!==null&&yv(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&yv(t),e===1)n.tag===0?XC(cw.bind(null,n)):ZE(cw.bind(null,n)),GC(function(){!(Ee&6)&&ks()}),t=null;else{switch(kE(r)){case 1:t=_g;break;case 4:t=AE;break;case 16:t=fh;break;case 536870912:t=xE;break;default:t=fh}t=XT(t,qT.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function qT(n,e){if(Vc=-1,Mc=0,Ee&6)throw Error(z(327));var t=n.callbackNode;if(Io()&&n.callbackNode!==t)return null;var r=ph(n,n===vt?xt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Nh(n,r);else{e=r;var s=Ee;Ee|=2;var i=KT();(vt!==n||xt!==e)&&(pr=null,No=Ye()+500,si(n,e));do try{yR();break}catch(a){WT(n,a)}while(!0);Rg(),Ch.current=i,Ee=s,tt!==null?e=0:(vt=null,xt=0,e=ut)}if(e!==0){if(e===2&&(s=Mp(n),s!==0&&(r=s,e=cm(n,s))),e===1)throw t=Bl,si(n,0),Yr(n,r),Xt(n,Ye()),t;if(e===6)Yr(n,r);else{if(s=n.current.alternate,!(r&30)&&!gR(s)&&(e=Nh(n,r),e===2&&(i=Mp(n),i!==0&&(r=i,e=cm(n,i))),e===1))throw t=Bl,si(n,0),Yr(n,r),Xt(n,Ye()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:$s(n,Kt,pr);break;case 3:if(Yr(n,r),(r&130023424)===r&&(e=Wg+500-Ye(),10<e)){if(ph(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){$t(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=qp($s.bind(null,n,Kt,pr),e);break}$s(n,Kt,pr);break;case 4:if(Yr(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-Fn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ye()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*mR(r/1960))-r,10<r){n.timeoutHandle=qp($s.bind(null,n,Kt,pr),r);break}$s(n,Kt,pr);break;case 5:$s(n,Kt,pr);break;default:throw Error(z(329))}}}return Xt(n,Ye()),n.callbackNode===t?qT.bind(null,n):null}function cm(n,e){var t=cl;return n.current.memoizedState.isDehydrated&&(si(n,e).flags|=256),n=Nh(n,e),n!==2&&(e=Kt,Kt=t,e!==null&&hm(e)),n}function hm(n){Kt===null?Kt=n:Kt.push.apply(Kt,n)}function gR(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!Bn(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Yr(n,e){for(e&=~qg,e&=~Sd,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Fn(e),r=1<<t;n[t]=-1,e&=~r}}function cw(n){if(Ee&6)throw Error(z(327));Io();var e=ph(n,0);if(!(e&1))return Xt(n,Ye()),null;var t=Nh(n,e);if(n.tag!==0&&t===2){var r=Mp(n);r!==0&&(e=r,t=cm(n,r))}if(t===1)throw t=Bl,si(n,0),Yr(n,e),Xt(n,Ye()),t;if(t===6)throw Error(z(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,$s(n,Kt,pr),Xt(n,Ye()),null}function Kg(n,e){var t=Ee;Ee|=1;try{return n(e)}finally{Ee=t,Ee===0&&(No=Ye()+500,wd&&ks())}}function mi(n){ss!==null&&ss.tag===0&&!(Ee&6)&&Io();var e=Ee;Ee|=1;var t=Sn.transition,r=Ae;try{if(Sn.transition=null,Ae=1,n)return n()}finally{Ae=r,Sn.transition=t,Ee=e,!(Ee&6)&&ks()}}function Gg(){nn=po.current,Le(po)}function si(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,KC(t)),tt!==null)for(t=tt.return;t!==null;){var r=t;switch(bg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&vh();break;case 3:Ro(),Le(Qt),Le(Mt),Mg();break;case 5:Vg(r);break;case 4:Ro();break;case 13:Le(Be);break;case 19:Le(Be);break;case 10:Pg(r.type._context);break;case 22:case 23:Gg()}t=t.return}if(vt=n,tt=n=fs(n.current,null),xt=nn=e,ut=0,Bl=null,qg=Sd=pi=0,Kt=cl=null,Ys!==null){for(e=0;e<Ys.length;e++)if(t=Ys[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}Ys=null}return n}function WT(n,e){do{var t=tt;try{if(Rg(),Nc.current=kh,bh){for(var r=qe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}bh=!1}if(fi=0,_t=lt=qe=null,ll=!1,Fl=0,zg.current=null,t===null||t.return===null){ut=1,Bl=e,tt=null;break}e:{var i=n,o=t.return,a=t,u=e;if(e=xt,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var _=Xv(o);if(_!==null){_.flags&=-257,Yv(_,o,a,i,e),_.mode&1&&Jv(i,c,e),e=_,u=c;var E=e.updateQueue;if(E===null){var k=new Set;k.add(u),e.updateQueue=k}else E.add(u);break e}else{if(!(e&1)){Jv(i,c,e),Hg();break e}u=Error(z(426))}}else if(Ue&&a.mode&1){var N=Xv(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),Yv(N,o,a,i,e),kg(Po(u,a));break e}}i=u=Po(u,a),ut!==4&&(ut=2),cl===null?cl=[i]:cl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=kT(i,u,e);qv(i,x);break e;case 1:a=u;var y=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(hs===null||!hs.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=CT(i,a,e);qv(i,R);break e}}i=i.return}while(i!==null)}HT(t)}catch(j){e=j,tt===t&&t!==null&&(tt=t=t.return);continue}break}while(!0)}function KT(){var n=Ch.current;return Ch.current=kh,n===null?kh:n}function Hg(){(ut===0||ut===3||ut===2)&&(ut=4),vt===null||!(pi&268435455)&&!(Sd&268435455)||Yr(vt,xt)}function Nh(n,e){var t=Ee;Ee|=2;var r=KT();(vt!==n||xt!==e)&&(pr=null,si(n,e));do try{_R();break}catch(s){WT(n,s)}while(!0);if(Rg(),Ee=t,Ch.current=r,tt!==null)throw Error(z(261));return vt=null,xt=0,ut}function _R(){for(;tt!==null;)GT(tt)}function yR(){for(;tt!==null&&!zk();)GT(tt)}function GT(n){var e=JT(n.alternate,n,nn);n.memoizedProps=n.pendingProps,e===null?HT(n):tt=e,zg.current=null}function HT(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=hR(t,e),t!==null){t.flags&=32767,tt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ut=6,tt=null;return}}else if(t=cR(t,e,nn),t!==null){tt=t;return}if(e=e.sibling,e!==null){tt=e;return}tt=e=n}while(e!==null);ut===0&&(ut=5)}function $s(n,e,t){var r=Ae,s=Sn.transition;try{Sn.transition=null,Ae=1,vR(n,e,t,r)}finally{Sn.transition=s,Ae=r}return null}function vR(n,e,t,r){do Io();while(ss!==null);if(Ee&6)throw Error(z(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(z(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(Zk(n,i),n===vt&&(tt=vt=null,xt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||uc||(uc=!0,XT(fh,function(){return Io(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Sn.transition,Sn.transition=null;var o=Ae;Ae=1;var a=Ee;Ee|=4,zg.current=null,fR(n,t),BT(t,n),FC(Bp),mh=!!$p,Bp=$p=null,n.current=t,pR(t),qk(),Ee=a,Ae=o,Sn.transition=i}else n.current=t;if(uc&&(uc=!1,ss=n,Ph=s),i=n.pendingLanes,i===0&&(hs=null),Gk(t.stateNode),Xt(n,Ye()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(Rh)throw Rh=!1,n=lm,lm=null,n;return Ph&1&&n.tag!==0&&Io(),i=n.pendingLanes,i&1?n===um?hl++:(hl=0,um=n):hl=0,ks(),null}function Io(){if(ss!==null){var n=kE(Ph),e=Sn.transition,t=Ae;try{if(Sn.transition=null,Ae=16>n?16:n,ss===null)var r=!1;else{if(n=ss,ss=null,Ph=0,Ee&6)throw Error(z(331));var s=Ee;for(Ee|=4,X=n.current;X!==null;){var i=X,o=i.child;if(X.flags&16){var a=i.deletions;if(a!==null){for(var u=0;u<a.length;u++){var c=a[u];for(X=c;X!==null;){var d=X;switch(d.tag){case 0:case 11:case 15:ul(8,d,i)}var f=d.child;if(f!==null)f.return=d,X=f;else for(;X!==null;){d=X;var m=d.sibling,_=d.return;if(FT(d),d===c){X=null;break}if(m!==null){m.return=_,X=m;break}X=_}}}var E=i.alternate;if(E!==null){var k=E.child;if(k!==null){E.child=null;do{var N=k.sibling;k.sibling=null,k=N}while(k!==null)}}X=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,X=o;else e:for(;X!==null;){if(i=X,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ul(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,X=x;break e}X=i.return}}var y=n.current;for(X=y;X!==null;){o=X;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,X=S;else e:for(o=y;X!==null;){if(a=X,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Td(9,a)}}catch(j){Qe(a,a.return,j)}if(a===o){X=null;break e}var R=a.sibling;if(R!==null){R.return=a.return,X=R;break e}X=a.return}}if(Ee=s,ks(),rr&&typeof rr.onPostCommitFiberRoot=="function")try{rr.onPostCommitFiberRoot(md,n)}catch{}r=!0}return r}finally{Ae=t,Sn.transition=e}}return!1}function hw(n,e,t){e=Po(t,e),e=kT(n,e,1),n=cs(n,e,1),e=$t(),n!==null&&(iu(n,1,e),Xt(n,e))}function Qe(n,e,t){if(n.tag===3)hw(n,n,t);else for(;e!==null;){if(e.tag===3){hw(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(hs===null||!hs.has(r))){n=Po(t,n),n=CT(e,n,1),e=cs(e,n,1),n=$t(),e!==null&&(iu(e,1,n),Xt(e,n));break}}e=e.return}}function wR(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=$t(),n.pingedLanes|=n.suspendedLanes&t,vt===n&&(xt&t)===t&&(ut===4||ut===3&&(xt&130023424)===xt&&500>Ye()-Wg?si(n,0):qg|=t),Xt(n,e)}function QT(n,e){e===0&&(n.mode&1?(e=Zu,Zu<<=1,!(Zu&130023424)&&(Zu=4194304)):e=1);var t=$t();n=xr(n,e),n!==null&&(iu(n,e,t),Xt(n,t))}function IR(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),QT(n,t)}function ER(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),QT(n,t)}var JT;JT=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Qt.current)Ht=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Ht=!1,uR(n,e,t);Ht=!!(n.flags&131072)}else Ht=!1,Ue&&e.flags&1048576&&eT(e,Eh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Oc(n,e),n=e.pendingProps;var s=bo(e,Mt.current);wo(e,t),s=jg(null,e,r,n,s,t);var i=Fg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Jt(r)?(i=!0,wh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Dg(e),s.updater=Ed,e.stateNode=s,s._reactInternals=e,Xp(e,r,n,t),e=em(null,e,r,!0,i,t)):(e.tag=0,Ue&&i&&xg(e),Ft(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Oc(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=SR(r),n=Nn(r,n),s){case 0:e=Zp(null,e,r,n,t);break e;case 1:e=tw(null,e,r,n,t);break e;case 11:e=Zv(null,e,r,n,t);break e;case 14:e=ew(null,e,r,Nn(r.type,n),t);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),Zp(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),tw(n,e,r,s,t);case 3:e:{if(DT(e),n===null)throw Error(z(387));r=e.pendingProps,i=e.memoizedState,s=i.element,oT(n,e),Ah(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Po(Error(z(423)),e),e=nw(n,e,r,t,s);break e}else if(r!==s){s=Po(Error(z(424)),e),e=nw(n,e,r,t,s);break e}else for(sn=us(e.stateNode.containerInfo.firstChild),ln=e,Ue=!0,Mn=null,t=sT(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(ko(),r===s){e=br(n,e,t);break e}Ft(n,e,r,t)}e=e.child}return e;case 5:return aT(e),n===null&&Hp(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,zp(r,s)?o=null:i!==null&&zp(r,i)&&(e.flags|=32),NT(n,e),Ft(n,e,o,t),e.child;case 6:return n===null&&Hp(e),null;case 13:return OT(n,e,t);case 4:return Og(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Co(e,null,r,t):Ft(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),Zv(n,e,r,s,t);case 7:return Ft(n,e,e.pendingProps,t),e.child;case 8:return Ft(n,e,e.pendingProps.children,t),e.child;case 12:return Ft(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,De(Th,r._currentValue),r._currentValue=o,i!==null)if(Bn(i.value,o)){if(i.children===s.children&&!Qt.current){e=br(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Er(-1,t&-t),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=t,u=i.alternate,u!==null&&(u.lanes|=t),Qp(i.return,t,e),a.lanes|=t;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(z(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Qp(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ft(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,wo(e,t),s=xn(s),r=r(s),e.flags|=1,Ft(n,e,r,t),e.child;case 14:return r=e.type,s=Nn(r,e.pendingProps),s=Nn(r.type,s),ew(n,e,r,s,t);case 15:return RT(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),Oc(n,e),e.tag=1,Jt(r)?(n=!0,wh(e)):n=!1,wo(e,t),bT(e,r,s),Xp(e,r,s,t),em(null,e,r,!0,n,t);case 19:return VT(n,e,t);case 22:return PT(n,e,t)}throw Error(z(156,e.tag))};function XT(n,e){return SE(n,e)}function TR(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wn(n,e,t,r){return new TR(n,e,t,r)}function Qg(n){return n=n.prototype,!(!n||!n.isReactComponent)}function SR(n){if(typeof n=="function")return Qg(n)?1:0;if(n!=null){if(n=n.$$typeof,n===pg)return 11;if(n===mg)return 14}return 2}function fs(n,e){var t=n.alternate;return t===null?(t=wn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Lc(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")Qg(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case ro:return ii(t.children,s,i,e);case fg:o=8,s|=8;break;case Ip:return n=wn(12,t,e,s|2),n.elementType=Ip,n.lanes=i,n;case Ep:return n=wn(13,t,e,s),n.elementType=Ep,n.lanes=i,n;case Tp:return n=wn(19,t,e,s),n.elementType=Tp,n.lanes=i,n;case aE:return Ad(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case iE:o=10;break e;case oE:o=9;break e;case pg:o=11;break e;case mg:o=14;break e;case Qr:o=16,r=null;break e}throw Error(z(130,n==null?n:typeof n,""))}return e=wn(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function ii(n,e,t,r){return n=wn(7,n,r,e),n.lanes=t,n}function Ad(n,e,t,r){return n=wn(22,n,r,e),n.elementType=aE,n.lanes=t,n.stateNode={isHidden:!1},n}function Hf(n,e,t){return n=wn(6,n,null,e),n.lanes=t,n}function Qf(n,e,t){return e=wn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function AR(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cf(0),this.expirationTimes=Cf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Jg(n,e,t,r,s,i,o,a,u){return n=new AR(n,e,t,a,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=wn(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dg(i),n}function xR(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:no,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function YT(n){if(!n)return ws;n=n._reactInternals;e:{if(ki(n)!==n||n.tag!==1)throw Error(z(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Jt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(n.tag===1){var t=n.type;if(Jt(t))return YE(n,t,e)}return e}function ZT(n,e,t,r,s,i,o,a,u){return n=Jg(t,r,!0,n,s,i,o,a,u),n.context=YT(null),t=n.current,r=$t(),s=ds(t),i=Er(r,s),i.callback=e??null,cs(t,i,s),n.current.lanes=s,iu(n,s,r),Xt(n,r),n}function xd(n,e,t,r){var s=e.current,i=$t(),o=ds(s);return t=YT(t),e.context===null?e.context=t:e.pendingContext=t,e=Er(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=cs(s,e,o),n!==null&&(Un(n,s,o,i),Pc(n,s,o)),o}function Dh(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function dw(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Xg(n,e){dw(n,e),(n=n.alternate)&&dw(n,e)}function bR(){return null}var eS=typeof reportError=="function"?reportError:function(n){console.error(n)};function Yg(n){this._internalRoot=n}bd.prototype.render=Yg.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(z(409));xd(n,e,null,null)};bd.prototype.unmount=Yg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;mi(function(){xd(null,n,null,null)}),e[Ar]=null}};function bd(n){this._internalRoot=n}bd.prototype.unstable_scheduleHydration=function(n){if(n){var e=PE();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Xr.length&&e!==0&&e<Xr[t].priority;t++);Xr.splice(t,0,n),t===0&&DE(n)}};function Zg(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function kd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function fw(){}function kR(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Dh(o);i.call(c)}}var o=ZT(e,r,n,0,null,!1,!1,"",fw);return n._reactRootContainer=o,n[Ar]=o.current,Ol(n.nodeType===8?n.parentNode:n),mi(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Dh(u);a.call(c)}}var u=Jg(n,0,!1,null,null,!1,!1,"",fw);return n._reactRootContainer=u,n[Ar]=u.current,Ol(n.nodeType===8?n.parentNode:n),mi(function(){xd(e,u,t,r)}),u}function Cd(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var u=Dh(o);a.call(u)}}xd(e,o,n,s)}else o=kR(t,e,n,s,r);return Dh(o)}CE=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=$a(e.pendingLanes);t!==0&&(yg(e,t|1),Xt(e,Ye()),!(Ee&6)&&(No=Ye()+500,ks()))}break;case 13:mi(function(){var r=xr(n,1);if(r!==null){var s=$t();Un(r,n,1,s)}}),Xg(n,1)}};vg=function(n){if(n.tag===13){var e=xr(n,134217728);if(e!==null){var t=$t();Un(e,n,134217728,t)}Xg(n,134217728)}};RE=function(n){if(n.tag===13){var e=ds(n),t=xr(n,e);if(t!==null){var r=$t();Un(t,n,e,r)}Xg(n,e)}};PE=function(){return Ae};NE=function(n,e){var t=Ae;try{return Ae=n,e()}finally{Ae=t}};Dp=function(n,e,t){switch(e){case"input":if(xp(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=vd(r);if(!s)throw Error(z(90));uE(r),xp(r,s)}}}break;case"textarea":hE(n,t);break;case"select":e=t.value,e!=null&&go(n,!!t.multiple,e,!1)}};yE=Kg;vE=mi;var CR={usingClientEntryPoint:!1,Events:[au,ao,vd,gE,_E,Kg]},Na={findFiberByHostInstance:Xs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RR={bundleType:Na.bundleType,version:Na.version,rendererPackageName:Na.rendererPackageName,rendererConfig:Na.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Nr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=EE(n),n===null?null:n.stateNode},findFiberByHostInstance:Na.findFiberByHostInstance||bR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cc.isDisabled&&cc.supportsFiber)try{md=cc.inject(RR),rr=cc}catch{}}dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CR;dn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zg(e))throw Error(z(200));return xR(n,e,null,t)};dn.createRoot=function(n,e){if(!Zg(n))throw Error(z(299));var t=!1,r="",s=eS;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Jg(n,1,!1,null,null,t,!1,r,s),n[Ar]=e.current,Ol(n.nodeType===8?n.parentNode:n),new Yg(e)};dn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(z(188)):(n=Object.keys(n).join(","),Error(z(268,n)));return n=EE(e),n=n===null?null:n.stateNode,n};dn.flushSync=function(n){return mi(n)};dn.hydrate=function(n,e,t){if(!kd(e))throw Error(z(200));return Cd(null,n,e,!0,t)};dn.hydrateRoot=function(n,e,t){if(!Zg(n))throw Error(z(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=eS;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=ZT(e,null,n,1,t??null,s,!1,i,o),n[Ar]=e.current,Ol(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new bd(e)};dn.render=function(n,e,t){if(!kd(e))throw Error(z(200));return Cd(null,n,e,!1,t)};dn.unmountComponentAtNode=function(n){if(!kd(n))throw Error(z(40));return n._reactRootContainer?(mi(function(){Cd(null,null,n,!1,function(){n._reactRootContainer=null,n[Ar]=null})}),!0):!1};dn.unstable_batchedUpdates=Kg;dn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!kd(t))throw Error(z(200));if(n==null||n._reactInternals===void 0)throw Error(z(38));return Cd(n,e,t,!1,r)};dn.version="18.3.1-next-f1338f8080-20240426";function tS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tS)}catch(n){console.error(n)}}tS(),tE.exports=dn;var PR=tE.exports,pw=PR;vp.createRoot=pw.createRoot,vp.hydrateRoot=pw.hydrateRoot;function le(n,e,t,r,s){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t}function V(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}let nS=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return nS=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^t()&15>>+r/4).toString(16))};function dm(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const fm=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};class se extends Error{}class kt extends se{constructor(e,t,r,s){super(`${kt.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.requestID=s==null?void 0:s.get("x-request-id"),this.error=t;const i=t;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,t,r){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e||!s)return new Rd({message:r,cause:fm(t)});const i=t==null?void 0:t.error;return e===400?new rS(e,i,r,s):e===401?new sS(e,i,r,s):e===403?new iS(e,i,r,s):e===404?new oS(e,i,r,s):e===409?new aS(e,i,r,s):e===422?new lS(e,i,r,s):e===429?new uS(e,i,r,s):e>=500?new cS(e,i,r,s):new kt(e,i,r,s)}}class In extends kt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Rd extends kt{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class e_ extends Rd{constructor({message:e}={}){super({message:e??"Request timed out."})}}class rS extends kt{}class sS extends kt{}class iS extends kt{}class oS extends kt{}class aS extends kt{}class lS extends kt{}class uS extends kt{}class cS extends kt{}class hS extends se{constructor(){super("Could not parse response content as the length limit was reached")}}class dS extends se{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class za extends Error{constructor(e){super(e)}}const NR=/^[a-z][a-z0-9+.-]*:/i,DR=n=>NR.test(n);let Wt=n=>(Wt=Array.isArray,Wt(n)),mw=Wt;function fS(n){return typeof n!="object"?{}:n??{}}function OR(n){if(!n)return!0;for(const e in n)return!1;return!0}function VR(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Jf(n){return n!=null&&typeof n=="object"&&!Array.isArray(n)}const MR=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new se(`${n} must be an integer`);if(e<0)throw new se(`${n} must be a positive integer`);return e},LR=n=>{try{return JSON.parse(n)}catch{return}},uu=n=>new Promise(e=>setTimeout(e,n)),Hi="6.9.1",jR=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function FR(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const UR=()=>{var t;const n=FR();if(n==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hi,"X-Stainless-OS":_w(Deno.build.os),"X-Stainless-Arch":gw(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(n==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hi,"X-Stainless-OS":_w(globalThis.process.platform??"unknown"),"X-Stainless-Arch":gw(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=$R();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function $R(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${i}.${o}`}}}return null}const gw=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",_w=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let yw;const BR=()=>yw??(yw=UR());function zR(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function pS(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function mS(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return pS({start(){},async pull(t){const{done:r,value:s}=await e.next();r?t.close():t.enqueue(s)},async cancel(){var t;await((t=e.return)==null?void 0:t.call(e))}})}function gS(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function qR(n){var r,s;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((s=(r=n[Symbol.asyncIterator]()).return)==null?void 0:s.call(r));return}const e=n.getReader(),t=e.cancel();e.releaseLock(),await t}const WR=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),_S="RFC3986",yS=n=>String(n),vw={RFC1738:n=>String(n).replace(/%20/g,"+"),RFC3986:yS},KR="RFC1738";let pm=(n,e)=>(pm=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),pm(n,e));const Qn=(()=>{const n=[];for(let e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n})(),Xf=1024,GR=(n,e,t,r,s)=>{if(n.length===0)return n;let i=n;if(typeof n=="symbol"?i=Symbol.prototype.toString.call(n):typeof n!="string"&&(i=String(n)),t==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(a){return"%26%23"+parseInt(a.slice(2),16)+"%3B"});let o="";for(let a=0;a<i.length;a+=Xf){const u=i.length>=Xf?i.slice(a,a+Xf):i,c=[];for(let d=0;d<u.length;++d){let f=u.charCodeAt(d);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||s===KR&&(f===40||f===41)){c[c.length]=u.charAt(d);continue}if(f<128){c[c.length]=Qn[f];continue}if(f<2048){c[c.length]=Qn[192|f>>6]+Qn[128|f&63];continue}if(f<55296||f>=57344){c[c.length]=Qn[224|f>>12]+Qn[128|f>>6&63]+Qn[128|f&63];continue}d+=1,f=65536+((f&1023)<<10|u.charCodeAt(d)&1023),c[c.length]=Qn[240|f>>18]+Qn[128|f>>12&63]+Qn[128|f>>6&63]+Qn[128|f&63]}o+=c.join("")}return o};function HR(n){return!n||typeof n!="object"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function ww(n,e){if(Wt(n)){const t=[];for(let r=0;r<n.length;r+=1)t.push(e(n[r]));return t}return e(n)}const vS={brackets(n){return String(n)+"[]"},comma:"comma",indices(n,e){return String(n)+"["+e+"]"},repeat(n){return String(n)}},wS=function(n,e){Array.prototype.push.apply(n,Wt(e)?e:[e])};let Iw;const at={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:GR,encodeValuesOnly:!1,format:_S,formatter:yS,indices:!1,serializeDate(n){return(Iw??(Iw=Function.prototype.call.bind(Date.prototype.toISOString)))(n)},skipNulls:!1,strictNullHandling:!1};function QR(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n=="symbol"||typeof n=="bigint"}const Yf={};function IS(n,e,t,r,s,i,o,a,u,c,d,f,m,_,E,k,N,x){let y=n,S=x,R=0,j=!1;for(;(S=S.get(Yf))!==void 0&&!j;){const A=S.get(n);if(R+=1,typeof A<"u"){if(A===R)throw new RangeError("Cyclic object value");j=!0}typeof S.get(Yf)>"u"&&(R=0)}if(typeof c=="function"?y=c(e,y):y instanceof Date?y=m==null?void 0:m(y):t==="comma"&&Wt(y)&&(y=ww(y,function(A){return A instanceof Date?m==null?void 0:m(A):A})),y===null){if(i)return u&&!k?u(e,at.encoder,N,"key",_):e;y=""}if(QR(y)||HR(y)){if(u){const A=k?e:u(e,at.encoder,N,"key",_);return[(E==null?void 0:E(A))+"="+(E==null?void 0:E(u(y,at.encoder,N,"value",_)))]}return[(E==null?void 0:E(e))+"="+(E==null?void 0:E(String(y)))]}const M=[];if(typeof y>"u")return M;let w;if(t==="comma"&&Wt(y))k&&u&&(y=ww(y,u)),w=[{value:y.length>0?y.join(",")||null:void 0}];else if(Wt(c))w=c;else{const A=Object.keys(y);w=d?A.sort(d):A}const v=a?String(e).replace(/\./g,"%2E"):String(e),T=r&&Wt(y)&&y.length===1?v+"[]":v;if(s&&Wt(y)&&y.length===0)return T+"[]";for(let A=0;A<w.length;++A){const b=w[A],P=typeof b=="object"&&typeof b.value<"u"?b.value:y[b];if(o&&P===null)continue;const C=f&&a?b.replace(/\./g,"%2E"):b,Ne=Wt(y)?typeof t=="function"?t(T,C):T:T+(f?"."+C:"["+C+"]");x.set(n,R);const je=new WeakMap;je.set(Yf,x),wS(M,IS(P,Ne,t,r,s,i,o,a,t==="comma"&&k&&Wt(y)?null:u,c,d,f,m,_,E,k,N,je))}return M}function JR(n=at){if(typeof n.allowEmptyArrays<"u"&&typeof n.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof n.encodeDotInKeys<"u"&&typeof n.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(n.encoder!==null&&typeof n.encoder<"u"&&typeof n.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=n.charset||at.charset;if(typeof n.charset<"u"&&n.charset!=="utf-8"&&n.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=_S;if(typeof n.format<"u"){if(!pm(vw,n.format))throw new TypeError("Unknown format option provided.");t=n.format}const r=vw[t];let s=at.filter;(typeof n.filter=="function"||Wt(n.filter))&&(s=n.filter);let i;if(n.arrayFormat&&n.arrayFormat in vS?i=n.arrayFormat:"indices"in n?i=n.indices?"indices":"repeat":i=at.arrayFormat,"commaRoundTrip"in n&&typeof n.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof n.allowDots>"u"?n.encodeDotInKeys?!0:at.allowDots:!!n.allowDots;return{addQueryPrefix:typeof n.addQueryPrefix=="boolean"?n.addQueryPrefix:at.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof n.allowEmptyArrays=="boolean"?!!n.allowEmptyArrays:at.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof n.charsetSentinel=="boolean"?n.charsetSentinel:at.charsetSentinel,commaRoundTrip:!!n.commaRoundTrip,delimiter:typeof n.delimiter>"u"?at.delimiter:n.delimiter,encode:typeof n.encode=="boolean"?n.encode:at.encode,encodeDotInKeys:typeof n.encodeDotInKeys=="boolean"?n.encodeDotInKeys:at.encodeDotInKeys,encoder:typeof n.encoder=="function"?n.encoder:at.encoder,encodeValuesOnly:typeof n.encodeValuesOnly=="boolean"?n.encodeValuesOnly:at.encodeValuesOnly,filter:s,format:t,formatter:r,serializeDate:typeof n.serializeDate=="function"?n.serializeDate:at.serializeDate,skipNulls:typeof n.skipNulls=="boolean"?n.skipNulls:at.skipNulls,sort:typeof n.sort=="function"?n.sort:null,strictNullHandling:typeof n.strictNullHandling=="boolean"?n.strictNullHandling:at.strictNullHandling}}function XR(n,e={}){let t=n;const r=JR(e);let s,i;typeof r.filter=="function"?(i=r.filter,t=i("",t)):Wt(r.filter)&&(i=r.filter,s=i);const o=[];if(typeof t!="object"||t===null)return"";const a=vS[r.arrayFormat],u=a==="comma"&&r.commaRoundTrip;s||(s=Object.keys(t)),r.sort&&s.sort(r.sort);const c=new WeakMap;for(let m=0;m<s.length;++m){const _=s[m];r.skipNulls&&t[_]===null||wS(o,IS(t[_],_,a,u,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const d=o.join(r.delimiter);let f=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),d.length>0?f+d:""}function YR(n){let e=0;for(const s of n)e+=s.length;const t=new Uint8Array(e);let r=0;for(const s of n)t.set(s,r),r+=s.length;return t}let Ew;function t_(n){let e;return(Ew??(e=new globalThis.TextEncoder,Ew=e.encode.bind(e)))(n)}let Tw;function Sw(n){let e;return(Tw??(e=new globalThis.TextDecoder,Tw=e.decode.bind(e)))(n)}var Zt,en;class Pd{constructor(){Zt.set(this,void 0),en.set(this,void 0),le(this,Zt,new Uint8Array),le(this,en,null)}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?t_(e):e;le(this,Zt,YR([V(this,Zt,"f"),t]));const r=[];let s;for(;(s=ZR(V(this,Zt,"f"),V(this,en,"f")))!=null;){if(s.carriage&&V(this,en,"f")==null){le(this,en,s.index);continue}if(V(this,en,"f")!=null&&(s.index!==V(this,en,"f")+1||s.carriage)){r.push(Sw(V(this,Zt,"f").subarray(0,V(this,en,"f")-1))),le(this,Zt,V(this,Zt,"f").subarray(V(this,en,"f"))),le(this,en,null);continue}const i=V(this,en,"f")!==null?s.preceding-1:s.preceding,o=Sw(V(this,Zt,"f").subarray(0,i));r.push(o),le(this,Zt,V(this,Zt,"f").subarray(s.index)),le(this,en,null)}return r}flush(){return V(this,Zt,"f").length?this.decode(`
`):[]}}Zt=new WeakMap,en=new WeakMap;Pd.NEWLINE_CHARS=new Set([`
`,"\r"]);Pd.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function ZR(n,e){for(let s=e??0;s<n.length;s++){if(n[s]===10)return{preceding:s,index:s+1,carriage:!1};if(n[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function eP(n){for(let r=0;r<n.length-1;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}const Oh={off:0,error:200,warn:300,info:400,debug:500},Aw=(n,e,t)=>{if(n){if(VR(Oh,n))return n;Et(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Oh))}`)}};function qa(){}function hc(n,e,t){return!e||Oh[n]>Oh[t]?qa:e[n].bind(e)}const tP={error:qa,warn:qa,info:qa,debug:qa};let xw=new WeakMap;function Et(n){const e=n.logger,t=n.logLevel??"off";if(!e)return tP;const r=xw.get(e);if(r&&r[0]===t)return r[1];const s={error:hc("error",e,t),warn:hc("warn",e,t),info:hc("info",e,t),debug:hc("debug",e,t)};return xw.set(e,[t,s]),s}const Bs=n=>(n.options&&(n.options={...n.options},delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);var Da;class er{constructor(e,t,r){this.iterator=e,Da.set(this,void 0),this.controller=t,le(this,Da,r)}static fromSSEResponse(e,t,r){let s=!1;const i=r?Et(r):console;async function*o(){if(s)throw new se("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const u of nP(e,t))if(!a){if(u.data.startsWith("[DONE]")){a=!0;continue}if(u.event===null||!u.event.startsWith("thread.")){let c;try{c=JSON.parse(u.data)}catch(d){throw i.error("Could not parse message into JSON:",u.data),i.error("From chunk:",u.raw),d}if(c&&c.error)throw new kt(void 0,c.error,void 0,e.headers);yield c}else{let c;try{c=JSON.parse(u.data)}catch(d){throw console.error("Could not parse message into JSON:",u.data),console.error("From chunk:",u.raw),d}if(u.event=="error")throw new kt(void 0,c.error,c.message,void 0);yield{event:u.event,data:c}}}a=!0}catch(u){if(dm(u))return;throw u}finally{a||t.abort()}}return new er(o,t,r)}static fromReadableStream(e,t,r){let s=!1;async function*i(){const a=new Pd,u=gS(e);for await(const c of u)for(const d of a.decode(c))yield d;for(const c of a.flush())yield c}async function*o(){if(s)throw new se("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const u of i())a||u&&(yield JSON.parse(u));a=!0}catch(u){if(dm(u))return;throw u}finally{a||t.abort()}}return new er(o,t,r)}[(Da=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),t.push(o)}return i.shift()}});return[new er(()=>s(e),this.controller,V(this,Da,"f")),new er(()=>s(t),this.controller,V(this,Da,"f"))]}toReadableStream(){const e=this;let t;return pS({async start(){t=e[Symbol.asyncIterator]()},async pull(r){try{const{value:s,done:i}=await t.next();if(i)return r.close();const o=t_(JSON.stringify(s)+`
`);r.enqueue(o)}catch(s){r.error(s)}},async cancel(){var r;await((r=t.return)==null?void 0:r.call(t))}})}}async function*nP(n,e){if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new se("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new se("Attempted to iterate over a response with no body");const t=new sP,r=new Pd,s=gS(n.body);for await(const i of rP(s))for(const o of r.decode(i)){const a=t.decode(o);a&&(yield a)}for(const i of r.flush()){const o=t.decode(i);o&&(yield o)}}async function*rP(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?t_(t):t;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=eP(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class sP{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=iP(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function iP(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}async function ES(n,e){const{response:t,requestLogID:r,retryOfRequestLogID:s,startTime:i}=e,o=await(async()=>{var f;if(e.options.stream)return Et(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):er.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const a=t.headers.get("content-type"),u=(f=a==null?void 0:a.split(";")[0])==null?void 0:f.trim();if((u==null?void 0:u.includes("application/json"))||(u==null?void 0:u.endsWith("+json"))){const m=await t.json();return TS(m,t)}return await t.text()})();return Et(n).debug(`[${r}] response parsed`,Bs({retryOfRequestLogID:s,url:t.url,status:t.status,body:o,durationMs:Date.now()-i})),o}function TS(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Wa;class Nd extends Promise{constructor(e,t,r=ES){super(s=>{s(null)}),this.responsePromise=t,this.parseResponse=r,Wa.set(this,void 0),le(this,Wa,e)}_thenUnwrap(e){return new Nd(V(this,Wa,"f"),this.responsePromise,async(t,r)=>TS(e(await this.parseResponse(t,r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(V(this,Wa,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}Wa=new WeakMap;var dc;class n_{constructor(e,t,r,s){dc.set(this,void 0),le(this,dc,e),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new se("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await V(this,dc,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(dc=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class oP extends Nd{constructor(e,t,r){super(e,t,async(s,i)=>new r(s,i.response,await ES(s,i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}class Dd extends n_{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class rt extends n_{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var r;const e=this.getPaginatedItems(),t=(r=e[e.length-1])==null?void 0:r.id;return t?{...this.options,query:{...fS(this.options.query),after:t}}:null}}class Vh extends n_{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.has_more=r.has_more||!1,this.last_id=r.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...fS(this.options.query),after:e}}:null}}const SS=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e==null?void 0:e.versions)==null?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function dl(n,e,t){return SS(),new File(n,e??"unknown_file",t)}function jc(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const r_=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",bw=async(n,e)=>mm(n.body)?{...n,body:await AS(n.body,e)}:n,gi=async(n,e)=>({...n,body:await AS(n.body,e)}),kw=new WeakMap;function aP(n){const e=typeof n=="function"?n:n.fetch,t=kw.get(e);if(t)return t;const r=(async()=>{try{const s="Response"in e?e.Response:(await e("data:,")).constructor,i=new FormData;return i.toString()!==await new s(i).text()}catch{return!0}})();return kw.set(e,r),r}const AS=async(n,e)=>{if(!await aP(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const t=new FormData;return await Promise.all(Object.entries(n||{}).map(([r,s])=>gm(t,r,s))),t},xS=n=>n instanceof Blob&&"name"in n,lP=n=>typeof n=="object"&&n!==null&&(n instanceof Response||r_(n)||xS(n)),mm=n=>{if(lP(n))return!0;if(Array.isArray(n))return n.some(mm);if(n&&typeof n=="object"){for(const e in n)if(mm(n[e]))return!0}return!1},gm=async(n,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")n.append(e,String(t));else if(t instanceof Response)n.append(e,dl([await t.blob()],jc(t)));else if(r_(t))n.append(e,dl([await new Response(mS(t)).blob()],jc(t)));else if(xS(t))n.append(e,t,jc(t));else if(Array.isArray(t))await Promise.all(t.map(r=>gm(n,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,s])=>gm(n,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}},bS=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",uP=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&bS(n),cP=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function hP(n,e,t){if(SS(),n=await n,uP(n))return n instanceof File?n:dl([await n.arrayBuffer()],n.name);if(cP(n)){const s=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),dl(await _m(s),e,t)}const r=await _m(n);if(e||(e=jc(n)),!(t!=null&&t.type)){const s=r.find(i=>typeof i=="object"&&"type"in i&&i.type);typeof s=="string"&&(t={...t,type:s})}return dl(r,e,t)}async function _m(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(bS(n))e.push(n instanceof Blob?n:await n.arrayBuffer());else if(r_(n))for await(const r of n)e.push(...await _m(r));else{const r=(t=n==null?void 0:n.constructor)==null?void 0:t.name;throw new Error(`Unexpected data type: ${typeof n}${r?`; constructor: ${r}`:""}${dP(n)}`)}return e}function dP(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}class ne{constructor(e){this._client=e}}function kS(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Cw=Object.freeze(Object.create(null)),fP=(n=kS)=>function(t,...r){if(t.length===1)return t[0];let s=!1;const i=[],o=t.reduce((d,f,m)=>{var k;/[?#]/.test(f)&&(s=!0);const _=r[m];let E=(s?encodeURIComponent:n)(""+_);return m!==r.length&&(_==null||typeof _=="object"&&_.toString===((k=Object.getPrototypeOf(Object.getPrototypeOf(_.hasOwnProperty??Cw)??Cw))==null?void 0:k.toString))&&(E=_+"",i.push({start:d.length+f.length,length:E.length,error:`Value of type ${Object.prototype.toString.call(_).slice(8,-1)} is not a valid path parameter`})),d+f+(m===r.length?"":E)},""),a=o.split(/[?#]/,1)[0],u=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=u.exec(a))!==null;)i.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(i.sort((d,f)=>d.start-f.start),i.length>0){let d=0;const f=i.reduce((m,_)=>{const E=" ".repeat(_.start-d),k="^".repeat(_.length);return d=_.start+_.length,m+E+k},"");throw new se(`Path parameters result in path with invalid segments:
${i.map(m=>m.error).join(`
`)}
${o}
${f}`)}return o},$=fP(kS);let CS=class extends ne{list(e,t={},r){return this._client.getAPIList($`/chat/completions/${e}/messages`,rt,{query:t,...r})}};function Mh(n){return n!==void 0&&"function"in n&&n.function!==void 0}function s_(n){return(n==null?void 0:n.$brand)==="auto-parseable-response-format"}function cu(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function pP(n,e){return!e||!RS(e)?{...n,choices:n.choices.map(t=>(PS(t.message.tool_calls),{...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:i_(n,e)}function i_(n,e){const t=n.choices.map(r=>{var s;if(r.finish_reason==="length")throw new hS;if(r.finish_reason==="content_filter")throw new dS;return PS(r.message.tool_calls),{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>gP(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?mP(e,r.message.content):null}}});return{...n,choices:t}}function mP(n,e){var t,r;return((t=n.response_format)==null?void 0:t.type)!=="json_schema"?null:((r=n.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in n.response_format?n.response_format.$parseRaw(e):JSON.parse(e):null}function gP(n,e){var r;const t=(r=n.tools)==null?void 0:r.find(s=>{var i;return Mh(s)&&((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:cu(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function _P(n,e){var r;if(!n||!("tools"in n)||!n.tools)return!1;const t=(r=n.tools)==null?void 0:r.find(s=>{var i;return Mh(s)&&((i=s.function)==null?void 0:i.name)===e.function.name});return Mh(t)&&(cu(t)||(t==null?void 0:t.function.strict)||!1)}function RS(n){var e;return s_(n.response_format)?!0:((e=n.tools)==null?void 0:e.some(t=>cu(t)||t.type==="function"&&t.function.strict===!0))??!1}function PS(n){for(const e of n||[])if(e.type!=="function")throw new se(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function yP(n){for(const e of n??[]){if(e.type!=="function")throw new se(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new se(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const Lh=n=>(n==null?void 0:n.role)==="assistant",NS=n=>(n==null?void 0:n.role)==="tool";var ym,Fc,Uc,Ka,Ga,$c,Ha,fr,Qa,jh,Fh,Qi,DS;class o_{constructor(){ym.add(this),this.controller=new AbortController,Fc.set(this,void 0),Uc.set(this,()=>{}),Ka.set(this,()=>{}),Ga.set(this,void 0),$c.set(this,()=>{}),Ha.set(this,()=>{}),fr.set(this,{}),Qa.set(this,!1),jh.set(this,!1),Fh.set(this,!1),Qi.set(this,!1),le(this,Fc,new Promise((e,t)=>{le(this,Uc,e,"f"),le(this,Ka,t,"f")})),le(this,Ga,new Promise((e,t)=>{le(this,$c,e,"f"),le(this,Ha,t,"f")})),V(this,Fc,"f").catch(()=>{}),V(this,Ga,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},V(this,ym,"m",DS).bind(this))},0)}_connected(){this.ended||(V(this,Uc,"f").call(this),this._emit("connect"))}get ended(){return V(this,Qa,"f")}get errored(){return V(this,jh,"f")}get aborted(){return V(this,Fh,"f")}abort(){this.controller.abort()}on(e,t){return(V(this,fr,"f")[e]||(V(this,fr,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=V(this,fr,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(V(this,fr,"f")[e]||(V(this,fr,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{le(this,Qi,!0),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){le(this,Qi,!0),await V(this,Ga,"f")}_emit(e,...t){if(V(this,Qa,"f"))return;e==="end"&&(le(this,Qa,!0),V(this,$c,"f").call(this));const r=V(this,fr,"f")[e];if(r&&(V(this,fr,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!V(this,Qi,"f")&&!(r!=null&&r.length)&&Promise.reject(s),V(this,Ka,"f").call(this,s),V(this,Ha,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!V(this,Qi,"f")&&!(r!=null&&r.length)&&Promise.reject(s),V(this,Ka,"f").call(this,s),V(this,Ha,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Fc=new WeakMap,Uc=new WeakMap,Ka=new WeakMap,Ga=new WeakMap,$c=new WeakMap,Ha=new WeakMap,fr=new WeakMap,Qa=new WeakMap,jh=new WeakMap,Fh=new WeakMap,Qi=new WeakMap,ym=new WeakSet,DS=function(e){if(le(this,jh,!0),e instanceof Error&&e.name==="AbortError"&&(e=new In),e instanceof In)return le(this,Fh,!0),this._emit("abort",e);if(e instanceof se)return this._emit("error",e);if(e instanceof Error){const t=new se(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new se(String(e)))};function vP(n){return typeof n.parse=="function"}var jt,vm,Uh,wm,Im,Em,OS,VS;const wP=10;class MS extends o_{constructor(){super(...arguments),jt.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(r=e.choices[0])==null?void 0:r.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),NS(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(Lh(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionToolCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new se("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),V(this,jt,"m",vm).call(this)}async finalMessage(){return await this.done(),V(this,jt,"m",Uh).call(this)}async finalFunctionToolCall(){return await this.done(),V(this,jt,"m",wm).call(this)}async finalFunctionToolCallResult(){return await this.done(),V(this,jt,"m",Im).call(this)}async totalUsage(){return await this.done(),V(this,jt,"m",Em).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=V(this,jt,"m",Uh).call(this);t&&this._emit("finalMessage",t);const r=V(this,jt,"m",vm).call(this);r&&this._emit("finalContent",r);const s=V(this,jt,"m",wm).call(this);s&&this._emit("finalFunctionToolCall",s);const i=V(this,jt,"m",Im).call(this);i!=null&&this._emit("finalFunctionToolCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",V(this,jt,"m",Em).call(this))}async _createChatCompletion(e,t,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),V(this,jt,"m",OS).call(this,t);const i=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(i_(i,t))}async _runChatCompletion(e,t,r){for(const s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,r)}async _runTools(e,t,r){var _,E,k;const s="tool",{tool_choice:i="auto",stream:o,...a}=t,u=typeof i!="string"&&i.type==="function"&&((_=i==null?void 0:i.function)==null?void 0:_.name),{maxChatCompletions:c=wP}=r||{},d=t.tools.map(N=>{if(cu(N)){if(!N.$callback)throw new se("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:N.$callback,name:N.function.name,description:N.function.description||"",parameters:N.function.parameters,parse:N.$parseRaw,strict:!0}}}return N}),f={};for(const N of d)N.type==="function"&&(f[N.function.name||N.function.function.name]=N.function);const m="tools"in t?d.map(N=>N.type==="function"?{type:"function",function:{name:N.function.name||N.function.function.name,parameters:N.function.parameters,description:N.function.description,strict:N.function.strict}}:N):void 0;for(const N of t.messages)this._addMessage(N,!1);for(let N=0;N<c;++N){const y=(E=(await this._createChatCompletion(e,{...a,tool_choice:i,tools:m,messages:[...this.messages]},r)).choices[0])==null?void 0:E.message;if(!y)throw new se("missing message in ChatCompletion response");if(!((k=y.tool_calls)!=null&&k.length))return;for(const S of y.tool_calls){if(S.type!=="function")continue;const R=S.id,{name:j,arguments:M}=S.function,w=f[j];if(w){if(u&&u!==j){const b=`Invalid tool_call: ${JSON.stringify(j)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:s,tool_call_id:R,content:b});continue}}else{const b=`Invalid tool_call: ${JSON.stringify(j)}. Available options are: ${Object.keys(f).map(P=>JSON.stringify(P)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:R,content:b});continue}let v;try{v=vP(w)?await w.parse(M):M}catch(b){const P=b instanceof Error?b.message:String(b);this._addMessage({role:s,tool_call_id:R,content:P});continue}const T=await w.function(v,this),A=V(this,jt,"m",VS).call(this,T);if(this._addMessage({role:s,tool_call_id:R,content:A}),u)return}}}}jt=new WeakSet,vm=function(){return V(this,jt,"m",Uh).call(this).content??null},Uh=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Lh(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new se("stream ended without producing a ChatCompletionMessage with role=assistant")},wm=function(){var e,t;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Lh(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.filter(i=>i.type==="function").at(-1))==null?void 0:t.function}},Im=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(NS(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===t.tool_call_id))}))return t.content}},Em=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},OS=function(e){if(e.n!=null&&e.n>1)throw new se("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},VS=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class a_ extends MS{static runTools(e,t,r){const s=new a_,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,i)),s}_addMessage(e,t=!0){super._addMessage(e,t),Lh(e)&&e.content&&this._emit("content",e.content)}}const LS=1,jS=2,FS=4,US=8,$S=16,BS=32,zS=64,qS=128,WS=256,KS=qS|WS,GS=$S|BS|KS|zS,HS=LS|jS|GS,QS=FS|US,IP=HS|QS,mt={STR:LS,NUM:jS,ARR:FS,OBJ:US,NULL:$S,BOOL:BS,NAN:zS,INFINITY:qS,MINUS_INFINITY:WS,INF:KS,SPECIAL:GS,ATOM:HS,COLLECTION:QS,ALL:IP};class EP extends Error{}class TP extends Error{}function SP(n,e=mt.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return AP(n.trim(),e)}const AP=(n,e)=>{const t=n.length;let r=0;const s=m=>{throw new EP(`${m} at position ${r}`)},i=m=>{throw new TP(`${m} at position ${r}`)},o=()=>(f(),r>=t&&s("Unexpected end of input"),n[r]==='"'?a():n[r]==="{"?u():n[r]==="["?c():n.substring(r,r+4)==="null"||mt.NULL&e&&t-r<4&&"null".startsWith(n.substring(r))?(r+=4,null):n.substring(r,r+4)==="true"||mt.BOOL&e&&t-r<4&&"true".startsWith(n.substring(r))?(r+=4,!0):n.substring(r,r+5)==="false"||mt.BOOL&e&&t-r<5&&"false".startsWith(n.substring(r))?(r+=5,!1):n.substring(r,r+8)==="Infinity"||mt.INFINITY&e&&t-r<8&&"Infinity".startsWith(n.substring(r))?(r+=8,1/0):n.substring(r,r+9)==="-Infinity"||mt.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(n.substring(r))?(r+=9,-1/0):n.substring(r,r+3)==="NaN"||mt.NAN&e&&t-r<3&&"NaN".startsWith(n.substring(r))?(r+=3,NaN):d()),a=()=>{const m=r;let _=!1;for(r++;r<t&&(n[r]!=='"'||_&&n[r-1]==="\\");)_=n[r]==="\\"?!_:!1,r++;if(n.charAt(r)=='"')try{return JSON.parse(n.substring(m,++r-Number(_)))}catch(E){i(String(E))}else if(mt.STR&e)try{return JSON.parse(n.substring(m,r-Number(_))+'"')}catch{return JSON.parse(n.substring(m,n.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},u=()=>{r++,f();const m={};try{for(;n[r]!=="}";){if(f(),r>=t&&mt.OBJ&e)return m;const _=a();f(),r++;try{const E=o();Object.defineProperty(m,_,{value:E,writable:!0,enumerable:!0,configurable:!0})}catch(E){if(mt.OBJ&e)return m;throw E}f(),n[r]===","&&r++}}catch{if(mt.OBJ&e)return m;s("Expected '}' at end of object")}return r++,m},c=()=>{r++;const m=[];try{for(;n[r]!=="]";)m.push(o()),f(),n[r]===","&&r++}catch{if(mt.ARR&e)return m;s("Expected ']' at end of array")}return r++,m},d=()=>{if(r===0){n==="-"&&mt.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n)}catch(_){if(mt.NUM&e)try{return n[n.length-1]==="."?JSON.parse(n.substring(0,n.lastIndexOf("."))):JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}i(String(_))}}const m=r;for(n[r]==="-"&&r++;n[r]&&!",]}".includes(n[r]);)r++;r==t&&!(mt.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(n.substring(m,r))}catch{n.substring(m,r)==="-"&&mt.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n.substring(m,n.lastIndexOf("e")))}catch(E){i(String(E))}}},f=()=>{for(;r<t&&` 
\r	`.includes(n[r]);)r++};return o()},Rw=n=>SP(n,mt.ALL^mt.NUM);var ot,dr,Fi,zr,Zf,fc,ep,tp,np,pc,rp,Pw;class zl extends MS{constructor(e){super(),ot.add(this),dr.set(this,void 0),Fi.set(this,void 0),zr.set(this,void 0),le(this,dr,e),le(this,Fi,[])}get currentChatCompletionSnapshot(){return V(this,zr,"f")}static fromReadableStream(e){const t=new zl(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){const s=new zl(t);return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,r){var o;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),V(this,ot,"m",Zf).call(this);const i=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const a of i)V(this,ot,"m",ep).call(this,a);if((o=i.controller.signal)!=null&&o.aborted)throw new In;return this._addChatCompletion(V(this,ot,"m",pc).call(this))}async _fromReadableStream(e,t){var o;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),V(this,ot,"m",Zf).call(this),this._connected();const s=er.fromReadableStream(e,this.controller);let i;for await(const a of s)i&&i!==a.id&&this._addChatCompletion(V(this,ot,"m",pc).call(this)),V(this,ot,"m",ep).call(this,a),i=a.id;if((o=s.controller.signal)!=null&&o.aborted)throw new In;return this._addChatCompletion(V(this,ot,"m",pc).call(this))}[(dr=new WeakMap,Fi=new WeakMap,zr=new WeakMap,ot=new WeakSet,Zf=function(){this.ended||le(this,zr,void 0)},fc=function(t){let r=V(this,Fi,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},V(this,Fi,"f")[t.index]=r,r)},ep=function(t){var s,i,o,a,u,c,d,f,m,_,E,k,N,x,y;if(this.ended)return;const r=V(this,ot,"m",Pw).call(this,t);this._emit("chunk",t,r);for(const S of t.choices){const R=r.choices[S.index];S.delta.content!=null&&((s=R.message)==null?void 0:s.role)==="assistant"&&((i=R.message)!=null&&i.content)&&(this._emit("content",S.delta.content,R.message.content),this._emit("content.delta",{delta:S.delta.content,snapshot:R.message.content,parsed:R.message.parsed})),S.delta.refusal!=null&&((o=R.message)==null?void 0:o.role)==="assistant"&&((a=R.message)!=null&&a.refusal)&&this._emit("refusal.delta",{delta:S.delta.refusal,snapshot:R.message.refusal}),((u=S.logprobs)==null?void 0:u.content)!=null&&((c=R.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=S.logprobs)==null?void 0:d.content,snapshot:((f=R.logprobs)==null?void 0:f.content)??[]}),((m=S.logprobs)==null?void 0:m.refusal)!=null&&((_=R.message)==null?void 0:_.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(E=S.logprobs)==null?void 0:E.refusal,snapshot:((k=R.logprobs)==null?void 0:k.refusal)??[]});const j=V(this,ot,"m",fc).call(this,R);R.finish_reason&&(V(this,ot,"m",np).call(this,R),j.current_tool_call_index!=null&&V(this,ot,"m",tp).call(this,R,j.current_tool_call_index));for(const M of S.delta.tool_calls??[])j.current_tool_call_index!==M.index&&(V(this,ot,"m",np).call(this,R),j.current_tool_call_index!=null&&V(this,ot,"m",tp).call(this,R,j.current_tool_call_index)),j.current_tool_call_index=M.index;for(const M of S.delta.tool_calls??[]){const w=(N=R.message.tool_calls)==null?void 0:N[M.index];w!=null&&w.type&&((w==null?void 0:w.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(x=w.function)==null?void 0:x.name,index:M.index,arguments:w.function.arguments,parsed_arguments:w.function.parsed_arguments,arguments_delta:((y=M.function)==null?void 0:y.arguments)??""}):(w==null||w.type,void 0))}}},tp=function(t,r){var o,a,u;if(V(this,ot,"m",fc).call(this,t).done_tool_calls.has(r))return;const i=(o=t.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const c=(u=(a=V(this,dr,"f"))==null?void 0:a.tools)==null?void 0:u.find(d=>Mh(d)&&d.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:cu(c)?c.$parseRaw(i.function.arguments):c!=null&&c.function.strict?JSON.parse(i.function.arguments):null})}else i.type},np=function(t){var s,i;const r=V(this,ot,"m",fc).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const o=V(this,ot,"m",rp).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(i=t.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},pc=function(){if(this.ended)throw new se("stream has ended, this shouldn't happen");const t=V(this,zr,"f");if(!t)throw new se("request ended without sending any chunks");return le(this,zr,void 0),le(this,Fi,[]),xP(t,V(this,dr,"f"))},rp=function(){var r;const t=(r=V(this,dr,"f"))==null?void 0:r.response_format;return s_(t)?t:null},Pw=function(t){var r,s,i,o;let a=V(this,zr,"f");const{choices:u,...c}=t;a?Object.assign(a,c):a=le(this,zr,{...c,choices:[]});for(const{delta:d,finish_reason:f,index:m,logprobs:_=null,...E}of t.choices){let k=a.choices[m];if(k||(k=a.choices[m]={finish_reason:f,index:m,message:{},logprobs:_,...E}),_)if(!k.logprobs)k.logprobs=Object.assign({},_);else{const{content:M,refusal:w,...v}=_;Object.assign(k.logprobs,v),M&&((r=k.logprobs).content??(r.content=[]),k.logprobs.content.push(...M)),w&&((s=k.logprobs).refusal??(s.refusal=[]),k.logprobs.refusal.push(...w))}if(f&&(k.finish_reason=f,V(this,dr,"f")&&RS(V(this,dr,"f")))){if(f==="length")throw new hS;if(f==="content_filter")throw new dS}if(Object.assign(k,E),!d)continue;const{content:N,refusal:x,function_call:y,role:S,tool_calls:R,...j}=d;if(Object.assign(k.message,j),x&&(k.message.refusal=(k.message.refusal||"")+x),S&&(k.message.role=S),y&&(k.message.function_call?(y.name&&(k.message.function_call.name=y.name),y.arguments&&((i=k.message.function_call).arguments??(i.arguments=""),k.message.function_call.arguments+=y.arguments)):k.message.function_call=y),N&&(k.message.content=(k.message.content||"")+N,!k.message.refusal&&V(this,ot,"m",rp).call(this)&&(k.message.parsed=Rw(k.message.content))),R){k.message.tool_calls||(k.message.tool_calls=[]);for(const{index:M,id:w,type:v,function:T,...A}of R){const b=(o=k.message.tool_calls)[M]??(o[M]={});Object.assign(b,A),w&&(b.id=w),v&&(b.type=v),T&&(b.function??(b.function={name:T.name??"",arguments:""})),T!=null&&T.name&&(b.function.name=T.name),T!=null&&T.arguments&&(b.function.arguments+=T.arguments,_P(V(this,dr,"f"),b)&&(b.function.parsed_arguments=Rw(b.function.arguments)))}}}return a},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("chunk",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new er(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function xP(n,e){const{id:t,choices:r,created:s,model:i,system_fingerprint:o,...a}=n,u={...a,id:t,choices:r.map(({message:c,finish_reason:d,index:f,logprobs:m,..._})=>{if(!d)throw new se(`missing finish_reason for choice ${f}`);const{content:E=null,function_call:k,tool_calls:N,...x}=c,y=c.role;if(!y)throw new se(`missing role for choice ${f}`);if(k){const{arguments:S,name:R}=k;if(S==null)throw new se(`missing function_call.arguments for choice ${f}`);if(!R)throw new se(`missing function_call.name for choice ${f}`);return{..._,message:{content:E,function_call:{arguments:S,name:R},role:y,refusal:c.refusal??null},finish_reason:d,index:f,logprobs:m}}return N?{..._,index:f,finish_reason:d,logprobs:m,message:{...x,role:y,content:E,refusal:c.refusal??null,tool_calls:N.map((S,R)=>{const{function:j,type:M,id:w,...v}=S,{arguments:T,name:A,...b}=j||{};if(w==null)throw new se(`missing choices[${f}].tool_calls[${R}].id
${mc(n)}`);if(M==null)throw new se(`missing choices[${f}].tool_calls[${R}].type
${mc(n)}`);if(A==null)throw new se(`missing choices[${f}].tool_calls[${R}].function.name
${mc(n)}`);if(T==null)throw new se(`missing choices[${f}].tool_calls[${R}].function.arguments
${mc(n)}`);return{...v,id:w,type:M,function:{...b,name:A,arguments:T}}})}}:{..._,message:{...x,content:E,role:y,refusal:c.refusal??null},finish_reason:d,index:f,logprobs:m}}),created:s,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return pP(u,e)}function mc(n){return JSON.stringify(n)}class $h extends zl{static fromReadableStream(e){const t=new $h(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,r){const s=new $h(t),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,i)),s}}let l_=class extends ne{constructor(){super(...arguments),this.messages=new CS(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get($`/chat/completions/${e}`,t)}update(e,t,r){return this._client.post($`/chat/completions/${e}`,{body:t,...r})}list(e={},t){return this._client.getAPIList("/chat/completions",rt,{query:e,...t})}delete(e,t){return this._client.delete($`/chat/completions/${e}`,t)}parse(e,t){return yP(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(r=>i_(r,e))}runTools(e,t){return e.stream?$h.runTools(this._client,e,t):a_.runTools(this._client,e,t)}stream(e,t){return zl.createChatCompletion(this._client,e,t)}};l_.Messages=CS;class u_ extends ne{constructor(){super(...arguments),this.completions=new l_(this._client)}}u_.Completions=l_;const JS=Symbol("brand.privateNullableHeaders");function*bP(n){if(!n)return;if(JS in n){const{values:r,nulls:s}=n;yield*r.entries();for(const i of s)yield[i,null];return}let e=!1,t;n instanceof Headers?t=n.entries():mw(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let r of t){const s=r[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const i=mw(r[1])?r[1]:[r[1]];let o=!1;for(const a of i)a!==void 0&&(e&&!o&&(o=!0,yield[s,null]),yield[s,a])}}const Y=n=>{const e=new Headers,t=new Set;for(const r of n){const s=new Set;for(const[i,o]of bP(r)){const a=i.toLowerCase();s.has(a)||(e.delete(i),s.add(a)),o===null?(e.delete(i),t.add(a)):(e.append(i,o),t.delete(a))}}return{[JS]:!0,values:e,nulls:t}};class XS extends ne{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:Y([{Accept:"application/octet-stream"},t==null?void 0:t.headers]),__binaryResponse:!0})}}class YS extends ne{create(e,t){return this._client.post("/audio/transcriptions",gi({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class ZS extends ne{create(e,t){return this._client.post("/audio/translations",gi({body:e,...t,__metadata:{model:e.model}},this._client))}}class hu extends ne{constructor(){super(...arguments),this.transcriptions=new YS(this._client),this.translations=new ZS(this._client),this.speech=new XS(this._client)}}hu.Transcriptions=YS;hu.Translations=ZS;hu.Speech=XS;class e1 extends ne{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get($`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",rt,{query:e,...t})}cancel(e,t){return this._client.post($`/batches/${e}/cancel`,t)}}class t1 extends ne{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}retrieve(e,t){return this._client.get($`/assistants/${e}`,{...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}update(e,t,r){return this._client.post($`/assistants/${e}`,{body:t,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e={},t){return this._client.getAPIList("/assistants",rt,{query:e,...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}delete(e,t){return this._client.delete($`/assistants/${e}`,{...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}}let n1=class extends ne{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}};class r1 extends ne{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}}let Od=class extends ne{constructor(){super(...arguments),this.sessions=new n1(this._client),this.transcriptionSessions=new r1(this._client)}};Od.Sessions=n1;Od.TranscriptionSessions=r1;class s1 extends ne{create(e,t){return this._client.post("/chatkit/sessions",{body:e,...t,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}cancel(e,t){return this._client.post($`/chatkit/sessions/${e}/cancel`,{...t,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}}let i1=class extends ne{retrieve(e,t){return this._client.get($`/chatkit/threads/${e}`,{...t,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}list(e={},t){return this._client.getAPIList("/chatkit/threads",Vh,{query:e,...t,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}delete(e,t){return this._client.delete($`/chatkit/threads/${e}`,{...t,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}listItems(e,t={},r){return this._client.getAPIList($`/chatkit/threads/${e}/items`,Vh,{query:t,...r,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},r==null?void 0:r.headers])})}};class Vd extends ne{constructor(){super(...arguments),this.sessions=new s1(this._client),this.threads=new i1(this._client)}}Vd.Sessions=s1;Vd.Threads=i1;class o1 extends ne{create(e,t,r){return this._client.post($`/threads/${e}/messages`,{body:t,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,t,r){const{thread_id:s}=t;return this._client.get($`/threads/${s}/messages/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,t,r){const{thread_id:s,...i}=t;return this._client.post($`/threads/${s}/messages/${e}`,{body:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,t={},r){return this._client.getAPIList($`/threads/${e}/messages`,rt,{query:t,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,t,r){const{thread_id:s}=t;return this._client.delete($`/threads/${s}/messages/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}class a1 extends ne{retrieve(e,t,r){const{thread_id:s,run_id:i,...o}=t;return this._client.get($`/threads/${s}/runs/${i}/steps/${e}`,{query:o,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,t,r){const{thread_id:s,...i}=t;return this._client.getAPIList($`/threads/${s}/runs/${e}/steps`,rt,{query:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}const kP=n=>{if(typeof Buffer<"u"){const e=Buffer.from(n,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(n),t=e.length,r=new Uint8Array(t);for(let s=0;s<t;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};var sp={};const Ui=n=>{var e,t,r,s;if(typeof globalThis.process<"u")return((e=sp==null?void 0:sp[n])==null?void 0:e.trim())??void 0;if(typeof globalThis.Deno<"u")return(s=(r=(t=globalThis.Deno.env)==null?void 0:t.get)==null?void 0:r.call(t,n))==null?void 0:s.trim()};var Tt,ei,Tm,Xn,Bc,Dn,ti,mo,Ks,Bh,tn,zc,qc,fl,Ja,Xa,Nw,Dw,Ow,Vw,Mw,Lw,jw;class pl extends o_{constructor(){super(...arguments),Tt.add(this),Tm.set(this,[]),Xn.set(this,{}),Bc.set(this,{}),Dn.set(this,void 0),ti.set(this,void 0),mo.set(this,void 0),Ks.set(this,void 0),Bh.set(this,void 0),tn.set(this,void 0),zc.set(this,void 0),qc.set(this,void 0),fl.set(this,void 0)}[(Tm=new WeakMap,Xn=new WeakMap,Bc=new WeakMap,Dn=new WeakMap,ti=new WeakMap,mo=new WeakMap,Ks=new WeakMap,Bh=new WeakMap,tn=new WeakMap,zc=new WeakMap,qc=new WeakMap,fl=new WeakMap,Tt=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new ei;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=er.fromReadableStream(e,this.controller);for await(const o of s)V(this,Tt,"m",Ja).call(this,o);if((i=s.controller.signal)!=null&&i.aborted)throw new In;return this._addRun(V(this,Tt,"m",Xa).call(this))}toReadableStream(){return new er(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,s){const i=new ei;return i._run(()=>i._runToolAssistantStream(e,t,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,r,s){var u;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},a=await e.submitToolOutputs(t,o,{...s,signal:this.controller.signal});this._connected();for await(const c of a)V(this,Tt,"m",Ja).call(this,c);if((u=a.controller.signal)!=null&&u.aborted)throw new In;return this._addRun(V(this,Tt,"m",Xa).call(this))}static createThreadAssistantStream(e,t,r){const s=new ei;return s._run(()=>s._threadAssistantStream(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,r,s){const i=new ei;return i._run(()=>i._runAssistantStream(e,t,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return V(this,zc,"f")}currentRun(){return V(this,qc,"f")}currentMessageSnapshot(){return V(this,Dn,"f")}currentRunStepSnapshot(){return V(this,fl,"f")}async finalRunSteps(){return await this.done(),Object.values(V(this,Xn,"f"))}async finalMessages(){return await this.done(),Object.values(V(this,Bc,"f"))}async finalRun(){if(await this.done(),!V(this,ti,"f"))throw Error("Final run was not received.");return V(this,ti,"f")}async _createThreadAssistantStream(e,t,r){var a;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...t,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const u of o)V(this,Tt,"m",Ja).call(this,u);if((a=o.controller.signal)!=null&&a.aborted)throw new In;return this._addRun(V(this,Tt,"m",Xa).call(this))}async _createAssistantStream(e,t,r,s){var u;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},a=await e.create(t,o,{...s,signal:this.controller.signal});this._connected();for await(const c of a)V(this,Tt,"m",Ja).call(this,c);if((u=a.controller.signal)!=null&&u.aborted)throw new In;return this._addRun(V(this,Tt,"m",Xa).call(this))}static accumulateDelta(e,t){for(const[r,s]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(Jf(i)&&Jf(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...s);continue}for(const o of s){if(!Jf(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const a=o.index;if(a==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof a!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${a}`);const u=i[a];u==null?i.push(o):i[a]=this.accumulateDelta(u,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,s){return await this._createAssistantStream(t,e,r,s)}async _runToolAssistantStream(e,t,r,s){return await this._createToolAssistantStream(t,e,r,s)}}ei=pl,Ja=function(e){if(!this.ended)switch(le(this,zc,e),V(this,Tt,"m",Ow).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":V(this,Tt,"m",jw).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":V(this,Tt,"m",Dw).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":V(this,Tt,"m",Nw).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Xa=function(){if(this.ended)throw new se("stream has ended, this shouldn't happen");if(!V(this,ti,"f"))throw Error("Final run has not been received");return V(this,ti,"f")},Nw=function(e){const[t,r]=V(this,Tt,"m",Mw).call(this,e,V(this,Dn,"f"));le(this,Dn,t),V(this,Bc,"f")[t.id]=t;for(const s of r){const i=t.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,o=t.content[s.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=V(this,mo,"f")){if(V(this,Ks,"f"))switch(V(this,Ks,"f").type){case"text":this._emit("textDone",V(this,Ks,"f").text,V(this,Dn,"f"));break;case"image_file":this._emit("imageFileDone",V(this,Ks,"f").image_file,V(this,Dn,"f"));break}le(this,mo,s.index)}le(this,Ks,t.content[s.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(V(this,mo,"f")!==void 0){const s=e.data.content[V(this,mo,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,V(this,Dn,"f"));break;case"text":this._emit("textDone",s.text,V(this,Dn,"f"));break}}V(this,Dn,"f")&&this._emit("messageDone",e.data),le(this,Dn,void 0)}},Dw=function(e){const t=V(this,Tt,"m",Vw).call(this,e);switch(le(this,fl,t),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==V(this,Bh,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(V(this,tn,"f")&&this._emit("toolCallDone",V(this,tn,"f")),le(this,Bh,i.index),le(this,tn,t.step_details.tool_calls[i.index]),V(this,tn,"f")&&this._emit("toolCallCreated",V(this,tn,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":le(this,fl,void 0),e.data.step_details.type=="tool_calls"&&V(this,tn,"f")&&(this._emit("toolCallDone",V(this,tn,"f")),le(this,tn,void 0)),this._emit("runStepDone",e.data,t);break}},Ow=function(e){V(this,Tm,"f").push(e),this._emit("event",e)},Vw=function(e){switch(e.event){case"thread.run.step.created":return V(this,Xn,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=V(this,Xn,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=ei.accumulateDelta(t,r.delta);V(this,Xn,"f")[e.data.id]=s}return V(this,Xn,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":V(this,Xn,"f")[e.data.id]=e.data;break}if(V(this,Xn,"f")[e.data.id])return V(this,Xn,"f")[e.data.id];throw new Error("No snapshot available")},Mw=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in t.content){let o=t.content[i.index];t.content[i.index]=V(this,Tt,"m",Lw).call(this,i,o)}else t.content[i.index]=i,r.push(i);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Lw=function(e,t){return ei.accumulateDelta(t,e)},jw=function(e){switch(le(this,qc,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":le(this,ti,e.data),V(this,tn,"f")&&(this._emit("toolCallDone",V(this,tn,"f")),le(this,tn,void 0));break}};let c_=class extends ne{constructor(){super(...arguments),this.steps=new a1(this._client)}create(e,t,r){const{include:s,...i}=t;return this._client.post($`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers]),stream:t.stream??!1})}retrieve(e,t,r){const{thread_id:s}=t;return this._client.get($`/threads/${s}/runs/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,t,r){const{thread_id:s,...i}=t;return this._client.post($`/threads/${s}/runs/${e}`,{body:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,t={},r){return this._client.getAPIList($`/threads/${e}/runs`,rt,{query:t,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}cancel(e,t,r){const{thread_id:s}=t;return this._client.post($`/threads/${s}/runs/${e}/cancel`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(s.id,{thread_id:e},r)}createAndStream(e,t,r){return pl.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){var i;const s=Y([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:a}=await this.retrieve(e,t,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let u=5e3;if(r!=null&&r.pollIntervalMs)u=r.pollIntervalMs;else{const c=a.headers.get("openai-poll-after-ms");if(c){const d=parseInt(c);isNaN(d)||(u=d)}}await uu(u);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(e,t,r){return pl.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r){const{thread_id:s,...i}=t;return this._client.post($`/threads/${s}/runs/${e}/submit_tool_outputs`,{body:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,r){const s=await this.submitToolOutputs(e,t,r);return await this.poll(s.id,t,r)}submitToolOutputsStream(e,t,r){return pl.createToolAssistantStream(e,this._client.beta.threads.runs,t,r)}};c_.Steps=a1;class Md extends ne{constructor(){super(...arguments),this.runs=new c_(this._client),this.messages=new o1(this._client)}create(e={},t){return this._client.post("/threads",{body:e,...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}retrieve(e,t){return this._client.get($`/threads/${e}`,{...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}update(e,t,r){return this._client.post($`/threads/${e}`,{body:t,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,t){return this._client.delete($`/threads/${e}`,{...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers]),stream:e.stream??!1})}async createAndRunPoll(e,t){const r=await this.createAndRun(e,t);return await this.runs.poll(r.id,{thread_id:r.thread_id},t)}createAndRunStream(e,t){return pl.createThreadAssistantStream(e,this._client.beta.threads,t)}}Md.Runs=c_;Md.Messages=o1;class Zo extends ne{constructor(){super(...arguments),this.realtime=new Od(this._client),this.chatkit=new Vd(this._client),this.assistants=new t1(this._client),this.threads=new Md(this._client)}}Zo.Realtime=Od;Zo.ChatKit=Vd;Zo.Assistants=t1;Zo.Threads=Md;class l1 extends ne{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class u1 extends ne{retrieve(e,t,r){const{container_id:s}=t;return this._client.get($`/containers/${s}/files/${e}/content`,{...r,headers:Y([{Accept:"application/binary"},r==null?void 0:r.headers]),__binaryResponse:!0})}}let h_=class extends ne{constructor(){super(...arguments),this.content=new u1(this._client)}create(e,t,r){return this._client.post($`/containers/${e}/files`,gi({body:t,...r},this._client))}retrieve(e,t,r){const{container_id:s}=t;return this._client.get($`/containers/${s}/files/${e}`,r)}list(e,t={},r){return this._client.getAPIList($`/containers/${e}/files`,rt,{query:t,...r})}delete(e,t,r){const{container_id:s}=t;return this._client.delete($`/containers/${s}/files/${e}`,{...r,headers:Y([{Accept:"*/*"},r==null?void 0:r.headers])})}};h_.Content=u1;class d_ extends ne{constructor(){super(...arguments),this.files=new h_(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get($`/containers/${e}`,t)}list(e={},t){return this._client.getAPIList("/containers",rt,{query:e,...t})}delete(e,t){return this._client.delete($`/containers/${e}`,{...t,headers:Y([{Accept:"*/*"},t==null?void 0:t.headers])})}}d_.Files=h_;class c1 extends ne{create(e,t,r){const{include:s,...i}=t;return this._client.post($`/conversations/${e}/items`,{query:{include:s},body:i,...r})}retrieve(e,t,r){const{conversation_id:s,...i}=t;return this._client.get($`/conversations/${s}/items/${e}`,{query:i,...r})}list(e,t={},r){return this._client.getAPIList($`/conversations/${e}/items`,Vh,{query:t,...r})}delete(e,t,r){const{conversation_id:s}=t;return this._client.delete($`/conversations/${s}/items/${e}`,r)}}class f_ extends ne{constructor(){super(...arguments),this.items=new c1(this._client)}create(e={},t){return this._client.post("/conversations",{body:e,...t})}retrieve(e,t){return this._client.get($`/conversations/${e}`,t)}update(e,t,r){return this._client.post($`/conversations/${e}`,{body:t,...r})}delete(e,t){return this._client.delete($`/conversations/${e}`,t)}}f_.Items=c1;class h1 extends ne{create(e,t){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&Et(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:s},...t});return r?i:(Et(this._client).debug("embeddings/decoding base64 embeddings from base64"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(a=>{const u=a.embedding;a.embedding=kP(u)}),o)))}}class d1 extends ne{retrieve(e,t,r){const{eval_id:s,run_id:i}=t;return this._client.get($`/evals/${s}/runs/${i}/output_items/${e}`,r)}list(e,t,r){const{eval_id:s,...i}=t;return this._client.getAPIList($`/evals/${s}/runs/${e}/output_items`,rt,{query:i,...r})}}class p_ extends ne{constructor(){super(...arguments),this.outputItems=new d1(this._client)}create(e,t,r){return this._client.post($`/evals/${e}/runs`,{body:t,...r})}retrieve(e,t,r){const{eval_id:s}=t;return this._client.get($`/evals/${s}/runs/${e}`,r)}list(e,t={},r){return this._client.getAPIList($`/evals/${e}/runs`,rt,{query:t,...r})}delete(e,t,r){const{eval_id:s}=t;return this._client.delete($`/evals/${s}/runs/${e}`,r)}cancel(e,t,r){const{eval_id:s}=t;return this._client.post($`/evals/${s}/runs/${e}`,r)}}p_.OutputItems=d1;class m_ extends ne{constructor(){super(...arguments),this.runs=new p_(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get($`/evals/${e}`,t)}update(e,t,r){return this._client.post($`/evals/${e}`,{body:t,...r})}list(e={},t){return this._client.getAPIList("/evals",rt,{query:e,...t})}delete(e,t){return this._client.delete($`/evals/${e}`,t)}}m_.Runs=p_;let f1=class extends ne{create(e,t){return this._client.post("/files",gi({body:e,...t},this._client))}retrieve(e,t){return this._client.get($`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",rt,{query:e,...t})}delete(e,t){return this._client.delete($`/files/${e}`,t)}content(e,t){return this._client.get($`/files/${e}/content`,{...t,headers:Y([{Accept:"application/binary"},t==null?void 0:t.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await uu(t),o=await this.retrieve(e),Date.now()-i>r)throw new e_({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class p1 extends ne{}let m1=class extends ne{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}};class g_ extends ne{constructor(){super(...arguments),this.graders=new m1(this._client)}}g_.Graders=m1;class g1 extends ne{create(e,t,r){return this._client.getAPIList($`/fine_tuning/checkpoints/${e}/permissions`,Dd,{body:t,method:"post",...r})}retrieve(e,t={},r){return this._client.get($`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...r})}delete(e,t,r){const{fine_tuned_model_checkpoint:s}=t;return this._client.delete($`/fine_tuning/checkpoints/${s}/permissions/${e}`,r)}}let __=class extends ne{constructor(){super(...arguments),this.permissions=new g1(this._client)}};__.Permissions=g1;class _1 extends ne{list(e,t={},r){return this._client.getAPIList($`/fine_tuning/jobs/${e}/checkpoints`,rt,{query:t,...r})}}class y_ extends ne{constructor(){super(...arguments),this.checkpoints=new _1(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get($`/fine_tuning/jobs/${e}`,t)}list(e={},t){return this._client.getAPIList("/fine_tuning/jobs",rt,{query:e,...t})}cancel(e,t){return this._client.post($`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return this._client.getAPIList($`/fine_tuning/jobs/${e}/events`,rt,{query:t,...r})}pause(e,t){return this._client.post($`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post($`/fine_tuning/jobs/${e}/resume`,t)}}y_.Checkpoints=_1;class ea extends ne{constructor(){super(...arguments),this.methods=new p1(this._client),this.jobs=new y_(this._client),this.checkpoints=new __(this._client),this.alpha=new g_(this._client)}}ea.Methods=p1;ea.Jobs=y_;ea.Checkpoints=__;ea.Alpha=g_;class y1 extends ne{}class v_ extends ne{constructor(){super(...arguments),this.graderModels=new y1(this._client)}}v_.GraderModels=y1;class v1 extends ne{createVariation(e,t){return this._client.post("/images/variations",gi({body:e,...t},this._client))}edit(e,t){return this._client.post("/images/edits",gi({body:e,...t,stream:e.stream??!1},this._client))}generate(e,t){return this._client.post("/images/generations",{body:e,...t,stream:e.stream??!1})}}class w1 extends ne{retrieve(e,t){return this._client.get($`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Dd,e)}delete(e,t){return this._client.delete($`/models/${e}`,t)}}class I1 extends ne{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class E1 extends ne{accept(e,t,r){return this._client.post($`/realtime/calls/${e}/accept`,{body:t,...r,headers:Y([{Accept:"*/*"},r==null?void 0:r.headers])})}hangup(e,t){return this._client.post($`/realtime/calls/${e}/hangup`,{...t,headers:Y([{Accept:"*/*"},t==null?void 0:t.headers])})}refer(e,t,r){return this._client.post($`/realtime/calls/${e}/refer`,{body:t,...r,headers:Y([{Accept:"*/*"},r==null?void 0:r.headers])})}reject(e,t={},r){return this._client.post($`/realtime/calls/${e}/reject`,{body:t,...r,headers:Y([{Accept:"*/*"},r==null?void 0:r.headers])})}}class T1 extends ne{create(e,t){return this._client.post("/realtime/client_secrets",{body:e,...t})}}class Ld extends ne{constructor(){super(...arguments),this.clientSecrets=new T1(this._client),this.calls=new E1(this._client)}}Ld.ClientSecrets=T1;Ld.Calls=E1;function CP(n,e){return!e||!PP(e)?{...n,output_parsed:null,output:n.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(r=>({...r,parsed:null}))}:t)}:S1(n,e)}function S1(n,e){const t=n.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:OP(e,s)};if(s.type==="message"){const i=s.content.map(o=>o.type==="output_text"?{...o,parsed:RP(e,o.text)}:o);return{...s,content:i}}return s}),r=Object.assign({},n,{output:t});return Object.getOwnPropertyDescriptor(n,"output_text")||Sm(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const i of s.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function RP(n,e){var t,r,s,i;return((r=(t=n.text)==null?void 0:t.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=n.text)==null?void 0:s.format)?((i=n.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function PP(n){var e;return!!s_((e=n.text)==null?void 0:e.format)}function NP(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function DP(n,e){return n.find(t=>t.type==="function"&&t.name===e)}function OP(n,e){const t=DP(n.tools??[],e.name);return{...e,...e,parsed_arguments:NP(t)?t.$parseRaw(e.arguments):t!=null&&t.strict?JSON.parse(e.arguments):null}}function Sm(n){const e=[];for(const t of n.output)if(t.type==="message")for(const r of t.content)r.type==="output_text"&&e.push(r.text);n.output_text=e.join("")}var $i,gc,qr,_c,Fw,Uw,$w,Bw;class w_ extends o_{constructor(e){super(),$i.add(this),gc.set(this,void 0),qr.set(this,void 0),_c.set(this,void 0),le(this,gc,e)}static createResponse(e,t,r){const s=new w_(t);return s._run(()=>s._createOrRetrieveResponse(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,t,r){var a;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),V(this,$i,"m",Fw).call(this);let i,o=null;"response_id"in t?(i=await e.responses.retrieve(t.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=t.starting_after??null):i=await e.responses.create({...t,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const u of i)V(this,$i,"m",Uw).call(this,u,o);if((a=i.controller.signal)!=null&&a.aborted)throw new In;return V(this,$i,"m",$w).call(this)}[(gc=new WeakMap,qr=new WeakMap,_c=new WeakMap,$i=new WeakSet,Fw=function(){this.ended||le(this,qr,void 0)},Uw=function(t,r){if(this.ended)return;const s=(o,a)=>{(r==null||a.sequence_number>r)&&this._emit(o,a)},i=V(this,$i,"m",Bw).call(this,t);switch(s("event",t),t.type){case"response.output_text.delta":{const o=i.output[t.output_index];if(!o)throw new se(`missing output at index ${t.output_index}`);if(o.type==="message"){const a=o.content[t.content_index];if(!a)throw new se(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new se(`expected content to be 'output_text', got ${a.type}`);s("response.output_text.delta",{...t,snapshot:a.text})}break}case"response.function_call_arguments.delta":{const o=i.output[t.output_index];if(!o)throw new se(`missing output at index ${t.output_index}`);o.type==="function_call"&&s("response.function_call_arguments.delta",{...t,snapshot:o.arguments});break}default:s(t.type,t);break}},$w=function(){if(this.ended)throw new se("stream has ended, this shouldn't happen");const t=V(this,qr,"f");if(!t)throw new se("request ended without sending any events");le(this,qr,void 0);const r=VP(t,V(this,gc,"f"));return le(this,_c,r),r},Bw=function(t){var s;let r=V(this,qr,"f");if(!r){if(t.type!=="response.created")throw new se(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return r=le(this,qr,t.response),r}switch(t.type){case"response.output_item.added":{r.output.push(t.item);break}case"response.content_part.added":{const i=r.output[t.output_index];if(!i)throw new se(`missing output at index ${t.output_index}`);const o=i.type,a=t.part;o==="message"&&a.type!=="reasoning_text"?i.content.push(a):o==="reasoning"&&a.type==="reasoning_text"&&(i.content||(i.content=[]),i.content.push(a));break}case"response.output_text.delta":{const i=r.output[t.output_index];if(!i)throw new se(`missing output at index ${t.output_index}`);if(i.type==="message"){const o=i.content[t.content_index];if(!o)throw new se(`missing content at index ${t.content_index}`);if(o.type!=="output_text")throw new se(`expected content to be 'output_text', got ${o.type}`);o.text+=t.delta}break}case"response.function_call_arguments.delta":{const i=r.output[t.output_index];if(!i)throw new se(`missing output at index ${t.output_index}`);i.type==="function_call"&&(i.arguments+=t.delta);break}case"response.reasoning_text.delta":{const i=r.output[t.output_index];if(!i)throw new se(`missing output at index ${t.output_index}`);if(i.type==="reasoning"){const o=(s=i.content)==null?void 0:s[t.content_index];if(!o)throw new se(`missing content at index ${t.content_index}`);if(o.type!=="reasoning_text")throw new se(`expected content to be 'reasoning_text', got ${o.type}`);o.text+=t.delta}break}case"response.completed":{le(this,qr,t.response);break}}return r},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=V(this,_c,"f");if(!e)throw new se("stream ended without producing a ChatCompletion");return e}}function VP(n,e){return CP(n,e)}class A1 extends ne{list(e,t={},r){return this._client.getAPIList($`/responses/${e}/input_items`,rt,{query:t,...r})}}class x1 extends ne{count(e={},t){return this._client.post("/responses/input_tokens",{body:e,...t})}}class jd extends ne{constructor(){super(...arguments),this.inputItems=new A1(this._client),this.inputTokens=new x1(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&Sm(r),r))}retrieve(e,t={},r){return this._client.get($`/responses/${e}`,{query:t,...r,stream:(t==null?void 0:t.stream)??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&Sm(s),s))}delete(e,t){return this._client.delete($`/responses/${e}`,{...t,headers:Y([{Accept:"*/*"},t==null?void 0:t.headers])})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(r=>S1(r,e))}stream(e,t){return w_.createResponse(this._client,e,t)}cancel(e,t){return this._client.post($`/responses/${e}/cancel`,t)}}jd.InputItems=A1;jd.InputTokens=x1;class b1 extends ne{create(e,t,r){return this._client.post($`/uploads/${e}/parts`,gi({body:t,...r},this._client))}}class I_ extends ne{constructor(){super(...arguments),this.parts=new b1(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post($`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post($`/uploads/${e}/complete`,{body:t,...r})}}I_.Parts=b1;const MP=async n=>{const e=await Promise.allSettled(n),t=e.filter(s=>s.status==="rejected");if(t.length){for(const s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class k1 extends ne{create(e,t,r){return this._client.post($`/vector_stores/${e}/file_batches`,{body:t,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,t,r){const{vector_store_id:s}=t;return this._client.get($`/vector_stores/${s}/file_batches/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}cancel(e,t,r){const{vector_store_id:s}=t;return this._client.post($`/vector_stores/${s}/file_batches/${e}/cancel`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,t,r){const s=await this.create(e,t);return await this.poll(e,s.id,r)}listFiles(e,t,r){const{vector_store_id:s,...i}=t;return this._client.getAPIList($`/vector_stores/${s}/file_batches/${e}/files`,rt,{query:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async poll(e,t,r){var i;const s=Y([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:a}=await this.retrieve(t,{vector_store_id:e},{...r,headers:s}).withResponse();switch(o.status){case"in_progress":let u=5e3;if(r!=null&&r.pollIntervalMs)u=r.pollIntervalMs;else{const c=a.headers.get("openai-poll-after-ms");if(c){const d=parseInt(c);isNaN(d)||(u=d)}}await uu(u);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},s){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(i,t.length),a=this._client,u=t.values(),c=[...r];async function d(m){for(let _ of m){const E=await a.files.create({file:_,purpose:"assistants"},s);c.push(E.id)}}const f=Array(o).fill(u).map(d);return await MP(f),await this.createAndPoll(e,{file_ids:c})}}class C1 extends ne{create(e,t,r){return this._client.post($`/vector_stores/${e}/files`,{body:t,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,t,r){const{vector_store_id:s}=t;return this._client.get($`/vector_stores/${s}/files/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,t,r){const{vector_store_id:s,...i}=t;return this._client.post($`/vector_stores/${s}/files/${e}`,{body:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,t={},r){return this._client.getAPIList($`/vector_stores/${e}/files`,rt,{query:t,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,t,r){const{vector_store_id:s}=t;return this._client.delete($`/vector_stores/${s}/files/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}async poll(e,t,r){var i;const s=Y([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const o=await this.retrieve(t,{vector_store_id:e},{...r,headers:s}).withResponse(),a=o.data;switch(a.status){case"in_progress":let u=5e3;if(r!=null&&r.pollIntervalMs)u=r.pollIntervalMs;else{const c=o.response.headers.get("openai-poll-after-ms");if(c){const d=parseInt(c);isNaN(d)||(u=d)}}await uu(u);break;case"failed":case"completed":return a}}}async upload(e,t,r){const s=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,t,r){const s=await this.upload(e,t,r);return await this.poll(e,s.id,r)}content(e,t,r){const{vector_store_id:s}=t;return this._client.getAPIList($`/vector_stores/${s}/files/${e}/content`,Dd,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}class Fd extends ne{constructor(){super(...arguments),this.files=new C1(this._client),this.fileBatches=new k1(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}retrieve(e,t){return this._client.get($`/vector_stores/${e}`,{...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}update(e,t,r){return this._client.post($`/vector_stores/${e}`,{body:t,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e={},t){return this._client.getAPIList("/vector_stores",rt,{query:e,...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}delete(e,t){return this._client.delete($`/vector_stores/${e}`,{...t,headers:Y([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}search(e,t,r){return this._client.getAPIList($`/vector_stores/${e}/search`,Dd,{body:t,method:"post",...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}Fd.Files=C1;Fd.FileBatches=k1;class R1 extends ne{create(e,t){return this._client.post("/videos",bw({body:e,...t},this._client))}retrieve(e,t){return this._client.get($`/videos/${e}`,t)}list(e={},t){return this._client.getAPIList("/videos",Vh,{query:e,...t})}delete(e,t){return this._client.delete($`/videos/${e}`,t)}downloadContent(e,t={},r){return this._client.get($`/videos/${e}/content`,{query:t,...r,headers:Y([{Accept:"application/binary"},r==null?void 0:r.headers]),__binaryResponse:!0})}remix(e,t,r){return this._client.post($`/videos/${e}/remix`,bw({body:t,...r},this._client))}}var Ji,P1,Wc;class N1 extends ne{constructor(){super(...arguments),Ji.add(this)}async unwrap(e,t,r=this._client.webhookSecret,s=300){return await this.verifySignature(e,t,r,s),JSON.parse(e)}async verifySignature(e,t,r=this._client.webhookSecret,s=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");V(this,Ji,"m",P1).call(this,r);const i=Y([t]).values,o=V(this,Ji,"m",Wc).call(this,i,"webhook-signature"),a=V(this,Ji,"m",Wc).call(this,i,"webhook-timestamp"),u=V(this,Ji,"m",Wc).call(this,i,"webhook-id"),c=parseInt(a,10);if(isNaN(c))throw new za("Invalid webhook timestamp format");const d=Math.floor(Date.now()/1e3);if(d-c>s)throw new za("Webhook timestamp is too old");if(c>d+s)throw new za("Webhook timestamp is too new");const f=o.split(" ").map(k=>k.startsWith("v1,")?k.substring(3):k),m=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),_=u?`${u}.${a}.${e}`:`${a}.${e}`,E=await crypto.subtle.importKey("raw",m,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const k of f)try{const N=Buffer.from(k,"base64");if(await crypto.subtle.verify("HMAC",E,N,new TextEncoder().encode(_)))return}catch{continue}throw new za("The given webhook signature does not match the expected signature")}}Ji=new WeakSet,P1=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Wc=function(e,t){if(!e)throw new Error("Headers are required");const r=e.get(t);if(r==null)throw new Error(`Missing required header: ${t}`);return r};var Am,E_,Kc,D1;class ge{constructor({baseURL:e=Ui("OPENAI_BASE_URL"),apiKey:t=Ui("OPENAI_API_KEY"),organization:r=Ui("OPENAI_ORG_ID")??null,project:s=Ui("OPENAI_PROJECT_ID")??null,webhookSecret:i=Ui("OPENAI_WEBHOOK_SECRET")??null,...o}={}){if(Am.add(this),Kc.set(this,void 0),this.completions=new l1(this),this.chat=new u_(this),this.embeddings=new h1(this),this.files=new f1(this),this.images=new v1(this),this.audio=new hu(this),this.moderations=new I1(this),this.models=new w1(this),this.fineTuning=new ea(this),this.graders=new v_(this),this.vectorStores=new Fd(this),this.webhooks=new N1(this),this.beta=new Zo(this),this.batches=new e1(this),this.uploads=new I_(this),this.responses=new jd(this),this.realtime=new Ld(this),this.conversations=new f_(this),this.evals=new m_(this),this.containers=new d_(this),this.videos=new R1(this),t===void 0)throw new se("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const a={apiKey:t,organization:r,project:s,webhookSecret:i,...o,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&jR())throw new se(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=a.baseURL,this.timeout=a.timeout??E_.DEFAULT_TIMEOUT,this.logger=a.logger??console;const u="warn";this.logLevel=u,this.logLevel=Aw(a.logLevel,"ClientOptions.logLevel",this)??Aw(Ui("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??u,this.fetchOptions=a.fetchOptions,this.maxRetries=a.maxRetries??2,this.fetch=a.fetch??zR(),le(this,Kc,WR),this._options=a,this.apiKey=typeof t=="string"?t:"Missing Key",this.organization=r,this.project=s,this.webhookSecret=i}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}async authHeaders(e){return Y([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return XR(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Hi}`}defaultIdempotencyKey(){return`stainless-node-retry-${nS()}`}makeStatusError(e,t,r,s){return kt.generate(e,t,r,s)}async _callApiKey(){const e=this._options.apiKey;if(typeof e!="function")return!1;let t;try{t=await e()}catch(r){throw r instanceof se?r:new se(`Failed to get token from 'apiKey' function: ${r.message}`,{cause:r})}if(typeof t!="string"||!t)throw new se(`Expected 'apiKey' function argument to return a string but it returned ${t}`);return this.apiKey=t,!0}buildURL(e,t,r){const s=!V(this,Am,"m",D1).call(this)&&r||this.baseURL,i=DR(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return OR(o)||(t={...o,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(i.search=this.stringifyQuery(t)),i.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:t,options:r}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(s=>({method:e,path:t,...s})))}request(e,t=null){return new Nd(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,r){var x,y;const s=await e,i=s.maxRetries??this.maxRetries;t==null&&(t=i),await this.prepareOptions(s);const{req:o,url:a,timeout:u}=await this.buildRequest(s,{retryCount:i-t});await this.prepareRequest(o,{url:a,options:s});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),d=r===void 0?"":`, retryOf: ${r}`,f=Date.now();if(Et(this).debug(`[${c}] sending request`,Bs({retryOfRequestLogID:r,method:s.method,url:a,options:s,headers:o.headers})),(x=s.signal)!=null&&x.aborted)throw new In;const m=new AbortController,_=await this.fetchWithTimeout(a,o,u,m).catch(fm),E=Date.now();if(_ instanceof globalThis.Error){const S=`retrying, ${t} attempts remaining`;if((y=s.signal)!=null&&y.aborted)throw new In;const R=dm(_)||/timed? ?out/i.test(String(_)+("cause"in _?String(_.cause):""));if(t)return Et(this).info(`[${c}] connection ${R?"timed out":"failed"} - ${S}`),Et(this).debug(`[${c}] connection ${R?"timed out":"failed"} (${S})`,Bs({retryOfRequestLogID:r,url:a,durationMs:E-f,message:_.message})),this.retryRequest(s,t,r??c);throw Et(this).info(`[${c}] connection ${R?"timed out":"failed"} - error; no more retries left`),Et(this).debug(`[${c}] connection ${R?"timed out":"failed"} (error; no more retries left)`,Bs({retryOfRequestLogID:r,url:a,durationMs:E-f,message:_.message})),R?new e_:new Rd({cause:_})}const k=[..._.headers.entries()].filter(([S])=>S==="x-request-id").map(([S,R])=>", "+S+": "+JSON.stringify(R)).join(""),N=`[${c}${d}${k}] ${o.method} ${a} ${_.ok?"succeeded":"failed"} with status ${_.status} in ${E-f}ms`;if(!_.ok){const S=await this.shouldRetry(_);if(t&&S){const T=`retrying, ${t} attempts remaining`;return await qR(_.body),Et(this).info(`${N} - ${T}`),Et(this).debug(`[${c}] response error (${T})`,Bs({retryOfRequestLogID:r,url:_.url,status:_.status,headers:_.headers,durationMs:E-f})),this.retryRequest(s,t,r??c,_.headers)}const R=S?"error; no more retries left":"error; not retryable";Et(this).info(`${N} - ${R}`);const j=await _.text().catch(T=>fm(T).message),M=LR(j),w=M?void 0:j;throw Et(this).debug(`[${c}] response error (${R})`,Bs({retryOfRequestLogID:r,url:_.url,status:_.status,headers:_.headers,message:w,durationMs:Date.now()-f})),this.makeStatusError(_.status,M,w,_.headers)}return Et(this).info(N),Et(this).debug(`[${c}] response start`,Bs({retryOfRequestLogID:r,url:_.url,status:_.status,headers:_.headers,durationMs:E-f})),{response:_,options:s,controller:m,requestLogID:c,retryOfRequestLogID:r,startTime:f}}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}requestAPIList(e,t){const r=this.makeRequest(t,null,void 0);return new oP(this,r,e)}async fetchWithTimeout(e,t,r,s){const{signal:i,method:o,...a}=t||{};i&&i.addEventListener("abort",()=>s.abort());const u=setTimeout(()=>s.abort(),r),c=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||typeof a.body=="object"&&a.body!==null&&Symbol.asyncIterator in a.body,d={signal:s.signal,...c?{duplex:"half"}:{},method:"GET",...a};o&&(d.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,d)}finally{clearTimeout(u)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r,s){let i;const o=s==null?void 0:s.get("retry-after-ms");if(o){const u=parseFloat(o);Number.isNaN(u)||(i=u)}const a=s==null?void 0:s.get("retry-after");if(a&&!i){const u=parseFloat(a);Number.isNaN(u)?i=Date.parse(a)-Date.now():i=u*1e3}if(!(i&&0<=i&&i<60*1e3)){const u=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(t,u)}return await uu(i),this.makeRequest(e,t-1,r)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,o=Math.min(.5*Math.pow(2,i),8),a=1-Math.random()*.25;return o*a*1e3}async buildRequest(e,{retryCount:t=0}={}){const r={...e},{method:s,path:i,query:o,defaultBaseURL:a}=r,u=this.buildURL(i,o,a);"timeout"in r&&MR("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const{bodyHeaders:c,body:d}=this.buildBody({options:r}),f=await this.buildHeaders({options:e,method:s,bodyHeaders:c,retryCount:t});return{req:{method:s,headers:f,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&d instanceof globalThis.ReadableStream&&{duplex:"half"},...d&&{body:d},...this.fetchOptions??{},...r.fetchOptions??{}},url:u,timeout:r.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:r,retryCount:s}){let i={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const o=Y([i,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...BR(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(o),o.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=Y([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:mS(e)}:V(this,Kc,"f").call(this,{body:e,headers:r})}}E_=ge,Kc=new WeakMap,Am=new WeakSet,D1=function(){return this.baseURL!=="https://api.openai.com/v1"};ge.OpenAI=E_;ge.DEFAULT_TIMEOUT=6e5;ge.OpenAIError=se;ge.APIError=kt;ge.APIConnectionError=Rd;ge.APIConnectionTimeoutError=e_;ge.APIUserAbortError=In;ge.NotFoundError=oS;ge.ConflictError=aS;ge.RateLimitError=uS;ge.BadRequestError=rS;ge.AuthenticationError=sS;ge.InternalServerError=cS;ge.PermissionDeniedError=iS;ge.UnprocessableEntityError=lS;ge.InvalidWebhookSignatureError=za;ge.toFile=hP;ge.Completions=l1;ge.Chat=u_;ge.Embeddings=h1;ge.Files=f1;ge.Images=v1;ge.Audio=hu;ge.Moderations=I1;ge.Models=w1;ge.FineTuning=ea;ge.Graders=v_;ge.VectorStores=Fd;ge.Webhooks=N1;ge.Beta=Zo;ge.Batches=e1;ge.Uploads=I_;ge.Responses=jd;ge.Realtime=Ld;ge.Conversations=f_;ge.Evals=m_;ge.Containers=d_;ge.Videos=R1;const LP=()=>{};var zw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},jP=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},V1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,u=s+2<n.length,c=u?n[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|c>>6,_=c&63;u||(_=64,o||(m=64)),r.push(t[d],t[f],t[m],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(O1(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):jP(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw new FP;const m=i<<2|a>>4;if(r.push(m),c!==64){const _=a<<4&240|c>>2;if(r.push(_),f!==64){const E=c<<6&192|f;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class FP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const UP=function(n){const e=O1(n);return V1.encodeByteArray(e,!0)},zh=function(n){return UP(n).replace(/\./g,"")},M1=function(n){try{return V1.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $P=()=>L1().__FIREBASE_DEFAULTS__,BP=()=>{if(typeof process>"u"||typeof zw>"u")return;const n=zw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},zP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&M1(n[1]);return e&&JSON.parse(e)},Ud=()=>{try{return LP()||$P()||BP()||zP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},j1=n=>{var e,t;return(t=(e=Ud())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},qP=n=>{const e=j1(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},F1=()=>{var n;return(n=Ud())==null?void 0:n.config},U1=n=>{var e;return(e=Ud())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ta(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $1(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[zh(JSON.stringify(t)),zh(JSON.stringify(o)),""].join(".")}const ml={};function GP(){const n={prod:[],emulator:[]};for(const e of Object.keys(ml))ml[e]?n.emulator.push(e):n.prod.push(e);return n}function HP(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let qw=!1;function B1(n,e){if(typeof window>"u"||typeof document>"u"||!ta(window.location.host)||ml[n]===e||ml[n]||qw)return;ml[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=GP().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,_){m.setAttribute("width","24"),m.setAttribute("id",_),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{qw=!0,o()},m}function d(m,_){m.setAttribute("id",_),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=HP(r),_=t("text"),E=document.getElementById(_)||document.createElement("span"),k=t("learnmore"),N=document.getElementById(k)||document.createElement("a"),x=t("preprendIcon"),y=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const S=m.element;a(S),d(N,k);const R=c();u(y,x),S.append(y,E,N,R),document.body.appendChild(S)}i?(E.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ct(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ct())}function z1(){var e;const n=(e=Ud())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function JP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function XP(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function YP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ZP(){const n=ct();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function q1(){return!z1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function W1(){return!z1()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function K1(){try{return typeof indexedDB=="object"}catch{return!1}}function e2(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2="FirebaseError";class Dr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=t2,Object.setPrototypeOf(this,Dr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,du.prototype.create)}}class du{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?n2(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Dr(s,a,r)}}function n2(n,e){return n.replace(r2,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const r2=/\{\$([^}]+)}/g;function s2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function _i(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(Ww(i)&&Ww(o)){if(!_i(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Ww(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function i2(n,e){const t=new o2(n,e);return t.subscribe.bind(t)}class o2{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");a2(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=ip),s.error===void 0&&(s.error=ip),s.complete===void 0&&(s.complete=ip);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function a2(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ip(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(n){return n&&n._delegate?n._delegate:n}class yi{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l2{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new WP;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(c2(e))try{this.getOrInitializeService({instanceIdentifier:zs})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=zs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=zs){return this.instances.has(e)}getOptions(e=zs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:u2(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=zs){return this.component?this.component.multipleInstances?e:zs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function u2(n){return n===zs?void 0:n}function c2(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new l2(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ve;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ve||(ve={}));const d2={debug:ve.DEBUG,verbose:ve.VERBOSE,info:ve.INFO,warn:ve.WARN,error:ve.ERROR,silent:ve.SILENT},f2=ve.INFO,p2={[ve.DEBUG]:"log",[ve.VERBOSE]:"log",[ve.INFO]:"info",[ve.WARN]:"warn",[ve.ERROR]:"error"},m2=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=p2[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class T_{constructor(e){this.name=e,this._logLevel=f2,this._logHandler=m2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?d2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ve.DEBUG,...e),this._logHandler(this,ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ve.VERBOSE,...e),this._logHandler(this,ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ve.INFO,...e),this._logHandler(this,ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ve.WARN,...e),this._logHandler(this,ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ve.ERROR,...e),this._logHandler(this,ve.ERROR,...e)}}const g2=(n,e)=>e.some(t=>n instanceof t);let Kw,Gw;function _2(){return Kw||(Kw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function y2(){return Gw||(Gw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const G1=new WeakMap,xm=new WeakMap,H1=new WeakMap,op=new WeakMap,S_=new WeakMap;function v2(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(ps(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&G1.set(t,n)}).catch(()=>{}),S_.set(e,n),e}function w2(n){if(xm.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});xm.set(n,e)}let bm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return xm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||H1.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ps(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function I2(n){bm=n(bm)}function E2(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(ap(this),e,...t);return H1.set(r,e.sort?e.sort():[e]),ps(r)}:y2().includes(n)?function(...e){return n.apply(ap(this),e),ps(G1.get(this))}:function(...e){return ps(n.apply(ap(this),e))}}function T2(n){return typeof n=="function"?E2(n):(n instanceof IDBTransaction&&w2(n),g2(n,_2())?new Proxy(n,bm):n)}function ps(n){if(n instanceof IDBRequest)return v2(n);if(op.has(n))return op.get(n);const e=T2(n);return e!==n&&(op.set(n,e),S_.set(e,n)),e}const ap=n=>S_.get(n);function S2(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=ps(o);return r&&o.addEventListener("upgradeneeded",u=>{r(ps(o.result),u.oldVersion,u.newVersion,ps(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const A2=["get","getKey","getAll","getAllKeys","count"],x2=["put","add","delete","clear"],lp=new Map;function Hw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(lp.get(e))return lp.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=x2.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||A2.includes(t)))return;const i=async function(o,...a){const u=this.transaction(o,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&u.done]))[0]};return lp.set(e,i),i}I2(n=>({...n,get:(e,t,r)=>Hw(e,t)||n.get(e,t,r),has:(e,t)=>!!Hw(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(k2(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function k2(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const km="@firebase/app",Qw="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr=new T_("@firebase/app"),C2="@firebase/app-compat",R2="@firebase/analytics-compat",P2="@firebase/analytics",N2="@firebase/app-check-compat",D2="@firebase/app-check",O2="@firebase/auth",V2="@firebase/auth-compat",M2="@firebase/database",L2="@firebase/data-connect",j2="@firebase/database-compat",F2="@firebase/functions",U2="@firebase/functions-compat",$2="@firebase/installations",B2="@firebase/installations-compat",z2="@firebase/messaging",q2="@firebase/messaging-compat",W2="@firebase/performance",K2="@firebase/performance-compat",G2="@firebase/remote-config",H2="@firebase/remote-config-compat",Q2="@firebase/storage",J2="@firebase/storage-compat",X2="@firebase/firestore",Y2="@firebase/ai",Z2="@firebase/firestore-compat",eN="firebase",tN="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm="[DEFAULT]",nN={[km]:"fire-core",[C2]:"fire-core-compat",[P2]:"fire-analytics",[R2]:"fire-analytics-compat",[D2]:"fire-app-check",[N2]:"fire-app-check-compat",[O2]:"fire-auth",[V2]:"fire-auth-compat",[M2]:"fire-rtdb",[L2]:"fire-data-connect",[j2]:"fire-rtdb-compat",[F2]:"fire-fn",[U2]:"fire-fn-compat",[$2]:"fire-iid",[B2]:"fire-iid-compat",[z2]:"fire-fcm",[q2]:"fire-fcm-compat",[W2]:"fire-perf",[K2]:"fire-perf-compat",[G2]:"fire-rc",[H2]:"fire-rc-compat",[Q2]:"fire-gcs",[J2]:"fire-gcs-compat",[X2]:"fire-fst",[Z2]:"fire-fst-compat",[Y2]:"fire-vertex","fire-js":"fire-js",[eN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qh=new Map,rN=new Map,Rm=new Map;function Jw(n,e){try{n.container.addComponent(e)}catch(t){kr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Do(n){const e=n.name;if(Rm.has(e))return kr.debug(`There were multiple attempts to register component ${e}.`),!1;Rm.set(e,n);for(const t of qh.values())Jw(t,n);for(const t of rN.values())Jw(t,n);return!0}function A_(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ln(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ms=new du("app","Firebase",sN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new yi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ms.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=tN;function Q1(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Cm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ms.create("bad-app-name",{appName:String(s)});if(t||(t=F1()),!t)throw ms.create("no-options");const i=qh.get(s);if(i){if(_i(t,i.options)&&_i(r,i.config))return i;throw ms.create("duplicate-app",{appName:s})}const o=new h2(s);for(const u of Rm.values())o.addComponent(u);const a=new iN(t,r,o);return qh.set(s,a),a}function J1(n=Cm){const e=qh.get(n);if(!e&&n===Cm&&F1())return Q1();if(!e)throw ms.create("no-app",{appName:n});return e}function gs(n,e,t){let r=nN[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),kr.warn(o.join(" "));return}Do(new yi(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oN="firebase-heartbeat-database",aN=1,ql="firebase-heartbeat-store";let up=null;function X1(){return up||(up=S2(oN,aN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ql)}catch(t){console.warn(t)}}}}).catch(n=>{throw ms.create("idb-open",{originalErrorMessage:n.message})})),up}async function lN(n){try{const t=(await X1()).transaction(ql),r=await t.objectStore(ql).get(Y1(n));return await t.done,r}catch(e){if(e instanceof Dr)kr.warn(e.message);else{const t=ms.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});kr.warn(t.message)}}}async function Xw(n,e){try{const r=(await X1()).transaction(ql,"readwrite");await r.objectStore(ql).put(e,Y1(n)),await r.done}catch(t){if(t instanceof Dr)kr.warn(t.message);else{const r=ms.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});kr.warn(r.message)}}}function Y1(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uN=1024,cN=30;class hN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new fN(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Yw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>cN){const o=pN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){kr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Yw(),{heartbeatsToSend:r,unsentEntries:s}=dN(this._heartbeatsCache.heartbeats),i=zh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return kr.warn(t),""}}}function Yw(){return new Date().toISOString().substring(0,10)}function dN(n,e=uN){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Zw(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Zw(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class fN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return K1()?e2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await lN(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Xw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Xw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Zw(n){return zh(JSON.stringify({version:2,heartbeats:n})).length}function pN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mN(n){Do(new yi("platform-logger",e=>new b2(e),"PRIVATE")),Do(new yi("heartbeat",e=>new hN(e),"PRIVATE")),gs(km,Qw,n),gs(km,Qw,"esm2020"),gs("fire-js","")}mN("");var gN="firebase",_N="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gs(gN,_N,"app");function Z1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yN=Z1,eA=new du("auth","Firebase",Z1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wh=new T_("@firebase/auth");function vN(n,...e){Wh.logLevel<=ve.WARN&&Wh.warn(`Auth (${na}): ${n}`,...e)}function Gc(n,...e){Wh.logLevel<=ve.ERROR&&Wh.error(`Auth (${na}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(n,...e){throw b_(n,...e)}function $n(n,...e){return b_(n,...e)}function x_(n,e,t){const r={...yN(),[e]:t};return new du("auth","Firebase",r).create(e,{appName:n.name})}function oi(n){return x_(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wN(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&lr(n,"argument-error"),x_(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function b_(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return eA.create(n,...e)}function ue(n,e,...t){if(!n)throw b_(e,...t)}function vr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Gc(e),new Error(e)}function Cr(n,e){n||vr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function IN(){return e0()==="http:"||e0()==="https:"}function e0(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(IN()||XP()||"connection"in navigator)?navigator.onLine:!0}function TN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Cr(t>e,"Short delay should be less than long delay!"),this.isMobile=QP()||YP()}get(){return EN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(n,e){Cr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],xN=new pu(3e4,6e4);function C_(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ra(n,e,t,r,s={}){return nA(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=fu({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:u,...i};return JP()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&ta(n.emulatorConfig.host)&&(c.credentials="include"),tA.fetch()(await rA(n,n.config.apiHost,t,a),c)})}async function nA(n,e,t){n._canInitEmulator=!1;const r={...SN,...e};try{const s=new kN(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw yc(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[u,c]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw yc(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw yc(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw yc(n,"user-disabled",o);const d=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw x_(n,d,c);lr(n,d)}}catch(s){if(s instanceof Dr)throw s;lr(n,"network-request-failed",{message:String(s)})}}async function bN(n,e,t,r,s={}){const i=await ra(n,e,t,r,s);return"mfaPendingCredential"in i&&lr(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function rA(n,e,t,r){const s=`${e}${t}?${r}`,i=n,o=i.config.emulator?k_(n.config,s):`${n.config.apiScheme}://${s}`;return AN.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class kN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r($n(this.auth,"network-request-failed")),xN.get())})}}function yc(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=$n(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CN(n,e){return ra(n,"POST","/v1/accounts:delete",e)}async function Kh(n,e){return ra(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function RN(n,e=!1){const t=cn(n),r=await t.getIdToken(e),s=R_(r);ue(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:gl(cp(s.auth_time)),issuedAtTime:gl(cp(s.iat)),expirationTime:gl(cp(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function cp(n){return Number(n)*1e3}function R_(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Gc("JWT malformed, contained fewer than 3 sections"),null;try{const s=M1(t);return s?JSON.parse(s):(Gc("Failed to decode base64 JWT payload"),null)}catch(s){return Gc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function t0(n){const e=R_(n);return ue(e,"internal-error"),ue(typeof e.exp<"u","internal-error"),ue(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wl(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Dr&&PN(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function PN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=gl(this.lastLoginAt),this.creationTime=gl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gh(n){var f;const e=n.auth,t=await n.getIdToken(),r=await Wl(n,Kh(e,{idToken:t}));ue(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?sA(s.providerUserInfo):[],o=ON(n.providerData,i),a=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!(o!=null&&o.length),c=a?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Nm(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(n,d)}async function DN(n){const e=cn(n);await Gh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ON(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function sA(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VN(n,e){const t=await nA(n,{},async()=>{const r=fu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=await rA(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:a,body:r};return n.emulatorConfig&&ta(n.emulatorConfig.host)&&(u.credentials="include"),tA.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function MN(n,e){return ra(n,"POST","/v2/accounts:revokeToken",C_(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ue(e.idToken,"internal-error"),ue(typeof e.idToken<"u","internal-error"),ue(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):t0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ue(e.length!==0,"internal-error");const t=t0(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ue(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await VN(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Eo;return r&&(ue(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ue(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ue(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Eo,this.toJSON())}_performRefresh(){return vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(n,e){ue(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class jn{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new NN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Nm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Wl(this,this.stsTokenManager.getToken(this.auth,e));return ue(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return RN(this,e)}reload(){return DN(this)}_assign(e){this!==e&&(ue(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new jn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ue(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Gh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ln(this.auth.app))return Promise.reject(oi(this.auth));const e=await this.getIdToken();return await Wl(this,CN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,u=t._redirectEventId??void 0,c=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:_,providerData:E,stsTokenManager:k}=t;ue(f&&k,e,"internal-error");const N=Eo.fromJSON(this.name,k);ue(typeof f=="string",e,"internal-error"),Wr(r,e.name),Wr(s,e.name),ue(typeof m=="boolean",e,"internal-error"),ue(typeof _=="boolean",e,"internal-error"),Wr(i,e.name),Wr(o,e.name),Wr(a,e.name),Wr(u,e.name),Wr(c,e.name),Wr(d,e.name);const x=new jn({uid:f,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:_,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:N,createdAt:c,lastLoginAt:d});return E&&Array.isArray(E)&&(x.providerData=E.map(y=>({...y}))),u&&(x._redirectEventId=u),x}static async _fromIdTokenResponse(e,t,r=!1){const s=new Eo;s.updateFromServerResponse(t);const i=new jn({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Gh(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ue(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?sA(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Eo;a.updateFromIdToken(r);const u=new jn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Nm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0=new Map;function wr(n){Cr(n instanceof Function,"Expected a class definition");let e=n0.get(n);return e?(Cr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,n0.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}iA.type="NONE";const r0=iA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(n,e,t){return`firebase:${n}:${e}:${t}`}class To{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Hc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Hc("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Kh(this.auth,{idToken:e}).catch(()=>{});return t?jn._fromGetAccountInfoResponse(this.auth,t,e):null}return jn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new To(wr(r0),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||wr(r0);const o=Hc(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const d=await c._get(o);if(d){let f;if(typeof d=="string"){const m=await Kh(e,{idToken:d}).catch(()=>{});if(!m)break;f=await jn._fromGetAccountInfoResponse(e,m,d)}else f=jn._fromJSON(e,d);c!==i&&(a=f),i=c;break}}catch{}const u=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new To(i,e,r):(i=u[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new To(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s0(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(uA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(oA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hA(e))return"Blackberry";if(dA(e))return"Webos";if(aA(e))return"Safari";if((e.includes("chrome/")||lA(e))&&!e.includes("edge/"))return"Chrome";if(cA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function oA(n=ct()){return/firefox\//i.test(n)}function aA(n=ct()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function lA(n=ct()){return/crios\//i.test(n)}function uA(n=ct()){return/iemobile/i.test(n)}function cA(n=ct()){return/android/i.test(n)}function hA(n=ct()){return/blackberry/i.test(n)}function dA(n=ct()){return/webos/i.test(n)}function P_(n=ct()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function LN(n=ct()){var e;return P_(n)&&!!((e=window.navigator)!=null&&e.standalone)}function jN(){return ZP()&&document.documentMode===10}function fA(n=ct()){return P_(n)||cA(n)||dA(n)||hA(n)||/windows phone/i.test(n)||uA(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pA(n,e=[]){let t;switch(n){case"Browser":t=s0(ct());break;case"Worker":t=`${s0(ct())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${na}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const u=e(i);o(u)}catch(u){a(u)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UN(n,e={}){return ra(n,"GET","/v2/passwordPolicy",C_(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N=6;class BN{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??$N,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new i0(this),this.idTokenSubscription=new i0(this),this.beforeStateQueue=new FN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=eA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=wr(t)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await To.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Kh(this,{idToken:e}),r=await jn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Ln(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===a)&&(u!=null&&u.user)&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ue(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Gh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=TN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ln(this.app))return Promise.reject(oi(this));const t=e?cn(e):null;return t&&ue(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ue(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ln(this.app)?Promise.reject(oi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ln(this.app)?Promise.reject(oi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await UN(this),t=new BN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new du("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await MN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&wr(e)||this._popupRedirectResolver;ue(t,this,"argument-error"),this.redirectPersistenceManager=await To.create(this,[wr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ue(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ue(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(Ln(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&vN(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function $d(n){return cn(n)}class i0{constructor(e){this.auth=e,this.observer=null,this.addObserver=i2(t=>this.observer=t)}get next(){return ue(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let N_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qN(n){N_=n}function WN(n){return N_.loadJS(n)}function KN(){return N_.gapiScript}function GN(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HN(n,e){const t=A_(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(_i(i,e??{}))return s;lr(s,"already-initialized")}return t.initialize({options:e})}function QN(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(wr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function JN(n,e,t){const r=$d(n);ue(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=mA(e),{host:o,port:a}=XN(e),u=a===null?"":`:${a}`,c={url:`${i}//${o}${u}/`},d=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ue(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ue(_i(c,r.config.emulator)&&_i(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,ta(o)?($1(`${i}//${o}${u}`),B1("Auth",!0)):YN()}function mA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function XN(n){const e=mA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:o0(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:o0(o)}}}function o0(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function YN(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return vr("not implemented")}_getIdTokenResponse(e){return vr("not implemented")}_linkToIdToken(e,t){return vr("not implemented")}_getReauthenticationResolver(e){return vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function So(n,e){return bN(n,"POST","/v1/accounts:signInWithIdp",C_(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN="http://localhost";class vi extends gA{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new vi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):lr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const o=new vi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return So(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,So(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,So(e,t)}buildRequest(){const e={requestUri:ZN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=fu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu extends D_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends mu{constructor(){super("facebook.com")}static credential(e){return vi._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zr.credential(e.oauthAccessToken)}catch{return null}}}Zr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr extends mu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return vi._fromParams({providerId:gr.PROVIDER_ID,signInMethod:gr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return gr.credentialFromTaggedObject(e)}static credentialFromError(e){return gr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return gr.credential(t,r)}catch{return null}}}gr.GOOGLE_SIGN_IN_METHOD="google.com";gr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends mu{constructor(){super("github.com")}static credential(e){return vi._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return es.credential(e.oauthAccessToken)}catch{return null}}}es.GITHUB_SIGN_IN_METHOD="github.com";es.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends mu{constructor(){super("twitter.com")}static credential(e,t){return vi._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ts.credential(t,r)}catch{return null}}}ts.TWITTER_SIGN_IN_METHOD="twitter.com";ts.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await jn._fromIdTokenResponse(e,r,s),o=a0(r);return new Oo({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=a0(r);return new Oo({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function a0(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh extends Dr{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Hh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Hh(e,t,r,s)}}function _A(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Hh._fromErrorAndOperation(n,i,e,r):i})}async function eD(n,e,t=!1){const r=await Wl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Oo._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tD(n,e,t=!1){const{auth:r}=n;if(Ln(r.app))return Promise.reject(oi(r));const s="reauthenticate";try{const i=await Wl(n,_A(r,s,e,n),t);ue(i.idToken,r,"internal-error");const o=R_(i.idToken);ue(o,r,"internal-error");const{sub:a}=o;return ue(n.uid===a,r,"user-mismatch"),Oo._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&lr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nD(n,e,t=!1){if(Ln(n.app))return Promise.reject(oi(n));const r="signIn",s=await _A(n,r,e),i=await Oo._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rD(n,e){return cn(n).setPersistence(e)}function sD(n,e,t,r){return cn(n).onIdTokenChanged(e,t,r)}function iD(n,e,t){return cn(n).beforeAuthStateChanged(e,t)}function oD(n,e,t,r){return cn(n).onAuthStateChanged(e,t,r)}function aD(n){return cn(n).signOut()}const Qh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Qh,"1"),this.storage.removeItem(Qh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lD=1e3,uD=10;class vA extends yA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=fA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);jN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,uD):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},lD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}vA.type="LOCAL";const wA=vA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA extends yA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}IA.type="SESSION";const EA=IA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Bd(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),u=await cD(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Bd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O_(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,u)=>{const c=O_("",20);s.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(d),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(){return window}function dD(n){ir().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(){return typeof ir().WorkerGlobalScope<"u"&&typeof ir().importScripts=="function"}async function fD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function pD(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function mD(){return TA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA="firebaseLocalStorageDb",gD=1,Jh="firebaseLocalStorage",AA="fbase_key";class gu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function zd(n,e){return n.transaction([Jh],e?"readwrite":"readonly").objectStore(Jh)}function _D(){const n=indexedDB.deleteDatabase(SA);return new gu(n).toPromise()}function Dm(){const n=indexedDB.open(SA,gD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Jh,{keyPath:AA})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Jh)?e(r):(r.close(),await _D(),e(await Dm()))})})}async function l0(n,e,t){const r=zd(n,!0).put({[AA]:e,value:t});return new gu(r).toPromise()}async function yD(n,e){const t=zd(n,!1).get(e),r=await new gu(t).toPromise();return r===void 0?null:r.value}function u0(n,e){const t=zd(n,!0).delete(e);return new gu(t).toPromise()}const vD=800,wD=3;class xA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Dm(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>wD)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return TA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Bd._getInstance(mD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await fD(),!this.activeServiceWorker)return;this.sender=new hD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||pD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Dm();return await l0(e,Qh,"1"),await u0(e,Qh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>l0(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>yD(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>u0(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=zd(s,!1).getAll();return new gu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),vD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}xA.type="LOCAL";const ID=xA;new pu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(n,e){return e?wr(e):(ue(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_ extends gA{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return So(e,this._buildIdpRequest())}_linkToIdToken(e,t){return So(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return So(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ED(n){return nD(n.auth,new V_(n),n.bypassAuthState)}function TD(n){const{auth:e,user:t}=n;return ue(t,e,"internal-error"),tD(t,new V_(n),n.bypassAuthState)}async function SD(n){const{auth:e,user:t}=n;return ue(t,e,"internal-error"),eD(t,new V_(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ED;case"linkViaPopup":case"linkViaRedirect":return SD;case"reauthViaPopup":case"reauthViaRedirect":return TD;default:lr(this.auth,"internal-error")}}resolve(e){Cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=new pu(2e3,1e4);async function xD(n,e,t){if(Ln(n.app))return Promise.reject($n(n,"operation-not-supported-in-this-environment"));const r=$d(n);wN(n,e,D_);const s=bA(r,t);return new ni(r,"signInViaPopup",e,s).executeNotNull()}class ni extends kA{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ni.currentPopupAction&&ni.currentPopupAction.cancel(),ni.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ue(e,this.auth,"internal-error"),e}async onExecution(){Cr(this.filter.length===1,"Popup operations only handle one event");const e=O_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject($n(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject($n(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ni.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($n(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,AD.get())};e()}}ni.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD="pendingRedirect",Qc=new Map;class kD extends kA{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Qc.get(this.auth._key());if(!e){try{const r=await CD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Qc.set(this.auth._key(),e)}return this.bypassAuthState||Qc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CD(n,e){const t=ND(e),r=PD(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function RD(n,e){Qc.set(n._key(),e)}function PD(n){return wr(n._redirectPersistence)}function ND(n){return Hc(bD,n.config.apiKey,n.name)}async function DD(n,e,t=!1){if(Ln(n.app))return Promise.reject(oi(n));const r=$d(n),s=bA(r,e),o=await new kD(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD=10*60*1e3;class VD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!MD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!CA(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError($n(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=OD&&this.cachedEventUids.clear(),this.cachedEventUids.has(c0(e))}saveEventToCache(e){this.cachedEventUids.add(c0(e)),this.lastProcessedEventTime=Date.now()}}function c0(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function CA({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function MD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return CA(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LD(n,e={}){return ra(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,FD=/^https?/;async function UD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await LD(n);for(const t of e)try{if($D(t))return}catch{}lr(n,"unauthorized-domain")}function $D(n){const e=Pm(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!FD.test(t))return!1;if(jD.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=new pu(3e4,6e4);function h0(){const n=ir().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function zD(n){return new Promise((e,t)=>{var s,i,o;function r(){h0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{h0(),t($n(n,"network-request-failed"))},timeout:BD.get()})}if((i=(s=ir().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=ir().gapi)!=null&&o.load)r();else{const a=GN("iframefcb");return ir()[a]=()=>{gapi.load?r():t($n(n,"network-request-failed"))},WN(`${KN()}?onload=${a}`).catch(u=>t(u))}}).catch(e=>{throw Jc=null,e})}let Jc=null;function qD(n){return Jc=Jc||zD(n),Jc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD=new pu(5e3,15e3),KD="__/auth/iframe",GD="emulator/auth/iframe",HD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},QD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function JD(n){const e=n.config;ue(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?k_(e,GD):`https://${n.config.authDomain}/${KD}`,r={apiKey:e.apiKey,appName:n.name,v:na},s=QD.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${fu(r).slice(1)}`}async function XD(n){const e=await qD(n),t=ir().gapi;return ue(t,n,"internal-error"),e.open({where:document.body,url:JD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:HD,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=$n(n,"network-request-failed"),a=ir().setTimeout(()=>{i(o)},WD.get());function u(){ir().clearTimeout(a),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ZD=500,eO=600,tO="_blank",nO="http://localhost";class d0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rO(n,e,t,r=ZD,s=eO){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u={...YD,width:r.toString(),height:s.toString(),top:i,left:o},c=ct().toLowerCase();t&&(a=lA(c)?tO:t),oA(c)&&(e=e||nO,u.scrollbars="yes");const d=Object.entries(u).reduce((m,[_,E])=>`${m}${_}=${E},`,"");if(LN(c)&&a!=="_self")return sO(e||"",a),new d0(null);const f=window.open(e||"",a,d);ue(f,n,"popup-blocked");try{f.focus()}catch{}return new d0(f)}function sO(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO="__/auth/handler",oO="emulator/auth/handler",aO=encodeURIComponent("fac");async function f0(n,e,t,r,s,i){ue(n.config.authDomain,n,"auth-domain-config-required"),ue(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:na,eventId:s};if(e instanceof D_){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",s2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof mu){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const u=await n._getAppCheckToken(),c=u?`#${aO}=${encodeURIComponent(u)}`:"";return`${lO(n)}?${fu(a).slice(1)}${c}`}function lO({config:n}){return n.emulator?k_(n,oO):`https://${n.authDomain}/${iO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hp="webStorageSupport";class uO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=EA,this._completeRedirectFn=DD,this._overrideRedirectResult=RD}async _openPopup(e,t,r,s){var o;Cr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await f0(e,t,r,Pm(),s);return rO(e,i,O_())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await f0(e,t,r,Pm(),s);return dD(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Cr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await XD(e),r=new VD(e);return t.register("authEvent",s=>(ue(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(hp,{type:hp},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[hp];i!==void 0&&t(!!i),lr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=UD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return fA()||aA()||P_()}}const cO=uO;var p0="@firebase/auth",m0="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ue(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dO(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function fO(n){Do(new yi("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ue(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pA(n)},c=new zN(r,s,i,u);return QN(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Do(new yi("auth-internal",e=>{const t=$d(e.getProvider("auth").getImmediate());return(r=>new hO(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),gs(p0,m0,dO(n)),gs(p0,m0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO=5*60,mO=U1("authIdTokenMaxAge")||pO;let g0=null;const gO=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>mO)return;const s=t==null?void 0:t.token;g0!==s&&(g0=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function _O(n=J1()){const e=A_(n,"auth");if(e.isInitialized())return e.getImmediate();const t=HN(n,{popupRedirectResolver:cO,persistence:[ID,wA,EA]}),r=U1("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=gO(i.toString());iD(t,o,()=>o(t.currentUser)),sD(t,a=>o(a))}}const s=j1("auth");return s&&JN(t,`http://${s}`),t}function yO(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}qN({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=$n("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",yO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});fO("Browser");var _0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _s,RA;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,v){function T(){}T.prototype=v.prototype,w.F=v.prototype,w.prototype=new T,w.prototype.constructor=w,w.D=function(A,b,P){for(var C=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)C[Ne-2]=arguments[Ne];return v.prototype[b].apply(A,C)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,v,T){T||(T=0);const A=Array(16);if(typeof v=="string")for(var b=0;b<16;++b)A[b]=v.charCodeAt(T++)|v.charCodeAt(T++)<<8|v.charCodeAt(T++)<<16|v.charCodeAt(T++)<<24;else for(b=0;b<16;++b)A[b]=v[T++]|v[T++]<<8|v[T++]<<16|v[T++]<<24;v=w.g[0],T=w.g[1],b=w.g[2];let P=w.g[3],C;C=v+(P^T&(b^P))+A[0]+3614090360&4294967295,v=T+(C<<7&4294967295|C>>>25),C=P+(b^v&(T^b))+A[1]+3905402710&4294967295,P=v+(C<<12&4294967295|C>>>20),C=b+(T^P&(v^T))+A[2]+606105819&4294967295,b=P+(C<<17&4294967295|C>>>15),C=T+(v^b&(P^v))+A[3]+3250441966&4294967295,T=b+(C<<22&4294967295|C>>>10),C=v+(P^T&(b^P))+A[4]+4118548399&4294967295,v=T+(C<<7&4294967295|C>>>25),C=P+(b^v&(T^b))+A[5]+1200080426&4294967295,P=v+(C<<12&4294967295|C>>>20),C=b+(T^P&(v^T))+A[6]+2821735955&4294967295,b=P+(C<<17&4294967295|C>>>15),C=T+(v^b&(P^v))+A[7]+4249261313&4294967295,T=b+(C<<22&4294967295|C>>>10),C=v+(P^T&(b^P))+A[8]+1770035416&4294967295,v=T+(C<<7&4294967295|C>>>25),C=P+(b^v&(T^b))+A[9]+2336552879&4294967295,P=v+(C<<12&4294967295|C>>>20),C=b+(T^P&(v^T))+A[10]+4294925233&4294967295,b=P+(C<<17&4294967295|C>>>15),C=T+(v^b&(P^v))+A[11]+2304563134&4294967295,T=b+(C<<22&4294967295|C>>>10),C=v+(P^T&(b^P))+A[12]+1804603682&4294967295,v=T+(C<<7&4294967295|C>>>25),C=P+(b^v&(T^b))+A[13]+4254626195&4294967295,P=v+(C<<12&4294967295|C>>>20),C=b+(T^P&(v^T))+A[14]+2792965006&4294967295,b=P+(C<<17&4294967295|C>>>15),C=T+(v^b&(P^v))+A[15]+1236535329&4294967295,T=b+(C<<22&4294967295|C>>>10),C=v+(b^P&(T^b))+A[1]+4129170786&4294967295,v=T+(C<<5&4294967295|C>>>27),C=P+(T^b&(v^T))+A[6]+3225465664&4294967295,P=v+(C<<9&4294967295|C>>>23),C=b+(v^T&(P^v))+A[11]+643717713&4294967295,b=P+(C<<14&4294967295|C>>>18),C=T+(P^v&(b^P))+A[0]+3921069994&4294967295,T=b+(C<<20&4294967295|C>>>12),C=v+(b^P&(T^b))+A[5]+3593408605&4294967295,v=T+(C<<5&4294967295|C>>>27),C=P+(T^b&(v^T))+A[10]+38016083&4294967295,P=v+(C<<9&4294967295|C>>>23),C=b+(v^T&(P^v))+A[15]+3634488961&4294967295,b=P+(C<<14&4294967295|C>>>18),C=T+(P^v&(b^P))+A[4]+3889429448&4294967295,T=b+(C<<20&4294967295|C>>>12),C=v+(b^P&(T^b))+A[9]+568446438&4294967295,v=T+(C<<5&4294967295|C>>>27),C=P+(T^b&(v^T))+A[14]+3275163606&4294967295,P=v+(C<<9&4294967295|C>>>23),C=b+(v^T&(P^v))+A[3]+4107603335&4294967295,b=P+(C<<14&4294967295|C>>>18),C=T+(P^v&(b^P))+A[8]+1163531501&4294967295,T=b+(C<<20&4294967295|C>>>12),C=v+(b^P&(T^b))+A[13]+2850285829&4294967295,v=T+(C<<5&4294967295|C>>>27),C=P+(T^b&(v^T))+A[2]+4243563512&4294967295,P=v+(C<<9&4294967295|C>>>23),C=b+(v^T&(P^v))+A[7]+1735328473&4294967295,b=P+(C<<14&4294967295|C>>>18),C=T+(P^v&(b^P))+A[12]+2368359562&4294967295,T=b+(C<<20&4294967295|C>>>12),C=v+(T^b^P)+A[5]+4294588738&4294967295,v=T+(C<<4&4294967295|C>>>28),C=P+(v^T^b)+A[8]+2272392833&4294967295,P=v+(C<<11&4294967295|C>>>21),C=b+(P^v^T)+A[11]+1839030562&4294967295,b=P+(C<<16&4294967295|C>>>16),C=T+(b^P^v)+A[14]+4259657740&4294967295,T=b+(C<<23&4294967295|C>>>9),C=v+(T^b^P)+A[1]+2763975236&4294967295,v=T+(C<<4&4294967295|C>>>28),C=P+(v^T^b)+A[4]+1272893353&4294967295,P=v+(C<<11&4294967295|C>>>21),C=b+(P^v^T)+A[7]+4139469664&4294967295,b=P+(C<<16&4294967295|C>>>16),C=T+(b^P^v)+A[10]+3200236656&4294967295,T=b+(C<<23&4294967295|C>>>9),C=v+(T^b^P)+A[13]+681279174&4294967295,v=T+(C<<4&4294967295|C>>>28),C=P+(v^T^b)+A[0]+3936430074&4294967295,P=v+(C<<11&4294967295|C>>>21),C=b+(P^v^T)+A[3]+3572445317&4294967295,b=P+(C<<16&4294967295|C>>>16),C=T+(b^P^v)+A[6]+76029189&4294967295,T=b+(C<<23&4294967295|C>>>9),C=v+(T^b^P)+A[9]+3654602809&4294967295,v=T+(C<<4&4294967295|C>>>28),C=P+(v^T^b)+A[12]+3873151461&4294967295,P=v+(C<<11&4294967295|C>>>21),C=b+(P^v^T)+A[15]+530742520&4294967295,b=P+(C<<16&4294967295|C>>>16),C=T+(b^P^v)+A[2]+3299628645&4294967295,T=b+(C<<23&4294967295|C>>>9),C=v+(b^(T|~P))+A[0]+4096336452&4294967295,v=T+(C<<6&4294967295|C>>>26),C=P+(T^(v|~b))+A[7]+1126891415&4294967295,P=v+(C<<10&4294967295|C>>>22),C=b+(v^(P|~T))+A[14]+2878612391&4294967295,b=P+(C<<15&4294967295|C>>>17),C=T+(P^(b|~v))+A[5]+4237533241&4294967295,T=b+(C<<21&4294967295|C>>>11),C=v+(b^(T|~P))+A[12]+1700485571&4294967295,v=T+(C<<6&4294967295|C>>>26),C=P+(T^(v|~b))+A[3]+2399980690&4294967295,P=v+(C<<10&4294967295|C>>>22),C=b+(v^(P|~T))+A[10]+4293915773&4294967295,b=P+(C<<15&4294967295|C>>>17),C=T+(P^(b|~v))+A[1]+2240044497&4294967295,T=b+(C<<21&4294967295|C>>>11),C=v+(b^(T|~P))+A[8]+1873313359&4294967295,v=T+(C<<6&4294967295|C>>>26),C=P+(T^(v|~b))+A[15]+4264355552&4294967295,P=v+(C<<10&4294967295|C>>>22),C=b+(v^(P|~T))+A[6]+2734768916&4294967295,b=P+(C<<15&4294967295|C>>>17),C=T+(P^(b|~v))+A[13]+1309151649&4294967295,T=b+(C<<21&4294967295|C>>>11),C=v+(b^(T|~P))+A[4]+4149444226&4294967295,v=T+(C<<6&4294967295|C>>>26),C=P+(T^(v|~b))+A[11]+3174756917&4294967295,P=v+(C<<10&4294967295|C>>>22),C=b+(v^(P|~T))+A[2]+718787259&4294967295,b=P+(C<<15&4294967295|C>>>17),C=T+(P^(b|~v))+A[9]+3951481745&4294967295,w.g[0]=w.g[0]+v&4294967295,w.g[1]=w.g[1]+(b+(C<<21&4294967295|C>>>11))&4294967295,w.g[2]=w.g[2]+b&4294967295,w.g[3]=w.g[3]+P&4294967295}r.prototype.v=function(w,v){v===void 0&&(v=w.length);const T=v-this.blockSize,A=this.C;let b=this.h,P=0;for(;P<v;){if(b==0)for(;P<=T;)s(this,w,P),P+=this.blockSize;if(typeof w=="string"){for(;P<v;)if(A[b++]=w.charCodeAt(P++),b==this.blockSize){s(this,A),b=0;break}}else for(;P<v;)if(A[b++]=w[P++],b==this.blockSize){s(this,A),b=0;break}}this.h=b,this.o+=v},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var v=1;v<w.length-8;++v)w[v]=0;v=this.o*8;for(var T=w.length-8;T<w.length;++T)w[T]=v&255,v/=256;for(this.v(w),w=Array(16),v=0,T=0;T<4;++T)for(let A=0;A<32;A+=8)w[v++]=this.g[T]>>>A&255;return w};function i(w,v){var T=a;return Object.prototype.hasOwnProperty.call(T,w)?T[w]:T[w]=v(w)}function o(w,v){this.h=v;const T=[];let A=!0;for(let b=w.length-1;b>=0;b--){const P=w[b]|0;A&&P==v||(T[b]=P,A=!1)}this.g=T}var a={};function u(w){return-128<=w&&w<128?i(w,function(v){return new o([v|0],v<0?-1:0)}):new o([w|0],w<0?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return f;if(w<0)return N(c(-w));const v=[];let T=1;for(let A=0;w>=T;A++)v[A]=w/T|0,T*=4294967296;return new o(v,0)}function d(w,v){if(w.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(w.charAt(0)=="-")return N(d(w.substring(1),v));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');const T=c(Math.pow(v,8));let A=f;for(let P=0;P<w.length;P+=8){var b=Math.min(8,w.length-P);const C=parseInt(w.substring(P,P+b),v);b<8?(b=c(Math.pow(v,b)),A=A.j(b).add(c(C))):(A=A.j(T),A=A.add(c(C)))}return A}var f=u(0),m=u(1),_=u(16777216);n=o.prototype,n.m=function(){if(k(this))return-N(this).m();let w=0,v=1;for(let T=0;T<this.g.length;T++){const A=this.i(T);w+=(A>=0?A:4294967296+A)*v,v*=4294967296}return w},n.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(E(this))return"0";if(k(this))return"-"+N(this).toString(w);const v=c(Math.pow(w,6));var T=this;let A="";for(;;){const b=R(T,v).g;T=x(T,b.j(v));let P=((T.g.length>0?T.g[0]:T.h)>>>0).toString(w);if(T=b,E(T))return P+A;for(;P.length<6;)P="0"+P;A=P+A}},n.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function E(w){if(w.h!=0)return!1;for(let v=0;v<w.g.length;v++)if(w.g[v]!=0)return!1;return!0}function k(w){return w.h==-1}n.l=function(w){return w=x(this,w),k(w)?-1:E(w)?0:1};function N(w){const v=w.g.length,T=[];for(let A=0;A<v;A++)T[A]=~w.g[A];return new o(T,~w.h).add(m)}n.abs=function(){return k(this)?N(this):this},n.add=function(w){const v=Math.max(this.g.length,w.g.length),T=[];let A=0;for(let b=0;b<=v;b++){let P=A+(this.i(b)&65535)+(w.i(b)&65535),C=(P>>>16)+(this.i(b)>>>16)+(w.i(b)>>>16);A=C>>>16,P&=65535,C&=65535,T[b]=C<<16|P}return new o(T,T[T.length-1]&-2147483648?-1:0)};function x(w,v){return w.add(N(v))}n.j=function(w){if(E(this)||E(w))return f;if(k(this))return k(w)?N(this).j(N(w)):N(N(this).j(w));if(k(w))return N(this.j(N(w)));if(this.l(_)<0&&w.l(_)<0)return c(this.m()*w.m());const v=this.g.length+w.g.length,T=[];for(var A=0;A<2*v;A++)T[A]=0;for(A=0;A<this.g.length;A++)for(let b=0;b<w.g.length;b++){const P=this.i(A)>>>16,C=this.i(A)&65535,Ne=w.i(b)>>>16,je=w.i(b)&65535;T[2*A+2*b]+=C*je,y(T,2*A+2*b),T[2*A+2*b+1]+=P*je,y(T,2*A+2*b+1),T[2*A+2*b+1]+=C*Ne,y(T,2*A+2*b+1),T[2*A+2*b+2]+=P*Ne,y(T,2*A+2*b+2)}for(w=0;w<v;w++)T[w]=T[2*w+1]<<16|T[2*w];for(w=v;w<2*v;w++)T[w]=0;return new o(T,0)};function y(w,v){for(;(w[v]&65535)!=w[v];)w[v+1]+=w[v]>>>16,w[v]&=65535,v++}function S(w,v){this.g=w,this.h=v}function R(w,v){if(E(v))throw Error("division by zero");if(E(w))return new S(f,f);if(k(w))return v=R(N(w),v),new S(N(v.g),N(v.h));if(k(v))return v=R(w,N(v)),new S(N(v.g),v.h);if(w.g.length>30){if(k(w)||k(v))throw Error("slowDivide_ only works with positive integers.");for(var T=m,A=v;A.l(w)<=0;)T=j(T),A=j(A);var b=M(T,1),P=M(A,1);for(A=M(A,2),T=M(T,2);!E(A);){var C=P.add(A);C.l(w)<=0&&(b=b.add(T),P=C),A=M(A,1),T=M(T,1)}return v=x(w,b.j(v)),new S(b,v)}for(b=f;w.l(v)>=0;){for(T=Math.max(1,Math.floor(w.m()/v.m())),A=Math.ceil(Math.log(T)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),P=c(T),C=P.j(v);k(C)||C.l(w)>0;)T-=A,P=c(T),C=P.j(v);E(P)&&(P=m),b=b.add(P),w=x(w,C)}return new S(b,w)}n.B=function(w){return R(this,w).h},n.and=function(w){const v=Math.max(this.g.length,w.g.length),T=[];for(let A=0;A<v;A++)T[A]=this.i(A)&w.i(A);return new o(T,this.h&w.h)},n.or=function(w){const v=Math.max(this.g.length,w.g.length),T=[];for(let A=0;A<v;A++)T[A]=this.i(A)|w.i(A);return new o(T,this.h|w.h)},n.xor=function(w){const v=Math.max(this.g.length,w.g.length),T=[];for(let A=0;A<v;A++)T[A]=this.i(A)^w.i(A);return new o(T,this.h^w.h)};function j(w){const v=w.g.length+1,T=[];for(let A=0;A<v;A++)T[A]=w.i(A)<<1|w.i(A-1)>>>31;return new o(T,w.h)}function M(w,v){const T=v>>5;v%=32;const A=w.g.length-T,b=[];for(let P=0;P<A;P++)b[P]=v>0?w.i(P+T)>>>v|w.i(P+T+1)<<32-v:w.i(P+T);return new o(b,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,RA=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,_s=o}).apply(typeof _0<"u"?_0:typeof self<"u"?self:typeof window<"u"?window:{});var vc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var PA,Ya,NA,Xc,Om,DA,OA,VA;(function(){var n,e=Object.defineProperty;function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof vc=="object"&&vc];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function s(l,h){if(h)e:{var p=r;l=l.split(".");for(var I=0;I<l.length-1;I++){var O=l[I];if(!(O in p))break e;p=p[O]}l=l[l.length-1],I=p[l],h=h(I),h!=I&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(h){var p=[],I;for(I in h)Object.prototype.hasOwnProperty.call(h,I)&&p.push([I,h[I]]);return p}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function u(l,h,p){return l.call.apply(l.bind,arguments)}function c(l,h,p){return c=u,c.apply(null,arguments)}function d(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var I=p.slice();return I.push.apply(I,arguments),l.apply(this,I)}}function f(l,h){function p(){}p.prototype=h.prototype,l.Z=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Ob=function(I,O,L){for(var H=Array(arguments.length-2),me=2;me<arguments.length;me++)H[me-2]=arguments[me];return h.prototype[O].apply(I,H)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function _(l){const h=l.length;if(h>0){const p=Array(h);for(let I=0;I<h;I++)p[I]=l[I];return p}return[]}function E(l,h){for(let I=1;I<arguments.length;I++){const O=arguments[I];var p=typeof O;if(p=p!="object"?p:O?Array.isArray(O)?"array":p:"null",p=="array"||p=="object"&&typeof O.length=="number"){p=l.length||0;const L=O.length||0;l.length=p+L;for(let H=0;H<L;H++)l[p+H]=O[H]}else l.push(O)}}class k{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function N(l){o.setTimeout(()=>{throw l},0)}function x(){var l=w;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class y{constructor(){this.h=this.g=null}add(h,p){const I=S.get();I.set(h,p),this.h?this.h.next=I:this.g=I,this.h=I}}var S=new k(()=>new R,l=>l.reset());class R{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let j,M=!1,w=new y,v=()=>{const l=Promise.resolve(void 0);j=()=>{l.then(T)}};function T(){for(var l;l=x();){try{l.h.call(l.g)}catch(p){N(p)}var h=S;h.j(l),h.h<100&&(h.h++,l.next=h.g,h.g=l)}M=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function b(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}b.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};o.addEventListener("test",p,h),o.removeEventListener("test",p,h)}catch{}return l}();function C(l){return/^[\s\xa0]*$/.test(l)}function Ne(l,h){b.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,h)}f(Ne,b),Ne.prototype.init=function(l,h){const p=this.type=l.type,I=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget,h||(p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement)),this.relatedTarget=h,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&Ne.Z.h.call(this)},Ne.prototype.h=function(){Ne.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var je="closure_listenable_"+(Math.random()*1e6|0),kn=0;function Cn(l,h,p,I,O){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!I,this.ha=O,this.key=++kn,this.da=this.fa=!1}function K(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function oe(l,h,p){for(const I in l)h.call(p,l[I],I,l)}function ee(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function pe(l){const h={};for(const p in l)h[p]=l[p];return h}const Ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pn(l,h){let p,I;for(let O=1;O<arguments.length;O++){I=arguments[O];for(p in I)l[p]=I[p];for(let L=0;L<Ce.length;L++)p=Ce[L],Object.prototype.hasOwnProperty.call(I,p)&&(l[p]=I[p])}}function Ze(l){this.src=l,this.g={},this.h=0}Ze.prototype.add=function(l,h,p,I,O){const L=l.toString();l=this.g[L],l||(l=this.g[L]=[],this.h++);const H=dt(l,h,I,O);return H>-1?(h=l[H],p||(h.fa=!1)):(h=new Cn(h,this.src,L,!!I,O),h.fa=p,l.push(h)),h};function mn(l,h){const p=h.type;if(p in l.g){var I=l.g[p],O=Array.prototype.indexOf.call(I,h,void 0),L;(L=O>=0)&&Array.prototype.splice.call(I,O,1),L&&(K(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function dt(l,h,p,I){for(let O=0;O<l.length;++O){const L=l[O];if(!L.da&&L.listener==h&&L.capture==!!p&&L.ha==I)return O}return-1}var Ke="closure_lm_"+(Math.random()*1e6|0),Te={};function Lt(l,h,p,I,O){if(Array.isArray(h)){for(let L=0;L<h.length;L++)Lt(l,h[L],p,I,O);return null}return p=qn(p),l&&l[je]?l.J(h,p,a(I)?!!I.capture:!1,O):zn(l,h,p,!1,I,O)}function zn(l,h,p,I,O,L){if(!h)throw Error("Invalid event type");const H=a(O)?!!O.capture:!!O;let me=cr(l);if(me||(l[Ke]=me=new Ze(l)),p=me.add(h,p,I,H,L),p.proxy)return p;if(I=ku(),p.proxy=I,I.src=l,I.listener=p,l.addEventListener)P||(O=H),O===void 0&&(O=!1),l.addEventListener(h.toString(),I,O);else if(l.attachEvent)l.attachEvent(Cu(h.toString()),I);else if(l.addListener&&l.removeListener)l.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return p}function ku(){function l(p){return h.call(l.src,l.listener,p)}const h=Ru;return l}function aa(l,h,p,I,O){if(Array.isArray(h))for(var L=0;L<h.length;L++)aa(l,h[L],p,I,O);else I=a(I)?!!I.capture:!!I,p=qn(p),l&&l[je]?(l=l.i,L=String(h).toString(),L in l.g&&(h=l.g[L],p=dt(h,p,I,O),p>-1&&(K(h[p]),Array.prototype.splice.call(h,p,1),h.length==0&&(delete l.g[L],l.h--)))):l&&(l=cr(l))&&(h=l.g[h.toString()],l=-1,h&&(l=dt(h,p,I,O)),(p=l>-1?h[l]:null)&&Ni(p))}function Ni(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[je])mn(h.i,l);else{var p=l.type,I=l.proxy;h.removeEventListener?h.removeEventListener(p,I,l.capture):h.detachEvent?h.detachEvent(Cu(p),I):h.addListener&&h.removeListener&&h.removeListener(I),(p=cr(h))?(mn(p,l),p.h==0&&(p.src=null,h[Ke]=null)):K(l)}}}function Cu(l){return l in Te?Te[l]:Te[l]="on"+l}function Ru(l,h){if(l.da)l=!0;else{h=new Ne(h,this);const p=l.listener,I=l.ha||l.src;l.fa&&Ni(l),l=p.call(I,h)}return l}function cr(l){return l=l[Ke],l instanceof Ze?l:null}var la="__closure_events_fn_"+(Math.random()*1e9>>>0);function qn(l){return typeof l=="function"?l:(l[la]||(l[la]=function(h){return l.handleEvent(h)}),l[la])}function ft(){A.call(this),this.i=new Ze(this),this.M=this,this.G=null}f(ft,A),ft.prototype[je]=!0,ft.prototype.removeEventListener=function(l,h,p,I){aa(this,l,h,p,I)};function re(l,h){var p,I=l.G;if(I)for(p=[];I;I=I.G)p.push(I);if(l=l.M,I=h.type||h,typeof h=="string")h=new b(h,l);else if(h instanceof b)h.target=h.target||l;else{var O=h;h=new b(I,l),pn(h,O)}O=!0;let L,H;if(p)for(H=p.length-1;H>=0;H--)L=h.g=p[H],O=Vr(L,I,!0,h)&&O;if(L=h.g=l,O=Vr(L,I,!0,h)&&O,O=Vr(L,I,!1,h)&&O,p)for(H=0;H<p.length;H++)L=h.g=p[H],O=Vr(L,I,!1,h)&&O}ft.prototype.N=function(){if(ft.Z.N.call(this),this.i){var l=this.i;for(const h in l.g){const p=l.g[h];for(let I=0;I<p.length;I++)K(p[I]);delete l.g[h],l.h--}}this.G=null},ft.prototype.J=function(l,h,p,I){return this.i.add(String(l),h,!1,p,I)},ft.prototype.K=function(l,h,p,I){return this.i.add(String(l),h,!0,p,I)};function Vr(l,h,p,I){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();let O=!0;for(let L=0;L<h.length;++L){const H=h[L];if(H&&!H.da&&H.capture==p){const me=H.listener,it=H.ha||H.src;H.fa&&mn(l.i,H),O=me.call(it,I)!==!1&&O}}return O&&!I.defaultPrevented}function cf(l,h){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=c(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:o.setTimeout(l,h||0)}function Di(l){l.g=cf(()=>{l.g=null,l.i&&(l.i=!1,Di(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class hf extends A{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Di(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wn(l){A.call(this),this.h=l,this.g={}}f(Wn,A);var Ps=[];function ua(l){oe(l.g,function(h,p){this.g.hasOwnProperty(p)&&Ni(h)},l),l.g={}}Wn.prototype.N=function(){Wn.Z.N.call(this),ua(this)},Wn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Oi=o.JSON.stringify,df=o.JSON.parse,Pu=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function ca(){}function Nu(){}var Ns={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ha(){b.call(this,"d")}f(ha,b);function da(){b.call(this,"c")}f(da,b);var hr={},Du=null;function Vi(){return Du=Du||new ft}hr.Ia="serverreachability";function Ou(l){b.call(this,hr.Ia,l)}f(Ou,b);function Mr(l){const h=Vi();re(h,new Ou(h))}hr.STAT_EVENT="statevent";function Vu(l,h){b.call(this,hr.STAT_EVENT,l),this.stat=h}f(Vu,b);function wt(l){const h=Vi();re(h,new Vu(h,l))}hr.Ja="timingevent";function Mu(l,h){b.call(this,hr.Ja,l),this.size=h}f(Mu,b);function Ds(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},h)}function Os(){this.g=!0}Os.prototype.ua=function(){this.g=!1};function F(l,h,p,I,O,L){l.info(function(){if(l.g)if(L){var H="",me=L.split("&");for(let Pe=0;Pe<me.length;Pe++){var it=me[Pe].split("=");if(it.length>1){const pt=it[0];it=it[1];const Gn=pt.split("_");H=Gn.length>=2&&Gn[1]=="type"?H+(pt+"="+it+"&"):H+(pt+"=redacted&")}}}else H=null;else H=L;return"XMLHTTP REQ ("+I+") [attempt "+O+"]: "+h+`
`+p+`
`+H})}function q(l,h,p,I,O,L,H){l.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+O+"]: "+h+`
`+p+`
`+L+" "+H})}function G(l,h,p,I){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+Xe(l,p)+(I?" "+I:"")})}function ae(l,h){l.info(function(){return"TIMEOUT: "+h})}Os.prototype.info=function(){};function Xe(l,h){if(!l.g)return h;if(!h)return null;try{const L=JSON.parse(h);if(L){for(l=0;l<L.length;l++)if(Array.isArray(L[l])){var p=L[l];if(!(p.length<2)){var I=p[1];if(Array.isArray(I)&&!(I.length<1)){var O=I[0];if(O!="noop"&&O!="stop"&&O!="close")for(let H=1;H<I.length;H++)I[H]=""}}}}return Oi(L)}catch{return h}}var ce={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Re={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ge;function Oe(){}f(Oe,ca),Oe.prototype.g=function(){return new XMLHttpRequest},Ge=new Oe;function Rn(l){return encodeURIComponent(String(l))}function Ct(l){var h=1;l=l.split(":");const p=[];for(;h>0&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function gn(l,h,p,I){this.j=l,this.i=h,this.l=p,this.S=I||1,this.V=new Wn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Lu}function Lu(){this.i=null,this.g="",this.h=!1}var ju={},fa={};function pa(l,h,p){l.M=1,l.A=Uu(Kn(h)),l.u=p,l.R=!0,Ay(l,null)}function Ay(l,h){l.F=Date.now(),Fu(l),l.B=Kn(l.A);var p=l.B,I=l.S;Array.isArray(I)||(I=[String(I)]),jy(p.i,"t",I),l.C=0,p=l.j.L,l.h=new Lu,l.g=nv(l.j,p?h:null,!l.u),l.P>0&&(l.O=new hf(c(l.Y,l,l.g),l.P)),h=l.V,p=l.g,I=l.ba;var O="readystatechange";Array.isArray(O)||(O&&(Ps[0]=O.toString()),O=Ps);for(let L=0;L<O.length;L++){const H=Lt(p,O[L],I||h.handleEvent,!1,h.h||h);if(!H)break;h.g[H.key]=H}h=l.J?pe(l.J):{},l.u?(l.v||(l.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,h)):(l.v="GET",l.g.ea(l.B,l.v,null,h)),Mr(),F(l.i,l.v,l.B,l.l,l.S,l.u)}gn.prototype.ba=function(l){l=l.target;const h=this.O;h&&Fr(l)==3?h.j():this.Y(l)},gn.prototype.Y=function(l){try{if(l==this.g)e:{const me=Fr(this.g),it=this.g.ya(),Pe=this.g.ca();if(!(me<3)&&(me!=3||this.g&&(this.h.h||this.g.la()||Wy(this.g)))){this.K||me!=4||it==7||(it==8||Pe<=0?Mr(3):Mr(2)),ff(this);var h=this.g.ca();this.X=h;var p=Bb(this);if(this.o=h==200,q(this.i,this.v,this.B,this.l,this.S,me,h),this.o){if(this.U&&!this.L){t:{if(this.g){var I,O=this.g;if((I=O.g?O.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(I)){var L=I;break t}}L=null}if(l=L)G(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,pf(this,l);else{this.o=!1,this.m=3,wt(12),Vs(this),ma(this);break e}}if(this.R){l=!0;let pt;for(;!this.K&&this.C<p.length;)if(pt=zb(this,p),pt==fa){me==4&&(this.m=4,wt(14),l=!1),G(this.i,this.l,null,"[Incomplete Response]");break}else if(pt==ju){this.m=4,wt(15),G(this.i,this.l,p,"[Invalid Chunk]"),l=!1;break}else G(this.i,this.l,pt,null),pf(this,pt);if(xy(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),me!=4||p.length!=0||this.h.h||(this.m=1,wt(16),l=!1),this.o=this.o&&l,!l)G(this.i,this.l,p,"[Invalid Chunked Response]"),Vs(this),ma(this);else if(p.length>0&&!this.W){this.W=!0;var H=this.j;H.g==this&&H.aa&&!H.P&&(H.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),Ef(H),H.P=!0,wt(11))}}else G(this.i,this.l,p,null),pf(this,p);me==4&&Vs(this),this.o&&!this.K&&(me==4?Yy(this.j,this):(this.o=!1,Fu(this)))}else rk(this.g),h==400&&p.indexOf("Unknown SID")>0?(this.m=3,wt(12)):(this.m=0,wt(13)),Vs(this),ma(this)}}}catch{}finally{}};function Bb(l){if(!xy(l))return l.g.la();const h=Wy(l.g);if(h==="")return"";let p="";const I=h.length,O=Fr(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Vs(l),ma(l),"";l.h.i=new o.TextDecoder}for(let L=0;L<I;L++)l.h.h=!0,p+=l.h.i.decode(h[L],{stream:!(O&&L==I-1)});return h.length=0,l.h.g+=p,l.C=0,l.h.g}function xy(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function zb(l,h){var p=l.C,I=h.indexOf(`
`,p);return I==-1?fa:(p=Number(h.substring(p,I)),isNaN(p)?ju:(I+=1,I+p>h.length?fa:(h=h.slice(I,I+p),l.C=I+p,h)))}gn.prototype.cancel=function(){this.K=!0,Vs(this)};function Fu(l){l.T=Date.now()+l.H,by(l,l.H)}function by(l,h){if(l.D!=null)throw Error("WatchDog timer not null");l.D=Ds(c(l.aa,l),h)}function ff(l){l.D&&(o.clearTimeout(l.D),l.D=null)}gn.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(ae(this.i,this.B),this.M!=2&&(Mr(),wt(17)),Vs(this),this.m=2,ma(this)):by(this,this.T-l)};function ma(l){l.j.I==0||l.K||Yy(l.j,l)}function Vs(l){ff(l);var h=l.O;h&&typeof h.dispose=="function"&&h.dispose(),l.O=null,ua(l.V),l.g&&(h=l.g,l.g=null,h.abort(),h.dispose())}function pf(l,h){try{var p=l.j;if(p.I!=0&&(p.g==l||mf(p.h,l))){if(!l.L&&mf(p.h,l)&&p.I==3){try{var I=p.Ba.g.parse(h)}catch{I=null}if(Array.isArray(I)&&I.length==3){var O=I;if(O[0]==0){e:if(!p.v){if(p.g)if(p.g.F+3e3<l.F)Wu(p),zu(p);else break e;If(p),wt(18)}}else p.xa=O[1],0<p.xa-p.K&&O[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=Ds(c(p.Va,p),6e3));Ry(p.h)<=1&&p.ta&&(p.ta=void 0)}else Ls(p,11)}else if((l.L||p.g==l)&&Wu(p),!C(h))for(O=p.Ba.g.parse(h),h=0;h<O.length;h++){let Pe=O[h];const pt=Pe[0];if(!(pt<=p.K))if(p.K=pt,Pe=Pe[1],p.I==2)if(Pe[0]=="c"){p.M=Pe[1],p.ba=Pe[2];const Gn=Pe[3];Gn!=null&&(p.ka=Gn,p.j.info("VER="+p.ka));const js=Pe[4];js!=null&&(p.za=js,p.j.info("SVER="+p.za));const Ur=Pe[5];Ur!=null&&typeof Ur=="number"&&Ur>0&&(I=1.5*Ur,p.O=I,p.j.info("backChannelRequestTimeoutMs_="+I)),I=p;const $r=l.g;if($r){const Gu=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Gu){var L=I.h;L.g||Gu.indexOf("spdy")==-1&&Gu.indexOf("quic")==-1&&Gu.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(gf(L,L.h),L.h=null))}if(I.G){const Tf=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;Tf&&(I.wa=Tf,Ve(I.J,I.G,Tf))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-l.F,p.j.info("Handshake RTT: "+p.T+"ms")),I=p;var H=l;if(I.na=tv(I,I.L?I.ba:null,I.W),H.L){Py(I.h,H);var me=H,it=I.O;it&&(me.H=it),me.D&&(ff(me),Fu(me)),I.g=H}else Jy(I);p.i.length>0&&qu(p)}else Pe[0]!="stop"&&Pe[0]!="close"||Ls(p,7);else p.I==3&&(Pe[0]=="stop"||Pe[0]=="close"?Pe[0]=="stop"?Ls(p,7):wf(p):Pe[0]!="noop"&&p.l&&p.l.qa(Pe),p.A=0)}}Mr(4)}catch{}}var qb=class{constructor(l,h){this.g=l,this.map=h}};function ky(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Cy(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Ry(l){return l.h?1:l.g?l.g.size:0}function mf(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function gf(l,h){l.g?l.g.add(h):l.h=h}function Py(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}ky.prototype.cancel=function(){if(this.i=Ny(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Ny(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.G);return h}return _(l.i)}var Dy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wb(l,h){if(l){l=l.split("&");for(let p=0;p<l.length;p++){const I=l[p].indexOf("=");let O,L=null;I>=0?(O=l[p].substring(0,I),L=l[p].substring(I+1)):O=l[p],h(O,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function Lr(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;l instanceof Lr?(this.l=l.l,ga(this,l.j),this.o=l.o,this.g=l.g,_a(this,l.u),this.h=l.h,_f(this,Fy(l.i)),this.m=l.m):l&&(h=String(l).match(Dy))?(this.l=!1,ga(this,h[1]||"",!0),this.o=ya(h[2]||""),this.g=ya(h[3]||"",!0),_a(this,h[4]),this.h=ya(h[5]||"",!0),_f(this,h[6]||"",!0),this.m=ya(h[7]||"")):(this.l=!1,this.i=new wa(null,this.l))}Lr.prototype.toString=function(){const l=[];var h=this.j;h&&l.push(va(h,Oy,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(va(h,Oy,!0),"@"),l.push(Rn(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&l.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(va(p,p.charAt(0)=="/"?Hb:Gb,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",va(p,Jb)),l.join("")},Lr.prototype.resolve=function(l){const h=Kn(this);let p=!!l.j;p?ga(h,l.j):p=!!l.o,p?h.o=l.o:p=!!l.g,p?h.g=l.g:p=l.u!=null;var I=l.h;if(p)_a(h,l.u);else if(p=!!l.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var O=h.h.lastIndexOf("/");O!=-1&&(I=h.h.slice(0,O+1)+I)}if(O=I,O==".."||O==".")I="";else if(O.indexOf("./")!=-1||O.indexOf("/.")!=-1){I=O.lastIndexOf("/",0)==0,O=O.split("/");const L=[];for(let H=0;H<O.length;){const me=O[H++];me=="."?I&&H==O.length&&L.push(""):me==".."?((L.length>1||L.length==1&&L[0]!="")&&L.pop(),I&&H==O.length&&L.push("")):(L.push(me),I=!0)}I=L.join("/")}else I=O}return p?h.h=I:p=l.i.toString()!=="",p?_f(h,Fy(l.i)):p=!!l.m,p&&(h.m=l.m),h};function Kn(l){return new Lr(l)}function ga(l,h,p){l.j=p?ya(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function _a(l,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);l.u=h}else l.u=null}function _f(l,h,p){h instanceof wa?(l.i=h,Xb(l.i,l.l)):(p||(h=va(h,Qb)),l.i=new wa(h,l.l))}function Ve(l,h,p){l.i.set(h,p)}function Uu(l){return Ve(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function ya(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function va(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,Kb),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function Kb(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Oy=/[#\/\?@]/g,Gb=/[#\?:]/g,Hb=/[#\?]/g,Qb=/[#\?@]/g,Jb=/#/g;function wa(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Ms(l){l.g||(l.g=new Map,l.h=0,l.i&&Wb(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=wa.prototype,n.add=function(l,h){Ms(this),this.i=null,l=Mi(this,l);let p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function Vy(l,h){Ms(l),h=Mi(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function My(l,h){return Ms(l),h=Mi(l,h),l.g.has(h)}n.forEach=function(l,h){Ms(this),this.g.forEach(function(p,I){p.forEach(function(O){l.call(h,O,I,this)},this)},this)};function Ly(l,h){Ms(l);let p=[];if(typeof h=="string")My(l,h)&&(p=p.concat(l.g.get(Mi(l,h))));else for(l=Array.from(l.g.values()),h=0;h<l.length;h++)p=p.concat(l[h]);return p}n.set=function(l,h){return Ms(this),this.i=null,l=Mi(this,l),My(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=Ly(this,l),l.length>0?String(l[0]):h):h};function jy(l,h,p){Vy(l,h),p.length>0&&(l.i=null,l.g.set(Mi(l,h),_(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(let I=0;I<h.length;I++){var p=h[I];const O=Rn(p);p=Ly(this,p);for(let L=0;L<p.length;L++){let H=O;p[L]!==""&&(H+="="+Rn(p[L])),l.push(H)}}return this.i=l.join("&")};function Fy(l){const h=new wa;return h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),h}function Mi(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function Xb(l,h){h&&!l.j&&(Ms(l),l.i=null,l.g.forEach(function(p,I){const O=I.toLowerCase();I!=O&&(Vy(this,I),jy(this,O,p))},l)),l.j=h}function Yb(l,h){const p=new Os;if(o.Image){const I=new Image;I.onload=d(jr,p,"TestLoadImage: loaded",!0,h,I),I.onerror=d(jr,p,"TestLoadImage: error",!1,h,I),I.onabort=d(jr,p,"TestLoadImage: abort",!1,h,I),I.ontimeout=d(jr,p,"TestLoadImage: timeout",!1,h,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=l}else h(!1)}function Zb(l,h){const p=new Os,I=new AbortController,O=setTimeout(()=>{I.abort(),jr(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:I.signal}).then(L=>{clearTimeout(O),L.ok?jr(p,"TestPingServer: ok",!0,h):jr(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(O),jr(p,"TestPingServer: error",!1,h)})}function jr(l,h,p,I,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),I(p)}catch{}}function ek(){this.g=new Pu}function yf(l){this.i=l.Sb||null,this.h=l.ab||!1}f(yf,ca),yf.prototype.g=function(){return new $u(this.i,this.h)};function $u(l,h){ft.call(this),this.H=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f($u,ft),n=$u.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=h,this.readyState=1,Ea(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(h.body=l),(this.H||o).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ia(this)),this.readyState=0},n.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Ea(this)),this.g&&(this.readyState=3,Ea(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Uy(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Uy(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}n.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Ia(this):Ea(this),this.readyState==3&&Uy(this)}},n.Oa=function(l){this.g&&(this.response=this.responseText=l,Ia(this))},n.Na=function(l){this.g&&(this.response=l,Ia(this))},n.ga=function(){this.g&&Ia(this)};function Ia(l){l.readyState=4,l.l=null,l.j=null,l.B=null,Ea(l)}n.setRequestHeader=function(l,h){this.A.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function Ea(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty($u.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function $y(l){let h="";return oe(l,function(p,I){h+=I,h+=":",h+=p,h+=`\r
`}),h}function vf(l,h,p){e:{for(I in p){var I=!1;break e}I=!0}I||(p=$y(p),typeof l=="string"?p!=null&&Rn(p):Ve(l,h,p))}function He(l){ft.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(He,ft);var tk=/^https?$/i,nk=["POST","PUT"];n=He.prototype,n.Fa=function(l){this.H=l},n.ea=function(l,h,p,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ge.g(),this.g.onreadystatechange=m(c(this.Ca,this));try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(L){By(this,L);return}if(l=p||"",p=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var O in I)p.set(O,I[O]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const L of I.keys())p.set(L,I.get(L));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(p.keys()).find(L=>L.toLowerCase()=="content-type"),O=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(nk,h,void 0)>=0)||I||O||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,H]of p)this.g.setRequestHeader(L,H);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(L){By(this,L)}};function By(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.o=5,zy(l),Bu(l)}function zy(l){l.A||(l.A=!0,re(l,"complete"),re(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,re(this,"complete"),re(this,"abort"),Bu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Bu(this,!0)),He.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?qy(this):this.Xa())},n.Xa=function(){qy(this)};function qy(l){if(l.h&&typeof i<"u"){if(l.v&&Fr(l)==4)setTimeout(l.Ca.bind(l),0);else if(re(l,"readystatechange"),Fr(l)==4){l.h=!1;try{const L=l.ca();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var I;if(I=L===0){let H=String(l.D).match(Dy)[1]||null;!H&&o.self&&o.self.location&&(H=o.self.location.protocol.slice(0,-1)),I=!tk.test(H?H.toLowerCase():"")}p=I}if(p)re(l,"complete"),re(l,"success");else{l.o=6;try{var O=Fr(l)>2?l.g.statusText:""}catch{O=""}l.l=O+" ["+l.ca()+"]",zy(l)}}finally{Bu(l)}}}}function Bu(l,h){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const p=l.g;l.g=null,h||re(l,"ready");try{p.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Fr(l){return l.g?l.g.readyState:0}n.ca=function(){try{return Fr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),df(h)}};function Wy(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function rk(l){const h={};l=(l.g&&Fr(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<l.length;I++){if(C(l[I]))continue;var p=Ct(l[I]);const O=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const L=h[O]||[];h[O]=L,L.push(p)}ee(h,function(I){return I.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ta(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function Ky(l){this.za=0,this.i=[],this.j=new Os,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ta("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ta("baseRetryDelayMs",5e3,l),this.Za=Ta("retryDelaySeedMs",1e4,l),this.Ta=Ta("forwardChannelMaxRetries",2,l),this.va=Ta("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new ky(l&&l.concurrentRequestLimit),this.Ba=new ek,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ky.prototype,n.ka=8,n.I=1,n.connect=function(l,h,p,I){wt(0),this.W=l,this.H=h||{},p&&I!==void 0&&(this.H.OSID=p,this.H.OAID=I),this.F=this.X,this.J=tv(this,null,this.W),qu(this)};function wf(l){if(Gy(l),l.I==3){var h=l.V++,p=Kn(l.J);if(Ve(p,"SID",l.M),Ve(p,"RID",h),Ve(p,"TYPE","terminate"),Sa(l,p),h=new gn(l,l.j,h),h.M=2,h.A=Uu(Kn(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(h.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=h.A,p=!0),p||(h.g=nv(h.j,null),h.g.ea(h.A)),h.F=Date.now(),Fu(h)}ev(l)}function zu(l){l.g&&(Ef(l),l.g.cancel(),l.g=null)}function Gy(l){zu(l),l.v&&(o.clearTimeout(l.v),l.v=null),Wu(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function qu(l){if(!Cy(l.h)&&!l.m){l.m=!0;var h=l.Ea;j||v(),M||(j(),M=!0),w.add(h,l),l.D=0}}function sk(l,h){return Ry(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=h.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=Ds(c(l.Ea,l,h),Zy(l,l.D)),l.D++,!0)}n.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const O=new gn(this,this.j,l);let L=this.o;if(this.U&&(L?(L=pe(L),pn(L,this.U)):L=this.U),this.u!==null||this.R||(O.J=L,L=null),this.S)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var I=this.i[p];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(h+=I,h>4096){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Qy(this,O,h),p=Kn(this.J),Ve(p,"RID",l),Ve(p,"CVER",22),this.G&&Ve(p,"X-HTTP-Session-Id",this.G),Sa(this,p),L&&(this.R?h="headers="+Rn($y(L))+"&"+h:this.u&&vf(p,this.u,L)),gf(this.h,O),this.Ra&&Ve(p,"TYPE","init"),this.S?(Ve(p,"$req",h),Ve(p,"SID","null"),O.U=!0,pa(O,p,null)):pa(O,p,h),this.I=2}}else this.I==3&&(l?Hy(this,l):this.i.length==0||Cy(this.h)||Hy(this))};function Hy(l,h){var p;h?p=h.l:p=l.V++;const I=Kn(l.J);Ve(I,"SID",l.M),Ve(I,"RID",p),Ve(I,"AID",l.K),Sa(l,I),l.u&&l.o&&vf(I,l.u,l.o),p=new gn(l,l.j,p,l.D+1),l.u===null&&(p.J=l.o),h&&(l.i=h.G.concat(l.i)),h=Qy(l,p,1e3),p.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),gf(l.h,p),pa(p,I,h)}function Sa(l,h){l.H&&oe(l.H,function(p,I){Ve(h,I,p)}),l.l&&oe({},function(p,I){Ve(h,I,p)})}function Qy(l,h,p){p=Math.min(l.i.length,p);const I=l.l?c(l.l.Ka,l.l,l):null;e:{var O=l.i;let me=-1;for(;;){const it=["count="+p];me==-1?p>0?(me=O[0].g,it.push("ofs="+me)):me=0:it.push("ofs="+me);let Pe=!0;for(let pt=0;pt<p;pt++){var L=O[pt].g;const Gn=O[pt].map;if(L-=me,L<0)me=Math.max(0,O[pt].g-100),Pe=!1;else try{L="req"+L+"_"||"";try{var H=Gn instanceof Map?Gn:Object.entries(Gn);for(const[js,Ur]of H){let $r=Ur;a(Ur)&&($r=Oi(Ur)),it.push(L+js+"="+encodeURIComponent($r))}}catch(js){throw it.push(L+"type="+encodeURIComponent("_badmap")),js}}catch{I&&I(Gn)}}if(Pe){H=it.join("&");break e}}H=void 0}return l=l.i.splice(0,p),h.G=l,H}function Jy(l){if(!l.g&&!l.v){l.Y=1;var h=l.Da;j||v(),M||(j(),M=!0),w.add(h,l),l.A=0}}function If(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=Ds(c(l.Da,l),Zy(l,l.A)),l.A++,!0)}n.Da=function(){if(this.v=null,Xy(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=Ds(c(this.Wa,this),l)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,wt(10),zu(this),Xy(this))};function Ef(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function Xy(l){l.g=new gn(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var h=Kn(l.na);Ve(h,"RID","rpc"),Ve(h,"SID",l.M),Ve(h,"AID",l.K),Ve(h,"CI",l.F?"0":"1"),!l.F&&l.ia&&Ve(h,"TO",l.ia),Ve(h,"TYPE","xmlhttp"),Sa(l,h),l.u&&l.o&&vf(h,l.u,l.o),l.O&&(l.g.H=l.O);var p=l.g;l=l.ba,p.M=1,p.A=Uu(Kn(h)),p.u=null,p.R=!0,Ay(p,l)}n.Va=function(){this.C!=null&&(this.C=null,zu(this),If(this),wt(19))};function Wu(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function Yy(l,h){var p=null;if(l.g==h){Wu(l),Ef(l),l.g=null;var I=2}else if(mf(l.h,h))p=h.G,Py(l.h,h),I=1;else return;if(l.I!=0){if(h.o)if(I==1){p=h.u?h.u.length:0,h=Date.now()-h.F;var O=l.D;I=Vi(),re(I,new Mu(I,p)),qu(l)}else Jy(l);else if(O=h.m,O==3||O==0&&h.X>0||!(I==1&&sk(l,h)||I==2&&If(l)))switch(p&&p.length>0&&(h=l.h,h.i=h.i.concat(p)),O){case 1:Ls(l,5);break;case 4:Ls(l,10);break;case 3:Ls(l,6);break;default:Ls(l,2)}}}function Zy(l,h){let p=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(p*=2),p*h}function Ls(l,h){if(l.j.info("Error code "+h),h==2){var p=c(l.bb,l),I=l.Ua;const O=!I;I=new Lr(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ga(I,"https"),Uu(I),O?Yb(I.toString(),p):Zb(I.toString(),p)}else wt(2);l.I=0,l.l&&l.l.pa(h),ev(l),Gy(l)}n.bb=function(l){l?(this.j.info("Successfully pinged google.com"),wt(2)):(this.j.info("Failed to ping google.com"),wt(1))};function ev(l){if(l.I=0,l.ja=[],l.l){const h=Ny(l.h);(h.length!=0||l.i.length!=0)&&(E(l.ja,h),E(l.ja,l.i),l.h.i.length=0,_(l.i),l.i.length=0),l.l.oa()}}function tv(l,h,p){var I=p instanceof Lr?Kn(p):new Lr(p);if(I.g!="")h&&(I.g=h+"."+I.g),_a(I,I.u);else{var O=o.location;I=O.protocol,h=h?h+"."+O.hostname:O.hostname,O=+O.port;const L=new Lr(null);I&&ga(L,I),h&&(L.g=h),O&&_a(L,O),p&&(L.h=p),I=L}return p=l.G,h=l.wa,p&&h&&Ve(I,p,h),Ve(I,"VER",l.ka),Sa(l,I),I}function nv(l,h,p){if(h&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Aa&&!l.ma?new He(new yf({ab:p})):new He(l.ma),h.Fa(l.L),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function rv(){}n=rv.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ku(){}Ku.prototype.g=function(l,h){return new Yt(l,h)};function Yt(l,h){ft.call(this),this.g=new Ky(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(l?l["X-WebChannel-Client-Profile"]=h.sa:l={"X-WebChannel-Client-Profile":h.sa}),this.g.U=l,(l=h&&h.Qb)&&!C(l)&&(this.g.u=l),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!C(h)&&(this.g.G=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Li(this)}f(Yt,ft),Yt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Yt.prototype.close=function(){wf(this.g)},Yt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.v&&(p={},p.__data__=Oi(l),l=p);h.i.push(new qb(h.Ya++,l)),h.I==3&&qu(h)},Yt.prototype.N=function(){this.g.l=null,delete this.j,wf(this.g),delete this.g,Yt.Z.N.call(this)};function sv(l){ha.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}f(sv,ha);function iv(){da.call(this),this.status=1}f(iv,da);function Li(l){this.g=l}f(Li,rv),Li.prototype.ra=function(){re(this.g,"a")},Li.prototype.qa=function(l){re(this.g,new sv(l))},Li.prototype.pa=function(l){re(this.g,new iv)},Li.prototype.oa=function(){re(this.g,"b")},Ku.prototype.createWebChannel=Ku.prototype.g,Yt.prototype.send=Yt.prototype.o,Yt.prototype.open=Yt.prototype.m,Yt.prototype.close=Yt.prototype.close,VA=function(){return new Ku},OA=function(){return Vi()},DA=hr,Om={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ce.NO_ERROR=0,ce.TIMEOUT=8,ce.HTTP_ERROR=6,Xc=ce,Re.COMPLETE="complete",NA=Re,Nu.EventType=Ns,Ns.OPEN="a",Ns.CLOSE="b",Ns.ERROR="c",Ns.MESSAGE="d",ft.prototype.listen=ft.prototype.J,Ya=Nu,He.prototype.listenOnce=He.prototype.K,He.prototype.getLastError=He.prototype.Ha,He.prototype.getLastErrorCode=He.prototype.ya,He.prototype.getStatus=He.prototype.ca,He.prototype.getResponseJson=He.prototype.La,He.prototype.getResponseText=He.prototype.la,He.prototype.send=He.prototype.ea,He.prototype.setWithCredentials=He.prototype.Fa,PA=He}).apply(typeof vc<"u"?vc:typeof self<"u"?self:typeof window<"u"?window:{});const y0="@firebase/firestore",v0="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}St.UNAUTHENTICATED=new St(null),St.GOOGLE_CREDENTIALS=new St("google-credentials-uid"),St.FIRST_PARTY=new St("first-party-uid"),St.MOCK_USER=new St("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sa="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is=new T_("@firebase/firestore");function Xi(){return Is.logLevel}function vO(n){Is.setLogLevel(n)}function B(n,...e){if(Is.logLevel<=ve.DEBUG){const t=e.map(M_);Is.debug(`Firestore (${sa}): ${n}`,...t)}}function Ut(n,...e){if(Is.logLevel<=ve.ERROR){const t=e.map(M_);Is.error(`Firestore (${sa}): ${n}`,...t)}}function wi(n,...e){if(Is.logLevel<=ve.WARN){const t=e.map(M_);Is.warn(`Firestore (${sa}): ${n}`,...t)}}function M_(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,MA(n,r,t)}function MA(n,e,t){let r=`FIRESTORE (${sa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ut(r),new Error(r)}function te(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||MA(e,s,r)}function de(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends Dr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class wO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(St.UNAUTHENTICATED))}shutdown(){}}class IO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class EO{constructor(e){this.t=e,this.currentUser=St.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){te(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let i=new Tr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Tr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},a=u=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Tr)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string",31837,{l:r}),new LA(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string",2055,{h:e}),new St(e)}}class TO{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=St.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class SO{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new TO(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(St.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class w0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class AO{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ln(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){te(this.o===void 0,3512);const r=i=>{i.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new w0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(te(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new w0(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=xO(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function he(n,e){return n<e?-1:n>e?1:0}function Vm(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return dp(s)===dp(i)?he(s,i):dp(s)?1:-1}return he(n.length,e.length)}const bO=55296,kO=57343;function dp(n){const e=n.charCodeAt(0);return e>=bO&&e<=kO}function Vo(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function jA(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0="__name__";class Yn{constructor(e,t,r){t===void 0?t=0:t>e.length&&Z(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Z(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Yn.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yn?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=Yn.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return he(e.length,t.length)}static compareSegments(e,t){const r=Yn.isNumericId(e),s=Yn.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?Yn.extractNumericId(e).compare(Yn.extractNumericId(t)):Vm(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _s.fromString(e.substring(4,e.length-2))}}class be extends Yn{construct(e,t,r){return new be(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new J(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new be(t)}static emptyPath(){return new be([])}}const CO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ze extends Yn{construct(e,t,r){return new ze(e,t,r)}static isValidIdentifier(e){return CO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ze.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===I0}static keyField(){return new ze([I0])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new J(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new J(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new J(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new J(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ze(t)}static emptyPath(){return new ze([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.path=e}static fromPath(e){return new Q(be.fromString(e))}static fromName(e){return new Q(be.fromString(e).popFirst(5))}static empty(){return new Q(be.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&be.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return be.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Q(new be(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RO(n,e,t){if(!t)throw new J(U.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function PO(n,e,t,r){if(e===!0&&r===!0)throw new J(U.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function E0(n){if(!Q.isDocumentKey(n))throw new J(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function FA(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function j_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Z(12329,{type:typeof n})}function Mo(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new J(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=j_(n);throw new J(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nt(n,e){const t={typeString:n};return e&&(t.value=e),t}function _u(n,e){if(!FA(n))throw new J(U.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(s&&typeof o!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new J(U.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0=-62135596800,S0=1e6;class Se{static now(){return Se.fromMillis(Date.now())}static fromDate(e){return Se.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*S0);return new Se(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new J(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new J(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<T0)throw new J(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new J(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/S0}_compareTo(e){return this.seconds===e.seconds?he(this.nanoseconds,e.nanoseconds):he(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Se._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(_u(e,Se._jsonSchema))return new Se(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-T0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Se._jsonSchemaVersion="firestore/timestamp/1.0",Se._jsonSchema={type:nt("string",Se._jsonSchemaVersion),seconds:nt("number"),nanoseconds:nt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{static fromTimestamp(e){return new ie(e)}static min(){return new ie(new Se(0,0))}static max(){return new ie(new Se(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kl=-1;class Xh{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function Mm(n){return n.fields.find(e=>e.kind===2)}function qs(n){return n.fields.filter(e=>e.kind!==2)}Xh.UNKNOWN_ID=-1;class Yc{constructor(e,t){this.fieldPath=e,this.kind=t}}class Gl{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Gl(0,hn.min())}}function NO(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ie.fromTimestamp(r===1e9?new Se(t+1,0):new Se(t,r));return new hn(s,Q.empty(),e)}function UA(n){return new hn(n.readTime,n.key,Kl)}class hn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new hn(ie.min(),Q.empty(),Kl)}static max(){return new hn(ie.max(),Q.empty(),Kl)}}function F_(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Q.comparator(n.documentKey,e.documentKey),t!==0?t:he(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class BA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ci(n){if(n.code!==U.FAILED_PRECONDITION||n.message!==$A)throw n;B("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Z(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new D((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof D?t:D.resolve(t)}catch(t){return D.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):D.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):D.reject(t)}static resolve(e){return new D((t,r)=>{t(e)})}static reject(e){return new D((t,r)=>{r(e)})}static waitFor(e){return new D((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},u=>r(u))}),o=!0,i===s&&t()})}static or(e){let t=D.resolve(!1);for(const r of e)t=t.next(s=>s?D.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new D((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let u=0;u<i;u++){const c=u;t(e[c]).next(d=>{o[c]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,t){return new D((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="SimpleDb";class qd{static open(e,t,r,s){try{return new qd(t,e.transaction(s,r))}catch(i){throw new _l(t,i)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Tr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new _l(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=U_(r.target.error);this.S.reject(new _l(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(B(rn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new OO(t)}}class ys{static delete(e){return B(rn,"Removing database:",e),Gs(L1().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!K1())return!1;if(ys.F())return!0;const e=ct(),t=ys.M(e),r=0<t&&t<10,s=zA(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,ys.M(ct())===12.2&&Ut("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(B(rn,"Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new _l(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new J(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new J(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new _l(e,o))},s.onupgradeneeded=i=>{B(rn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{B(rn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=qd.open(this.db,e,i?"readonly":"readwrite",r),u=s(a).next(c=>(a.C(),c)).catch(c=>(a.abort(c),D.reject(c))).toPromise();return u.catch(()=>{}),await a.D,u}catch(a){const u=a,c=u.name!=="FirebaseError"&&o<3;if(B(rn,"Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function zA(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class DO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Gs(this.U.delete())}}class _l extends J{constructor(e,t){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Cs(n){return n.name==="IndexedDbTransactionError"}class OO{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(B(rn,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(B(rn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Gs(r)}add(e){return B(rn,"ADD",this.store.name,e,e),Gs(this.store.add(e))}get(e){return Gs(this.store.get(e)).next(t=>(t===void 0&&(t=null),B(rn,"GET",this.store.name,e,t),t))}delete(e){return B(rn,"DELETE",this.store.name,e),Gs(this.store.delete(e))}count(){return B(rn,"COUNT",this.store.name),Gs(this.store.count())}J(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new D((o,a)=>{i.onerror=u=>{a(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,u)=>{o.push(u)}).next(()=>o)}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new D((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,t){B(rn,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.H(s,t)}te(e){const t=this.cursor({});return new D((r,s)=>{t.onerror=i=>{const o=U_(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,t){const r=[];return new D((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const u=new DO(a),c=t(a.primaryKey,a.value,u);if(c instanceof D){const d=c.catch(f=>(u.done(),D.reject(f)));r.push(d)}u.isDone?s():u.G===null?a.continue():a.continue(u.G)}}).next(()=>D.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Gs(n){return new D((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=U_(r.target.error);t(s)}})}let A0=!1;function U_(n){const e=ys.M(ct());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new J("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return A0||(A0=!0,setTimeout(()=>{throw r},0)),r}}return n}const yl="IndexBackfiller";class VO{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){B(yl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ne.ie();B(yl,`Documents written: ${t}`)}catch(t){Cs(t)?B(yl,"Ignoring IndexedDB error during index backfill: ",t):await Ci(t)}await this.re(6e4)})}}class MO{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const r=new Set;let s=t,i=!0;return D.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return B(yl,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(B(yl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}_e(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=UA(i);F_(o,r)>0&&(r=o)}),new hn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}En.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai=-1;function Wd(n){return n==null}function Hl(n){return n===0&&1/n==-1/0}function LO(n){return typeof n=="number"&&Number.isInteger(n)&&!Hl(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="";function Vt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=x0(e)),e=jO(n.get(t),e);return x0(e)}function jO(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case Yh:t+="";break;default:t+=i}}return t}function x0(n){return n+Yh+""}function tr(n){const e=n.length;if(te(e>=2,64408,{path:n}),e===2)return te(n.charAt(0)===Yh&&n.charAt(1)==="",56145,{path:n}),be.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf(Yh,i);switch((o<0||o>t)&&Z(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(i,o);let u;s.length===0?u=a:(s+=a,u=s,s=""),r.push(u);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:Z(61167,{path:n})}i=o+2}return new be(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws="remoteDocuments",yu="owner",Bi="owner",Ql="mutationQueues",FO="userId",Vn="mutations",b0="batchId",ri="userMutationsIndex",k0=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zc(n,e){return[n,Vt(e)]}function qA(n,e,t){return[n,Vt(e),t]}const UO={},Lo="documentMutations",Zh="remoteDocumentsV14",$O=["prefixPath","collectionGroup","readTime","documentId"],eh="documentKeyIndex",BO=["prefixPath","collectionGroup","documentId"],WA="collectionGroupIndex",zO=["collectionGroup","readTime","prefixPath","documentId"],Jl="remoteDocumentGlobal",Lm="remoteDocumentGlobalKey",jo="targets",KA="queryTargetsIndex",qO=["canonicalId","targetId"],Fo="targetDocuments",WO=["targetId","path"],$_="documentTargetsIndex",KO=["path","targetId"],ed="targetGlobalKey",li="targetGlobal",Xl="collectionParents",GO=["collectionId","parent"],Uo="clientMetadata",HO="clientId",Kd="bundles",QO="bundleId",Gd="namedQueries",JO="name",B_="indexConfiguration",XO="indexId",jm="collectionGroupIndex",YO="collectionGroup",vl="indexState",ZO=["indexId","uid"],GA="sequenceNumberIndex",eV=["uid","sequenceNumber"],wl="indexEntries",tV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],HA="documentKeyIndex",nV=["indexId","uid","orderedDocumentKey"],Hd="documentOverlays",rV=["userId","collectionPath","documentId"],Fm="collectionPathOverlayIndex",sV=["userId","collectionPath","largestBatchId"],QA="collectionGroupOverlayIndex",iV=["userId","collectionGroup","largestBatchId"],z_="globals",oV="name",JA=[Ql,Vn,Lo,Ws,jo,yu,li,Fo,Uo,Jl,Xl,Kd,Gd],aV=[...JA,Hd],XA=[Ql,Vn,Lo,Zh,jo,yu,li,Fo,Uo,Jl,Xl,Kd,Gd,Hd],YA=XA,q_=[...YA,B_,vl,wl],lV=q_,ZA=[...q_,z_],uV=ZA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um extends BA{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function ht(n,e){const t=de(n);return ys.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C0(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ri(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ex(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e,t){this.comparator=e,this.root=t||At.EMPTY}insert(e,t){return new $e(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,At.BLACK,null,null))}remove(e){return new $e(this.comparator,this.root.remove(e,this.comparator).copy(null,null,At.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wc(this.root,e,this.comparator,!1)}getReverseIterator(){return new wc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wc(this.root,e,this.comparator,!0)}}class wc{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class At{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??At.RED,this.left=s??At.EMPTY,this.right=i??At.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new At(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return At.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return At.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,At.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,At.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Z(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Z(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Z(27949);return e+(this.isRed()?0:1)}}At.EMPTY=null,At.RED=!0,At.BLACK=!1;At.EMPTY=new class{constructor(){this.size=0}get key(){throw Z(57766)}get value(){throw Z(16141)}get color(){throw Z(16727)}get left(){throw Z(29726)}get right(){throw Z(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new At(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.comparator=e,this.data=new $e(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new R0(this.data.getIterator())}getIteratorFrom(e){return new R0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof xe)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new xe(this.comparator);return t.data=e,t}}class R0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function zi(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new Tn([])}unionWith(e){let t=new xe(ze.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Tn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Vo(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new tx("Invalid base64 string: "+i):i}}(e);return new st(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new st(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return he(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}st.EMPTY_BYTE_STRING=new st("");const cV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Rr(n){if(te(!!n,39018),typeof n=="string"){let e=0;const t=cV.exec(n);if(te(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Fe(n.seconds),nanos:Fe(n.nanos)}}function Fe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Pr(n){return typeof n=="string"?st.fromBase64String(n):st.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nx="server_timestamp",rx="__type__",sx="__previous_value__",ix="__local_write_time__";function W_(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[rx])==null?void 0:r.stringValue)===nx}function Qd(n){const e=n.mapValue.fields[sx];return W_(e)?Qd(e):e}function Yl(n){const e=Rr(n.mapValue.fields[ix].timestampValue);return new Se(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(e,t,r,s,i,o,a,u,c,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c,this.isUsingEmulator=d}}const td="(default)";class Ii{constructor(e,t){this.projectId=e,this.database=t||td}static empty(){return new Ii("","")}get isDefaultDatabase(){return this.database===td}isEqual(e){return e instanceof Ii&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_="__type__",ox="__max__",is={mapValue:{fields:{__type__:{stringValue:ox}}}},G_="__vector__",$o="value",th={nullValue:"NULL_VALUE"};function Es(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?W_(n)?4:ax(n)?9007199254740991:Jd(n)?10:11:Z(28295,{value:n})}function ur(n,e){if(n===e)return!0;const t=Es(n);if(t!==Es(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yl(n).isEqual(Yl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Rr(s.timestampValue),a=Rr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Pr(s.bytesValue).isEqual(Pr(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return Fe(s.geoPointValue.latitude)===Fe(i.geoPointValue.latitude)&&Fe(s.geoPointValue.longitude)===Fe(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Fe(s.integerValue)===Fe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Fe(s.doubleValue),a=Fe(i.doubleValue);return o===a?Hl(o)===Hl(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Vo(n.arrayValue.values||[],e.arrayValue.values||[],ur);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(C0(o)!==C0(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!ur(o[u],a[u])))return!1;return!0}(n,e);default:return Z(52216,{left:n})}}function Zl(n,e){return(n.values||[]).find(t=>ur(t,e))!==void 0}function Ts(n,e){if(n===e)return 0;const t=Es(n),r=Es(e);if(t!==r)return he(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return he(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Fe(i.integerValue||i.doubleValue),u=Fe(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return P0(n.timestampValue,e.timestampValue);case 4:return P0(Yl(n),Yl(e));case 5:return Vm(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Pr(i),u=Pr(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){const d=he(a[c],u[c]);if(d!==0)return d}return he(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=he(Fe(i.latitude),Fe(o.latitude));return a!==0?a:he(Fe(i.longitude),Fe(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return N0(n.arrayValue,e.arrayValue);case 10:return function(i,o){var m,_,E,k;const a=i.fields||{},u=o.fields||{},c=(m=a[$o])==null?void 0:m.arrayValue,d=(_=u[$o])==null?void 0:_.arrayValue,f=he(((E=c==null?void 0:c.values)==null?void 0:E.length)||0,((k=d==null?void 0:d.values)==null?void 0:k.length)||0);return f!==0?f:N0(c,d)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===is.mapValue&&o===is.mapValue)return 0;if(i===is.mapValue)return 1;if(o===is.mapValue)return-1;const a=i.fields||{},u=Object.keys(a),c=o.fields||{},d=Object.keys(c);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const m=Vm(u[f],d[f]);if(m!==0)return m;const _=Ts(a[u[f]],c[d[f]]);if(_!==0)return _}return he(u.length,d.length)}(n.mapValue,e.mapValue);default:throw Z(23264,{he:t})}}function P0(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return he(n,e);const t=Rr(n),r=Rr(e),s=he(t.seconds,r.seconds);return s!==0?s:he(t.nanos,r.nanos)}function N0(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Ts(t[s],r[s]);if(i)return i}return he(t.length,r.length)}function Bo(n){return $m(n)}function $m(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Rr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Pr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=$m(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${$m(t.fields[o])}`;return s+"}"}(n.mapValue):Z(61005,{value:n})}function nh(n){switch(Es(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Qd(n);return e?16+nh(e):16;case 5:return 2*n.stringValue.length;case 6:return Pr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+nh(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Ri(r.fields,(i,o)=>{s+=i.length+nh(o)}),s}(n.mapValue);default:throw Z(13486,{value:n})}}function H_(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Bm(n){return!!n&&"integerValue"in n}function eu(n){return!!n&&"arrayValue"in n}function D0(n){return!!n&&"nullValue"in n}function O0(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function rh(n){return!!n&&"mapValue"in n}function Jd(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[K_])==null?void 0:r.stringValue)===G_}function Il(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ri(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Il(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Il(n.arrayValue.values[t]);return e}return{...n}}function ax(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===ox}const lx={mapValue:{fields:{[K_]:{stringValue:G_},[$o]:{arrayValue:{}}}}};function dV(n){return"nullValue"in n?th:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?H_(Ii.empty(),Q.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Jd(n)?lx:{mapValue:{}}:Z(35942,{value:n})}function fV(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?H_(Ii.empty(),Q.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?lx:"mapValue"in n?Jd(n)?{mapValue:{}}:is:Z(61959,{value:n})}function V0(n,e){const t=Ts(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function M0(n,e){const t=Ts(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.value=e}static empty(){return new Gt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!rh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Il(t)}setAll(e){let t=ze.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Il(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());rh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ur(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];rh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Ri(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Gt(Il(this.value))}}function ux(n){const e=[];return Ri(n.fields,(t,r)=>{const s=new ze([t]);if(rh(r)){const i=ux(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Tn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Je(e,0,ie.min(),ie.min(),ie.min(),Gt.empty(),0)}static newFoundDocument(e,t,r,s){return new Je(e,1,t,ie.min(),r,s,0)}static newNoDocument(e,t){return new Je(e,2,t,ie.min(),ie.min(),Gt.empty(),0)}static newUnknownDocument(e,t){return new Je(e,3,t,ie.min(),ie.min(),Gt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Gt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Gt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Je&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Je(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,t){this.position=e,this.inclusive=t}}function L0(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=Q.comparator(Q.fromName(o.referenceValue),t.key):r=Ts(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function j0(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ur(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,t="asc"){this.field=e,this.dir=t}}function pV(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{}class we extends cx{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new mV(e,t,r):t==="array-contains"?new yV(e,r):t==="in"?new gx(e,r):t==="not-in"?new vV(e,r):t==="array-contains-any"?new wV(e,r):new we(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new gV(e,r):new _V(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ts(t,this.value)):t!==null&&Es(this.value)===Es(t)&&this.matchesComparison(Ts(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Z(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ke extends cx{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ke(e,t)}matches(e){return qo(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function qo(n){return n.op==="and"}function zm(n){return n.op==="or"}function Q_(n){return hx(n)&&qo(n)}function hx(n){for(const e of n.filters)if(e instanceof ke)return!1;return!0}function qm(n){if(n instanceof we)return n.field.canonicalString()+n.op.toString()+Bo(n.value);if(Q_(n))return n.filters.map(e=>qm(e)).join(",");{const e=n.filters.map(t=>qm(t)).join(",");return`${n.op}(${e})`}}function dx(n,e){return n instanceof we?function(r,s){return s instanceof we&&r.op===s.op&&r.field.isEqual(s.field)&&ur(r.value,s.value)}(n,e):n instanceof ke?function(r,s){return s instanceof ke&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&dx(o,s.filters[a]),!0):!1}(n,e):void Z(19439)}function fx(n,e){const t=n.filters.concat(e);return ke.create(t,n.op)}function px(n){return n instanceof we?function(t){return`${t.field.canonicalString()} ${t.op} ${Bo(t.value)}`}(n):n instanceof ke?function(t){return t.op.toString()+" {"+t.getFilters().map(px).join(" ,")+"}"}(n):"Filter"}class mV extends we{constructor(e,t,r){super(e,t,r),this.key=Q.fromName(r.referenceValue)}matches(e){const t=Q.comparator(e.key,this.key);return this.matchesComparison(t)}}class gV extends we{constructor(e,t){super(e,"in",t),this.keys=mx("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class _V extends we{constructor(e,t){super(e,"not-in",t),this.keys=mx("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function mx(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(r=>Q.fromName(r.referenceValue))}class yV extends we{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return eu(t)&&Zl(t.arrayValue,this.value)}}class gx extends we{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Zl(this.value.arrayValue,t)}}class vV extends we{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Zl(this.value.arrayValue,t)}}class wV extends we{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!eu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Zl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IV{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function Wm(n,e=null,t=[],r=[],s=null,i=null,o=null){return new IV(n,e,t,r,s,i,o)}function Ei(n){const e=de(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>qm(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Wd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Bo(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Bo(r)).join(",")),e.Te=t}return e.Te}function vu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!pV(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!dx(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!j0(n.startAt,e.startAt)&&j0(n.endAt,e.endAt)}function rd(n){return Q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function sd(n,e){return n.filters.filter(t=>t instanceof we&&t.field.isEqual(e))}function F0(n,e,t){let r=th,s=!0;for(const i of sd(n,e)){let o=th,a=!0;switch(i.op){case"<":case"<=":o=dV(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=th}V0({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];V0({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function U0(n,e,t){let r=is,s=!0;for(const i of sd(n,e)){let o=is,a=!0;switch(i.op){case">=":case">":o=fV(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=is}M0({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];M0({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function EV(n,e,t,r,s,i,o,a){return new Xd(n,e,t,r,s,i,o,a)}function Yd(n){return new Xd(n)}function $0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function TV(n){return n.collectionGroup!==null}function El(n){const e=de(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new xe(ze.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new nd(i,r))}),t.has(ze.keyField().canonicalString())||e.Ie.push(new nd(ze.keyField(),r))}return e.Ie}function An(n){const e=de(n);return e.Ee||(e.Ee=SV(e,El(n))),e.Ee}function SV(n,e){if(n.limitType==="F")return Wm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new nd(s.field,i)});const t=n.endAt?new zo(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new zo(n.startAt.position,n.startAt.inclusive):null;return Wm(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Km(n,e,t){return new Xd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Zd(n,e){return vu(An(n),An(e))&&n.limitType===e.limitType}function _x(n){return`${Ei(An(n))}|lt:${n.limitType}`}function Yi(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>px(s)).join(", ")}]`),Wd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>Bo(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>Bo(s)).join(",")),`Target(${r})`}(An(n))}; limitType=${n.limitType})`}function wu(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Q.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of El(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,u){const c=L0(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,El(r),s)||r.endAt&&!function(o,a,u){const c=L0(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,El(r),s))}(n,e)}function AV(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function yx(n){return(e,t)=>{let r=!1;for(const s of El(n)){const i=xV(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function xV(n,e,t){const r=n.field.isKeyField()?Q.comparator(e.key,t.key):function(i,o,a){const u=o.data.field(i),c=a.data.field(i);return u!==null&&c!==null?Ts(u,c):Z(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Z(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ri(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return ex(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bV=new $e(Q.comparator);function on(){return bV}const vx=new $e(Q.comparator);function Za(...n){let e=vx;for(const t of n)e=e.insert(t.key,t);return e}function wx(n){let e=vx;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function nr(){return Tl()}function Ix(){return Tl()}function Tl(){return new Or(n=>n.toString(),(n,e)=>n.isEqual(e))}const kV=new $e(Q.comparator),CV=new xe(Q.comparator);function _e(...n){let e=CV;for(const t of n)e=e.add(t);return e}const RV=new xe(he);function PV(){return RV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hl(e)?"-0":e}}function Ex(n){return{integerValue:""+n}}function NV(n,e){return LO(e)?Ex(e):J_(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(){this._=void 0}}function DV(n,e,t){return n instanceof Wo?function(s,i){const o={fields:{[rx]:{stringValue:nx},[ix]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&W_(i)&&(i=Qd(i)),i&&(o.fields[sx]=i),{mapValue:o}}(t,e):n instanceof Ko?Sx(n,e):n instanceof Go?Ax(n,e):function(s,i){const o=Tx(s,i),a=B0(o)+B0(s.Ae);return Bm(o)&&Bm(s.Ae)?Ex(a):J_(s.serializer,a)}(n,e)}function OV(n,e,t){return n instanceof Ko?Sx(n,e):n instanceof Go?Ax(n,e):t}function Tx(n,e){return n instanceof tu?function(r){return Bm(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Wo extends ef{}class Ko extends ef{constructor(e){super(),this.elements=e}}function Sx(n,e){const t=xx(e);for(const r of n.elements)t.some(s=>ur(s,r))||t.push(r);return{arrayValue:{values:t}}}class Go extends ef{constructor(e){super(),this.elements=e}}function Ax(n,e){let t=xx(e);for(const r of n.elements)t=t.filter(s=>!ur(s,r));return{arrayValue:{values:t}}}class tu extends ef{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function B0(n){return Fe(n.integerValue||n.doubleValue)}function xx(n){return eu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,t){this.field=e,this.transform=t}}function VV(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Ko&&s instanceof Ko||r instanceof Go&&s instanceof Go?Vo(r.elements,s.elements,ur):r instanceof tu&&s instanceof tu?ur(r.Ae,s.Ae):r instanceof Wo&&s instanceof Wo}(n.transform,e.transform)}class MV{constructor(e,t){this.version=e,this.transformResults=t}}class an{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new an}static exists(e){return new an(void 0,e)}static updateTime(e){return new an(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class tf{}function kx(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new X_(n.key,an.none()):new ia(n.key,n.data,an.none());{const t=n.data,r=Gt.empty();let s=new xe(ze.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Rs(n.key,r,new Tn(s.toArray()),an.none())}}function LV(n,e,t){n instanceof ia?function(s,i,o){const a=s.value.clone(),u=q0(s.fieldTransforms,i,o.transformResults);a.setAll(u),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Rs?function(s,i,o){if(!sh(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=q0(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(Cx(s)),u.setAll(a),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Sl(n,e,t,r){return n instanceof ia?function(i,o,a,u){if(!sh(i.precondition,o))return a;const c=i.value.clone(),d=W0(i.fieldTransforms,u,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Rs?function(i,o,a,u){if(!sh(i.precondition,o))return a;const c=W0(i.fieldTransforms,u,o),d=o.data;return d.setAll(Cx(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return sh(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function jV(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Tx(r.transform,s||null);i!=null&&(t===null&&(t=Gt.empty()),t.set(r.field,i))}return t||null}function z0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Vo(r,s,(i,o)=>VV(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ia extends tf{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Rs extends tf{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Cx(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function q0(n,e,t){const r=new Map;te(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,OV(o,a,t[s]))}return r}function W0(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,DV(i,o,e))}return r}class X_ extends tf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Rx extends tf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&LV(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Sl(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Sl(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Ix();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const u=kx(o,a);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(ie.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),_e())}isEqual(e){return this.batchId===e.batchId&&Vo(this.mutations,e.mutations,(t,r)=>z0(t,r))&&Vo(this.baseMutations,e.baseMutations,(t,r)=>z0(t,r))}}class Z_{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){te(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return kV}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Z_(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et,Ie;function UV(n){switch(n){case U.OK:return Z(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return Z(15467,{code:n})}}function Px(n){if(n===void 0)return Ut("GRPC error has no .code"),U.UNKNOWN;switch(n){case et.OK:return U.OK;case et.CANCELLED:return U.CANCELLED;case et.UNKNOWN:return U.UNKNOWN;case et.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case et.INTERNAL:return U.INTERNAL;case et.UNAVAILABLE:return U.UNAVAILABLE;case et.UNAUTHENTICATED:return U.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case et.NOT_FOUND:return U.NOT_FOUND;case et.ALREADY_EXISTS:return U.ALREADY_EXISTS;case et.PERMISSION_DENIED:return U.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case et.ABORTED:return U.ABORTED;case et.OUT_OF_RANGE:return U.OUT_OF_RANGE;case et.UNIMPLEMENTED:return U.UNIMPLEMENTED;case et.DATA_LOSS:return U.DATA_LOSS;default:return Z(39323,{code:n})}}(Ie=et||(et={}))[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $V(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV=new _s([4294967295,4294967295],0);function K0(n){const e=$V().encode(n),t=new RA;return t.update(e),new Uint8Array(t.digest())}function G0(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new _s([t,r],0),new _s([s,i],0)]}class ty{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new el(`Invalid padding: ${t}`);if(r<0)throw new el(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new el(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new el(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=_s.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(_s.fromNumber(r)));return s.compare(BV)===1&&(s=new _s([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=K0(e),[r,s]=G0(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new ty(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const t=K0(e),[r,s]=G0(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class el extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Iu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new nf(ie.min(),s,new $e(he),on(),_e())}}class Iu{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Iu(r,t,_e(),_e(),_e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class Nx{constructor(e,t){this.targetId=e,this.Ce=t}}class Dx{constructor(e,t,r=st.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class H0{constructor(){this.ve=0,this.Fe=Q0(),this.Me=st.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=_e(),t=_e(),r=_e();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Z(38017,{changeType:i})}}),new Iu(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Q0()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,te(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class zV{constructor(e){this.Ge=e,this.ze=new Map,this.je=on(),this.Je=Ic(),this.He=Ic(),this.Ye=new $e(he)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Z(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,s)=>{this.rt(s)&&t(s)})}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(rd(i))if(r===0){const o=new Q(i.path);this.et(t,o,Je.newNoDocument(o,ie.min()))}else te(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const a=this.ut(e),u=a?this.ct(a,e,o):1;if(u!==0){this.it(t);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Pr(r).toUint8Array()}catch(u){if(u instanceof tx)return wi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new ty(o,s,i)}catch(u){return wi(u instanceof el?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(t,i,null),s++)}),s}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&rd(a.target)){const u=new Q(a.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Je.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let r=_e();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.ot(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new nf(e,t,this.Ye,this.je,r);return this.je=on(),this.Je=Ic(),this.He=Ic(),this.Ye=new $e(he),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new H0,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new xe(he),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new xe(he),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||B("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new H0),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ic(){return new $e(Q.comparator)}function Q0(){return new $e(Q.comparator)}const qV={asc:"ASCENDING",desc:"DESCENDING"},WV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},KV={and:"AND",or:"OR"};class GV{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gm(n,e){return n.useProto3Json||Wd(e)?e:{value:e}}function Ho(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ox(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function HV(n,e){return Ho(n,e.toTimestamp())}function Bt(n){return te(!!n,49232),ie.fromTimestamp(function(t){const r=Rr(t);return new Se(r.seconds,r.nanos)}(n))}function ny(n,e){return Hm(n,e).canonicalString()}function Hm(n,e){const t=function(s){return new be(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Vx(n){const e=be.fromString(n);return te(qx(e),10190,{key:e.toString()}),e}function id(n,e){return ny(n.databaseId,e.path)}function ui(n,e){const t=Vx(e);if(t.get(1)!==n.databaseId.projectId)throw new J(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new J(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Q(jx(t))}function Mx(n,e){return ny(n.databaseId,e)}function Lx(n){const e=Vx(n);return e.length===4?be.emptyPath():jx(e)}function Qm(n){return new be(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function jx(n){return te(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function J0(n,e,t){return{name:id(n,e),fields:t.value.mapValue.fields}}function QV(n,e,t){const r=ui(n,e.name),s=Bt(e.updateTime),i=e.createTime?Bt(e.createTime):ie.min(),o=new Gt({mapValue:{fields:e.fields}}),a=Je.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function JV(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Z(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(te(d===void 0||typeof d=="string",58123),st.fromBase64String(d||"")):(te(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),st.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?U.UNKNOWN:Px(c.code);return new J(d,c.message||"")}(o);t=new Dx(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ui(n,r.document.name),i=Bt(r.document.updateTime),o=r.document.createTime?Bt(r.document.createTime):ie.min(),a=new Gt({mapValue:{fields:r.document.fields}}),u=Je.newFoundDocument(s,i,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];t=new ih(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ui(n,r.document),i=r.readTime?Bt(r.readTime):ie.min(),o=Je.newNoDocument(s,i),a=r.removedTargetIds||[];t=new ih([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ui(n,r.document),i=r.removedTargetIds||[];t=new ih([],i,s,null)}else{if(!("filter"in e))return Z(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new FV(s,i),a=r.targetId;t=new Nx(a,o)}}return t}function od(n,e){let t;if(e instanceof ia)t={update:J0(n,e.key,e.value)};else if(e instanceof X_)t={delete:id(n,e.key)};else if(e instanceof Rs)t={update:J0(n,e.key,e.data),updateMask:nM(e.fieldMask)};else{if(!(e instanceof Rx))return Z(16599,{Vt:e.type});t={verify:id(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Wo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ko)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Go)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof tu)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Z(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:HV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Z(27497)}(n,e.precondition)),t}function Jm(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?an.updateTime(Bt(i.updateTime)):i.exists!==void 0?an.exists(i.exists):an.none()}(e.currentDocument):an.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let u=null;if("setToServerValue"in a)te(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),u=new Wo;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];u=new Ko(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];u=new Go(d)}else"increment"in a?u=new tu(o,a.increment):Z(16584,{proto:a});const c=ze.fromServerFormat(a.fieldPath);return new bx(c,u)}(n,s)):[];if(e.update){e.update.name;const s=ui(n,e.update.name),i=new Gt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const c=u.fieldPaths||[];return new Tn(c.map(d=>ze.fromServerFormat(d)))}(e.updateMask);return new Rs(s,i,o,t,r)}return new ia(s,i,t,r)}if(e.delete){const s=ui(n,e.delete);return new X_(s,t)}if(e.verify){const s=ui(n,e.verify);return new Rx(s,t)}return Z(1463,{proto:e})}function XV(n,e){return n&&n.length>0?(te(e!==void 0,14353),n.map(t=>function(s,i){let o=s.updateTime?Bt(s.updateTime):Bt(i);return o.isEqual(ie.min())&&(o=Bt(i)),new MV(o,s.transformResults||[])}(t,e))):[]}function Fx(n,e){return{documents:[Mx(n,e.path)]}}function Ux(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Mx(n,s);const i=function(c){if(c.length!==0)return zx(ke.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(d=>function(m){return{field:Zi(m.field),direction:ZV(m.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Gm(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:t,parent:s}}function $x(n){let e=Lx(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){te(r===1,65062);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const m=Bx(f);return m instanceof ke&&Q_(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(m=>function(E){return new nd(eo(E.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Wd(m)?null:m}(t.limit));let u=null;t.startAt&&(u=function(f){const m=!!f.before,_=f.values||[];return new zo(_,m)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const m=!f.before,_=f.values||[];return new zo(_,m)}(t.endAt)),EV(e,s,o,i,a,"F",u,c)}function YV(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Z(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Bx(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=eo(t.unaryFilter.field);return we.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=eo(t.unaryFilter.field);return we.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=eo(t.unaryFilter.field);return we.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=eo(t.unaryFilter.field);return we.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Z(61313);default:return Z(60726)}}(n):n.fieldFilter!==void 0?function(t){return we.create(eo(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Z(58110);default:return Z(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ke.create(t.compositeFilter.filters.map(r=>Bx(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Z(1026)}}(t.compositeFilter.op))}(n):Z(30097,{filter:n})}function ZV(n){return qV[n]}function eM(n){return WV[n]}function tM(n){return KV[n]}function Zi(n){return{fieldPath:n.canonicalString()}}function eo(n){return ze.fromServerFormat(n.fieldPath)}function zx(n){return n instanceof we?function(t){if(t.op==="=="){if(O0(t.value))return{unaryFilter:{field:Zi(t.field),op:"IS_NAN"}};if(D0(t.value))return{unaryFilter:{field:Zi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(O0(t.value))return{unaryFilter:{field:Zi(t.field),op:"IS_NOT_NAN"}};if(D0(t.value))return{unaryFilter:{field:Zi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zi(t.field),op:eM(t.op),value:t.value}}}(n):n instanceof ke?function(t){const r=t.getFilters().map(s=>zx(s));return r.length===1?r[0]:{compositeFilter:{op:tM(t.op),filters:r}}}(n):Z(54877,{filter:n})}function nM(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function qx(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,t,r,s,i=ie.min(),o=ie.min(),a=st.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Ir(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e){this.yt=e}}function rM(n,e){let t;if(e.document)t=QV(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Q.fromSegments(e.noDocument.path),s=Si(e.noDocument.readTime);t=Je.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Z(56709);{const r=Q.fromSegments(e.unknownDocument.path),s=Si(e.unknownDocument.version);t=Je.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new Se(s[0],s[1]);return ie.fromTimestamp(i)}(e.readTime)),t}function X0(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ad(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:id(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ho(i,o.version.toTimestamp()),createTime:Ho(i,o.createTime.toTimestamp())}}(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ti(e.version)};else{if(!e.isUnknownDocument())return Z(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ti(e.version)}}return r}function ad(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ti(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Si(n){const e=new Se(n.seconds,n.nanoseconds);return ie.fromTimestamp(e)}function Hs(n,e){const t=(e.baseMutations||[]).map(i=>Jm(n.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Jm(n.yt,i)),s=Se.fromMillis(e.localWriteTimeMs);return new Y_(e.batchId,s,t,r)}function tl(n){const e=Si(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Si(n.lastLimboFreeSnapshotVersion):ie.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){const o=i.documents.length;return te(o===1,1966,{count:o}),An(Yd(Lx(i.documents[0])))}(n.query):function(i){return An($x(i))}(n.query),new Ir(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,st.fromBase64String(n.resumeToken))}function Kx(n,e){const t=Ti(e.snapshotVersion),r=Ti(e.lastLimboFreeSnapshotVersion);let s;s=rd(e.target)?Fx(n.yt,e.target):Ux(n.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ei(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Gx(n){const e=$x({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Km(e,e.limit,"L"):e}function fp(n,e){return new ey(e.largestBatchId,Jm(n.yt,e.overlayMutation))}function Y0(n,e){const t=e.path.lastSegment();return[n,Vt(e.path.popLast()),t]}function Z0(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ti(r.readTime),documentKey:Vt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{getBundleMetadata(e,t){return eI(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Si(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return eI(e).put(function(s){return{bundleId:s.id,createTime:Ti(Bt(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return tI(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:Gx(i.bundledQuery),readTime:Si(i.readTime)}}(r)})}saveNamedQuery(e,t){return tI(e).put(function(s){return{name:s.name,readTime:Ti(Bt(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function eI(n){return ht(n,Kd)}function tI(n){return ht(n,Gd)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new rf(e,r)}getOverlay(e,t){return Oa(e).get(Y0(this.userId,t)).next(r=>r?fp(this.serializer,r):null)}getOverlays(e,t){const r=nr();return D.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new ey(t,o);s.push(this.St(e,a))}),D.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(Vt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Oa(e).Z(Fm,a))}),D.waitFor(i)}getOverlaysForCollection(e,t,r){const s=nr(),i=Vt(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Oa(e).J(Fm,o).next(a=>{for(const u of a){const c=fp(this.serializer,u);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=nr();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Oa(e).ee({index:QA,range:a},(u,c,d)=>{const f=fp(this.serializer,c);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}St(e,t){return Oa(e).put(function(s,i,o){const[a,u,c]=Y0(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:od(s.yt,o.mutation)}}(this.serializer,this.userId,t))}}function Oa(n){return ht(n,Hd)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{bt(e){return ht(e,z_)}getSessionToken(e){return this.bt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?st.fromUint8Array(r):st.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Fe(e.integerValue));else if("doubleValue"in e){const r=Fe(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Hl(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Rr(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Pr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?ax(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Jd(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Z(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const s of Object.keys(r))this.Ot(s,t),this.Ct(r[s],t)}kt(e,t){var o,a;const r=e.fields||{};this.Ft(t,53);const s=$o,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(t,15),t.Mt(Fe(i)),this.Ot(s,t),this.Ct(r[s],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const s of r)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),Q.fromName(e).path.forEach(r=>{this.Ft(t,60),this.Ut(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Qs.Kt=new Qs;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi=255;function oM(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function nI(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=oM(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class aM{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),r=nI(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),r=nI(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(qi),this.sn(255)}_n(){this.an(qi),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===qi?(this.sn(qi),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===qi?(this.an(qi),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class lM{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class uM{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Va{constructor(){this.cn=new aM,this.ln=new lM(this.cn),this.hn=new uM(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,t,r,s){this.Tn=e,this.In=t,this.En=r,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Js(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:oh(this.En),directionalValue:oh(this.dn),orderedDocumentKey:oh(t),documentKey:r.path.toArray()}}Vn(e,t,r){const s=this.Rn(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Kr(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=rI(n.En,e.En),t!==0?t:(t=rI(n.dn,e.dn),t!==0?t:Q.comparator(n.In,e.In)))}function rI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function oh(n){return W1()?function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r}(n):n}function sI(n){return typeof n!="string"?n:function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(n)}class iI{constructor(e){this.mn=new xe((t,r)=>ze.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(te(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Mm(e);if(t!==void 0&&!this.wn(t))return!1;const r=qs(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const u=r[i];if(!this.Sn(a,u)||!this.bn(this.fn[o++],u))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new xe(ze.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Yc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Yc(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Yc(r.field,r.dir==="asc"?0:1)));return new Xh(Xh.UNKNOWN_ID,this.collectionId,t,Gl.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hx(n){var t,r;if(te(n instanceof we||n instanceof ke,20012),n instanceof we){if(n instanceof gx){const s=((r=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:r.map(i=>we.create(n.field,"==",i)))||[];return ke.create(s,"or")}return n}const e=n.filters.map(s=>Hx(s));return ke.create(e,n.op)}function cM(n){if(n.getFilters().length===0)return[];const e=Zm(Hx(n));return te(Qx(e),7391),Xm(e)||Ym(e)?[e]:e.getFilters()}function Xm(n){return n instanceof we}function Ym(n){return n instanceof ke&&Q_(n)}function Qx(n){return Xm(n)||Ym(n)||function(t){if(t instanceof ke&&zm(t)){for(const r of t.getFilters())if(!Xm(r)&&!Ym(r))return!1;return!0}return!1}(n)}function Zm(n){if(te(n instanceof we||n instanceof ke,34018),n instanceof we)return n;if(n.filters.length===1)return Zm(n.filters[0]);const e=n.filters.map(r=>Zm(r));let t=ke.create(e,n.op);return t=ld(t),Qx(t)?t:(te(t instanceof ke,64498),te(qo(t),40251),te(t.filters.length>1,57927),t.filters.reduce((r,s)=>ry(r,s)))}function ry(n,e){let t;return te(n instanceof we||n instanceof ke,38388),te(e instanceof we||e instanceof ke,25473),t=n instanceof we?e instanceof we?function(s,i){return ke.create([s,i],"and")}(n,e):oI(n,e):e instanceof we?oI(e,n):function(s,i){if(te(s.filters.length>0&&i.filters.length>0,48005),qo(s)&&qo(i))return fx(s,i.getFilters());const o=zm(s)?s:i,a=zm(s)?i:s,u=o.filters.map(c=>ry(c,a));return ke.create(u,"or")}(n,e),ld(t)}function oI(n,e){if(qo(e))return fx(e,n.getFilters());{const t=e.filters.map(r=>ry(n,r));return ke.create(t,"or")}}function ld(n){if(te(n instanceof we||n instanceof ke,11850),n instanceof we)return n;const e=n.getFilters();if(e.length===1)return ld(e[0]);if(hx(n))return n;const t=e.map(s=>ld(s)),r=[];return t.forEach(s=>{s instanceof we?r.push(s):s instanceof ke&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:ke.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(){this.Cn=new sy}addToCollectionParentIndex(e,t){return this.Cn.add(t),D.resolve()}getCollectionParents(e,t){return D.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return D.resolve()}deleteFieldIndex(e,t){return D.resolve()}deleteAllFieldIndexes(e){return D.resolve()}createTargetIndexes(e,t){return D.resolve()}getDocumentsMatchingTarget(e,t){return D.resolve(null)}getIndexType(e,t){return D.resolve(0)}getFieldIndexes(e,t){return D.resolve([])}getNextCollectionGroupToUpdate(e){return D.resolve(null)}getMinOffset(e,t){return D.resolve(hn.min())}getMinOffsetFromCollectionGroup(e,t){return D.resolve(hn.min())}updateCollectionGroup(e,t,r){return D.resolve()}updateIndexEntries(e,t){return D.resolve()}}class sy{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new xe(be.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new xe(be.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI="IndexedDbIndexManager",Ec=new Uint8Array(0);class dM{constructor(e,t){this.databaseId=t,this.vn=new sy,this.Fn=new Or(r=>Ei(r),(r,s)=>vu(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const i={collectionId:r,parent:Vt(s)};return lI(e).put(i)}return D.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[jA(t),""],!1,!0);return lI(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(tr(o.parent))}return r})}addFieldIndex(e,t){const r=Ma(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=Ki(e);return i.next(a=>{o.put(Z0(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=Ma(e),s=Ki(e),i=Wi(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Ma(e),r=Wi(e),s=Ki(e);return t.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,t){return D.forEach(this.Mn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new iI(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=Wi(e);let s=!0;const i=new Map;return D.forEach(this.Mn(t),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=_e();const a=[];return D.forEach(i,(u,c)=>{B(aI,`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(R=>`${R.fieldPath}:${R.kind}`).join(",")}`}(u)} to execute ${Ei(t)}`);const d=function(S,R){const j=Mm(R);if(j===void 0)return null;for(const M of sd(S,j.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(c,u),f=function(S,R){const j=new Map;for(const M of qs(R))for(const w of sd(S,M.fieldPath))switch(w.op){case"==":case"in":j.set(M.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return j.set(M.fieldPath.canonicalString(),w.value),Array.from(j.values())}return null}(c,u),m=function(S,R){const j=[];let M=!0;for(const w of qs(R)){const v=w.kind===0?F0(S,w.fieldPath,S.startAt):U0(S,w.fieldPath,S.startAt);j.push(v.value),M&&(M=v.inclusive)}return new zo(j,M)}(c,u),_=function(S,R){const j=[];let M=!0;for(const w of qs(R)){const v=w.kind===0?U0(S,w.fieldPath,S.endAt):F0(S,w.fieldPath,S.endAt);j.push(v.value),M&&(M=v.inclusive)}return new zo(j,M)}(c,u),E=this.On(u,c,m),k=this.On(u,c,_),N=this.Nn(u,c,f),x=this.Bn(u.indexId,d,E,m.inclusive,k,_.inclusive,N);return D.forEach(x,y=>r.Y(y,t.limit).next(S=>{S.forEach(R=>{const j=Q.fromSegments(R.documentKey);o.has(j)||(o=o.add(j),a.push(j))})}))}).next(()=>a)}return D.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=cM(ke.create(e.filters,"and")).map(r=>Wm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,r,s,i,o,a){const u=(t!=null?t.length:1)*Math.max(r.length,i.length),c=u/(t!=null?t.length:1),d=[];for(let f=0;f<u;++f){const m=t?this.Ln(t[f/c]):Ec,_=this.kn(e,m,r[f%c],s),E=this.qn(e,m,i[f%c],o),k=a.map(N=>this.kn(e,m,N,!0));d.push(...this.createRange(_,E,k))}return d}kn(e,t,r,s){const i=new Js(e,Q.empty(),t,r);return s?i:i.An()}qn(e,t,r,s){const i=new Js(e,Q.empty(),t,r);return s?i.An():i}xn(e,t){const r=new iI(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.Mn(t);return D.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new xe(ze.comparator),d=!1;for(const f of u.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:c=c.add(m.field));for(const f of u.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Qn(e,t){const r=new Va;for(const s of qs(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);Qs.Kt.Dt(i,o)}return r.un()}Ln(e){const t=new Va;return Qs.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Va;return Qs.Kt.Dt(H_(this.databaseId,t),r.Pn(function(i){const o=qs(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,t,r){if(r===null)return[];let s=[];s.push(new Va);let i=0;for(const o of qs(e)){const a=r[i++];for(const u of s)if(this.Un(t,o.fieldPath)&&eu(a))s=this.Kn(s,o,a);else{const c=u.Pn(o.kind);Qs.Kt.Dt(a,c)}}return this.Wn(s)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const u=new Va;u.seed(a.un()),Qs.Kt.Dt(o,u.Pn(t.kind)),i.push(u)}return i}Un(e,t){return!!e.filters.find(r=>r instanceof we&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Ma(e),s=Ki(e);return(t?r.J(jm,IDBKeyRange.bound(t,t)):r.J()).next(i=>{const o=[];return D.forEach(i,a=>s.get([a.indexId,this.uid]).next(u=>{o.push(function(d,f){const m=f?new Gl(f.sequenceNumber,new hn(Si(f.readTime),new Q(tr(f.documentKey)),f.largestBatchId)):Gl.empty(),_=d.fields.map(([E,k])=>new Yc(ze.fromServerFormat(E),k));return new Xh(d.indexId,d.collectionGroup,_,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:he(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=Ma(e),i=Ki(e);return this.Gn(e).next(o=>s.J(jm,IDBKeyRange.bound(t,t)).next(a=>D.forEach(a,u=>i.put(Z0(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return D.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?D.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),D.forEach(a,u=>this.zn(e,s,u).next(c=>{const d=this.jn(i,u);return c.isEqual(d)?D.resolve():this.Jn(e,i,u,c,d)}))))})}Hn(e,t,r,s){return Wi(e).put(s.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,s){return Wi(e).delete(s.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const s=Wi(e);let i=new xe(Kr);return s.ee({index:HA,range:IDBKeyRange.only([r.indexId,this.uid,oh(this.$n(r,t))])},(o,a)=>{i=i.add(new Js(r.indexId,t,sI(a.arrayValue),sI(a.directionalValue)))}).next(()=>i)}jn(e,t){let r=new xe(Kr);const s=this.Qn(t,e);if(s==null)return r;const i=Mm(t);if(i!=null){const o=e.data.field(i.fieldPath);if(eu(o))for(const a of o.arrayValue.values||[])r=r.add(new Js(t.indexId,e.key,this.Ln(a),s))}else r=r.add(new Js(t.indexId,e.key,Ec,s));return r}Jn(e,t,r,s,i){B(aI,"Updating index entries for document '%s'",t.key);const o=[];return function(u,c,d,f,m){const _=u.getIterator(),E=c.getIterator();let k=zi(_),N=zi(E);for(;k||N;){let x=!1,y=!1;if(k&&N){const S=d(k,N);S<0?y=!0:S>0&&(x=!0)}else k!=null?y=!0:x=!0;x?(f(N),N=zi(E)):y?(m(k),k=zi(_)):(k=zi(_),N=zi(E))}}(s,i,Kr,a=>{o.push(this.Hn(e,t,r,a))},a=>{o.push(this.Yn(e,t,r,a))}),D.waitFor(o)}Gn(e){let t=1;return Ki(e).ee({index:GA,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Kr(o,a)).filter((o,a,u)=>!a||Kr(o,u[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Kr(o,e),u=Kr(o,t);if(a===0)s[0]=e.An();else if(a>0&&u<0)s.push(o),s.push(o.An());else if(u>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,Ec,Q.empty()),u=s[o+1].Vn(this.uid,Ec,Q.empty());i.push(IDBKeyRange.bound(a,u))}return i}Zn(e,t){return Kr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(uI)}getMinOffset(e,t){return D.mapArray(this.Mn(t),r=>this.xn(e,r).next(s=>s||Z(44426))).next(uI)}}function lI(n){return ht(n,Xl)}function Wi(n){return ht(n,wl)}function Ma(n){return ht(n,B_)}function Ki(n){return ht(n,vl)}function uI(n){te(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;F_(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new hn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Jx=41943040;class Dt{static withCacheSize(e){return new Dt(e,Dt.DEFAULT_COLLECTION_PERCENTILE,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xx(n,e,t){const r=n.store(Vn),s=n.store(Lo),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=r.ee({range:o},(d,f,m)=>(a++,m.delete()));i.push(u.next(()=>{te(a===1,47070,{batchId:t.batchId})}));const c=[];for(const d of t.mutations){const f=qA(e,d.key.path,t.batchId);i.push(s.delete(f)),c.push(d.key)}return D.waitFor(i).next(()=>c)}function ud(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Z(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dt.DEFAULT_COLLECTION_PERCENTILE=10,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dt.DEFAULT=new Dt(Jx,Dt.DEFAULT_COLLECTION_PERCENTILE,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dt.DISABLED=new Dt(-1,0,0);class sf{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,t,r,s){te(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new sf(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gr(e).ee({index:ri,range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=to(e),o=Gr(e);return o.add({}).next(a=>{te(typeof a=="number",49019);const u=new Y_(a,t,r,s),c=function(_,E,k){const N=k.baseMutations.map(y=>od(_.yt,y)),x=k.mutations.map(y=>od(_.yt,y));return{userId:E,batchId:k.batchId,localWriteTimeMs:k.localWriteTime.toMillis(),baseMutations:N,mutations:x}}(this.serializer,this.userId,u),d=[];let f=new xe((m,_)=>he(m.canonicalString(),_.canonicalString()));for(const m of s){const _=qA(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),d.push(o.put(c)),d.push(i.put(_,UO))}return f.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=u.keys()}),D.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return Gr(e).get(t).next(r=>r?(te(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Hs(this.serializer,r)):null)}er(e,t){return this.Xn[t]?D.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Xn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Gr(e).ee({index:ri,range:s},(o,a,u)=>{a.userId===this.userId&&(te(a.batchId>=r,47524,{tr:r}),i=Hs(this.serializer,a)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=ai;return Gr(e).ee({index:ri,range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ai],[this.userId,Number.POSITIVE_INFINITY]);return Gr(e).J(ri,t).next(r=>r.map(s=>Hs(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Zc(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return to(e).ee({range:s},(o,a,u)=>{const[c,d,f]=o,m=tr(d);if(c===this.userId&&t.path.isEqual(m))return Gr(e).get(f).next(_=>{if(!_)throw Z(61480,{nr:o,batchId:f});te(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:f}),i.push(Hs(this.serializer,_))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new xe(he);const s=[];return t.forEach(i=>{const o=Zc(this.userId,i.path),a=IDBKeyRange.lowerBound(o),u=to(e).ee({range:a},(c,d,f)=>{const[m,_,E]=c,k=tr(_);m===this.userId&&i.path.isEqual(k)?r=r.add(E):f.done()});s.push(u)}),D.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=Zc(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new xe(he);return to(e).ee({range:o},(u,c,d)=>{const[f,m,_]=u,E=tr(m);f===this.userId&&r.isPrefixOf(E)?E.length===s&&(a=a.add(_)):d.done()}).next(()=>this.rr(e,a))}rr(e,t){const r=[],s=[];return t.forEach(i=>{s.push(Gr(e).get(i).next(o=>{if(o===null)throw Z(35274,{batchId:i});te(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(Hs(this.serializer,o))}))}),D.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return Xx(e.le,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),D.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return D.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return to(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const u=tr(i[1]);s.push(u)}else a.done()}).next(()=>{te(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,t){return Yx(e,this.userId,t)}_r(e){return Zx(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:ai,lastStreamToken:""})}}function Yx(n,e,t){const r=Zc(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return to(n).ee({range:i,X:!0},(a,u,c)=>{const[d,f,m]=a;d===e&&f===s&&(o=!0),c.done()}).next(()=>o)}function Gr(n){return ht(n,Vn)}function to(n){return ht(n,Lo)}function Zx(n){return ht(n,Ql)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ai(0)}static cr(){return new Ai(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const r=new Ai(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(t=>ie.fromTimestamp(new Se(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Gi(e).delete(t.targetId)).next(()=>this.lr(e)).next(r=>(te(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return Gi(e).ee((o,a)=>{const u=tl(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(s++,i.push(this.removeTargetData(e,u)))}).next(()=>D.waitFor(i)).next(()=>s)}forEachTarget(e,t){return Gi(e).ee((r,s)=>{const i=tl(s);t(i)})}lr(e){return hI(e).get(ed).next(t=>(te(t!==null,2888),t))}hr(e,t){return hI(e).put(ed,t)}Pr(e,t){return Gi(e).put(Kx(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Ei(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Gi(e).ee({range:s,index:KA},(o,a,u)=>{const c=tl(a);vu(t,c.target)&&(i=c,u.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=ns(e);return t.forEach(o=>{const a=Vt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),D.waitFor(s)}removeMatchingKeys(e,t,r){const s=ns(e);return D.forEach(t,i=>{const o=Vt(i.path);return D.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=ns(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=ns(e);let i=_e();return s.ee({range:r,X:!0},(o,a,u)=>{const c=tr(o[1]),d=new Q(c);i=i.add(d)}).next(()=>i)}containsKey(e,t){const r=Vt(t.path),s=IDBKeyRange.bound([r],[jA(r)],!1,!0);let i=0;return ns(e).ee({index:$_,X:!0,range:s},([o,a],u,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}At(e,t){return Gi(e).get(t).next(r=>r?tl(r):null)}}function Gi(n){return ht(n,jo)}function hI(n){return ht(n,li)}function ns(n){return ht(n,Fo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI="LruGarbageCollector",pM=1048576;function fI([n,e],[t,r]){const s=he(n,t);return s===0?he(e,r):s}class mM{constructor(e){this.Ir=e,this.buffer=new xe(fI),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();fI(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class eb{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){B(dI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Cs(t)?B(dI,"Ignoring IndexedDB error during garbage collection: ",t):await Ci(t)}await this.Vr(3e5)})}}class gM{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return D.resolve(En.ce);const r=new mM(t);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(B("LruGarbageCollector","Garbage collection skipped; disabled"),D.resolve(cI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cI):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,o,a,u,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),Xi()<=ve.DEBUG&&B("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(u-a)+`ms
	Removed ${f} documents in `+(c-u)+`ms
Total Duration: ${c-d}ms`),D.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function tb(n,e){return new gM(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(e,t){this.db=e,this.garbageCollector=tb(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(r,s)=>t(s))}addReference(e,t,r){return Tc(e,r)}removeReference(e,t,r){return Tc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Tc(e,t)}br(e,t){return function(s,i){let o=!1;return Zx(s).te(a=>Yx(s,a,i).next(u=>(u&&(o=!0),D.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=t){const u=this.br(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ie.min()),ns(e).delete(function(f){return[0,Vt(f.path)]}(o))))});s.push(u)}}).next(()=>D.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Tc(e,t)}Sr(e,t){const r=ns(e);let s,i=En.ce;return r.ee({index:$_},([o,a],{path:u,sequenceNumber:c})=>{o===0?(i!==En.ce&&t(new Q(tr(s)),i),i=c,s=u):i=En.ce}).next(()=>{i!==En.ce&&t(new Q(tr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Tc(n,e){return ns(n).put(function(r,s){return{targetId:0,path:Vt(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(){this.changes=new Or(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Je.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?D.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Fs(e).put(r)}removeEntry(e,t,r){return Fs(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ad(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Dr(e,r)))}getEntry(e,t){let r=Je.newInvalidDocument(t);return Fs(e).ee({index:eh,range:IDBKeyRange.only(La(t))},(s,i)=>{r=this.Cr(t,i)}).next(()=>r)}vr(e,t){let r={size:0,document:Je.newInvalidDocument(t)};return Fs(e).ee({index:eh,range:IDBKeyRange.only(La(t))},(s,i)=>{r={document:this.Cr(t,i),size:ud(i)}}).next(()=>r)}getEntries(e,t){let r=on();return this.Fr(e,t,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,t){let r=on(),s=new $e(Q.comparator);return this.Fr(e,t,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,ud(o))}).next(()=>({documents:r,Or:s}))}Fr(e,t,r){if(t.isEmpty())return D.resolve();let s=new xe(gI);t.forEach(u=>s=s.add(u));const i=IDBKeyRange.bound(La(s.first()),La(s.last())),o=s.getIterator();let a=o.getNext();return Fs(e).ee({index:eh,range:i},(u,c,d)=>{const f=Q.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&gI(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.j(La(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),ad(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fs(e).J(IDBKeyRange.bound(a,u,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let d=on();for(const f of c){const m=this.Cr(Q.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(wu(t,m)||s.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,t,r,s){let i=on();const o=mI(t,r),a=mI(t,hn.max());return Fs(e).ee({index:WA,range:IDBKeyRange.bound(o,a,!0)},(u,c,d)=>{const f=this.Cr(Q.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(f.key,f),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new vM(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return pI(e).get(Lm).next(t=>(te(!!t,20021),t))}Dr(e,t){return pI(e).put(Lm,t)}Cr(e,t){if(t){const r=rM(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ie.min())))return r}return Je.newInvalidDocument(e)}}function rb(n){return new yM(n)}class vM extends nb{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Or(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new xe((i,o)=>he(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(t.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const u=X0(this.Nr.serializer,o);s=s.add(i.path.popLast());const c=ud(u);r+=c-a.size,t.push(this.Nr.addEntry(e,i,u))}else if(r-=a.size,this.trackRemovals){const u=X0(this.Nr.serializer,o.convertToNoDocument(ie.min()));t.push(this.Nr.addEntry(e,i,u))}}),s.forEach(i=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.Nr.updateMetadata(e,r)),D.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function pI(n){return ht(n,Jl)}function Fs(n){return ht(n,Zh)}function La(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function mI(n,e){const t=e.documentKey.path.toArray();return[n,ad(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function gI(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=he(t[i],r[i]),s)return s;return s=he(t.length,r.length),s||(s=he(t[t.length-2],r[r.length-2]),s||he(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Sl(r.mutation,s,Tn.empty(),Se.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,_e()).next(()=>r))}getLocalViewOfDocuments(e,t,r=_e()){const s=nr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Za();return i.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=nr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,_e()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=on();const o=Tl(),a=function(){return Tl()}();return t.forEach((u,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof Rs)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Sl(d.mutation,c,d.mutation.getFieldMask(),Se.now())):o.set(c.key,Tn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,d)=>o.set(c,d)),t.forEach((c,d)=>a.set(c,new wM(d,o.get(c)??null))),a))}recalculateAndSaveOverlays(e,t){const r=Tl();let s=new $e((o,a)=>o-a),i=_e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=t.get(u);if(c===null)return;let d=r.get(u)||Tn.empty();d=a.applyToLocalView(c,d),r.set(u,d);const f=(s.get(a.batchId)||_e()).add(u);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,d=u.value,f=Ix();d.forEach(m=>{if(!i.has(m)){const _=kx(t.get(m),r.get(m));_!==null&&f.set(m,_),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return D.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return Q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):TV(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):D.resolve(nr());let a=Kl,u=i;return o.next(c=>D.forEach(c,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?D.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,_e())).next(d=>({batchId:a,changes:wx(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Q(t)).next(r=>{let s=Za();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Za();return this.indexManager.getCollectionParents(e,i).next(a=>D.forEach(a,u=>{const c=function(f,m){return new Xd(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((u,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,Je.newInvalidDocument(d)))});let a=Za();return o.forEach((u,c)=>{const d=i.get(u);d!==void 0&&Sl(d.mutation,c,Tn.empty(),Se.now()),wu(t,c)&&(a=a.insert(u,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return D.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Bt(s.createTime)}}(t)),D.resolve()}getNamedQuery(e,t){return D.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(s){return{name:s.name,query:Gx(s.bundledQuery),readTime:Bt(s.readTime)}}(t)),D.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EM{constructor(){this.overlays=new $e(Q.comparator),this.qr=new Map}getOverlay(e,t){return D.resolve(this.overlays.get(t))}getOverlays(e,t){const r=nr();return D.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.St(e,t,i)}),D.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),D.resolve()}getOverlaysForCollection(e,t,r){const s=nr(),i=t.length+1,o=new Q(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return D.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new $e((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=nr(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=nr(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return D.resolve(a)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new ey(t,r));let i=this.qr.get(t);i===void 0&&(i=_e(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{constructor(){this.sessionToken=st.EMPTY_BYTE_STRING}getSessionToken(e){return D.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,D.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(){this.Qr=new xe(gt.$r),this.Ur=new xe(gt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new gt(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new gt(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){const t=new Q(new be([])),r=new gt(t,e),s=new gt(t,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Q(new be([])),r=new gt(t,e),s=new gt(t,e+1);let i=_e();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new gt(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class gt{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Q.comparator(e.key,t.key)||he(e.Yr,t.Yr)}static Kr(e,t){return he(e.Yr,t.Yr)||Q.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new xe(gt.$r)}checkEmpty(e){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Y_(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new gt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return D.resolve(o)}lookupMutationBatch(e,t){return D.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return D.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?ai:this.tr-1)}getAllMutationBatches(e){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new gt(t,0),s=new gt(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),D.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new xe(he);return t.forEach(s=>{const i=new gt(s,0),o=new gt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),D.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;Q.isDocumentKey(i)||(i=i.child(""));const o=new gt(new Q(i),0);let a=new xe(he);return this.Zr.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(u.Yr)),!0)},o),D.resolve(this.ti(a))}ti(e){const t=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){te(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return D.forEach(t.mutations,s=>{const i=new gt(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){const r=new gt(t,0),s=this.Zr.firstAfterOrEqual(r);return D.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,D.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{constructor(e){this.ri=e,this.docs=function(){return new $e(Q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return D.resolve(r?r.document.mutableCopy():Je.newInvalidDocument(t))}getEntries(e,t){let r=on();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Je.newInvalidDocument(s))}),D.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=on();const o=t.path,a=new Q(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||F_(UA(d),r)<=0||(s.has(d.key)||wu(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return D.resolve(i)}getAllFromCollectionGroup(e,t,r,s){Z(9500)}ii(e,t){return D.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new xM(this)}getSize(e){return D.resolve(this.size)}}class xM extends nb{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),D.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(e){this.persistence=e,this.si=new Or(t=>Ei(t),vu),this.lastRemoteSnapshotVersion=ie.min(),this.highestTargetId=0,this.oi=0,this._i=new iy,this.targetCount=0,this.ai=Ai.ur()}forEachTarget(e,t){return this.si.forEach((r,s)=>t(s)),D.resolve()}getLastRemoteSnapshotVersion(e){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return D.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),D.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ai(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,D.resolve()}updateTargetData(e,t){return this.Pr(t),D.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,D.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),D.waitFor(i).next(()=>s)}getTargetCount(e){return D.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return D.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),D.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),D.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),D.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return D.resolve(r)}containsKey(e,t){return D.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e,t){this.ui={},this.overlays={},this.ci=new En(0),this.li=!1,this.li=!0,this.hi=new TM,this.referenceDelegate=e(this),this.Pi=new bM(this),this.indexManager=new hM,this.remoteDocumentCache=function(s){return new AM(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new Wx(t),this.Ii=new IM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new EM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new SM(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){B("MemoryPersistence","Starting transaction:",e);const s=new kM(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,t){return D.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}}class kM extends BA{constructor(e){super(),this.currentSequenceNumber=e}}class of{constructor(e){this.persistence=e,this.Ri=new iy,this.Vi=null}static mi(e){return new of(e)}get fi(){if(this.Vi)return this.Vi;throw Z(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),D.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),D.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),D.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.fi,r=>{const s=Q.fromPath(r);return this.gi(e,s).next(i=>{i||t.removeEntry(s,ie.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return D.or([()=>D.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class cd{constructor(e,t){this.persistence=e,this.pi=new Or(r=>Vt(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=tb(this,t)}static mi(e,t){return new cd(e,t)}Ei(){}di(e){return D.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return D.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?D.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,t).next(a=>{a||(r++,i.removeEntry(o,ie.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),D.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),D.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),D.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),D.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=nh(e.data.value)),t}br(e,t,r){return D.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return D.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{constructor(e){this.serializer=e}k(e,t,r,s){const i=new qd("createOrUpgrade",t);r<1&&s>=1&&(function(u){u.createObjectStore(yu)}(e),function(u){u.createObjectStore(Ql,{keyPath:FO}),u.createObjectStore(Vn,{keyPath:b0,autoIncrement:!0}).createIndex(ri,k0,{unique:!0}),u.createObjectStore(Lo)}(e),_I(e),function(u){u.createObjectStore(Ws)}(e));let o=D.resolve();return r<3&&s>=3&&(r!==0&&(function(u){u.deleteObjectStore(Fo),u.deleteObjectStore(jo),u.deleteObjectStore(li)}(e),_I(e)),o=o.next(()=>function(u){const c=u.store(li),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ie.min().toTimestamp(),targetCount:0};return c.put(ed,d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store(Vn).J().next(f=>{u.deleteObjectStore(Vn),u.createObjectStore(Vn,{keyPath:b0,autoIncrement:!0}).createIndex(ri,k0,{unique:!0});const m=c.store(Vn),_=f.map(E=>m.put(E));return D.waitFor(_)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore(Uo,{keyPath:HO})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(u){u.createObjectStore(Jl)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(u){u.createObjectStore(Kd,{keyPath:QO})})(e),function(u){u.createObjectStore(Gd,{keyPath:JO})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(u){const c=u.createObjectStore(Hd,{keyPath:rV});c.createIndex(Fm,sV,{unique:!1}),c.createIndex(QA,iV,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(u){const c=u.createObjectStore(Zh,{keyPath:$O});c.createIndex(eh,BO),c.createIndex(WA,zO)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(Ws))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(u){u.createObjectStore(B_,{keyPath:XO,autoIncrement:!0}).createIndex(jm,YO,{unique:!1}),u.createObjectStore(vl,{keyPath:ZO}).createIndex(GA,eV,{unique:!1}),u.createObjectStore(wl,{keyPath:tV}).createIndex(HA,nV,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore(vl).clear()}).next(()=>{t.objectStore(wl).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(u){u.createObjectStore(z_,{keyPath:oV})})(e)})),r<18&&s>=18&&W1()&&(o=o.next(()=>{t.objectStore(vl).clear()}).next(()=>{t.objectStore(wl).clear()})),o}wi(e){let t=0;return e.store(Ws).ee((r,s)=>{t+=ud(s)}).next(()=>{const r={byteSize:t};return e.store(Jl).put(Lm,r)})}yi(e){const t=e.store(Ql),r=e.store(Vn);return t.J().next(s=>D.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,ai],[i.userId,i.lastAcknowledgedBatchId]);return r.J(ri,o).next(a=>D.forEach(a,u=>{te(u.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const c=Hs(this.serializer,u);return Xx(e,i.userId,c).next(()=>{})}))}))}Si(e){const t=e.store(Fo),r=e.store(Ws);return e.store(li).get(ed).next(s=>{const i=[];return r.ee((o,a)=>{const u=new be(o),c=function(f){return[0,Vt(f)]}(u);i.push(t.get(c).next(d=>d?D.resolve():(f=>t.put({targetId:0,path:Vt(f),sequenceNumber:s.highestListenSequenceNumber}))(u)))}).next(()=>D.waitFor(i))})}bi(e,t){e.createObjectStore(Xl,{keyPath:GO});const r=t.store(Xl),s=new sy,i=o=>{if(s.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Vt(u)})}};return t.store(Ws).ee({X:!0},(o,a)=>{const u=new be(o);return i(u.popLast())}).next(()=>t.store(Lo).ee({X:!0},([o,a,u],c)=>{const d=tr(a);return i(d.popLast())}))}Di(e){const t=e.store(jo);return t.ee((r,s)=>{const i=tl(s),o=Kx(this.serializer,i);return t.put(o)})}Ci(e,t){const r=t.store(Ws),s=[];return r.ee((i,o)=>{const a=t.store(Zh),u=function(f){return f.document?new Q(be.fromString(f.document.name).popFirst(5)):f.noDocument?Q.fromSegments(f.noDocument.path):f.unknownDocument?Q.fromSegments(f.unknownDocument.path):Z(36783)}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>D.waitFor(s))}Fi(e,t){const r=t.store(Vn),s=rb(this.serializer),i=new oy(of.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(u=>{let c=a.get(u.userId)??_e();Hs(this.serializer,u).keys().forEach(d=>c=c.add(d)),a.set(u.userId,c)}),D.forEach(a,(u,c)=>{const d=new St(c),f=rf.wt(this.serializer,d),m=i.getIndexManager(d),_=sf.wt(d,this.serializer,m,i.referenceDelegate);return new sb(s,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Um(t,En.ce),u).next()})})}}function _I(n){n.createObjectStore(Fo,{keyPath:WO}).createIndex($_,KO,{unique:!0}),n.createObjectStore(jo,{keyPath:"targetId"}).createIndex(KA,qO,{unique:!0}),n.createObjectStore(li)}const Hr="IndexedDbPersistence",pp=18e5,mp=5e3,gp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",RM="main";class ay{constructor(e,t,r,s,i,o,a,u,c,d,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=c,this.Oi=d,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!ay.v())throw new J(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new _M(this,s),this.$i=t+RM,this.serializer=new Wx(u),this.Ui=new ys(this.$i,this.Ni,new CM(this.serializer)),this.hi=new iM,this.Pi=new fM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=rb(this.serializer),this.Ii=new sM,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&Ut(Hr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new J(U.FAILED_PRECONDITION,gp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new En(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Sc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(Cs(e))return B(Hr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return B(Hr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return ja(e).get(Bi).next(t=>D.resolve(this.es(t)))}ts(e){return Sc(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,pp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=ht(t,Uo);return r.J().next(s=>{const i=this.ss(s,pp),o=s.filter(a=>i.indexOf(a)===-1);return D.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?D.resolve(!0):ja(e).get(Bi).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,mp)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new J(U.FAILED_PRECONDITION,gp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Sc(e).J().next(r=>this.ss(r,mp).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&B(Hr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[yu,Uo],e=>{const t=new Um(e,En.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Sc(e).J().next(t=>this.ss(t,pp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return sf.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new dM(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return rf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){B(Hr,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(u){return u===18?uV:u===17?ZA:u===16?lV:u===15?q_:u===14?YA:u===13?XA:u===12?aV:u===11?JA:void Z(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new Um(a,this.ci?this.ci.next():En.ce),t==="readwrite-primary"?this.Hi(o).next(u=>!!u||this.Yi(o)).next(u=>{if(!u)throw Ut(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new J(U.FAILED_PRECONDITION,$A);return r(o)}).next(u=>this.Xi(o).next(()=>u)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return ja(e).get(Bi).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,mp)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new J(U.FAILED_PRECONDITION,gp)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ja(e).put(Bi,t)}static v(){return ys.v()}Zi(e){const t=ja(e);return t.get(Bi).next(r=>this.es(r)?(B(Hr,"Releasing primary lease."),t.delete(Bi)):D.resolve())}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ut(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;q1()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const r=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return B(Hr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ut(Hr,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ut("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ja(n){return ht(n,yu)}function Sc(n){return ht(n,Uo)}function PM(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=_e(),s=_e();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ly(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return q1()?8:zA(ct())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new NM;return this.Ss(e,t,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,t,o,a.size)})}).next(()=>i.result)}bs(e,t,r,s){return r.documentReadCount<this.fs?(Xi()<=ve.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",Yi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),D.resolve()):(Xi()<=ve.DEBUG&&B("QueryEngine","Query:",Yi(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Xi()<=ve.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",Yi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,An(t))):D.resolve())}ys(e,t){if($0(t))return D.resolve(null);let r=An(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Km(t,null,"F"),r=An(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=_e(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.Ds(t,a);return this.Cs(t,c,o,u.readTime)?this.ys(e,Km(t,null,"F")):this.vs(e,c,t,u)}))})))}ws(e,t,r,s){return $0(t)||s.isEqual(ie.min())?D.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,r,s)?D.resolve(null):(Xi()<=ve.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Yi(t)),this.vs(e,o,t,NO(s,Kl)).next(a=>a))})}Ds(e,t){let r=new xe(yx(e));return t.forEach((s,i)=>{wu(e,i)&&(r=r.add(i))}),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return Xi()<=ve.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",Yi(t)),this.ps.getDocumentsMatchingQuery(e,t,hn.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="LocalStore",DM=3e8;class OM{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new $e(he),this.xs=new Or(i=>Ei(i),vu),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sb(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function ob(n,e,t,r){return new OM(n,e,t,r)}async function ab(n,e){const t=de(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let u=_e();for(const c of s){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of i){a.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:a}))})})}function VM(n,e){const t=de(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(a,u,c,d){const f=c.batch,m=f.keys();let _=D.resolve();return m.forEach(E=>{_=_.next(()=>d.getEntry(u,E)).next(k=>{const N=c.docVersions.get(E);te(N!==null,48541),k.version.compareTo(N)<0&&(f.applyToRemoteDocument(k,c),k.isValidDocument()&&(k.setReadTime(c.commitVersion),d.addEntry(k)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(u,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=_e();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function lb(n){const e=de(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function MM(n,e){const t=de(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const a=[];e.targetChanges.forEach((d,f)=>{const m=s.get(f);if(!m)return;a.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Pi.addMatchingKeys(i,d.addedDocuments,f)));let _=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(st.EMPTY_BYTE_STRING,ie.min()).withLastLimboFreeSnapshotVersion(ie.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),s=s.insert(f,_),function(k,N,x){return k.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=DM?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(m,_,d)&&a.push(t.Pi.updateTargetData(i,_))});let u=on(),c=_e();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(LM(i,o,e.documentUpdates).next(d=>{u=d.ks,c=d.qs})),!r.isEqual(ie.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next(f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return D.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(t.Ms=s,i))}function LM(n,e,t){let r=_e(),s=_e();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=on();return t.forEach((a,u)=>{const c=i.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),u.isNoDocument()&&u.version.isEqual(ie.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):B(uy,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{ks:o,qs:s}})}function jM(n,e){const t=de(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ai),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function FM(n,e){const t=de(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Pi.getTargetData(r,e).next(i=>i?(s=i,D.resolve(s)):t.Pi.allocateTargetId(r).next(o=>(s=new Ir(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function eg(n,e,t){const r=de(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Cs(o))throw o;B(uy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function yI(n,e,t){const r=de(n);let s=ie.min(),i=_e();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,d){const f=de(u),m=f.xs.get(d);return m!==void 0?D.resolve(f.Ms.get(m)):f.Pi.getTargetData(c,d)}(r,o,An(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,t?s:ie.min(),t?i:_e())).next(a=>(UM(r,AV(e),a),{documents:a,Qs:i})))}function UM(n,e,t){let r=n.Os.get(e)||ie.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Os.set(e,r)}class vI{constructor(){this.activeTargetIds=PV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ub{constructor(){this.Mo=new vI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new vI,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI="ConnectivityMonitor";class II{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){B(wI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){B(wI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ac=null;function tg(){return Ac===null?Ac=function(){return 268435456+Math.round(2147483648*Math.random())}():Ac++,"0x"+Ac.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p="RestConnection",BM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class zM{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===td?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const o=tg(),a=this.zo(e,t.toUriEncodedString());B(_p,`Sending RPC '${e}' ${o}:`,a,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:c}=new URL(a),d=ta(c);return this.Jo(e,a,u,r,d).then(f=>(B(_p,`Received RPC '${e}' ${o}: `,f),f),f=>{throw wi(_p,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,t,r,s,i,o){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+sa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,t){const r=BM[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qM{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nt="WebChannelConnection";class WM extends zM{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const o=tg();return new Promise((a,u)=>{const c=new PA;c.setWithCredentials(!0),c.listenOnce(NA.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Xc.NO_ERROR:const f=c.getResponseJson();B(Nt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Xc.TIMEOUT:B(Nt,`RPC '${e}' ${o} timed out`),u(new J(U.DEADLINE_EXCEEDED,"Request time out"));break;case Xc.HTTP_ERROR:const m=c.getStatus();if(B(Nt,`RPC '${e}' ${o} failed with status:`,m,"response text:",c.getResponseText()),m>0){let _=c.getResponseJson();Array.isArray(_)&&(_=_[0]);const E=_==null?void 0:_.error;if(E&&E.status&&E.message){const k=function(x){const y=x.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(y)>=0?y:U.UNKNOWN}(E.status);u(new J(k,E.message))}else u(new J(U.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new J(U.UNAVAILABLE,"Connection failed."));break;default:Z(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{B(Nt,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);B(Nt,`RPC '${e}' ${o} sending request:`,s),c.send(t,"POST",d,r,15)})}T_(e,t,r){const s=tg(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=VA(),a=OA(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const d=i.join("");B(Nt,`Creating RPC '${e}' stream ${s}: ${d}`,u);const f=o.createWebChannel(d,u);this.I_(f);let m=!1,_=!1;const E=new qM({Yo:N=>{_?B(Nt,`Not sending because RPC '${e}' stream ${s} is closed:`,N):(m||(B(Nt,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),B(Nt,`RPC '${e}' stream ${s} sending:`,N),f.send(N))},Zo:()=>f.close()}),k=(N,x,y)=>{N.listen(x,S=>{try{y(S)}catch(R){setTimeout(()=>{throw R},0)}})};return k(f,Ya.EventType.OPEN,()=>{_||(B(Nt,`RPC '${e}' stream ${s} transport opened.`),E.o_())}),k(f,Ya.EventType.CLOSE,()=>{_||(_=!0,B(Nt,`RPC '${e}' stream ${s} transport closed`),E.a_(),this.E_(f))}),k(f,Ya.EventType.ERROR,N=>{_||(_=!0,wi(Nt,`RPC '${e}' stream ${s} transport errored. Name:`,N.name,"Message:",N.message),E.a_(new J(U.UNAVAILABLE,"The operation could not be completed")))}),k(f,Ya.EventType.MESSAGE,N=>{var x;if(!_){const y=N.data[0];te(!!y,16349);const S=y,R=(S==null?void 0:S.error)||((x=S[0])==null?void 0:x.error);if(R){B(Nt,`RPC '${e}' stream ${s} received error:`,R);const j=R.status;let M=function(T){const A=et[T];if(A!==void 0)return Px(A)}(j),w=R.message;M===void 0&&(M=U.INTERNAL,w="Unknown error status: "+j+" with message "+R.message),_=!0,E.a_(new J(M,w)),f.close()}else B(Nt,`RPC '${e}' stream ${s} received:`,y),E.u_(y)}}),k(a,DA.STAT_EVENT,N=>{N.stat===Om.PROXY?B(Nt,`RPC '${e}' stream ${s} detected buffering proxy`):N.stat===Om.NOPROXY&&B(Nt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{E.__()},0),E}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KM(){return typeof window<"u"?window:null}function ah(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function af(n){return new GV(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&B("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI="PersistentStream";class hb{constructor(e,t,r,s,i,o,a,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new cb(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===U.RESOURCE_EXHAUSTED?(Ut(t.toString()),Ut("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===t&&this.G_(r,s)},r=>{e(()=>{const s=new J(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return B(EI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(B(EI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class GM extends hb{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=JV(this.serializer,e),r=function(i){if(!("targetChange"in i))return ie.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ie.min():o.readTime?Bt(o.readTime):ie.min()}(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Qm(this.serializer),t.addTarget=function(i,o){let a;const u=o.target;if(a=rd(u)?{documents:Fx(i,u)}:{query:Ux(i,u).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Ox(i,o.resumeToken);const c=Gm(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ie.min())>0){a.readTime=Ho(i,o.snapshotVersion.toTimestamp());const c=Gm(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=YV(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Qm(this.serializer),t.removeTarget=e,this.q_(t)}}class HM extends hb{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=XV(e.writeResults,e.commitTime),r=Bt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Qm(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>od(this.serializer,r))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{}class JM extends QM{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new J(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Hm(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new J(U.UNKNOWN,i.toString())})}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Hm(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new J(U.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class XM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ut(t),this.aa=!1):B("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xi="RemoteStore";class YM{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Pi(this)&&(B(xi,"Restarting streams for network reachability change."),await async function(u){const c=de(u);c.Ea.add(4),await Eu(c),c.Ra.set("Unknown"),c.Ea.delete(4),await lf(c)}(this))})}),this.Ra=new XM(r,s)}}async function lf(n){if(Pi(n))for(const e of n.da)await e(!0)}async function Eu(n){for(const e of n.da)await e(!1)}function db(n,e){const t=de(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),fy(t)?dy(t):oa(t).O_()&&hy(t,e))}function cy(n,e){const t=de(n),r=oa(t);t.Ia.delete(e),r.O_()&&fb(t,e),t.Ia.size===0&&(r.O_()?r.L_():Pi(t)&&t.Ra.set("Unknown"))}function hy(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ie.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}oa(n).Y_(e)}function fb(n,e){n.Va.Ue(e),oa(n).Z_(e)}function dy(n){n.Va=new zV({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),oa(n).start(),n.Ra.ua()}function fy(n){return Pi(n)&&!oa(n).x_()&&n.Ia.size>0}function Pi(n){return de(n).Ea.size===0}function pb(n){n.Va=void 0}async function ZM(n){n.Ra.set("Online")}async function eL(n){n.Ia.forEach((e,t)=>{hy(n,e)})}async function tL(n,e){pb(n),fy(n)?(n.Ra.ha(e),dy(n)):n.Ra.set("Unknown")}async function nL(n,e,t){if(n.Ra.set("Online"),e instanceof Dx&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(n,e)}catch(r){B(xi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await hd(n,r)}else if(e instanceof ih?n.Va.Ze(e):e instanceof Nx?n.Va.st(e):n.Va.tt(e),!t.isEqual(ie.min()))try{const r=await lb(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(c);d&&i.Ia.set(c,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(st.EMPTY_BYTE_STRING,d.snapshotVersion)),fb(i,u);const f=new Ir(d.target,u,c,d.sequenceNumber);hy(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){B(xi,"Failed to raise snapshot:",r),await hd(n,r)}}async function hd(n,e,t){if(!Cs(e))throw e;n.Ea.add(1),await Eu(n),n.Ra.set("Offline"),t||(t=()=>lb(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{B(xi,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await lf(n)})}function mb(n,e){return e().catch(t=>hd(n,t,e))}async function Tu(n){const e=de(n),t=Ss(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ai;for(;rL(e);)try{const s=await jM(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,sL(e,s)}catch(s){await hd(e,s)}gb(e)&&_b(e)}function rL(n){return Pi(n)&&n.Ta.length<10}function sL(n,e){n.Ta.push(e);const t=Ss(n);t.O_()&&t.X_&&t.ea(e.mutations)}function gb(n){return Pi(n)&&!Ss(n).x_()&&n.Ta.length>0}function _b(n){Ss(n).start()}async function iL(n){Ss(n).ra()}async function oL(n){const e=Ss(n);for(const t of n.Ta)e.ea(t.mutations)}async function aL(n,e,t){const r=n.Ta.shift(),s=Z_.from(r,e,t);await mb(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Tu(n)}async function lL(n,e){e&&Ss(n).X_&&await async function(r,s){if(function(o){return UV(o)&&o!==U.ABORTED}(s.code)){const i=r.Ta.shift();Ss(r).B_(),await mb(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Tu(r)}}(n,e),gb(n)&&_b(n)}async function TI(n,e){const t=de(n);t.asyncQueue.verifyOperationInProgress(),B(xi,"RemoteStore received new credentials");const r=Pi(t);t.Ea.add(3),await Eu(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await lf(t)}async function uL(n,e){const t=de(n);e?(t.Ea.delete(2),await lf(t)):e||(t.Ea.add(2),await Eu(t),t.Ra.set("Unknown"))}function oa(n){return n.ma||(n.ma=function(t,r,s){const i=de(t);return i.sa(),new GM(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Xo:ZM.bind(null,n),t_:eL.bind(null,n),r_:tL.bind(null,n),H_:nL.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),fy(n)?dy(n):n.Ra.set("Unknown")):(await n.ma.stop(),pb(n))})),n.ma}function Ss(n){return n.fa||(n.fa=function(t,r,s){const i=de(t);return i.sa(),new HM(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:iL.bind(null,n),r_:lL.bind(null,n),ta:oL.bind(null,n),na:aL.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Tu(n)):(await n.fa.stop(),n.Ta.length>0&&(B(xi,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Tr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new py(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new J(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function my(n,e){if(Ut("AsyncQueue",`${e}: ${n}`),Cs(n))return new J(U.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{static emptySet(e){return new Ao(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Q.comparator(t.key,r.key):(t,r)=>Q.comparator(t.key,r.key),this.keyedMap=Za(),this.sortedSet=new $e(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ao)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Ao;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(){this.ga=new $e(Q.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Z(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class Qo{constructor(e,t,r,s,i,o,a,u,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Qo(e,t,Ao.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Zd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class hL{constructor(){this.queries=AI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=de(t),i=s.queries;s.queries=AI(),i.forEach((o,a)=>{for(const u of a.Sa)u.onError(r)})})(this,new J(U.ABORTED,"Firestore shutting down"))}}function AI(){return new Or(n=>_x(n),Zd)}async function dL(n,e){const t=de(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new cL,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=my(o,`Initialization of query '${Yi(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&gy(t)}async function fL(n,e){const t=de(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function pL(n,e){const t=de(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&gy(t)}function mL(n,e,t){const r=de(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function gy(n){n.Ca.forEach(e=>{e.next()})}var ng,xI;(xI=ng||(ng={})).Ma="default",xI.Cache="cache";class gL{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Qo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Qo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ng.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e){this.key=e}}class vb{constructor(e){this.key=e}}class _L{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=_e(),this.mutatedKeys=_e(),this.eu=yx(e),this.tu=new Ao(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new SI,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const m=s.get(d),_=wu(this.query,f)?f:null,E=!!m&&this.mutatedKeys.has(m.key),k=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let N=!1;m&&_?m.data.isEqual(_.data)?E!==k&&(r.track({type:3,doc:_}),N=!0):this.su(m,_)||(r.track({type:2,doc:_}),N=!0,(u&&this.eu(_,u)>0||c&&this.eu(_,c)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),N=!0):m&&!_&&(r.track({type:1,doc:m}),N=!0,(u||c)&&(a=!0)),N&&(_?(o=o.add(_),i=k?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(_,E){const k=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Z(20277,{Rt:N})}};return k(_)-k(E)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(r),s=s??!1;const a=t&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,c=u!==this.Za;return this.Za=u,o.length!==0||c?{snapshot:new Qo(this.query,e.tu,i,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new SI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=_e(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new vb(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new yb(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=_e();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Qo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const _y="SyncEngine";class yL{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class vL{constructor(e){this.key=e,this.hu=!1}}class wL{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Or(a=>_x(a),Zd),this.Iu=new Map,this.Eu=new Set,this.du=new $e(Q.comparator),this.Au=new Map,this.Ru=new iy,this.Vu={},this.mu=new Map,this.fu=Ai.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function IL(n,e,t=!0){const r=Ab(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await wb(r,e,t,!0),s}async function EL(n,e){const t=Ab(n);await wb(t,e,!0,!1)}async function wb(n,e,t,r){const s=await FM(n.localStore,An(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await TL(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&db(n.remoteStore,s),a}async function TL(n,e,t,r,s){n.pu=(f,m,_)=>async function(k,N,x,y){let S=N.view.ru(x);S.Cs&&(S=await yI(k.localStore,N.query,!1).then(({documents:w})=>N.view.ru(w,S)));const R=y&&y.targetChanges.get(N.targetId),j=y&&y.targetMismatches.get(N.targetId)!=null,M=N.view.applyChanges(S,k.isPrimaryClient,R,j);return kI(k,N.targetId,M.au),M.snapshot}(n,f,m,_);const i=await yI(n.localStore,e,!0),o=new _L(e,i.Qs),a=o.ru(i.documents),u=Iu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,u);kI(n,t,c.au);const d=new yL(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function SL(n,e,t){const r=de(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Zd(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await eg(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&cy(r.remoteStore,s.targetId),rg(r,s.targetId)}).catch(Ci)):(rg(r,s.targetId),await eg(r.localStore,s.targetId,!0))}async function AL(n,e){const t=de(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),cy(t.remoteStore,r.targetId))}async function xL(n,e,t){const r=xb(n);try{const s=await function(o,a){const u=de(o),c=Se.now(),d=a.reduce((_,E)=>_.add(E.key),_e());let f,m;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=on(),k=_e();return u.Ns.getEntries(_,d).next(N=>{E=N,E.forEach((x,y)=>{y.isValidDocument()||(k=k.add(x))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,E)).next(N=>{f=N;const x=[];for(const y of a){const S=jV(y,f.get(y.key).overlayedDocument);S!=null&&x.push(new Rs(y.key,S,ux(S.value.mapValue),an.exists(!0)))}return u.mutationQueue.addMutationBatch(_,c,x,a)}).next(N=>{m=N;const x=N.applyToLocalDocumentSet(f,k);return u.documentOverlayCache.saveOverlays(_,N.batchId,x)})}).then(()=>({batchId:m.batchId,changes:wx(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,u){let c=o.Vu[o.currentUser.toKey()];c||(c=new $e(he)),c=c.insert(a,u),o.Vu[o.currentUser.toKey()]=c}(r,s.batchId,t),await Su(r,s.changes),await Tu(r.remoteStore)}catch(s){const i=my(s,"Failed to persist write");t.reject(i)}}async function Ib(n,e){const t=de(n);try{const r=await MM(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Au.get(i);o&&(te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?te(o.hu,14607):s.removedDocuments.size>0&&(te(o.hu,42227),o.hu=!1))}),await Su(t,r,e)}catch(r){await Ci(r)}}function bI(n,e,t){const r=de(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const u=de(o);u.onlineState=a;let c=!1;u.queries.forEach((d,f)=>{for(const m of f.Sa)m.va(a)&&(c=!0)}),c&&gy(u)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function bL(n,e,t){const r=de(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new $e(Q.comparator);o=o.insert(i,Je.newNoDocument(i,ie.min()));const a=_e().add(i),u=new nf(ie.min(),new Map,new $e(he),o,a);await Ib(r,u),r.du=r.du.remove(i),r.Au.delete(e),yy(r)}else await eg(r.localStore,e,!1).then(()=>rg(r,e,t)).catch(Ci)}async function kL(n,e){const t=de(n),r=e.batch.batchId;try{const s=await VM(t.localStore,e);Tb(t,r,null),Eb(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Su(t,s)}catch(s){await Ci(s)}}async function CL(n,e,t){const r=de(n);try{const s=await function(o,a){const u=de(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return u.mutationQueue.lookupMutationBatch(c,a).next(f=>(te(f!==null,37113),d=f.keys(),u.mutationQueue.removeMutationBatch(c,f))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>u.localDocuments.getDocuments(c,d))})}(r.localStore,e);Tb(r,e,t),Eb(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Su(r,s)}catch(s){await Ci(s)}}function Eb(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function Tb(n,e,t){const r=de(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function rg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||Sb(n,r)})}function Sb(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(cy(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),yy(n))}function kI(n,e,t){for(const r of t)r instanceof yb?(n.Ru.addReference(r.key,e),RL(n,r)):r instanceof vb?(B(_y,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||Sb(n,r.key)):Z(19791,{wu:r})}function RL(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(B(_y,"New document in limbo: "+t),n.Eu.add(r),yy(n))}function yy(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Q(be.fromString(e)),r=n.fu.next();n.Au.set(r,new vL(t)),n.du=n.du.insert(t,r),db(n.remoteStore,new Ir(An(Yd(t.path)),r,"TargetPurposeLimboResolution",En.ce))}}async function Su(n,e,t){const r=de(n),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,u)=>{o.push(r.pu(u,e,t).then(c=>{var d;if((c||t)&&r.isPrimaryClient){const f=c?!c.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(c){s.push(c);const f=ly.As(u.targetId,c);i.push(f)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(u,c){const d=de(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>D.forEach(c,m=>D.forEach(m.Es,_=>d.persistence.referenceDelegate.addReference(f,m.targetId,_)).next(()=>D.forEach(m.ds,_=>d.persistence.referenceDelegate.removeReference(f,m.targetId,_)))))}catch(f){if(!Cs(f))throw f;B(uy,"Failed to update sequence numbers: "+f)}for(const f of c){const m=f.targetId;if(!f.fromCache){const _=d.Ms.get(m),E=_.snapshotVersion,k=_.withLastLimboFreeSnapshotVersion(E);d.Ms=d.Ms.insert(m,k)}}}(r.localStore,i))}async function PL(n,e){const t=de(n);if(!t.currentUser.isEqual(e)){B(_y,"User change. New user:",e.toKey());const r=await ab(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(u=>{u.reject(new J(U.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Su(t,r.Ls)}}function NL(n,e){const t=de(n),r=t.Au.get(e);if(r&&r.hu)return _e().add(r.key);{let s=_e();const i=t.Iu.get(e);if(!i)return s;for(const o of i){const a=t.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function Ab(n){const e=de(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ib.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=NL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bL.bind(null,e),e.Pu.H_=pL.bind(null,e.eventManager),e.Pu.yu=mL.bind(null,e.eventManager),e}function xb(n){const e=de(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=CL.bind(null,e),e}class nu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=af(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return ob(this.persistence,new ib,e.initialUser,this.serializer)}Cu(e){return new oy(of.mi,this.serializer)}Du(e){return new ub}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}nu.provider={build:()=>new nu};class DL extends nu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){te(this.persistence.referenceDelegate instanceof cd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new eb(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new oy(r=>cd.mi(r,t),this.serializer)}}class OL extends nu{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await xb(this.xu.syncEngine),await Tu(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return ob(this.persistence,new ib,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new eb(r,e.asyncQueue,t)}Mu(e,t){const r=new MO(t,this.persistence);return new VO(e.asyncQueue,r)}Cu(e){const t=PM(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new ay(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,KM(),ah(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new ub}}class dd{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>bI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=PL.bind(null,this.syncEngine),await uL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new hL}()}createDatastore(e){const t=af(e.databaseInfo.databaseId),r=function(i){return new WM(i)}(e.databaseInfo);return function(i,o,a,u){return new JM(i,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new YM(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>bI(this.syncEngine,t,0),function(){return II.v()?new II:new $M}())}createSyncEngine(e,t){return function(s,i,o,a,u,c,d){const f=new wL(s,i,o,a,u,c);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=de(s);B(xi,"RemoteStore shutting down."),i.Ea.add(5),await Eu(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}dd.provider={build:()=>new dd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ut("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const As="FirestoreClient";class ML{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=St.UNAUTHENTICATED,this.clientId=L_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{B(As,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(B(As,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Tr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=my(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function yp(n,e){n.asyncQueue.verifyOperationInProgress(),B(As,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await ab(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function CI(n,e){n.asyncQueue.verifyOperationInProgress();const t=await LL(n);B(As,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>TI(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>TI(e.remoteStore,s)),n._onlineComponents=e}async function LL(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){B(As,"Using user provided OfflineComponentProvider");try{await yp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;wi("Error using user provided cache. Falling back to memory cache: "+t),await yp(n,new nu)}}else B(As,"Using default OfflineComponentProvider"),await yp(n,new DL(void 0));return n._offlineComponents}async function bb(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(B(As,"Using user provided OnlineComponentProvider"),await CI(n,n._uninitializedComponentsProvider._online)):(B(As,"Using default OnlineComponentProvider"),await CI(n,new dd))),n._onlineComponents}function jL(n){return bb(n).then(e=>e.syncEngine)}async function FL(n){const e=await bb(n),t=e.eventManager;return t.onListen=IL.bind(null,e.syncEngine),t.onUnlisten=SL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=EL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=AL.bind(null,e.syncEngine),t}function UL(n,e,t={}){const r=new Tr;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,u,c){const d=new VL({next:m=>{d.Nu(),o.enqueueAndForget(()=>fL(i,f));const _=m.docs.has(a);!_&&m.fromCache?c.reject(new J(U.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&u&&u.source==="server"?c.reject(new J(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new gL(Yd(a.path),d,{includeMetadataChanges:!0,qa:!0});return dL(i,f)}(await FL(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kb(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb="firestore.googleapis.com",PI=!0;class NI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new J(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Cb,this.ssl=PI}else this.host=e.host,this.ssl=e.ssl??PI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Jx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<pM)throw new J(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}PO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kb(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new J(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new J(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new J(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vy{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new NI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new J(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new J(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new NI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new wO;switch(r.type){case"firstParty":return new SO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new J(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=RI.get(t);r&&(B("ComponentProvider","Removing Datastore"),RI.delete(t),r.terminate())}(this),Promise.resolve()}}function $L(n,e,t,r={}){var c;n=Mo(n,vy);const s=ta(e),i=n._getSettings(),o={...i,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;s&&($1(`https://${a}`),B1("Firestore",!0)),i.host!==Cb&&i.host!==a&&wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:a,ssl:s,emulatorOptions:r};if(!_i(u,o)&&(n._setSettings(u),r.mockUserToken)){let d,f;if(typeof r.mockUserToken=="string")d=r.mockUserToken,f=St.MOCK_USER;else{d=KP(r.mockUserToken,(c=n._app)==null?void 0:c.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new J(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new St(m)}n._authCredentials=new IO(new LA(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new wy(this.firestore,e,this._query)}}class yt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ru(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yt(this.firestore,e,this._key)}toJSON(){return{type:yt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(_u(t,yt._jsonSchema))return new yt(e,r||null,new Q(be.fromString(t.referencePath)))}}yt._jsonSchemaVersion="firestore/documentReference/1.0",yt._jsonSchema={type:nt("string",yt._jsonSchemaVersion),referencePath:nt("string")};class ru extends wy{constructor(e,t,r){super(e,t,Yd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yt(this.firestore,null,new Q(e))}withConverter(e){return new ru(this.firestore,e,this._path)}}function DI(n,e,...t){if(n=cn(n),arguments.length===1&&(e=L_.newId()),RO("doc","path",e),n instanceof vy){const r=be.fromString(e,...t);return E0(r),new yt(n,null,new Q(r))}{if(!(n instanceof yt||n instanceof ru))throw new J(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(be.fromString(e,...t));return E0(r),new yt(n.firestore,n instanceof ru?n.converter:null,new Q(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI="AsyncQueue";class VI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new cb(this,"async_queue_retry"),this._c=()=>{const r=ah();r&&B(OI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=ah();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ah();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Tr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Cs(e))throw e;B(OI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Ut("INTERNAL UNHANDLED ERROR: ",MI(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=py.createAndSchedule(this,e,t,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&Z(47125,{Pc:MI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function MI(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class uf extends vy{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new VI,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new VI(e),this._firestoreClient=void 0,await e}}}function BL(n,e){const t=typeof n=="object"?n:J1(),r=typeof n=="string"?n:td,s=A_(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=qP("firestore");i&&$L(s,...i)}return s}function Rb(n){if(n._terminated)throw new J(U.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Pb(n),n._firestoreClient}function Pb(n){var r,s,i;const e=n._freezeSettings(),t=function(a,u,c,d){return new hV(a,u,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,kb(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new ML(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}}(n._componentsProvider))}function zL(n,e){wi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return qL(n,dd.provider,{build:r=>new OL(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function qL(n,e,t){if((n=Mo(n,uf))._firestoreClient||n._terminated)throw new J(U.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new J(U.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Pb(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vn(st.fromBase64String(e))}catch(t){throw new J(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new vn(st.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:vn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(_u(e,vn._jsonSchema))return vn.fromBase64String(e.bytes)}}vn._jsonSchemaVersion="firestore/bytes/1.0",vn._jsonSchema={type:nt("string",vn._jsonSchemaVersion),bytes:nt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new J(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new J(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new J(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return he(this._lat,e._lat)||he(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:or._jsonSchemaVersion}}static fromJSON(e){if(_u(e,or._jsonSchema))return new or(e.latitude,e.longitude)}}or._jsonSchemaVersion="firestore/geoPoint/1.0",or._jsonSchema={type:nt("string",or._jsonSchemaVersion),latitude:nt("number"),longitude:nt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ar._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(_u(e,ar._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new ar(e.vectorValues);throw new J(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ar._jsonSchemaVersion="firestore/vectorValue/1.0",ar._jsonSchema={type:nt("string",ar._jsonSchemaVersion),vectorValues:nt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL=/^__.*__$/;class KL{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Rs(e,this.data,this.fieldMask,t,this.fieldTransforms):new ia(e,this.data,t,this.fieldTransforms)}}function Nb(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Z(40011,{Ac:n})}}class Ty{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ty({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return fd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Nb(this.Ac)&&WL.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class GL{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||af(e)}Cc(e,t,r,s=!1){return new Ty({Ac:e,methodName:t,Dc:r,path:ze.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function HL(n){const e=n._freezeSettings(),t=af(n._databaseId);return new GL(n._databaseId,!!e.ignoreUndefinedProperties,t)}function QL(n,e,t,r,s,i={}){const o=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);Mb("Data must be an object, but it was:",o,r);const a=Ob(r,o);let u,c;if(i.merge)u=new Tn(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const m=JL(e,f,t);if(!o.contains(m))throw new J(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);YL(d,m)||d.push(m)}u=new Tn(d),c=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,c=o.fieldTransforms;return new KL(new Gt(a),u,c)}class Sy extends Ey{_toFieldTransform(e){return new bx(e.path,new Wo)}isEqual(e){return e instanceof Sy}}function Db(n,e){if(Vb(n=cn(n)))return Mb("Unsupported field value:",e,n),Ob(n,e);if(n instanceof Ey)return function(r,s){if(!Nb(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let u=Db(a,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=cn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return NV(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Se.fromDate(r);return{timestampValue:Ho(s.serializer,i)}}if(r instanceof Se){const i=new Se(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ho(s.serializer,i)}}if(r instanceof or)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof vn)return{bytesValue:Ox(s.serializer,r._byteString)};if(r instanceof yt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ny(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ar)return function(o,a){return{mapValue:{fields:{[K_]:{stringValue:G_},[$o]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return J_(a.serializer,c)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${j_(r)}`)}(n,e)}function Ob(n,e){const t={};return ex(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ri(n,(r,s)=>{const i=Db(s,e.mc(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function Vb(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Se||n instanceof or||n instanceof vn||n instanceof yt||n instanceof Ey||n instanceof ar)}function Mb(n,e,t){if(!Vb(t)||!FA(t)){const r=j_(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function JL(n,e,t){if((e=cn(e))instanceof Iy)return e._internalPath;if(typeof e=="string")return Lb(n,e);throw fd("Field path arguments must be of type string or ",n,!1,void 0,t)}const XL=new RegExp("[~\\*/\\[\\]]");function Lb(n,e,t){if(e.search(XL)>=0)throw fd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Iy(...e.split("."))._internalPath}catch{throw fd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fd(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new J(U.INVALID_ARGUMENT,a+n+u)}function YL(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ZL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Fb("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class ZL extends jb{data(){return super.data()}}function Fb(n,e){return typeof e=="string"?Lb(n,e):e instanceof Iy?e._internalPath:e._delegate._internalPath}class e4{convertValue(e,t="none"){switch(Es(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Fe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Pr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Z(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ri(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var r,s,i;const t=(i=(s=(r=e.fields)==null?void 0:r[$o].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Fe(o.doubleValue));return new ar(t)}convertGeoPoint(e){return new or(Fe(e.latitude),Fe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Qd(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Yl(e));default:return null}}convertTimestamp(e){const t=Rr(e);return new Se(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=be.fromString(e);te(qx(r),9688,{name:e});const s=new Ii(r.get(1),r.get(3)),i=new Q(r.popFirst(5));return s.isEqual(t)||Ut(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t4(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class nl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ci extends jb{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new lh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Fb("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new J(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ci._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ci._jsonSchemaVersion="firestore/documentSnapshot/1.0",ci._jsonSchema={type:nt("string",ci._jsonSchemaVersion),bundleSource:nt("string","DocumentSnapshot"),bundleName:nt("string"),bundle:nt("string")};class lh extends ci{data(e={}){return super.data(e)}}class Al{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new nl(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new lh(this._firestore,this._userDataWriter,r.key,r,new nl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new J(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const u=new lh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new nl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const u=new lh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new nl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:n4(a.type),doc:u,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new J(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Al._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=L_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function n4(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Z(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r4(n){n=Mo(n,yt);const e=Mo(n.firestore,uf);return UL(Rb(e),n._key).then(t=>a4(e,n,t))}Al._jsonSchemaVersion="firestore/querySnapshot/1.0",Al._jsonSchema={type:nt("string",Al._jsonSchemaVersion),bundleSource:nt("string","QuerySnapshot"),bundleName:nt("string"),bundle:nt("string")};class s4 extends e4{constructor(e){super(),this.firestore=e}convertBytes(e){return new vn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yt(this.firestore,null,t)}}function i4(n,e,t){n=Mo(n,yt);const r=Mo(n.firestore,uf),s=t4(n.converter,e,t);return o4(r,[QL(HL(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,an.none())])}function o4(n,e){return function(r,s){const i=new Tr;return r.asyncQueue.enqueueAndForget(async()=>xL(await jL(r),s,i)),i.promise}(Rb(n),e)}function a4(n,e,t){const r=t.docs.get(e._key),s=new s4(n);return new ci(n,s,e._key,r,new nl(t.hasPendingWrites,t.fromCache),e.converter)}function l4(){return new Sy("serverTimestamp")}(function(e,t=!0){(function(s){sa=s})(na),Do(new yi("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new uf(new EO(r.getProvider("auth-internal")),new AO(o,r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new J(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ii(c.options.projectId,d)}(o,s),o);return i={useFetchStreams:t,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),gs(y0,v0,e),gs(y0,v0,"esm2020")})();vO("error");const u4={apiKey:"AIzaSyAYOQ9Npqhf6AW6qq32rrvtw1F1q7vuUaM",authDomain:"nove-research-data.firebaseapp.com",projectId:"nove-research-data",storageBucket:"nove-research-data.firebasestorage.app",messagingSenderId:"777873062473",appId:"1:777873062473:web:fde24fe43e75d7d0875d98",measurementId:"G-9C0KKVETT2"},Ub=Q1(u4),uh=_O(Ub);rD(uh,wA).catch(n=>console.error("Persistence error:",n));const Au=new gr;Au.addScope("profile");Au.addScope("email");Au.setCustomParameters({prompt:"select_account",access_type:"offline"});if(typeof window<"u"){const n=navigator.userAgent.toLowerCase();n.includes("safari")&&!n.includes("chrome")&&!n.includes("firefox")&&Au.setCustomParameters({prompt:"consent"})}const sg=BL(Ub);typeof window<"u"&&zL(sg).catch(n=>{n.code==="failed-precondition"?console.warn("Firestore: Multiple tabs open, persistence disabled"):n.code==="unimplemented"&&console.warn("Firestore: Browser does not support persistence")});const c4=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform),h4=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,d4=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",f4=({onClose:n})=>{const[e,t]=W.useState(null),[r,s]=W.useState(!1);W.useEffect(()=>{const o=/iPad|iPhone|iPod/.test(navigator.userAgent);s(o);const a=u=>{u.preventDefault(),t(u)};return window.addEventListener("beforeinstallprompt",a),()=>{window.removeEventListener("beforeinstallprompt",a)}},[]);const i=async()=>{if(e){e.prompt();const{outcome:o}=await e.userChoice;o==="accepted"&&(t(null),n())}};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:g.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full",children:[g.jsxs("div",{className:"text-center mb-4",children:[g.jsx("div",{className:"w-16 h-16 bg-indigo-600 rounded-lg mx-auto mb-4 flex items-center justify-center",children:g.jsx("span",{className:"text-white text-2xl font-bold",children:"AI"})}),g.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:" "}),g.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"AI Scheduler      ."})]}),r?g.jsxs("div",{className:"mb-4",children:[g.jsx("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-3",children:g.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"iOS  :"})}),g.jsxs("ol",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-2",children:[g.jsxs("li",{className:"flex items-center",children:[g.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"1"}),"   () "]}),g.jsxs("li",{className:"flex items-center",children:[g.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),'"  " ']}),g.jsxs("li",{className:"flex items-center",children:[g.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),'""  ']})]})]}):g.jsx("div",{className:"mb-4",children:e?g.jsx("button",{onClick:i,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:" "}):g.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:g.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:'  "  "  " " .'})})}),g.jsxs("div",{className:"flex space-x-2",children:[g.jsx("button",{onClick:n,className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:""}),g.jsx("button",{onClick:()=>{localStorage.setItem("pwa-prompt-dismissed","true"),n()},className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"  "})]})]})})},p4={ko:{language_selection_title:"",error_title_required:" .",error_subject_required:" .",error_time_required:"  .",error_difficulty_required:" .",error_deadline_required:" .",my_assignments_title:" AI Scheduler",today_schedule_title:"    ",all_assignments_title:"   ",sort_label_auto:" ",sort_label_deadline:"",sort_label_difficulty:"",sort_label_time:"",add_new_assignment_button:"+   ",profile_login:"",profile_logout:"",profile_settings:"",filter_all:"",filter_active:"",filter_completed:"",empty_message_today:"   .  ! ",empty_message_all:"   .",empty_message_active:"  .",empty_message_completed:"  .",empty_encouragement_1:"    .",empty_encouragement_2:"    .",empty_encouragement_3:"    .",empty_encouragement_4:"    .",delete_button:"",edit_button_aria:" ",info_button_aria:" ",filter_title:"",sort_title:"",filter_sort_button_aria:"  ",calendar_view_button_aria:" ",list_view_button_aria:" ",more_options_button_aria:" ",select_button_label:"",cancel_selection_button_label:"",delete_selected_button_label:"{count} ",delete_selected_confirm_title:" ",delete_selected_confirm_message:" {count}   .",days_left:"{count} ",d_day:"D-DAY",days_overdue:"{count} ",time_allocation:" {time}",total_time:" {time}",month_names:["1","2","3","4","5","6","7","8","9","10","11","12"],day_names_short:["","","","","","",""],day_names_long:["","","","","","",""],calendar_header_month_format:"{year} {month}",calendar_view_day3:"3",calendar_view_week:"",calendar_view_month:"",settings_title:"",confirm_button:"",new_assignment_modal_title:"  ",edit_assignment_modal_title:" ",assignment_title_label:"",assignment_title_placeholder:":   ",subject_label:"",subject_placeholder:": ",description_label:"  ()",description_placeholder:": 1-3  ",estimated_time_label:"  ()",estimated_time_placeholder:": 60",difficulty_label:"",difficulty_1:" ",difficulty_2:"",difficulty_3:"",difficulty_4:"",difficulty_5:" ",deadline_label:"",ai_analyze_button:" AI ",ai_analyzing:"AI  ...",ai_analysis_complete:"  ",cancel_button:"",add_button:"",save_button:"",assignment_details_modal_title:"  ",close_button:"",delete_account_final_confirm_title:"  ",delete_account_final_confirm_message:"    ,     .",delete_all_data_button:"  ",settings_done_button:"",settings_section_data:" ",settings_export_data:"",settings_import_data:"",import_confirm_title:" ",import_confirm_message:"    .     .",import_success_toast:"  .",import_error_alert_title:" ",import_error_alert_message:"        .",settings_section_general:"",settings_section_info:"",settings_section_help:"",settings_dark_mode:" ",settings_language:"",settings_api_key:"AI  ",settings_api_key_placeholder:"OpenAI API  ",settings_offline_mode:" ",settings_offline_mode_desc:"AI      ",language_name:" ()",language_modal_title:"",settings_section_background:"",settings_bg_default:"",settings_bg_default_dark:"",settings_bg_pink:"",settings_bg_cherry_noir:" ",settings_bg_blue:"",settings_bg_deep_ocean:"",settings_bg_green:"",settings_bg_forest_green:"",settings_bg_purple:"",settings_bg_royal_purple:" ",settings_version:"",settings_developer:"",developer_name:"GimGyuMin",settings_copyright:"",copyright_notice:" 2025 GimGyuMin. All Rights Reserved.",build_number:" ",settings_data_header:" ",settings_data_header_desc:"   ,  .",settings_background_header:"",settings_background_header_desc:"      .",settings_display_header:" ",settings_display_header_desc:"  .",display_option_both:"  ",display_option_today:" ",display_option_all:" ",settings_sync_header:" ",settings_sync_header_desc:"     .",sync_auto_enabled:"  ",sync_auto_disabled:"  ",data_importing:" ...",data_exporting:" ...",data_deleting:" ...",url_import_title:"URL  ",url_import_message:"URL     ?",url_import_confirm:"",url_import_success:"URL   !",url_import_error:"URL   .",settings_share_link_header:" ",settings_generate_link:"  ",settings_copy_link:"",link_copied_toast:"  .",short_url_created:"  URL !",share_link_created:"   !",short_url_failed:"  URL     .",no_data_to_share:"  .   .",usage_guide_tab:"",usage_guide_title:" ",usage_basic_title:" ",usage_basic_desc:`1.   "   "  .
2. , , ,   .
3.    .
4. ""    .`,usage_ai_title:"AI  ",usage_ai_desc:`    "AI "    .
   "AI "     .
 AI       .

 AI    API   .`,usage_ai_setup_title:"AI  ",usage_ai_setup_desc:`1.  >  API   .
2. Google Gemini API  .
3. API     Google   :
   https://ai.google.dev/gemini-api/docs/api-key
4.    AI  .`,usage_share_title:" ",usage_share_desc:`1.  >  "  "  .
2.     .
3. " "   .
4.    .`,usage_theme_title:" ",usage_theme_desc:`1.  >     .
2.     .
3. , , , ,     .
4.    .`,usage_calendar_title:"  ",usage_calendar_desc:`1.     .
2. 3//    .
3.      .
4.      .`,usage_offline_title:"  ",usage_offline_desc:`1.  >  " "  .
2. API    , ,  .
3. AI         .
4.    .`,goal_assistant_title:" ",goal_assistant_mode_woop:"WOOP ",goal_assistant_mode_automation:" ",automation_title:"  ",automation_base_name_label:" ",automation_base_name_placeholder:":   ",automation_total_units_label:" ",automation_total_units_placeholder:": 30",automation_units_per_day_label:" ",automation_period_label:"",automation_start_date_label:"",automation_end_date_label:"",automation_generate_button:"{count} ",automation_error_all_fields:"   .",automation_error_start_after_end:"   .",automation_error_short_period:"  . (1 )",next_button:"",back_button:"",wish_tip:"  ,    .",wish_example:": 3  5kg ,   A+ ",outcome_tip:"          .",outcome_example:":     ,   ",obstacle_tip:"      (,  ) ?",obstacle_example:":       ,    ",plan_tip:"' ~, ~'       .",plan_example:":      ,    10 .",recurrence_label:"",recurrence_tip:"     ?      .",recurrence_example:":  ,,  ",recurrence_option_daily:" ",deadline_tip:"    .     .",deadline_option_no_deadline:" ",day_names_short_picker:["","","","","","",""],settings_delete_account:"  ",delete_account_header:" ",delete_account_header_desc:"    ,     .",version_update_title:" ",version_update_1_title:"AI  ",version_update_1_desc:"Gemini API      AI     .",version_update_2_title:" ",version_update_2_desc:"    URL  .   .",version_update_3_title:"  UI",version_update_3_desc:"         ."},en:{language_selection_title:"Language",error_wish_required:"Please enter your wish.",error_outcome_required:"Please enter the outcome.",error_obstacle_required:"Please enter the obstacle.",error_plan_required:"Please enter your If-Then plan.",error_deadline_required:"Please select a deadline.",error_day_required:"Please select at least one day.",my_goals_title:"My Goals",sort_label_manual:"Manual",sort_label_deadline:"Deadline",sort_label_newest:"Newest",sort_label_alphabetical:"Alphabetical",sort_label_ai:"AI Recommended",ai_sorting_button:"Sorting...",add_new_goal_button_label:"Add New Goal",profile_login:"Login",profile_logout:"Logout",profile_settings:"Settings",filter_all:"All Goals",filter_active:"In Progress",filter_completed:"Completed",empty_message_all:"Add your first goal to begin your journey.",empty_message_active:"No goals in progress.",empty_message_completed:"No completed goals yet.",empty_encouragement_1:"Take the first step toward something amazing.",empty_encouragement_2:"Small changes lead to big achievements.",empty_encouragement_3:"What you do today shapes tomorrow.",empty_encouragement_4:"Your goals are waiting to become reality.",delete_button:"Delete",edit_button_aria:"Edit Goal",info_button_aria:"Details",filter_title:"Filter",sort_title:"Sort",filter_sort_button_aria:"Filter and Sort",calendar_view_button_aria:"Calendar View",list_view_button_aria:"List View",more_options_button_aria:"More",select_button_label:"Select",cancel_selection_button_label:"Cancel",delete_selected_button_label:"Delete {count}",delete_selected_confirm_title:"Delete Goals",delete_selected_confirm_message:"The {count} selected goals will be permanently deleted.",days_left:"{count} days left",d_day:"D-DAY",days_overdue:"{count} days overdue",month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],day_names_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],calendar_header_month_format:"{month} {year}",calendar_view_day3:"3-Day",calendar_view_week:"Week",calendar_view_month:"Month",settings_title:"Settings",sort_alert_title:"Unable to Sort",sort_alert_message:"Add at least two goals to use AI recommendations.",ai_sort_error_title:"Sorting Unavailable",ai_sort_error_message:"AI sorting is temporarily unavailable.",confirm_button:"OK",new_goal_modal_title:"New Goal",edit_goal_modal_title:"Edit Goal",wish_label:"Wish",outcome_label:"Outcome",obstacle_label:"Obstacle",plan_label:"If-Then Plan",deadline_label:"Deadline",cancel_button:"Cancel",add_button:"Add",save_button:"Save",goal_details_modal_title:"Goal Details",ai_coach_suggestion:" AI Coach",ai_analyzing:"AI Analyzing...",close_button:"Close",ai_sort_reason_modal_title:"AI Sort Rationale",ai_sort_criteria:" AI Sort Criteria",delete_account_final_confirm_title:"Delete All Data",delete_account_final_confirm_message:"All your goals and data will be permanently deleted. This action cannot be undone.",delete_all_data_button:"Delete All Data",settings_done_button:"Done",settings_section_data:"Data Management",settings_export_data:"Export",settings_import_data:"Import",import_confirm_title:"Import Data",import_confirm_message:"This will replace your current goals with new data. This action cannot be undone.",import_success_toast:"Data imported successfully.",import_error_alert_title:"Import Failed",import_error_alert_message:"There was an error reading the file, or the file format is incorrect.",settings_section_general:"General",settings_section_info:"Information",settings_section_help:"How to Use",settings_dark_mode:"Dark Mode",settings_language:"Language",settings_api_key:"AI Assistant",settings_api_key_placeholder:"Enter OpenAI API key",settings_offline_mode:"Offline Mode",settings_offline_mode_desc:"Use basic features without AI",language_name:"English (US)",language_modal_title:"Language",settings_section_background:"Appearance",settings_bg_default:"Light",settings_bg_default_dark:"Dark",settings_bg_pink:"Pink",settings_bg_cherry_noir:"Cherry Noir",settings_bg_blue:"Blue",settings_bg_deep_ocean:"Ocean",settings_bg_green:"Green",settings_bg_forest_green:"Forest",settings_bg_purple:"Purple",settings_bg_royal_purple:"Royal Purple",settings_version:"Version",settings_developer:"Developer",developer_name:"GimGyuMin",settings_copyright:"Copyright",copyright_notice:" 2025 GimGyuMin. All Rights Reserved.",build_number:"Build Number",settings_data_header:"Data Management",settings_data_header_desc:"Export or import your goal data.",settings_background_header:"Background",settings_background_header_desc:"Change the app's background style to express your personality.",settings_display_header:"Display Options",settings_display_header_desc:"Choose which sections to display.",display_option_both:"Show Both",display_option_today:"Today Only",display_option_all:"All Tasks Only",settings_sync_header:"Auto Sync",settings_sync_header_desc:"Automatically sync data to cloud when changes are detected.",sync_auto_enabled:"Auto sync enabled",sync_auto_disabled:"Auto sync disabled",data_importing:"Importing...",data_exporting:"Exporting...",data_deleting:"Deleting...",url_import_title:"Load from URL",url_import_message:"Overwrite current goals with data from the URL?",url_import_confirm:"Load",url_import_success:"Successfully loaded data from URL!",url_import_error:"Invalid data in URL.",settings_share_link_header:"Share via Link",settings_generate_link:"Generate Share Link",settings_copy_link:"Copy",link_copied_toast:"Link copied to clipboard.",short_url_created:" Short URL created successfully!",share_link_created:" Share link generated!",short_url_failed:" Short URL creation failed, using default link.",no_data_to_share:"No goals to share. Please add goals first.",usage_guide_tab:"How to Use",usage_guide_title:"User Guide",usage_basic_title:"Add a Goal",usage_basic_desc:`1. Tap "Add and Edit Goals" button on the home screen.
2. Fill in your goal, outcome, obstacle, and plan in order.
3. Select deadline and repeat days.
4. Tap "Save" to add your goal.`,usage_ai_title:"Use AI Features",usage_ai_desc:` Use "AI Suggestion" button when writing goals for improvements.
 Tap "AI Sort" button to organize goals by importance.
 Get AI analysis for more effective goal setting.

 API key setup is required to use AI features.`,usage_ai_setup_title:"Set Up AI Features",usage_ai_setup_desc:`1. Go to Settings > General and find the API Key field.
2. Enter your OpenAI API key.
3. For API key generation:
   https://platform.openai.com/api-keys
4. AI features will be activated after entering the key.`,usage_share_title:"Share Your Goals",usage_share_desc:`1. Go to Settings > Sharing and tap "Create Goal Link".
2. Review the automatically generated short link.
3. Tap "Copy Link" to copy to clipboard.
4. Share the link via messenger or email.`,usage_theme_title:"Change Theme",usage_theme_desc:`1. Go to Settings > Appearance and use the dark mode toggle.
2. Select your preferred background theme.
3. Choose from Default, Pink, Blue, Green, or Purple themes.
4. Changes are applied immediately.`,usage_calendar_title:"Use Calendar View",usage_calendar_desc:`1. Tap the calendar icon in the bottom tabs.
2. Choose between 3-day, weekly, or monthly view.
3. Tap on any date to see goals for that day.
4. Use left/right arrows to navigate dates.`,usage_offline_title:"Use Offline Mode",usage_offline_desc:`1. Go to Settings > General and turn on "Offline Mode".
2. Add, edit, and delete goals without an API key.
3. AI features are unavailable, but all basic functions work normally.
4. Your data is safely stored in the browser.`,goal_assistant_title:"Add Goal",goal_assistant_mode_woop:"WOOP",goal_assistant_mode_automation:"Automation",automation_title:"Goal Automation",automation_base_name_label:"Base Goal Name",automation_base_name_placeholder:"e.g., Study Vocabulary",automation_total_units_label:"Total Units",automation_total_units_placeholder:"e.g., 30",automation_units_per_day_label:"Units per Day",automation_period_label:"Period",automation_start_date_label:"Start Date",automation_end_date_label:"End Date",automation_generate_button:"Generate {count}",automation_error_all_fields:"Please fill out all fields correctly.",automation_error_start_after_end:"Start date must be before end date.",automation_error_short_period:"The period is too short (min. 1 day).",next_button:"Next",back_button:"Back",wish_tip:"Set a challenging yet realistic goal. Make it specific and measurable.",wish_example:"e.g., Lose 5kg in 3 months, Get an A+ this semester",outcome_tip:"Imagine the most positive outcome of achieving your goal. The more vivid, the better.",outcome_example:"e.g., Feeling healthier and more confident, Receiving a scholarship",obstacle_tip:"What is the main internal obstacle (e.g., habits, emotions) that could stop you?",obstacle_example:"e.g., Feeling too tired for the gym after work, Procrastinating on difficult tasks",plan_tip:"Create a specific plan to overcome your obstacle in an 'if-then' format.",plan_example:"e.g., If I feel too tired for the gym after work, then I will change into my workout clothes and stretch for 10 minutes.",recurrence_label:"Recurrence",recurrence_tip:"Is this a goal you need to work on consistently? Set it as a recurring goal to track your streak.",recurrence_example:"e.g., Go to the gym every Mon, Wed, Fri",recurrence_option_daily:"Recurring Goal",deadline_tip:"Set a realistic deadline to stay motivated. Long-term goals without a deadline are also fine.",deadline_option_no_deadline:"No Deadline",day_names_short_picker:["M","T","W","T","F","S","S"],settings_delete_account:"Delete All Data",delete_account_header:"Delete Data",delete_account_header_desc:"This action is irreversible and will permanently delete all your goals and data.",version_update_title:"What's New",version_update_1_title:"AI Assistant Setup",version_update_1_desc:"Configure your OpenAI API key directly or use offline mode to enjoy the app without AI features.",version_update_2_title:"Goal Sharing",version_update_2_desc:"Share your goals via links with short URL support. Perfect Unicode handling for all languages.",version_update_3_title:"Modern Style UI",version_update_3_desc:"Refined modern design language with mobile optimization for a more intuitive experience."}},fe={add:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),g.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),check:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("polyline",{points:"20 6 9 17 4 12"})}),info:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("circle",{cx:"12",cy:"12",r:"10"}),g.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),g.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),delete:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("polyline",{points:"3 6 5 6 21 6"}),g.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),g.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),g.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),edit:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),g.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),close:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),g.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),back:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("polyline",{points:"15 18 9 12 15 6"})}),forward:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("polyline",{points:"9 18 15 12 9 6"})}),calendar:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),g.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),g.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),g.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),list:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),g.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),g.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),g.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),g.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),g.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),settings:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("circle",{cx:"12",cy:"12",r:"3"}),g.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),filter:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),ai:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M12 3L14.34 8.66L20 11L14.34 13.34L12 19L9.66 13.34L4 11L9.66 8.66L12 3Z"}),g.jsx("path",{d:"M5 21L7 16"}),g.jsx("path",{d:"M19 21L17 16"})]}),data:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),g.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),background:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round",children:[g.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),g.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),g.jsx("polyline",{points:"21 15 16 10 5 21"})]}),exclamation:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:g.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm1-4h-2V7h2v6z"})}),globe:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("circle",{cx:"12",cy:"12",r:"10"}),g.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),g.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 1.53 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),sync:g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("polyline",{points:"23 4 23 10 17 10"}),g.jsx("polyline",{points:"1 20 1 14 7 14"}),g.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})},LI=(n,e)=>{const t=new Date(n),r=new Date(e);return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()&&t.getDate()===r.getDate()},jI=(n,e=1)=>{const t=new Date(n),r=t.getDay(),s=(r<e?7:0)+r-e;return t.setDate(t.getDate()-s),t.setHours(0,0,0,0),t},FI=n=>{try{const e=new TextEncoder().encode(n),t=Array.from(e).map(r=>String.fromCharCode(r)).join("");return btoa(t)}catch(e){return console.error("UTF-8 to Base64 encoding failed:",e),""}},m4=n=>{try{const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return new TextDecoder().decode(t)}catch(e){return console.error("Base64 to UTF-8 decoding failed:",e),""}},UI=n=>{try{const t=JSON.stringify(n).replace(/\s+/g," ").trim();return FI(t)}catch(e){return console.error("Data compression failed:",e),FI(JSON.stringify(n))}},g4=async n=>{if(n.length<1500)return n;const e=[{name:"is.gd",createUrl:async t=>{const r=await fetch(`https://is.gd/create.php?format=simple&url=${encodeURIComponent(t)}`);if(!r.ok)throw new Error("is.gd API failed");const s=await r.text();if(s.includes("Error")||!s.startsWith("http"))throw new Error("Invalid response from is.gd");return s.trim()}},{name:"tinyurl",createUrl:async t=>new Promise((r,s)=>{const i=`tinyurl_${Date.now()}`,o=document.createElement("script"),a=setTimeout(()=>{u(),s(new Error("TinyURL timeout"))},5e3),u=()=>{clearTimeout(a),o.parentNode&&document.head.removeChild(o),delete window[i]};window[i]=c=>{u(),c&&typeof c=="string"&&!c.includes("Error")&&c.startsWith("http")?r(c.trim()):s(new Error("Invalid TinyURL response"))},o.onerror=()=>{u(),s(new Error("TinyURL script load failed"))},o.src=`https://tinyurl.com/api-create.php?url=${encodeURIComponent(t)}&callback=${i}`,document.head.appendChild(o)})},{name:"v.gd",createUrl:async t=>{const r=await fetch(`https://v.gd/create.php?format=simple&url=${encodeURIComponent(t)}`);if(!r.ok)throw new Error("v.gd API failed");const s=await r.text();if(s.includes("Error")||!s.startsWith("http"))throw new Error("Invalid response from v.gd");return s.trim()}}];for(const t of e)try{console.log(`Trying ${t.name} for URL shortening...`);const r=await t.createUrl(n);return console.log(` ${t.name} success:`,r),r}catch(r){console.warn(` ${t.name} failed:`,r);continue}return console.warn("All URL shortening services failed, using original URL"),n},ig=[{id:"default",lightThemeClass:"bg-solid-default",darkThemeClass:"bg-solid-default",lightNameKey:"settings_bg_default",darkNameKey:"settings_bg_default_dark"},{id:"pink",lightThemeClass:"bg-solid-pink",darkThemeClass:"bg-solid-pink",lightNameKey:"settings_bg_pink",darkNameKey:"settings_bg_cherry_noir"},{id:"blue",lightThemeClass:"bg-solid-blue",darkThemeClass:"bg-solid-blue",lightNameKey:"settings_bg_blue",darkNameKey:"settings_bg_deep_ocean"},{id:"green",lightThemeClass:"bg-solid-green",darkThemeClass:"bg-solid-green",lightNameKey:"settings_bg_green",darkNameKey:"settings_bg_forest_green"},{id:"purple",lightThemeClass:"bg-solid-purple",darkThemeClass:"bg-solid-purple",lightNameKey:"settings_bg_purple",darkNameKey:"settings_bg_royal_purple"}],_4=()=>{const[n,e]=W.useState(null),[t,r]=W.useState(!1),[s,i]=W.useState(()=>localStorage.getItem("nova-lang")||"ko"),[o,a]=W.useState([]),[u,c]=W.useState(()=>{const F=localStorage.getItem("nova-allocations");return F?JSON.parse(F):[]}),[d,f]=W.useState("all"),[m,_]=W.useState("auto"),[E,k]=W.useState(()=>{const F=localStorage.getItem("nova-theme");return F==="system"||!F?d4()==="dark":F==="dark"}),[N,x]=W.useState(()=>localStorage.getItem("nova-theme")||"system"),[y,S]=W.useState("default"),[R,j]=W.useState(()=>localStorage.getItem("nova-display-option")||"both"),[M,w]=W.useState(()=>{const F=localStorage.getItem("nova-auto-sync");return F===null?!0:F==="true"}),[v,T]=W.useState(!1),[A,b]=W.useState(null),[P,C]=W.useState(null),[Ne,je]=W.useState(!1),[kn,Cn]=W.useState(!1),[K,oe]=W.useState(!1),[ee,pe]=W.useState(null),[Ce,pn]=W.useState(!1),[Ze,mn]=W.useState(new Set),[dt,Ke]=W.useState(""),[Te,Lt]=W.useState("idle"),[zn,ku]=W.useState(!1),[aa,Ni]=W.useState(!1),[Cu,Ru]=W.useState(!1),[cr,la]=W.useState(()=>localStorage.getItem("nova-api-key")||""),[qn,ft]=W.useState(()=>localStorage.getItem("nova-offline-mode")==="true"),re=W.useCallback(F=>p4[s][F]||F,[s]),Vr=W.useCallback(F=>{const q=F||cr;if(qn||!q)return null;try{return new ge({apiKey:q,dangerouslyAllowBrowser:!0})}catch(G){return console.error("Failed to create AI instance:",G),null}},[cr,qn]),cf=W.useCallback(F=>{x(F)},[]),Di=W.useMemo(()=>[re("empty_encouragement_1"),re("empty_encouragement_2"),re("empty_encouragement_3"),re("empty_encouragement_4")],[re]),hf=W.useMemo(()=>Di[Math.floor(Math.random()*Di.length)],[Di]),Wn=W.useCallback(async F=>{try{console.log("Firestore   ...",F);const q=DI(sg,"users",F),G=await r4(q);if(G.exists()){const ae=G.data();console.log(" :",ae),ae.assignments&&Array.isArray(ae.assignments)&&(a(ae.assignments),console.log("  :",ae.assignments.length,"")),ae.allocations&&Array.isArray(ae.allocations)&&(c(ae.allocations),console.log("  :",ae.allocations.length,""))}else{console.log("Firestore   .");const ae=localStorage.getItem("nova-todos"),Xe=localStorage.getItem("nova-allocations");if(ae){const ce=JSON.parse(ae);a(ce),console.log("   :",ce.length,"")}if(Xe){const ce=JSON.parse(Xe);c(ce),console.log("   :",ce.length,"")}}}catch(q){console.error("Firestore   :",q)}},[]),Ps=W.useCallback(async(F,q)=>{if(!n){console.log("    Firestore  .");return}try{console.log("Firestore  ...",{assignments:F.length,allocations:q.length});const G=Re=>{if(Array.isArray(Re))return Re.map(Ge=>G(Ge));if(Re!==null&&typeof Re=="object"){const Ge={};for(const Oe in Re)Oe==="wish"||Oe==="outcome"||Oe==="obstacle"||Oe==="plan"||Oe==="isRecurring"||Oe==="recurringDays"||Oe==="lastCompletedDate"||Oe==="streak"||Re[Oe]!==void 0&&(Ge[Oe]=G(Re[Oe]));return Ge}return Re},ae=G(F),Xe=G(q),ce=DI(sg,"users",n.uid);await i4(ce,{assignments:ae,allocations:Xe,updatedAt:l4()},{merge:!0}),console.log("Firestore  !")}catch(G){throw console.error("Firestore  :",G),G}},[n]),ua=W.useCallback(async()=>{try{await xD(uh,Au),Ke(" !")}catch(F){console.error(" :",F);let q="   .";F.code==="auth/operation-not-allowed"?q=`Firebase Console Google   .

1. Firebase Console 
2. Authentication > Sign-in method
3. Google  `:F.code==="auth/unauthorized-domain"?q="   . Firebase Console  .":F.code==="auth/popup-blocked"?q=" .    .":F.code==="auth/popup-closed-by-user"&&(q=" ."),pe({title:" ",message:q})}},[]),Oi=W.useCallback(async()=>{try{await aD(uh),a([]),c([]),Ke(" .")}catch(F){console.error(" :",F)}},[]),df=W.useCallback(async()=>{if(!n){Ke(" .");return}try{Ke(" ..."),await Ps(o,u),await Wn(n.uid),Ke("  !")}catch(F){console.error(" :",F),Ke(" .  .")}},[n,o,u,Ps,Wn]);W.useEffect(()=>{let F=!0;r(!0);const q=oD(uh,async G=>{if(F)try{if(e(G),G)await Wn(G.uid);else{const ae=localStorage.getItem("nova-todos"),Xe=localStorage.getItem("nova-allocations");if(ae)try{const ce=JSON.parse(ae);a(ce)}catch(ce){console.error("   :",ce)}if(Xe)try{const ce=JSON.parse(Xe);c(ce)}catch(ce){console.error("    :",ce)}}}catch(ae){console.error("    :",ae)}finally{F&&r(!1)}},G=>{console.error("Firebase  :",G),F&&r(!1)});return()=>{F=!1,q()}},[Wn]),W.useEffect(()=>{const F=localStorage.getItem("nova-dark-mode"),q=localStorage.getItem("nova-background"),G=localStorage.getItem("nova-sort-type");F&&k(JSON.parse(F)),q&&S(q),G&&_(G)},[]),W.useEffect(()=>{const q=new URLSearchParams(window.location.search).get("data");if(q)try{const G=m4(q),ae=JSON.parse(G);if(Array.isArray(ae)&&(ae.length===0||"title"in ae[0]&&"id"in ae[0]))pe({title:re("url_import_title"),message:re("url_import_message"),confirmText:re("url_import_confirm"),cancelText:re("cancel_button"),onConfirm:()=>{a(ae),Ke(re("url_import_success")),window.history.replaceState({},document.title,window.location.pathname)},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});else throw new Error("Invalid data format")}catch(G){console.error("Failed to parse data from URL",G),pe({title:re("import_error_alert_title"),message:re("url_import_error")}),window.history.replaceState({},document.title,window.location.pathname)}},[re]),W.useEffect(()=>{const F=window.matchMedia("(prefers-color-scheme: dark)"),q=G=>{N==="system"&&k(G.matches)};return k(N==="system"?F.matches:N==="dark"),F.addEventListener("change",q),()=>F.removeEventListener("change",q)},[N]),W.useEffect(()=>{(()=>{const q=localStorage.getItem("pwa-prompt-dismissed"),G=c4(),ae=h4();if(G&&!ae&&!q){const Xe=setTimeout(()=>{Ru(!0)},3e3);return()=>clearTimeout(Xe)}})()},[]),W.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/Nova-AI-Planer/sw.js").then(F=>{console.log("SW registered: ",F)}).catch(F=>{console.log("SW registration failed: ",F)})},[]),W.useEffect(()=>{localStorage.setItem("nova-theme",N),localStorage.setItem("nova-dark-mode",JSON.stringify(E))},[N,E]),W.useEffect(()=>{localStorage.setItem("nova-lang",s)},[s]),W.useEffect(()=>{localStorage.setItem("nova-display-option",R)},[R]),W.useEffect(()=>{localStorage.setItem("nova-auto-sync",String(M))},[M]),W.useEffect(()=>{if(!t&&(n||localStorage.setItem("nova-todos",JSON.stringify(o)),n&&o.length>0&&M)){const F=setTimeout(()=>{Ps(o,u)},3e3);return()=>clearTimeout(F)}},[o,n,t,M]),W.useEffect(()=>{if(!t&&(n||localStorage.setItem("nova-allocations",JSON.stringify(u)),n&&u.length>0&&M)){const F=setTimeout(()=>{Ps(o,u)},3e3);return()=>clearTimeout(F)}},[u,n,t,M]),W.useEffect(()=>{localStorage.setItem("nova-api-key",cr)},[cr]),W.useEffect(()=>{localStorage.setItem("nova-offline-mode",String(qn))},[qn]),W.useEffect(()=>{const F=ig.find(G=>G.id===y)||ig[0],q=E?F.darkThemeClass:F.lightThemeClass;document.body.className="",E&&document.body.classList.add("dark-mode"),q&&document.body.classList.add(q),localStorage.setItem("nova-background",y)},[y,E]),W.useEffect(()=>{localStorage.setItem("nova-sort-type",m)},[m]),W.useEffect(()=>{if(dt){const F=setTimeout(()=>Ke(""),3e3);return()=>clearTimeout(F)}},[dt]);const Pu=W.useCallback(F=>{const q=F.filter(ce=>!ce.completed),G=new Date;G.setHours(0,0,0,0);const ae=[];[...q].sort((ce,Re)=>{const Ge=Math.ceil((new Date(ce.deadline).getTime()-G.getTime())/864e5),Oe=Math.ceil((new Date(Re.deadline).getTime()-G.getTime())/(1e3*60*60*24));return Ge!==Oe?Ge-Oe:ce.estimatedTime!==Re.estimatedTime?Re.estimatedTime-ce.estimatedTime:Re.difficulty-ce.difficulty}).forEach(ce=>{const Re=new Date(ce.deadline);Re.setHours(0,0,0,0);const Ge=Math.ceil((Re.getTime()-G.getTime())/(1e3*60*60*24));if(Ge<=0)return;const Oe=Math.ceil(ce.estimatedTime/Ge);for(let Rn=0;Rn<Ge;Rn++){const Ct=new Date(G);Ct.setDate(G.getDate()+Rn);const gn=Ct.toISOString().split("T")[0];ae.push({assignmentId:ce.id,date:gn,allocatedTime:Oe,completed:!1})}}),c(ae)},[]);W.useEffect(()=>{o.length>0?Pu(o):c([])},[o,Pu]);const ca=W.useMemo(()=>{const F=new Date().toISOString().split("T")[0];return u.filter(q=>q.date===F)},[u]),Nu=W.useMemo(()=>ca.map(F=>{const q=o.find(G=>G.id===F.assignmentId);return q?{...q,todayTime:F.allocatedTime,allocationCompleted:F.completed}:null}).filter(F=>F!==null),[ca,o]),Ns=W.useMemo(()=>{let F=[...o];if(m==="auto"){const q=new Date;q.setHours(0,0,0,0),F.sort((G,ae)=>{const Xe=Math.ceil((new Date(G.deadline).getTime()-q.getTime())/864e5),ce=Math.ceil((new Date(ae.deadline).getTime()-q.getTime())/(1e3*60*60*24));return Xe!==ce?Xe-ce:G.estimatedTime!==ae.estimatedTime?ae.estimatedTime-G.estimatedTime:ae.difficulty-G.difficulty})}else m==="deadline"?F.sort((q,G)=>!q.deadline&&!G.deadline?0:q.deadline?G.deadline?new Date(q.deadline).getTime()-new Date(G.deadline).getTime():-1:1):m==="difficulty"?F.sort((q,G)=>G.difficulty-q.difficulty):m==="time"&&F.sort((q,G)=>G.estimatedTime-q.estimatedTime);return d==="active"?F.filter(q=>!q.completed):d==="completed"?F.filter(q=>q.completed):F},[o,d,m]),ha=F=>{const q={...F,id:Date.now(),completed:!1,totalAllocatedTime:0};a(G=>[q,...G]),T(!1)},da=F=>{a(o.map(q=>q.id===F.id?F:q)),b(null)},hr=F=>{a(o.filter(q=>q.id!==F)),c(u.filter(q=>q.assignmentId!==F))},Du=F=>{const q=new Date().toISOString().split("T")[0];a(o.map(G=>{if(G.id===F){const ae=G.completedDates||[],Xe=ae.includes(q);let ce;Xe?ce=ae.filter(Ge=>Ge!==q):ce=[...ae,q];const Re=G.completed||!Xe&&ae.length>0;return{...G,completedDates:ce,completed:ce.length>0?Re:!1}}return G})),c(u.map(G=>G.assignmentId===F&&G.date===q?{...G,completed:!G.completed}:G))},Vi=async F=>{if(F==="ai"){if(o.length<2){pe({title:re("sort_alert_title"),message:re("sort_alert_message")});return}Cn(!0);try{const q=Vr();if(!q){Ke(qn?"  AI    .":"AI    API  ."),Cn(!1),_("manual");return}const G=`Here is a list of assignments with their details (title, subject, deadline, difficulty, estimatedTime). Prioritize them based on urgency (closer deadline), difficulty, and time required. Return a JSON object with a single key "sorted_ids" which is an array of the assignment IDs in the recommended order. Do not include any other text or explanations. Assignments: ${JSON.stringify(o.map(({id:Ct,title:gn,subject:Lu,deadline:ju,difficulty:fa,estimatedTime:pa})=>({id:Ct,title:gn,subject:Lu,deadline:ju,difficulty:fa,estimatedTime:pa})))}`,ae=await q.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:"You are an assignment prioritization expert."},{role:"user",content:G}],response_format:{type:"json_object"},temperature:.7}),ce=JSON.parse(ae.choices[0].message.content||"{}").sorted_ids.map(Number),Re=new Map(o.map(Ct=>[Number(Ct.id),Ct])),Ge=ce.map(Ct=>Re.get(Ct)).filter(Boolean),Oe=o.filter(Ct=>!ce.includes(Number(Ct.id))),Rn=[...Ge,...Oe].map(Ct=>({...Ct,id:Number(Ct.id)}));a(Rn),_("manual")}catch(q){console.error("AI sort failed:",q),pe({title:re("ai_sort_error_title"),message:re("ai_sort_error_message")})}finally{Cn(!1)}}else _(F)},Ou=F=>{const q=new Set(Ze);q.has(F)?q.delete(F):q.add(F),mn(q)},Mr=()=>{pn(!1),mn(new Set)},Vu=()=>{const F=Ze.size;pe({title:re("delete_selected_confirm_title"),message:re("delete_selected_confirm_message").replace("{count}",String(F)),isDestructive:!0,confirmText:re("delete_selected_button_label").replace("{count}",String(F)),cancelText:re("cancel_button"),onConfirm:()=>{a(o.filter(q=>!Ze.has(q.id))),Mr()}})},wt=()=>{Lt("exporting");const F=JSON.stringify(o,null,2),q="data:application/json;charset=utf-8,"+encodeURIComponent(F),G="nova_goals.json",ae=document.createElement("a");ae.setAttribute("href",q),ae.setAttribute("download",G),ae.click(),setTimeout(()=>{Lt("idle"),je(!1)},1500)},Mu=F=>{var ae;const q=(ae=F.target.files)==null?void 0:ae[0];if(!q)return;const G=new FileReader;G.onload=Xe=>{var ce;try{const Re=(ce=Xe.target)==null?void 0:ce.result;if(typeof Re!="string")throw new Error("File content is not a string");const Ge=JSON.parse(Re);if(Array.isArray(Ge)&&Ge.every(Oe=>"title"in Oe&&"id"in Oe))pe({title:re("import_confirm_title"),message:re("import_confirm_message"),confirmText:re("settings_import_data"),cancelText:re("cancel_button"),onConfirm:()=>{Lt("importing"),setTimeout(()=>{a(Ge),Ke(re("import_success_toast")),Lt("idle"),je(!1)},1500)}});else throw new Error("Invalid file format")}catch{pe({title:re("import_error_alert_title"),message:re("import_error_alert_message")})}},G.onerror=()=>pe({title:re("import_error_alert_title"),message:re("import_error_alert_message")}),G.readAsText(q),F.target.value=""},Ds=()=>{Lt("deleting"),setTimeout(()=>{a([]),i("ko"),k(!0),S("default"),_("manual"),localStorage.clear(),Lt("idle"),je(!1)},1500)},Os=v||!!A||!!P||Ne||!!ee||zn||aa;return g.jsxs("div",{className:`main-page-layout ${K?"calendar-view-active":""}`,children:[g.jsx("div",{className:`page-content ${Os?"modal-open":""}`,children:g.jsxs("div",{className:"container",children:[g.jsx(y4,{t:re,isSelectionMode:Ce,selectedCount:Ze.size,onCancelSelection:Mr,onDeleteSelected:Vu,isViewModeCalendar:K,onToggleViewMode:()=>oe(!K),isAiSorting:kn,sortType:m,onSort:Vi,filter:d,onFilter:f,onSetSelectionMode:()=>pn(!0),onOpenSettings:()=>je(!0),onAddGoal:()=>T(!0),user:n,onSync:df,onLogin:ua,onLogout:Oi}),K?g.jsx(S4,{todos:o,t:re,onGoalClick:C,language:s}):g.jsx(v4,{todos:Ns,todayAssignments:Nu,onToggleComplete:Du,onDelete:hr,onEdit:b,onInfo:C,t:re,filter:d,randomEncouragement:hf,isSelectionMode:Ce,selectedTodoIds:Ze,onSelectTodo:Ou,displayOption:R})]})}),v&&g.jsx(BI,{onClose:()=>T(!1),onAddTodo:ha,t:re,createAI:Vr}),A&&g.jsx(BI,{onClose:()=>b(null),onEditTodo:da,existingTodo:A,t:re,createAI:Vr}),P&&g.jsx(w4,{todo:P,onClose:()=>C(null),t:re}),Ne&&g.jsx(I4,{onClose:()=>je(!1),isDarkMode:E,onToggleDarkMode:()=>k(!E),themeMode:N,onThemeChange:cf,backgroundTheme:y,onSetBackgroundTheme:S,onExportData:wt,onImportData:Mu,setAlertConfig:pe,onDeleteAllData:Ds,dataActionStatus:Te,language:s,onSetLanguage:i,t:re,todos:o,setToastMessage:Ke,onOpenVersionInfo:()=>ku(!0),onOpenUsageGuide:()=>Ni(!0),apiKey:cr,onSetApiKey:la,isOfflineMode:qn,onToggleOfflineMode:()=>ft(!qn),user:n,onGoogleLogin:ua,onLogout:Oi,displayOption:R,onSetDisplayOption:j,autoSync:M,onToggleAutoSync:()=>w(!M)}),zn&&g.jsx(E4,{onClose:()=>ku(!1),t:re}),aa&&g.jsx(T4,{onClose:()=>Ni(!1),t:re}),ee&&g.jsx(A4,{title:ee.title,message:ee.message,onConfirm:()=>{var F;(F=ee.onConfirm)==null||F.call(ee),pe(null)},onCancel:ee.onCancel?()=>{var F;(F=ee.onCancel)==null||F.call(ee),pe(null)}:void 0,confirmText:ee.confirmText,cancelText:ee.cancelText,isDestructive:ee.isDestructive,t:re}),dt&&g.jsx("div",{className:"toast-notification",children:dt}),Cu&&g.jsx(f4,{onClose:()=>Ru(!1)})]})},y4=({t:n,isSelectionMode:e,selectedCount:t,onCancelSelection:r,onDeleteSelected:s,isViewModeCalendar:i,onToggleViewMode:o,isAiSorting:a,sortType:u,onSort:c,filter:d,onFilter:f,onSetSelectionMode:m,onOpenSettings:_,onAddGoal:E,user:k,onSync:N,onLogin:x,onLogout:y})=>{const[S,R]=W.useState(!1),[j,M]=W.useState(!1);W.useEffect(()=>{const A=()=>{R(!1),M(!1)};return document.addEventListener("click",A),document.addEventListener("touchstart",A),()=>{document.removeEventListener("click",A),document.removeEventListener("touchstart",A)}},[]);const w=A=>{A.stopPropagation(),R(b=>!b)},v=A=>{A.stopPropagation(),M(b=>!b)},T=A=>{A.stopPropagation()};return g.jsxs("header",{children:[g.jsx("div",{className:"header-left",children:e&&g.jsx("button",{onClick:r,className:"header-action-button",children:n("cancel_selection_button_label")})}),g.jsxs("div",{className:"header-title-group",children:[g.jsx("h1",{children:n("my_assignments_title")}),!e&&g.jsxs("div",{className:"header-inline-actions",style:{gap:"8px"},children:[g.jsx("button",{onClick:o,className:"header-icon-button",style:{transition:"all 0.2s ease"},"aria-label":n(i?"list_view_button_aria":"calendar_view_button_aria"),children:i?fe.list:fe.calendar}),k&&g.jsx("button",{onClick:N,className:"header-icon-button",style:{transition:"all 0.2s ease"},"aria-label":"",title:" ",children:fe.sync}),g.jsxs("div",{className:"filter-sort-container",children:[g.jsx("button",{onClick:w,onTouchStart:w,className:"header-icon-button",style:{transition:"all 0.2s ease"},"aria-label":n("filter_sort_button_aria"),children:a?g.jsx("div",{className:"spinner"}):fe.filter}),S&&g.jsxs("div",{className:"profile-popover filter-sort-popover",onClick:T,onTouchStart:T,children:[g.jsx("div",{className:"popover-section",children:g.jsx("button",{onClick:()=>{m(),R(!1)},className:"popover-action-button",children:g.jsx("span",{children:n("select_button_label")})})}),g.jsxs("div",{className:"popover-section",children:[g.jsx("h4",{children:n("filter_title")}),g.jsxs("button",{onClick:()=>{f("all")},className:`popover-action-button ${d==="all"?"active":""}`,children:[g.jsx("span",{children:n("filter_all")}),d==="all"&&fe.check]}),g.jsxs("button",{onClick:()=>{f("active")},className:`popover-action-button ${d==="active"?"active":""}`,children:[g.jsx("span",{children:n("filter_active")}),d==="active"&&fe.check]}),g.jsxs("button",{onClick:()=>{f("completed")},className:`popover-action-button ${d==="completed"?"active":""}`,children:[g.jsx("span",{children:n("filter_completed")}),d==="completed"&&fe.check]})]}),g.jsxs("div",{className:"popover-section",children:[g.jsx("h4",{children:n("sort_title")}),g.jsxs("button",{onClick:()=>{c("auto")},className:`popover-action-button ${u==="auto"?"active":""}`,children:[g.jsx("span",{children:n("sort_label_auto")}),u==="auto"&&fe.check]}),g.jsxs("button",{onClick:()=>{c("deadline")},className:`popover-action-button ${u==="deadline"?"active":""}`,children:[g.jsx("span",{children:n("sort_label_deadline")}),u==="deadline"&&fe.check]}),g.jsxs("button",{onClick:()=>{c("difficulty")},className:`popover-action-button ${u==="difficulty"?"active":""}`,children:[g.jsx("span",{children:n("sort_label_difficulty")}),u==="difficulty"&&fe.check]}),g.jsxs("button",{onClick:()=>{c("time")},className:`popover-action-button ${u==="time"?"active":""}`,children:[g.jsx("span",{children:n("sort_label_time")}),u==="time"&&fe.check]})]})]})]}),g.jsx("button",{onClick:_,className:"header-icon-button",style:{transition:"all 0.2s ease"},"aria-label":n("settings_title"),children:fe.settings})]})]}),g.jsx("div",{className:"header-right",children:e?g.jsx("button",{onClick:s,className:"header-action-button destructive",children:n("delete_selected_button_label").replace("{count}",String(t))}):g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:E,className:"header-icon-button",style:{transition:"all 0.2s ease"},"aria-label":n("add_new_assignment_button"),children:fe.add}),g.jsxs("div",{className:"filter-sort-container",children:[g.jsx("button",{onClick:v,onTouchStart:v,className:"header-icon-button profile-button",style:{transition:"all 0.2s ease"},"aria-label":"",children:k?k.photoURL?g.jsx("img",{src:k.photoURL,alt:"",style:{width:"28px",height:"28px",borderRadius:"50%"}}):g.jsx("span",{style:{fontSize:"20px"},children:""}):g.jsx("span",{style:{fontSize:"20px"},children:""})}),j&&g.jsxs("div",{className:"profile-popover",onClick:T,onTouchStart:T,children:[k&&k.displayName&&g.jsxs("div",{className:"popover-section",style:{borderBottom:"1px solid var(--border-color)",paddingBottom:"8px",marginBottom:"8px"},children:[g.jsx("div",{style:{padding:"4px 0",fontWeight:500,color:"var(--text-primary)"},children:k.displayName}),k.email&&g.jsx("div",{style:{padding:"4px 0",fontSize:"12px",color:"var(--text-secondary)"},children:k.email})]}),g.jsx("div",{className:"popover-section",children:k?g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:()=>{_(),M(!1)},className:"popover-action-button",children:g.jsxs("span",{children:[fe.settings," ",n("profile_settings")]})}),g.jsx("button",{onClick:()=>{y(),M(!1)},className:"popover-action-button",children:g.jsxs("span",{children:[" ",n("profile_logout")]})})]}):g.jsx("button",{onClick:()=>{x(),M(!1)},className:"popover-action-button",children:g.jsxs("span",{children:[" ",n("profile_login")]})})})]})]})]})})]})},v4=({todos:n,todayAssignments:e,onToggleComplete:t,onDelete:r,onEdit:s,onInfo:i,t:o,filter:a,randomEncouragement:u,isSelectionMode:c,selectedTodoIds:d,onSelectTodo:f,displayOption:m})=>{n.filter(R=>R.completed).length;const _=n.length,E=new Date().toISOString().split("T")[0],k=e.filter(R=>!(R.completedDates||[]).includes(E)),N=e.length>0;N&&k.length;const x=N&&g.jsxs("div",{className:"today-assignments-section",children:[g.jsxs("h2",{className:"section-title",children:[o("today_schedule_title")," (",k.length,")"]}),k.length>0?g.jsx("ul",{children:k.map(R=>g.jsx($I,{todo:R,todayTime:R.todayTime,showProgress:!1,showCheckbox:!0,onToggleComplete:t,onDelete:r,onEdit:s,onInfo:i,t:o,isSelectionMode:c,isSelected:d.has(R.id),onSelect:f},`today-${R.id}`))}):g.jsxs("div",{style:{padding:"24px",textAlign:"center",backgroundColor:"var(--success-bg)",borderRadius:"12px",margin:"12px 0"},children:[g.jsx("div",{style:{fontSize:"48px",marginBottom:"12px"},children:""}),g.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"var(--success-color)",marginBottom:"4px"},children:" !"}),g.jsx("div",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:"    "})]})]});if(n.length===0&&!N){const R=`empty_message_${a}`;return g.jsxs("div",{className:"empty-message",children:[g.jsx("p",{children:o(R)}),a==="all"&&g.jsx("span",{children:u})]})}const y=(m==="both"||m==="today")&&N,S=(m==="both"||m==="all")&&n.length>0;return g.jsxs("div",{children:[y&&x,S&&g.jsxs("div",{className:"all-assignments-section",children:[g.jsxs("h2",{className:"section-title",children:[o("all_assignments_title")," (",_,")"]}),g.jsx("ul",{children:n.map(R=>g.jsx($I,{todo:R,showProgress:!0,showCheckbox:!1,onToggleComplete:t,onDelete:r,onEdit:s,onInfo:i,t:o,isSelectionMode:c,isSelected:d.has(R.id),onSelect:f},R.id))})]})]})},$I=ZI.memo(({todo:n,todayTime:e,showProgress:t=!0,showCheckbox:r=!0,onToggleComplete:s,onDelete:i,onEdit:o,onInfo:a,t:u,isSelectionMode:c,isSelected:d,onSelect:f})=>{const m=()=>{c&&f(n.id)},_="".repeat(n.difficulty),E=new Date().toISOString().split("T")[0],N=(n.completedDates||[]).includes(E),y=(()=>{if(!n.deadline)return 0;const R=new Date;R.setHours(0,0,0,0);const j=new Date(n.deadline);j.setHours(0,0,0,0);const M=n.completedDates||[],w=M.length>0?new Date(Math.min(...M.map(b=>new Date(b).getTime()))):R;w.setHours(0,0,0,0);const v=Math.ceil((j.getTime()-w.getTime())/(1e3*60*60*24))+1,T=M.length;return v<=0?100:Math.min(100,Math.round(T/v*100))})(),S=R=>{const j=new Date;j.setHours(0,0,0,0);const M=new Date(R);M.setHours(0,0,0,0);const w=M.getTime()-j.getTime(),v=Math.ceil(w/(1e3*60*60*24));return v<0?` D+${Math.abs(v)}`:v===0?" D-Day":` D-${v}`};return g.jsx("li",{className:`${n.completed?"completed":""} ${c?"selection-mode":""} ${d?"selected":""}`,onClick:m,children:g.jsxs("div",{className:"swipeable-content",children:[r&&g.jsxs("label",{className:"checkbox-container",onClick:R=>R.stopPropagation(),children:[g.jsx("input",{type:"checkbox",checked:n.completed,onChange:()=>s(n.id)}),g.jsx("span",{className:"checkmark"})]}),g.jsxs("div",{className:"todo-text-with-info",style:{flex:1,marginLeft:r?"0":"12px"},children:[g.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[g.jsx("span",{className:"todo-text",children:n.title}),!r&&N&&g.jsx("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"2px 8px",backgroundColor:"#3b82f6",color:"white",fontSize:"11px",fontWeight:"600",borderRadius:"12px"},children:" "})]}),g.jsxs("div",{className:"assignment-meta",children:[g.jsx("span",{className:"assignment-subject",children:n.subject}),g.jsx("span",{className:"assignment-difficulty",children:_})]}),g.jsxs("div",{className:"assignment-meta",style:{marginTop:"4px"},children:[n.deadline&&g.jsx("span",{className:"todo-deadline",style:{fontWeight:"600",fontSize:"13px"},children:S(n.deadline)}),e&&g.jsxs("span",{className:"assignment-time",children:["  ",e,""]}),!e&&g.jsxs("span",{className:"assignment-total-time",children:["  ",n.estimatedTime,""]})]}),t&&g.jsxs("div",{style:{marginTop:"8px",width:"100%"},children:[g.jsx("div",{style:{width:"100%",height:"6px",backgroundColor:"var(--border-color)",borderRadius:"3px",overflow:"hidden"},children:g.jsx("div",{style:{width:`${y}%`,height:"100%",backgroundColor:y===100?"#10b981":"#3b82f6",transition:"width 0.3s ease, background-color 0.3s ease",borderRadius:"3px"}})}),g.jsxs("div",{style:{fontSize:"11px",color:"var(--text-secondary)",marginTop:"2px",textAlign:"right"},children:[y,"% "]})]})]}),g.jsx("div",{className:"todo-actions-and-meta",children:g.jsxs("div",{className:"todo-buttons",children:[!r&&N&&g.jsx("button",{onClick:R=>{R.stopPropagation(),s(n.id)},className:"info-button",style:{fontSize:"11px",padding:"4px 8px",backgroundColor:"#ef4444",color:"white",borderRadius:"6px",border:"none"},"aria-label":" ",children:""}),g.jsx("button",{onClick:R=>{R.stopPropagation(),o(n)},className:"info-button edit-button","aria-label":u("edit_button_aria"),children:fe.edit}),g.jsx("button",{onClick:R=>{R.stopPropagation(),i(n.id)},className:"delete-button","aria-label":u("delete_button"),children:fe.delete}),g.jsx("button",{onClick:R=>{R.stopPropagation(),a(n)},className:"info-button","aria-label":u("info_button_aria"),children:fe.info})]})})]})})}),xu=({onClose:n,children:e,className:t="",isClosing:r})=>g.jsx("div",{className:`modal-backdrop ${r?"is-closing":""}`,onClick:n,children:g.jsx("div",{className:`modal-content ${t} ${r?"is-closing":""}`,onClick:s=>s.stopPropagation(),children:e})}),bu=n=>{const[e,t]=W.useState(!1);return[e,()=>{t(!0),setTimeout(n,500)}]},BI=({onClose:n,onAddTodo:e,onEditTodo:t,existingTodo:r,t:s,createAI:i})=>{var b;const[o,a]=bu(n),[u,c]=W.useState((r==null?void 0:r.title)||""),[d,f]=W.useState((r==null?void 0:r.subject)||""),[m,_]=W.useState((r==null?void 0:r.description)||""),[E,k]=W.useState(((b=r==null?void 0:r.estimatedTime)==null?void 0:b.toString())||""),[N,x]=W.useState((r==null?void 0:r.difficulty)||3),[y,S]=W.useState((r==null?void 0:r.deadline)||""),[R,j]=W.useState({}),[M,w]=W.useState(!1),v=()=>{const P={};return u.trim()||(P.title=!0),d.trim()||(P.subject=!0),(!E||parseInt(E)<=0)&&(P.estimatedTime=!0),y||(P.deadline=!0),j(P),Object.keys(P).length===0},T=async()=>{if(!u.trim()||!d.trim()){alert("   .");return}w(!0);try{const P=i();if(!P){alert("AI    API  ."),w(!1);return}const C=`    (1-5)  () :
- : ${u}
- : ${d}
${m?`- : ${m}`:""}

JSON  :
{
  "difficulty": 1-5  ,
  "estimatedTime":   ,
  "reason": "  "
}`,Ne=await P.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:"   .         ."},{role:"user",content:C}],response_format:{type:"json_object"},temperature:.7}),je=JSON.parse(Ne.choices[0].message.content||"{}");x(je.difficulty),k(je.estimatedTime.toString()),w(!1)}catch(P){console.error("AI  :",P),alert("AI  .  ."),w(!1)}},A=()=>{if(!v())return;const P={title:u.trim(),subject:d.trim(),description:m.trim()||void 0,estimatedTime:parseInt(E),difficulty:N,deadline:y};r&&t?t({...r,...P}):e&&e(P)};return g.jsxs(xu,{onClose:a,isClosing:o,className:"assignment-modal",children:[g.jsxs("div",{className:"goal-assistant-header",children:[g.jsx("h2",{children:s(r?"edit_assignment_modal_title":"new_assignment_modal_title")}),g.jsx("button",{onClick:a,className:"close-button",children:fe.close})]}),g.jsxs("div",{className:"goal-assistant-body assignment-form",children:[g.jsxs("div",{className:"form-group",children:[g.jsx("label",{children:s("assignment_title_label")}),g.jsx("input",{type:"text",value:u,onChange:P=>{c(P.target.value),j({...R,title:!1})},placeholder:s("assignment_title_placeholder"),className:R.title?"input-error":""}),R.title&&g.jsxs("p",{className:"field-error-message",children:[fe.exclamation," ",s("error_title_required")]})]}),g.jsxs("div",{className:"form-group",children:[g.jsx("label",{children:s("subject_label")}),g.jsx("input",{type:"text",value:d,onChange:P=>{f(P.target.value),j({...R,subject:!1})},placeholder:s("subject_placeholder"),className:R.subject?"input-error":""}),R.subject&&g.jsxs("p",{className:"field-error-message",children:[fe.exclamation," ",s("error_subject_required")]})]}),g.jsxs("div",{className:"form-group",children:[g.jsx("label",{children:s("description_label")}),g.jsx("textarea",{value:m,onChange:P=>_(P.target.value),placeholder:s("description_placeholder"),rows:3,style:{width:"100%",padding:"12px",border:"1px solid var(--border-color)",borderRadius:"8px",fontSize:"14px",resize:"vertical",fontFamily:"inherit"}})]}),g.jsxs("div",{className:"form-group",children:[g.jsx("label",{children:s("estimated_time_label")}),g.jsxs("div",{style:{position:"relative"},children:[g.jsx("input",{type:"number",value:E,onChange:P=>{k(P.target.value),j({...R,estimatedTime:!1})},placeholder:s("estimated_time_placeholder"),className:R.estimatedTime?"input-error":"",min:"1",style:{paddingRight:"40px"}}),g.jsx("span",{style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-secondary)",pointerEvents:"none"},children:""})]}),R.estimatedTime&&g.jsxs("p",{className:"field-error-message",children:[fe.exclamation," ",s("error_time_required")]})]}),g.jsxs("div",{className:"form-group",children:[g.jsx("label",{children:s("difficulty_label")}),g.jsx("div",{className:"difficulty-selector",style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"8px",marginTop:"8px"},children:[1,2,3,4,5].map(P=>g.jsx("button",{type:"button",className:`difficulty-button ${N===P?"selected":""}`,onClick:()=>x(P),style:{padding:"12px",border:N===P?"2px solid var(--primary-color)":"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:N===P?"var(--primary-color)":"transparent",color:N===P?"white":"var(--text-primary)",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},children:P},P))}),g.jsx("p",{style:{marginTop:"8px",fontSize:"13px",color:"var(--text-secondary)",textAlign:"center"},children:s(`difficulty_${N}`)})]}),g.jsxs("div",{className:"form-group",children:[g.jsx("label",{children:s("deadline_label")}),g.jsx("input",{type:"date",value:y,onChange:P=>{S(P.target.value),j({...R,deadline:!1})},className:R.deadline?"input-error":""}),R.deadline&&g.jsxs("p",{className:"field-error-message",children:[fe.exclamation," ",s("error_deadline_required")]})]}),g.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"16px"},children:g.jsx("button",{type:"button",onClick:T,disabled:M||!u.trim()||!d.trim(),style:{padding:"10px 20px",backgroundColor:M?"var(--border-color)":"var(--primary-color)",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:M||!u.trim()||!d.trim()?"not-allowed":"pointer",opacity:M||!u.trim()||!d.trim()?.6:1,transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px"},children:M?" "+s("ai_analyzing"):" "+s("ai_analyze_button")})})]}),g.jsxs("div",{className:"modal-buttons",style:{display:"flex",justifyContent:"center",gap:"16px",marginTop:"24px"},children:[g.jsx("button",{onClick:a,className:"circular-button secondary",style:{width:"56px",height:"56px",borderRadius:"50%",border:"2px solid var(--border-color)",backgroundColor:"transparent",color:"var(--text-primary)",fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease"},"aria-label":s("cancel_button"),children:""}),g.jsx("button",{onClick:A,className:"circular-button primary",style:{width:"56px",height:"56px",borderRadius:"50%",border:"none",backgroundColor:"var(--primary-color)",color:"white",fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(59, 130, 246, 0.3)"},"aria-label":s(r?"save_button":"add_button"),children:""})]})]})},w4=({todo:n,onClose:e,t})=>{const[r,s]=bu(e);return g.jsxs(xu,{onClose:s,isClosing:r,className:"info-modal",children:[g.jsxs("div",{className:"info-modal-content",children:[g.jsx("h2",{children:t("goal_details_modal_title")}),g.jsxs("div",{className:"info-section",children:[g.jsx("h4",{children:t("assignment_title_label")}),g.jsx("p",{children:n.title})]}),g.jsxs("div",{className:"info-section",children:[g.jsx("h4",{children:t("subject_label")}),g.jsx("p",{children:n.subject})]}),n.description&&g.jsxs("div",{className:"info-section",children:[g.jsx("h4",{children:t("description_label")}),g.jsx("p",{children:n.description})]}),g.jsxs("div",{className:"info-section",children:[g.jsx("h4",{children:t("estimated_time_label")}),g.jsxs("p",{children:[n.estimatedTime,""]})]}),g.jsxs("div",{className:"info-section",children:[g.jsx("h4",{children:t("difficulty_label")}),g.jsx("p",{children:"".repeat(n.difficulty)})]}),n.deadline&&g.jsxs("div",{className:"info-section",children:[g.jsx("h4",{children:t("deadline_label")}),g.jsx("p",{children:new Date(n.deadline).toLocaleDateString()})]})]}),g.jsx("div",{className:"modal-buttons",children:g.jsx("button",{onClick:s,className:"primary",children:t("close_button")})})]})},I4=({onClose:n,isDarkMode:e,onToggleDarkMode:t,themeMode:r,onThemeChange:s,backgroundTheme:i,onSetBackgroundTheme:o,onExportData:a,onImportData:u,setAlertConfig:c,onDeleteAllData:d,dataActionStatus:f,language:m,onSetLanguage:_,t:E,todos:k,setToastMessage:N,onOpenVersionInfo:x,onOpenUsageGuide:y,apiKey:S,onSetApiKey:R,isOfflineMode:j,onToggleOfflineMode:M,user:w,onGoogleLogin:v,onLogout:T,displayOption:A,onSetDisplayOption:b,autoSync:P,onToggleAutoSync:C})=>{const[Ne,je]=bu(n),[kn,Cn]=W.useState("appearance"),[K,oe]=W.useState(""),[ee,pe]=W.useState(!1),Ce=W.useRef(null),pn=[{id:"appearance",label:E("settings_section_background"),icon:fe.background},{id:"general",label:E("settings_section_general"),icon:fe.settings},{id:"data",label:E("settings_section_data"),icon:fe.data}],Ze=()=>c({title:E("delete_account_header"),message:E("delete_account_header_desc"),isDestructive:!0,confirmText:E("delete_all_data_button"),cancelText:E("cancel_button"),onConfirm:d,onCancel:()=>{}}),mn=async()=>{if(!k||k.length===0){alert(E("no_data_to_share"));return}pe(!0);try{const Te=UI(k),Lt=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(Te)}`,zn=await g4(Lt);oe(zn),zn!==Lt&&zn.length<Lt.length?N(E("short_url_created")):N(E("share_link_created"))}catch(Te){console.error("Failed to create share link",Te);const Lt=UI(k),zn=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(Lt)}`;oe(zn),N(E("short_url_failed"))}finally{pe(!1)}},dt=()=>{K&&navigator.clipboard.writeText(K).then(()=>{N(E("link_copied_toast"))})},Ke=()=>{switch(kn){case"appearance":return g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"settings-section-header",children:" "}),g.jsxs("div",{className:"settings-section-body",children:[g.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>s("light"),children:[g.jsxs("div",{children:[g.jsx("span",{children:" "}),g.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"   "})]}),r==="light"&&fe.check]}),g.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>s("dark"),children:[g.jsxs("div",{children:[g.jsx("span",{children:" "}),g.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"   "})]}),r==="dark"&&fe.check]}),g.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>s("system"),children:[g.jsxs("div",{children:[g.jsx("span",{children:"  "}),g.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:"     "})]}),r==="system"&&fe.check]})]}),g.jsx("div",{className:"settings-section-header",children:E("settings_background_header")}),g.jsx("div",{className:"settings-section-body",children:ig.map(Te=>g.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>o(Te.id),children:[g.jsx("span",{children:E(e?Te.darkNameKey:Te.lightNameKey)}),i===Te.id&&fe.check]},Te.id))})]});case"general":return g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"settings-section-header",children:E("settings_display_header")}),g.jsx("div",{className:"settings-section-desc",children:E("settings_display_header_desc")}),g.jsxs("div",{className:"settings-section-body",children:[g.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>b("both"),children:[g.jsx("span",{children:E("display_option_both")}),A==="both"&&fe.check]}),g.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>b("today"),children:[g.jsx("span",{children:E("display_option_today")}),A==="today"&&fe.check]}),g.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>b("all"),children:[g.jsx("span",{children:E("display_option_all")}),A==="all"&&fe.check]})]}),w&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"settings-section-header",children:E("settings_sync_header")}),g.jsx("div",{className:"settings-section-desc",children:E("settings_sync_header_desc")}),g.jsx("div",{className:"settings-section-body",children:g.jsxs("label",{className:"settings-item",children:[g.jsxs("div",{children:[g.jsx("span",{children:E(P?"sync_auto_enabled":"sync_auto_disabled")}),g.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:P?"   3   ":"  "})]}),g.jsxs("div",{className:"theme-toggle-switch",children:[g.jsx("input",{type:"checkbox",checked:P,onChange:C}),g.jsx("span",{className:"slider round"})]})]})})]}),g.jsx("div",{className:"settings-section-header",children:E("settings_api_key")}),g.jsxs("div",{className:"settings-section-body",children:[g.jsx("div",{className:"settings-item",children:g.jsx("input",{type:"password",placeholder:E("settings_api_key_placeholder"),value:S,onChange:Te=>R(Te.target.value),style:{width:"100%",padding:"8px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--input-bg)"}})}),g.jsxs("label",{className:"settings-item",children:[g.jsxs("div",{children:[g.jsx("span",{children:E("settings_offline_mode")}),g.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("settings_offline_mode_desc")})]}),g.jsxs("div",{className:"theme-toggle-switch",children:[g.jsx("input",{type:"checkbox",checked:j,onChange:M}),g.jsx("span",{className:"slider round"})]})]})]}),g.jsx("div",{className:"settings-section-header",children:E("settings_language")}),g.jsxs("div",{className:"settings-section-body",children:[g.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>_("ko"),children:[g.jsx("span",{children:""}),m==="ko"&&fe.check]}),g.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>_("en"),children:[g.jsx("span",{children:"English"}),m==="en"&&fe.check]})]}),g.jsx("div",{className:"settings-section-header",children:E("settings_section_info")}),g.jsxs("div",{className:"settings-section-body",children:[g.jsxs("div",{className:"settings-item nav-indicator",onClick:x,children:[g.jsx("span",{children:E("settings_version")}),g.jsxs("div",{className:"settings-item-value-with-icon",children:[g.jsx("span",{children:"1.2"}),fe.forward]})]}),g.jsxs("div",{className:"settings-item nav-indicator",onClick:y,children:[g.jsx("span",{children:E("usage_guide_title")}),g.jsx("div",{className:"settings-item-value-with-icon",children:fe.forward})]}),g.jsxs("div",{className:"settings-item",children:[g.jsx("span",{children:E("settings_developer")}),g.jsx("span",{className:"settings-item-value",children:E("developer_name")})]}),g.jsxs("div",{className:"settings-item",children:[g.jsx("span",{children:E("settings_copyright")}),g.jsx("span",{className:"settings-item-value",children:E("copyright_notice")})]})]})]});case"data":return g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"settings-section-header",children:E("settings_data_header")}),g.jsxs("div",{className:"settings-section-body",children:[g.jsx("button",{className:"settings-item action-item",onClick:a,disabled:f!=="idle",children:g.jsx("span",{className:"action-text",children:E(f==="exporting"?"data_exporting":"settings_export_data")})}),g.jsxs("button",{className:"settings-item action-item",onClick:()=>{var Te;return(Te=Ce.current)==null?void 0:Te.click()},disabled:f!=="idle",children:[g.jsx("span",{className:"action-text",children:E(f==="importing"?"data_importing":"settings_import_data")}),g.jsx("input",{type:"file",ref:Ce,onChange:u,accept:".json",style:{display:"none"}})]})]}),g.jsx("div",{className:"settings-section-header",children:E("settings_share_link_header")}),g.jsxs("div",{className:"settings-section-body",children:[!K&&g.jsx("button",{className:"settings-item action-item",onClick:mn,disabled:ee,children:g.jsx("span",{className:"action-text",children:ee?"  URL  ...":E("settings_generate_link")})}),K&&g.jsxs("div",{className:"share-link-container",children:[g.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px",opacity:.7},children:[K.length<100?"  URL":"  ","(",K.length,")"]}),g.jsx("input",{type:"text",readOnly:!0,value:K,onClick:Te=>Te.target.select()}),g.jsx("button",{onClick:dt,children:E("settings_copy_link")})]})]}),g.jsx("div",{className:"settings-section-header",children:""}),g.jsx("div",{className:"settings-section-body",children:w?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"settings-item",style:{flexDirection:"column",alignItems:"flex-start",gap:"8px"},children:g.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",width:"100%"},children:[w.photoURL&&g.jsx("img",{src:w.photoURL,alt:"Profile",style:{width:"40px",height:"40px",borderRadius:"50%"}}),g.jsxs("div",{style:{flex:1},children:[g.jsx("div",{style:{fontWeight:"600"},children:w.displayName||""}),g.jsx("div",{style:{fontSize:"13px",opacity:.7},children:w.email})]})]})}),g.jsx("button",{className:"settings-item action-item",onClick:T,style:{justifyContent:"center"},children:g.jsx("span",{className:"action-text",children:""})})]}):g.jsx("button",{className:"settings-item action-item",onClick:v,style:{justifyContent:"center",backgroundColor:"var(--primary-color)",color:"white"},children:g.jsx("span",{className:"action-text",children:" Google "})})}),g.jsx("div",{className:"settings-section-header",children:E("settings_delete_account")}),g.jsx("div",{className:"settings-section-body",children:g.jsx("button",{className:"settings-item action-item",onClick:Ze,disabled:f!=="idle",children:g.jsx("span",{className:"action-text destructive",children:E(f==="deleting"?"data_deleting":"settings_delete_account")})})})]});default:return null}};return g.jsxs(xu,{onClose:je,isClosing:Ne,className:"settings-modal",children:[g.jsxs("div",{className:"settings-modal-header",children:[g.jsx("div",{}),g.jsx("h2",{children:E("settings_title")}),g.jsx("div",{className:"settings-modal-header-right",children:g.jsx("button",{onClick:je,className:"close-button",children:fe.close})})]}),g.jsxs("div",{className:"settings-modal-body",children:[g.jsx("div",{className:"settings-tabs",children:pn.map(Te=>g.jsxs("button",{className:`settings-tab-button ${kn===Te.id?"active":""}`,onClick:()=>Cn(Te.id),"aria-label":Te.label,children:[g.jsx("div",{className:"settings-tab-icon",children:Te.icon}),g.jsx("span",{children:Te.label})]},Te.id))}),g.jsx("div",{className:"settings-tab-content-container",children:g.jsx("div",{className:"settings-tab-content",children:Ke()},kn)})]})]})},E4=({onClose:n,t:e})=>{const[t,r]=bu(n),s="1.2 (25.10.20)",i=[{icon:fe.ai,titleKey:"version_update_1_title",descKey:"version_update_1_desc"},{icon:fe.globe,titleKey:"version_update_2_title",descKey:"version_update_2_desc"},{icon:fe.background,titleKey:"version_update_3_title",descKey:"version_update_3_desc"}];return g.jsxs(xu,{onClose:r,isClosing:t,className:"version-info-modal",children:[g.jsxs("div",{className:"version-info-header",children:[g.jsx("h2",{children:e("version_update_title")}),g.jsxs("p",{children:[e("build_number"),": ",s]})]}),g.jsx("div",{className:"version-info-body",children:i.map((o,a)=>g.jsxs("div",{className:"changelog-item",children:[g.jsx("div",{className:"changelog-icon",style:{"--icon-bg":"var(--primary-color)"},children:o.icon}),g.jsxs("div",{className:"changelog-text",children:[g.jsx("h3",{children:e(o.titleKey)}),g.jsx("p",{children:e(o.descKey)})]})]},a))}),g.jsx("div",{className:"modal-buttons",children:g.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},T4=({onClose:n,t:e})=>{const[t,r]=bu(n),s=o=>{const a=/(https?:\/\/[^\s]+)/g;return o.split(a).map((c,d)=>a.test(c)?g.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"guide-link",children:c},d):c)},i=[{titleKey:"usage_basic_title",descKey:"usage_basic_desc"},{titleKey:"usage_ai_setup_title",descKey:"usage_ai_setup_desc"},{titleKey:"usage_ai_use_title",descKey:"usage_ai_use_desc"},{titleKey:"usage_share_title",descKey:"usage_share_desc"},{titleKey:"usage_theme_title",descKey:"usage_theme_desc"},{titleKey:"usage_calendar_title",descKey:"usage_calendar_desc"},{titleKey:"usage_offline_title",descKey:"usage_offline_desc"}];return g.jsxs(xu,{onClose:r,isClosing:t,className:"usage-guide-modal",children:[g.jsx("div",{className:"version-info-header",children:g.jsx("h2",{children:e("usage_guide_title")})}),g.jsx("div",{className:"version-info-body",children:i.map((o,a)=>g.jsxs("div",{className:"usage-guide-item",children:[g.jsx("h3",{children:e(o.titleKey)}),g.jsx("p",{children:o.titleKey==="usage_ai_setup_title"?s(e(o.descKey)):e(o.descKey)})]},a))}),g.jsx("div",{className:"modal-buttons",children:g.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},S4=({todos:n,t:e,onGoalClick:t,language:r})=>{const[s,i]=W.useState(new Date),[o,a]=W.useState("week"),u=m=>{const _=new Date(s);o==="month"?_.setMonth(_.getMonth()+m):o==="week"?_.setDate(_.getDate()+m*7):_.setDate(_.getDate()+m*3),i(_)},c=W.useMemo(()=>{const m=[];let _,E;if(o==="month"){const k=new Date(s.getFullYear(),s.getMonth(),1);_=jI(k,r==="ko"?1:0),E=42}else o==="week"?(_=jI(s,r==="ko"?1:0),E=7):(_=new Date(s),_.setDate(_.getDate()-1),E=3);for(let k=0;k<E;k++){const N=new Date(_);N.setDate(N.getDate()+k),m.push(N)}return m},[s,o,r]),d=W.useMemo(()=>{if(o==="month"){const m=s.getFullYear(),_=e("month_names")[s.getMonth()],E=e("calendar_header_month_format");return E&&typeof E=="string"&&E!=="calendar_header_month_format"?E.replace("{year}",String(m)).replace("{month}",_):`${_} ${m}`}return`${s.getFullYear()}.${s.getMonth()+1}`},[s,o,e]),f=W.useMemo(()=>{const m=e("day_names_short");if(r==="ko"&&Array.isArray(m)){const[_,...E]=m;return[...E,_]}return m},[r,e]);return g.jsxs("div",{className:"calendar-view-container",children:[g.jsxs("div",{className:"calendar-header",children:[g.jsx("button",{onClick:()=>u(-1),children:fe.back}),g.jsx("h2",{children:d}),g.jsx("button",{onClick:()=>u(1),children:fe.forward})]}),g.jsxs("div",{className:"calendar-view-mode-selector",children:[g.jsx("button",{onClick:()=>a("day3"),className:o==="day3"?"active":"",children:e("calendar_view_day3")}),g.jsx("button",{onClick:()=>a("week"),className:o==="week"?"active":"",children:e("calendar_view_week")}),g.jsx("button",{onClick:()=>a("month"),className:`calendar-view-button-month ${o==="month"?"active":""}`,children:e("calendar_view_month")})]}),(o==="week"||o==="month")&&g.jsx("div",{className:"calendar-days-of-week",children:Array.isArray(f)&&f.map(m=>g.jsx("div",{children:m},m))}),g.jsx("div",{className:`calendar-grid view-mode-${o}`,children:c.map(m=>{const E=LI(m,new Date),k=m.getMonth()===s.getMonth(),N=n.filter(x=>x.deadline&&LI(m,x.deadline));return g.jsxs("div",{className:`calendar-day ${!k&&o==="month"?"not-current-month":""} ${E?"is-today":""}`,"data-day-name":e("day_names_long")[m.getDay()],children:[g.jsx("div",{className:"day-header",children:g.jsx("span",{className:"day-number",children:m.getDate()})}),g.jsx("div",{className:"calendar-goals",children:N.map(x=>g.jsx("div",{className:`calendar-goal-item ${x.completed?"completed":""}`,onClick:()=>t(x),children:x.title},x.id))})]},m.toISOString())})})]})},A4=({title:n,message:e,onConfirm:t,onCancel:r,confirmText:s,cancelText:i,isDestructive:o,t:a})=>{const u=typeof r=="function";return g.jsx("div",{className:"modal-backdrop alert-backdrop",children:g.jsxs("div",{className:"modal-content alert-modal",children:[g.jsxs("div",{className:"alert-content",children:[g.jsx("h2",{children:n}),g.jsx("p",{dangerouslySetInnerHTML:{__html:e}})]}),g.jsxs("div",{className:"modal-buttons",children:[u&&g.jsx("button",{onClick:r,className:"secondary",children:i||a("cancel_button")}),g.jsx("button",{onClick:t,className:o?"destructive":"primary",children:s||a("confirm_button")})]})]})})},x4=vp.createRoot(document.getElementById("root")),$b=document.createElement("style");$b.textContent=`
  .header-icon-button:hover {
    transform: scale(1.07);
    background-color: rgba(99, 102, 241, 0.1);
    border-radius: 8px;
  }
  
  .header-inline-actions {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .todo-deadline {
    display: inline-flex;
    align-items: center;
    gap: 4px;
  }
  
  :root {
    --success-bg: rgba(16, 185, 129, 0.1);
    --success-color: #10b981;
  }
  
  [data-theme="dark"] {
    --success-bg: rgba(16, 185, 129, 0.15);
    --success-color: #34d399;
  }
`;document.head.appendChild($b);x4.render(g.jsx(ZI.StrictMode,{children:g.jsx(_4,{})}));
