(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const iR="modulepreload",sR=function(t){return"/Nova-1.0/"+t},Sy={},Ds=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=sR(l),l in Sy)return;Sy[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":iR,u||(m.as="script"),m.crossOrigin="",m.href=l,a&&m.setAttribute("nonce",a),document.head.appendChild(m),u)return new Promise((_,v)=>{m.addEventListener("load",_),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function oR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var tI={exports:{}},Vh={},nI={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zu=Symbol.for("react.element"),aR=Symbol.for("react.portal"),lR=Symbol.for("react.fragment"),uR=Symbol.for("react.strict_mode"),cR=Symbol.for("react.profiler"),dR=Symbol.for("react.provider"),hR=Symbol.for("react.context"),fR=Symbol.for("react.forward_ref"),pR=Symbol.for("react.suspense"),mR=Symbol.for("react.memo"),gR=Symbol.for("react.lazy"),xy=Symbol.iterator;function _R(t){return t===null||typeof t!="object"?null:(t=xy&&t[xy]||t["@@iterator"],typeof t=="function"?t:null)}var rI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},iI=Object.assign,sI={};function Ka(t,e,n){this.props=t,this.context=e,this.refs=sI,this.updater=n||rI}Ka.prototype.isReactComponent={};Ka.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ka.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function oI(){}oI.prototype=Ka.prototype;function vg(t,e,n){this.props=t,this.context=e,this.refs=sI,this.updater=n||rI}var Tg=vg.prototype=new oI;Tg.constructor=vg;iI(Tg,Ka.prototype);Tg.isPureReactComponent=!0;var Cy=Array.isArray,aI=Object.prototype.hasOwnProperty,Eg={current:null},lI={key:!0,ref:!0,__self:!0,__source:!0};function uI(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)aI.call(e,r)&&!lI.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:zu,type:t,key:s,ref:o,props:i,_owner:Eg.current}}function yR(t,e){return{$$typeof:zu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function wg(t){return typeof t=="object"&&t!==null&&t.$$typeof===zu}function vR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ay=/\/+/g;function qf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vR(""+t.key):e.toString(36)}function ad(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case zu:case aR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+qf(o,0):r,Cy(i)?(n="",t!=null&&(n=t.replace(Ay,"$&/")+"/"),ad(i,e,n,"",function(u){return u})):i!=null&&(wg(i)&&(i=yR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Ay,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Cy(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+qf(s,a);o+=ad(s,e,n,l,i)}else if(l=_R(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+qf(s,a++),o+=ad(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Lc(t,e,n){if(t==null)return t;var r=[],i=0;return ad(t,r,"","",function(s){return e.call(n,s,i++)}),r}function TR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var fn={current:null},ld={transition:null},ER={ReactCurrentDispatcher:fn,ReactCurrentBatchConfig:ld,ReactCurrentOwner:Eg};function cI(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:Lc,forEach:function(t,e,n){Lc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Lc(t,function(){e++}),e},toArray:function(t){return Lc(t,function(e){return e})||[]},only:function(t){if(!wg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Re.Component=Ka;Re.Fragment=lR;Re.Profiler=cR;Re.PureComponent=vg;Re.StrictMode=uR;Re.Suspense=pR;Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ER;Re.act=cI;Re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=iI({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Eg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)aI.call(e,l)&&!lI.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:zu,type:t.type,key:i,ref:s,props:r,_owner:o}};Re.createContext=function(t){return t={$$typeof:hR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:dR,_context:t},t.Consumer=t};Re.createElement=uI;Re.createFactory=function(t){var e=uI.bind(null,t);return e.type=t,e};Re.createRef=function(){return{current:null}};Re.forwardRef=function(t){return{$$typeof:fR,render:t}};Re.isValidElement=wg;Re.lazy=function(t){return{$$typeof:gR,_payload:{_status:-1,_result:t},_init:TR}};Re.memo=function(t,e){return{$$typeof:mR,type:t,compare:e===void 0?null:e}};Re.startTransition=function(t){var e=ld.transition;ld.transition={};try{t()}finally{ld.transition=e}};Re.unstable_act=cI;Re.useCallback=function(t,e){return fn.current.useCallback(t,e)};Re.useContext=function(t){return fn.current.useContext(t)};Re.useDebugValue=function(){};Re.useDeferredValue=function(t){return fn.current.useDeferredValue(t)};Re.useEffect=function(t,e){return fn.current.useEffect(t,e)};Re.useId=function(){return fn.current.useId()};Re.useImperativeHandle=function(t,e,n){return fn.current.useImperativeHandle(t,e,n)};Re.useInsertionEffect=function(t,e){return fn.current.useInsertionEffect(t,e)};Re.useLayoutEffect=function(t,e){return fn.current.useLayoutEffect(t,e)};Re.useMemo=function(t,e){return fn.current.useMemo(t,e)};Re.useReducer=function(t,e,n){return fn.current.useReducer(t,e,n)};Re.useRef=function(t){return fn.current.useRef(t)};Re.useState=function(t){return fn.current.useState(t)};Re.useSyncExternalStore=function(t,e,n){return fn.current.useSyncExternalStore(t,e,n)};Re.useTransition=function(){return fn.current.useTransition()};Re.version="18.3.1";nI.exports=Re;var G=nI.exports;const dI=oR(G);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wR=G,IR=Symbol.for("react.element"),SR=Symbol.for("react.fragment"),xR=Object.prototype.hasOwnProperty,CR=wR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,AR={key:!0,ref:!0,__self:!0,__source:!0};function hI(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)xR.call(e,r)&&!AR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:IR,type:t,key:s,ref:o,props:i,_owner:CR.current}}Vh.Fragment=SR;Vh.jsx=hI;Vh.jsxs=hI;tI.exports=Vh;var p=tI.exports,bp={},fI={exports:{}},Vn={},pI={exports:{}},mI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,ce){var he=Z.length;Z.push(ce);e:for(;0<he;){var xe=he-1>>>1,Me=Z[xe];if(0<i(Me,ce))Z[xe]=ce,Z[he]=Me,he=xe;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var ce=Z[0],he=Z.pop();if(he!==ce){Z[0]=he;e:for(var xe=0,Me=Z.length,Ct=Me>>>1;xe<Ct;){var be=2*(xe+1)-1,Mt=Z[be],Ce=be+1,Oe=Z[Ce];if(0>i(Mt,he))Ce<Me&&0>i(Oe,Mt)?(Z[xe]=Oe,Z[Ce]=he,xe=Ce):(Z[xe]=Mt,Z[be]=he,xe=be);else if(Ce<Me&&0>i(Oe,he))Z[xe]=Oe,Z[Ce]=he,xe=Ce;else break e}}return ce}function i(Z,ce){var he=Z.sortIndex-ce.sortIndex;return he!==0?he:Z.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],f=1,m=null,_=3,v=!1,E=!1,P=!1,M=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(Z){for(var ce=n(u);ce!==null;){if(ce.callback===null)r(u);else if(ce.startTime<=Z)r(u),ce.sortIndex=ce.expirationTime,e(l,ce);else break;ce=n(u)}}function V(Z){if(P=!1,A(Z),!E)if(n(l)!==null)E=!0,Fe(q);else{var ce=n(u);ce!==null&&Te(V,ce.startTime-Z)}}function q(Z,ce){E=!1,P&&(P=!1,C(x),x=-1),v=!0;var he=_;try{for(A(ce),m=n(l);m!==null&&(!(m.expirationTime>ce)||Z&&!D());){var xe=m.callback;if(typeof xe=="function"){m.callback=null,_=m.priorityLevel;var Me=xe(m.expirationTime<=ce);ce=t.unstable_now(),typeof Me=="function"?m.callback=Me:m===n(l)&&r(l),A(ce)}else r(l);m=n(l)}if(m!==null)var Ct=!0;else{var be=n(u);be!==null&&Te(V,be.startTime-ce),Ct=!1}return Ct}finally{m=null,_=he,v=!1}}var z=!1,S=null,x=-1,R=5,N=-1;function D(){return!(t.unstable_now()-N<R)}function F(){if(S!==null){var Z=t.unstable_now();N=Z;var ce=!0;try{ce=S(!0,Z)}finally{ce?b():(z=!1,S=null)}}else z=!1}var b;if(typeof w=="function")b=function(){w(F)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,Qe=Se.port2;Se.port1.onmessage=F,b=function(){Qe.postMessage(null)}}else b=function(){M(F,0)};function Fe(Z){S=Z,z||(z=!0,b())}function Te(Z,ce){x=M(function(){Z(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){E||v||(E=!0,Fe(q))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Z){switch(_){case 1:case 2:case 3:var ce=3;break;default:ce=_}var he=_;_=ce;try{return Z()}finally{_=he}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,ce){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var he=_;_=Z;try{return ce()}finally{_=he}},t.unstable_scheduleCallback=function(Z,ce,he){var xe=t.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?xe+he:xe):he=xe,Z){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=he+Me,Z={id:f++,callback:ce,priorityLevel:Z,startTime:he,expirationTime:Me,sortIndex:-1},he>xe?(Z.sortIndex=he,e(u,Z),n(l)===null&&Z===n(u)&&(P?(C(x),x=-1):P=!0,Te(V,he-xe))):(Z.sortIndex=Me,e(l,Z),E||v||(E=!0,Fe(q))),Z},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(Z){var ce=_;return function(){var he=_;_=ce;try{return Z.apply(this,arguments)}finally{_=he}}}})(mI);pI.exports=mI;var RR=pI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PR=G,Dn=RR;function te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gI=new Set,hu={};function yo(t,e){Sa(t,e),Sa(t+"Capture",e)}function Sa(t,e){for(hu[t]=e,t=0;t<e.length;t++)gI.add(e[t])}var ei=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dp=Object.prototype.hasOwnProperty,kR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ry={},Py={};function NR(t){return Dp.call(Py,t)?!0:Dp.call(Ry,t)?!1:kR.test(t)?Py[t]=!0:(Ry[t]=!0,!1)}function bR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function DR(t,e,n,r){if(e===null||typeof e>"u"||bR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function pn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Kt[t]=new pn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Kt[e]=new pn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Kt[t]=new pn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Kt[t]=new pn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Kt[t]=new pn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Kt[t]=new pn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Kt[t]=new pn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Kt[t]=new pn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Kt[t]=new pn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ig=/[\-:]([a-z])/g;function Sg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ig,Sg);Kt[e]=new pn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ig,Sg);Kt[e]=new pn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ig,Sg);Kt[e]=new pn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Kt[t]=new pn(t,1,!1,t.toLowerCase(),null,!1,!1)});Kt.xlinkHref=new pn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Kt[t]=new pn(t,1,!1,t.toLowerCase(),null,!0,!0)});function xg(t,e,n,r){var i=Kt.hasOwnProperty(e)?Kt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(DR(e,n,i,r)&&(n=null),r||i===null?NR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var li=PR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fc=Symbol.for("react.element"),Yo=Symbol.for("react.portal"),Xo=Symbol.for("react.fragment"),Cg=Symbol.for("react.strict_mode"),Mp=Symbol.for("react.profiler"),_I=Symbol.for("react.provider"),yI=Symbol.for("react.context"),Ag=Symbol.for("react.forward_ref"),Vp=Symbol.for("react.suspense"),Lp=Symbol.for("react.suspense_list"),Rg=Symbol.for("react.memo"),bi=Symbol.for("react.lazy"),vI=Symbol.for("react.offscreen"),ky=Symbol.iterator;function Tl(t){return t===null||typeof t!="object"?null:(t=ky&&t[ky]||t["@@iterator"],typeof t=="function"?t:null)}var ft=Object.assign,zf;function Ml(t){if(zf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);zf=e&&e[1]||""}return`
`+zf+t}var $f=!1;function jf(t,e){if(!t||$f)return"";$f=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{$f=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ml(t):""}function MR(t){switch(t.tag){case 5:return Ml(t.type);case 16:return Ml("Lazy");case 13:return Ml("Suspense");case 19:return Ml("SuspenseList");case 0:case 2:case 15:return t=jf(t.type,!1),t;case 11:return t=jf(t.type.render,!1),t;case 1:return t=jf(t.type,!0),t;default:return""}}function Fp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xo:return"Fragment";case Yo:return"Portal";case Mp:return"Profiler";case Cg:return"StrictMode";case Vp:return"Suspense";case Lp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case yI:return(t.displayName||"Context")+".Consumer";case _I:return(t._context.displayName||"Context")+".Provider";case Ag:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rg:return e=t.displayName||null,e!==null?e:Fp(t.type)||"Memo";case bi:e=t._payload,t=t._init;try{return Fp(t(e))}catch{}}return null}function VR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fp(e);case 8:return e===Cg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function is(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function TI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function LR(t){var e=TI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Uc(t){t._valueTracker||(t._valueTracker=LR(t))}function EI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=TI(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ld(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Up(t,e){var n=e.checked;return ft({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ny(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=is(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function wI(t,e){e=e.checked,e!=null&&xg(t,"checked",e,!1)}function Op(t,e){wI(t,e);var n=is(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Bp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Bp(t,e.type,is(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function by(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Bp(t,e,n){(e!=="number"||Ld(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Vl=Array.isArray;function da(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+is(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Gp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(te(91));return ft({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Dy(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(te(92));if(Vl(n)){if(1<n.length)throw Error(te(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:is(n)}}function II(t,e){var n=is(e.value),r=is(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function My(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function SI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?SI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Oc,xI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Oc=Oc||document.createElement("div"),Oc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Oc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function fu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var $l={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FR=["Webkit","ms","Moz","O"];Object.keys($l).forEach(function(t){FR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$l[e]=$l[t]})});function CI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||$l.hasOwnProperty(t)&&$l[t]?(""+e).trim():e+"px"}function AI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=CI(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var UR=ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zp(t,e){if(e){if(UR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(te(62))}}function $p(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jp=null;function Pg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hp=null,ha=null,fa=null;function Vy(t){if(t=Hu(t)){if(typeof Hp!="function")throw Error(te(280));var e=t.stateNode;e&&(e=Bh(e),Hp(t.stateNode,t.type,e))}}function RI(t){ha?fa?fa.push(t):fa=[t]:ha=t}function PI(){if(ha){var t=ha,e=fa;if(fa=ha=null,Vy(t),e)for(t=0;t<e.length;t++)Vy(e[t])}}function kI(t,e){return t(e)}function NI(){}var Hf=!1;function bI(t,e,n){if(Hf)return t(e,n);Hf=!0;try{return kI(t,e,n)}finally{Hf=!1,(ha!==null||fa!==null)&&(NI(),PI())}}function pu(t,e){var n=t.stateNode;if(n===null)return null;var r=Bh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(te(231,e,typeof n));return n}var Wp=!1;if(ei)try{var El={};Object.defineProperty(El,"passive",{get:function(){Wp=!0}}),window.addEventListener("test",El,El),window.removeEventListener("test",El,El)}catch{Wp=!1}function OR(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var jl=!1,Fd=null,Ud=!1,Kp=null,BR={onError:function(t){jl=!0,Fd=t}};function GR(t,e,n,r,i,s,o,a,l){jl=!1,Fd=null,OR.apply(BR,arguments)}function qR(t,e,n,r,i,s,o,a,l){if(GR.apply(this,arguments),jl){if(jl){var u=Fd;jl=!1,Fd=null}else throw Error(te(198));Ud||(Ud=!0,Kp=u)}}function vo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function DI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ly(t){if(vo(t)!==t)throw Error(te(188))}function zR(t){var e=t.alternate;if(!e){if(e=vo(t),e===null)throw Error(te(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Ly(i),t;if(s===r)return Ly(i),e;s=s.sibling}throw Error(te(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(te(189))}}if(n.alternate!==r)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?t:e}function MI(t){return t=zR(t),t!==null?VI(t):null}function VI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=VI(t);if(e!==null)return e;t=t.sibling}return null}var LI=Dn.unstable_scheduleCallback,Fy=Dn.unstable_cancelCallback,$R=Dn.unstable_shouldYield,jR=Dn.unstable_requestPaint,Et=Dn.unstable_now,HR=Dn.unstable_getCurrentPriorityLevel,kg=Dn.unstable_ImmediatePriority,FI=Dn.unstable_UserBlockingPriority,Od=Dn.unstable_NormalPriority,WR=Dn.unstable_LowPriority,UI=Dn.unstable_IdlePriority,Lh=null,Pr=null;function KR(t){if(Pr&&typeof Pr.onCommitFiberRoot=="function")try{Pr.onCommitFiberRoot(Lh,t,void 0,(t.current.flags&128)===128)}catch{}}var dr=Math.clz32?Math.clz32:YR,JR=Math.log,QR=Math.LN2;function YR(t){return t>>>=0,t===0?32:31-(JR(t)/QR|0)|0}var Bc=64,Gc=4194304;function Ll(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Bd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Ll(a):(s&=o,s!==0&&(r=Ll(s)))}else o=n&~i,o!==0?r=Ll(o):s!==0&&(r=Ll(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-dr(e),i=1<<n,r|=t[n],e&=~i;return r}function XR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-dr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=XR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Jp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function OI(){var t=Bc;return Bc<<=1,!(Bc&4194240)&&(Bc=64),t}function Wf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function $u(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-dr(e),t[e]=n}function eP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-dr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Ng(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-dr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var He=0;function BI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var GI,bg,qI,zI,$I,Qp=!1,qc=[],zi=null,$i=null,ji=null,mu=new Map,gu=new Map,Mi=[],tP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uy(t,e){switch(t){case"focusin":case"focusout":zi=null;break;case"dragenter":case"dragleave":$i=null;break;case"mouseover":case"mouseout":ji=null;break;case"pointerover":case"pointerout":mu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gu.delete(e.pointerId)}}function wl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Hu(e),e!==null&&bg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function nP(t,e,n,r,i){switch(e){case"focusin":return zi=wl(zi,t,e,n,r,i),!0;case"dragenter":return $i=wl($i,t,e,n,r,i),!0;case"mouseover":return ji=wl(ji,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return mu.set(s,wl(mu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,gu.set(s,wl(gu.get(s)||null,t,e,n,r,i)),!0}return!1}function jI(t){var e=Hs(t.target);if(e!==null){var n=vo(e);if(n!==null){if(e=n.tag,e===13){if(e=DI(n),e!==null){t.blockedOn=e,$I(t.priority,function(){qI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ud(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Yp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);jp=r,n.target.dispatchEvent(r),jp=null}else return e=Hu(n),e!==null&&bg(e),t.blockedOn=n,!1;e.shift()}return!0}function Oy(t,e,n){ud(t)&&n.delete(e)}function rP(){Qp=!1,zi!==null&&ud(zi)&&(zi=null),$i!==null&&ud($i)&&($i=null),ji!==null&&ud(ji)&&(ji=null),mu.forEach(Oy),gu.forEach(Oy)}function Il(t,e){t.blockedOn===e&&(t.blockedOn=null,Qp||(Qp=!0,Dn.unstable_scheduleCallback(Dn.unstable_NormalPriority,rP)))}function _u(t){function e(i){return Il(i,t)}if(0<qc.length){Il(qc[0],t);for(var n=1;n<qc.length;n++){var r=qc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(zi!==null&&Il(zi,t),$i!==null&&Il($i,t),ji!==null&&Il(ji,t),mu.forEach(e),gu.forEach(e),n=0;n<Mi.length;n++)r=Mi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Mi.length&&(n=Mi[0],n.blockedOn===null);)jI(n),n.blockedOn===null&&Mi.shift()}var pa=li.ReactCurrentBatchConfig,Gd=!0;function iP(t,e,n,r){var i=He,s=pa.transition;pa.transition=null;try{He=1,Dg(t,e,n,r)}finally{He=i,pa.transition=s}}function sP(t,e,n,r){var i=He,s=pa.transition;pa.transition=null;try{He=4,Dg(t,e,n,r)}finally{He=i,pa.transition=s}}function Dg(t,e,n,r){if(Gd){var i=Yp(t,e,n,r);if(i===null)rp(t,e,r,qd,n),Uy(t,r);else if(nP(i,t,e,n,r))r.stopPropagation();else if(Uy(t,r),e&4&&-1<tP.indexOf(t)){for(;i!==null;){var s=Hu(i);if(s!==null&&GI(s),s=Yp(t,e,n,r),s===null&&rp(t,e,r,qd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else rp(t,e,r,null,n)}}var qd=null;function Yp(t,e,n,r){if(qd=null,t=Pg(r),t=Hs(t),t!==null)if(e=vo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=DI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qd=t,null}function HI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(HR()){case kg:return 1;case FI:return 4;case Od:case WR:return 16;case UI:return 536870912;default:return 16}default:return 16}}var Bi=null,Mg=null,cd=null;function WI(){if(cd)return cd;var t,e=Mg,n=e.length,r,i="value"in Bi?Bi.value:Bi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return cd=i.slice(t,1<r?1-r:void 0)}function dd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zc(){return!0}function By(){return!1}function Ln(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?zc:By,this.isPropagationStopped=By,this}return ft(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zc)},persist:function(){},isPersistent:zc}),e}var Ja={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vg=Ln(Ja),ju=ft({},Ja,{view:0,detail:0}),oP=Ln(ju),Kf,Jf,Sl,Fh=ft({},ju,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Sl&&(Sl&&t.type==="mousemove"?(Kf=t.screenX-Sl.screenX,Jf=t.screenY-Sl.screenY):Jf=Kf=0,Sl=t),Kf)},movementY:function(t){return"movementY"in t?t.movementY:Jf}}),Gy=Ln(Fh),aP=ft({},Fh,{dataTransfer:0}),lP=Ln(aP),uP=ft({},ju,{relatedTarget:0}),Qf=Ln(uP),cP=ft({},Ja,{animationName:0,elapsedTime:0,pseudoElement:0}),dP=Ln(cP),hP=ft({},Ja,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fP=Ln(hP),pP=ft({},Ja,{data:0}),qy=Ln(pP),mP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_P={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=_P[t])?!!e[t]:!1}function Lg(){return yP}var vP=ft({},ju,{key:function(t){if(t.key){var e=mP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=dd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?gP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lg,charCode:function(t){return t.type==="keypress"?dd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?dd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),TP=Ln(vP),EP=ft({},Fh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zy=Ln(EP),wP=ft({},ju,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lg}),IP=Ln(wP),SP=ft({},Ja,{propertyName:0,elapsedTime:0,pseudoElement:0}),xP=Ln(SP),CP=ft({},Fh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),AP=Ln(CP),RP=[9,13,27,32],Fg=ei&&"CompositionEvent"in window,Hl=null;ei&&"documentMode"in document&&(Hl=document.documentMode);var PP=ei&&"TextEvent"in window&&!Hl,KI=ei&&(!Fg||Hl&&8<Hl&&11>=Hl),$y=" ",jy=!1;function JI(t,e){switch(t){case"keyup":return RP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function QI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Zo=!1;function kP(t,e){switch(t){case"compositionend":return QI(e);case"keypress":return e.which!==32?null:(jy=!0,$y);case"textInput":return t=e.data,t===$y&&jy?null:t;default:return null}}function NP(t,e){if(Zo)return t==="compositionend"||!Fg&&JI(t,e)?(t=WI(),cd=Mg=Bi=null,Zo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return KI&&e.locale!=="ko"?null:e.data;default:return null}}var bP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!bP[t.type]:e==="textarea"}function YI(t,e,n,r){RI(r),e=zd(e,"onChange"),0<e.length&&(n=new Vg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Wl=null,yu=null;function DP(t){lS(t,0)}function Uh(t){var e=na(t);if(EI(e))return t}function MP(t,e){if(t==="change")return e}var XI=!1;if(ei){var Yf;if(ei){var Xf="oninput"in document;if(!Xf){var Wy=document.createElement("div");Wy.setAttribute("oninput","return;"),Xf=typeof Wy.oninput=="function"}Yf=Xf}else Yf=!1;XI=Yf&&(!document.documentMode||9<document.documentMode)}function Ky(){Wl&&(Wl.detachEvent("onpropertychange",ZI),yu=Wl=null)}function ZI(t){if(t.propertyName==="value"&&Uh(yu)){var e=[];YI(e,yu,t,Pg(t)),bI(DP,e)}}function VP(t,e,n){t==="focusin"?(Ky(),Wl=e,yu=n,Wl.attachEvent("onpropertychange",ZI)):t==="focusout"&&Ky()}function LP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uh(yu)}function FP(t,e){if(t==="click")return Uh(e)}function UP(t,e){if(t==="input"||t==="change")return Uh(e)}function OP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gr=typeof Object.is=="function"?Object.is:OP;function vu(t,e){if(gr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Dp.call(e,i)||!gr(t[i],e[i]))return!1}return!0}function Jy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Qy(t,e){var n=Jy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Jy(n)}}function eS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?eS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function tS(){for(var t=window,e=Ld();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ld(t.document)}return e}function Ug(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function BP(t){var e=tS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&eS(n.ownerDocument.documentElement,n)){if(r!==null&&Ug(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Qy(n,s);var o=Qy(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var GP=ei&&"documentMode"in document&&11>=document.documentMode,ea=null,Xp=null,Kl=null,Zp=!1;function Yy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zp||ea==null||ea!==Ld(r)||(r=ea,"selectionStart"in r&&Ug(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Kl&&vu(Kl,r)||(Kl=r,r=zd(Xp,"onSelect"),0<r.length&&(e=new Vg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ea)))}function $c(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ta={animationend:$c("Animation","AnimationEnd"),animationiteration:$c("Animation","AnimationIteration"),animationstart:$c("Animation","AnimationStart"),transitionend:$c("Transition","TransitionEnd")},Zf={},nS={};ei&&(nS=document.createElement("div").style,"AnimationEvent"in window||(delete ta.animationend.animation,delete ta.animationiteration.animation,delete ta.animationstart.animation),"TransitionEvent"in window||delete ta.transitionend.transition);function Oh(t){if(Zf[t])return Zf[t];if(!ta[t])return t;var e=ta[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in nS)return Zf[t]=e[n];return t}var rS=Oh("animationend"),iS=Oh("animationiteration"),sS=Oh("animationstart"),oS=Oh("transitionend"),aS=new Map,Xy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fs(t,e){aS.set(t,e),yo(e,[t])}for(var ep=0;ep<Xy.length;ep++){var tp=Xy[ep],qP=tp.toLowerCase(),zP=tp[0].toUpperCase()+tp.slice(1);fs(qP,"on"+zP)}fs(rS,"onAnimationEnd");fs(iS,"onAnimationIteration");fs(sS,"onAnimationStart");fs("dblclick","onDoubleClick");fs("focusin","onFocus");fs("focusout","onBlur");fs(oS,"onTransitionEnd");Sa("onMouseEnter",["mouseout","mouseover"]);Sa("onMouseLeave",["mouseout","mouseover"]);Sa("onPointerEnter",["pointerout","pointerover"]);Sa("onPointerLeave",["pointerout","pointerover"]);yo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yo("onBeforeInput",["compositionend","keypress","textInput","paste"]);yo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$P=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fl));function Zy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,qR(r,e,void 0,t),t.currentTarget=null}function lS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Zy(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Zy(i,a,u),s=l}}}if(Ud)throw t=Kp,Ud=!1,Kp=null,t}function tt(t,e){var n=e[im];n===void 0&&(n=e[im]=new Set);var r=t+"__bubble";n.has(r)||(uS(e,t,2,!1),n.add(r))}function np(t,e,n){var r=0;e&&(r|=4),uS(n,t,r,e)}var jc="_reactListening"+Math.random().toString(36).slice(2);function Tu(t){if(!t[jc]){t[jc]=!0,gI.forEach(function(n){n!=="selectionchange"&&($P.has(n)||np(n,!1,t),np(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[jc]||(e[jc]=!0,np("selectionchange",!1,e))}}function uS(t,e,n,r){switch(HI(e)){case 1:var i=iP;break;case 4:i=sP;break;default:i=Dg}n=i.bind(null,e,n,t),i=void 0,!Wp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function rp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Hs(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}bI(function(){var u=s,f=Pg(n),m=[];e:{var _=aS.get(t);if(_!==void 0){var v=Vg,E=t;switch(t){case"keypress":if(dd(n)===0)break e;case"keydown":case"keyup":v=TP;break;case"focusin":E="focus",v=Qf;break;case"focusout":E="blur",v=Qf;break;case"beforeblur":case"afterblur":v=Qf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Gy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=lP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=IP;break;case rS:case iS:case sS:v=dP;break;case oS:v=xP;break;case"scroll":v=oP;break;case"wheel":v=AP;break;case"copy":case"cut":case"paste":v=fP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=zy}var P=(e&4)!==0,M=!P&&t==="scroll",C=P?_!==null?_+"Capture":null:_;P=[];for(var w=u,A;w!==null;){A=w;var V=A.stateNode;if(A.tag===5&&V!==null&&(A=V,C!==null&&(V=pu(w,C),V!=null&&P.push(Eu(w,V,A)))),M)break;w=w.return}0<P.length&&(_=new v(_,E,null,n,f),m.push({event:_,listeners:P}))}}if(!(e&7)){e:{if(_=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",_&&n!==jp&&(E=n.relatedTarget||n.fromElement)&&(Hs(E)||E[ti]))break e;if((v||_)&&(_=f.window===f?f:(_=f.ownerDocument)?_.defaultView||_.parentWindow:window,v?(E=n.relatedTarget||n.toElement,v=u,E=E?Hs(E):null,E!==null&&(M=vo(E),E!==M||E.tag!==5&&E.tag!==6)&&(E=null)):(v=null,E=u),v!==E)){if(P=Gy,V="onMouseLeave",C="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(P=zy,V="onPointerLeave",C="onPointerEnter",w="pointer"),M=v==null?_:na(v),A=E==null?_:na(E),_=new P(V,w+"leave",v,n,f),_.target=M,_.relatedTarget=A,V=null,Hs(f)===u&&(P=new P(C,w+"enter",E,n,f),P.target=A,P.relatedTarget=M,V=P),M=V,v&&E)t:{for(P=v,C=E,w=0,A=P;A;A=Oo(A))w++;for(A=0,V=C;V;V=Oo(V))A++;for(;0<w-A;)P=Oo(P),w--;for(;0<A-w;)C=Oo(C),A--;for(;w--;){if(P===C||C!==null&&P===C.alternate)break t;P=Oo(P),C=Oo(C)}P=null}else P=null;v!==null&&ev(m,_,v,P,!1),E!==null&&M!==null&&ev(m,M,E,P,!0)}}e:{if(_=u?na(u):window,v=_.nodeName&&_.nodeName.toLowerCase(),v==="select"||v==="input"&&_.type==="file")var q=MP;else if(Hy(_))if(XI)q=UP;else{q=LP;var z=VP}else(v=_.nodeName)&&v.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(q=FP);if(q&&(q=q(t,u))){YI(m,q,n,f);break e}z&&z(t,_,u),t==="focusout"&&(z=_._wrapperState)&&z.controlled&&_.type==="number"&&Bp(_,"number",_.value)}switch(z=u?na(u):window,t){case"focusin":(Hy(z)||z.contentEditable==="true")&&(ea=z,Xp=u,Kl=null);break;case"focusout":Kl=Xp=ea=null;break;case"mousedown":Zp=!0;break;case"contextmenu":case"mouseup":case"dragend":Zp=!1,Yy(m,n,f);break;case"selectionchange":if(GP)break;case"keydown":case"keyup":Yy(m,n,f)}var S;if(Fg)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Zo?JI(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(KI&&n.locale!=="ko"&&(Zo||x!=="onCompositionStart"?x==="onCompositionEnd"&&Zo&&(S=WI()):(Bi=f,Mg="value"in Bi?Bi.value:Bi.textContent,Zo=!0)),z=zd(u,x),0<z.length&&(x=new qy(x,t,null,n,f),m.push({event:x,listeners:z}),S?x.data=S:(S=QI(n),S!==null&&(x.data=S)))),(S=PP?kP(t,n):NP(t,n))&&(u=zd(u,"onBeforeInput"),0<u.length&&(f=new qy("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:u}),f.data=S))}lS(m,e)})}function Eu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function zd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=pu(t,n),s!=null&&r.unshift(Eu(t,s,i)),s=pu(t,e),s!=null&&r.push(Eu(t,s,i))),t=t.return}return r}function Oo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ev(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=pu(n,s),l!=null&&o.unshift(Eu(n,l,a))):i||(l=pu(n,s),l!=null&&o.push(Eu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var jP=/\r\n?/g,HP=/\u0000|\uFFFD/g;function tv(t){return(typeof t=="string"?t:""+t).replace(jP,`
`).replace(HP,"")}function Hc(t,e,n){if(e=tv(e),tv(t)!==e&&n)throw Error(te(425))}function $d(){}var em=null,tm=null;function nm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rm=typeof setTimeout=="function"?setTimeout:void 0,WP=typeof clearTimeout=="function"?clearTimeout:void 0,nv=typeof Promise=="function"?Promise:void 0,KP=typeof queueMicrotask=="function"?queueMicrotask:typeof nv<"u"?function(t){return nv.resolve(null).then(t).catch(JP)}:rm;function JP(t){setTimeout(function(){throw t})}function ip(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),_u(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);_u(e)}function Hi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function rv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Qa=Math.random().toString(36).slice(2),Cr="__reactFiber$"+Qa,wu="__reactProps$"+Qa,ti="__reactContainer$"+Qa,im="__reactEvents$"+Qa,QP="__reactListeners$"+Qa,YP="__reactHandles$"+Qa;function Hs(t){var e=t[Cr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ti]||n[Cr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=rv(t);t!==null;){if(n=t[Cr])return n;t=rv(t)}return e}t=n,n=t.parentNode}return null}function Hu(t){return t=t[Cr]||t[ti],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function na(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(te(33))}function Bh(t){return t[wu]||null}var sm=[],ra=-1;function ps(t){return{current:t}}function rt(t){0>ra||(t.current=sm[ra],sm[ra]=null,ra--)}function Ze(t,e){ra++,sm[ra]=t.current,t.current=e}var ss={},rn=ps(ss),vn=ps(!1),ro=ss;function xa(t,e){var n=t.type.contextTypes;if(!n)return ss;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Tn(t){return t=t.childContextTypes,t!=null}function jd(){rt(vn),rt(rn)}function iv(t,e,n){if(rn.current!==ss)throw Error(te(168));Ze(rn,e),Ze(vn,n)}function cS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(te(108,VR(t)||"Unknown",i));return ft({},n,r)}function Hd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ss,ro=rn.current,Ze(rn,t),Ze(vn,vn.current),!0}function sv(t,e,n){var r=t.stateNode;if(!r)throw Error(te(169));n?(t=cS(t,e,ro),r.__reactInternalMemoizedMergedChildContext=t,rt(vn),rt(rn),Ze(rn,t)):rt(vn),Ze(vn,n)}var jr=null,Gh=!1,sp=!1;function dS(t){jr===null?jr=[t]:jr.push(t)}function XP(t){Gh=!0,dS(t)}function ms(){if(!sp&&jr!==null){sp=!0;var t=0,e=He;try{var n=jr;for(He=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}jr=null,Gh=!1}catch(i){throw jr!==null&&(jr=jr.slice(t+1)),LI(kg,ms),i}finally{He=e,sp=!1}}return null}var ia=[],sa=0,Wd=null,Kd=0,Gn=[],qn=0,io=null,Wr=1,Kr="";function Ls(t,e){ia[sa++]=Kd,ia[sa++]=Wd,Wd=t,Kd=e}function hS(t,e,n){Gn[qn++]=Wr,Gn[qn++]=Kr,Gn[qn++]=io,io=t;var r=Wr;t=Kr;var i=32-dr(r)-1;r&=~(1<<i),n+=1;var s=32-dr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Wr=1<<32-dr(e)+i|n<<i|r,Kr=s+t}else Wr=1<<s|n<<i|r,Kr=t}function Og(t){t.return!==null&&(Ls(t,1),hS(t,1,0))}function Bg(t){for(;t===Wd;)Wd=ia[--sa],ia[sa]=null,Kd=ia[--sa],ia[sa]=null;for(;t===io;)io=Gn[--qn],Gn[qn]=null,Kr=Gn[--qn],Gn[qn]=null,Wr=Gn[--qn],Gn[qn]=null}var bn=null,kn=null,at=!1,lr=null;function fS(t,e){var n=zn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ov(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,bn=t,kn=Hi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,bn=t,kn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=io!==null?{id:Wr,overflow:Kr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=zn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,bn=t,kn=null,!0):!1;default:return!1}}function om(t){return(t.mode&1)!==0&&(t.flags&128)===0}function am(t){if(at){var e=kn;if(e){var n=e;if(!ov(t,e)){if(om(t))throw Error(te(418));e=Hi(n.nextSibling);var r=bn;e&&ov(t,e)?fS(r,n):(t.flags=t.flags&-4097|2,at=!1,bn=t)}}else{if(om(t))throw Error(te(418));t.flags=t.flags&-4097|2,at=!1,bn=t}}}function av(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;bn=t}function Wc(t){if(t!==bn)return!1;if(!at)return av(t),at=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!nm(t.type,t.memoizedProps)),e&&(e=kn)){if(om(t))throw pS(),Error(te(418));for(;e;)fS(t,e),e=Hi(e.nextSibling)}if(av(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){kn=Hi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}kn=null}}else kn=bn?Hi(t.stateNode.nextSibling):null;return!0}function pS(){for(var t=kn;t;)t=Hi(t.nextSibling)}function Ca(){kn=bn=null,at=!1}function Gg(t){lr===null?lr=[t]:lr.push(t)}var ZP=li.ReactCurrentBatchConfig;function xl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var r=n.stateNode}if(!r)throw Error(te(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,t))}return t}function Kc(t,e){throw t=Object.prototype.toString.call(e),Error(te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lv(t){var e=t._init;return e(t._payload)}function mS(t){function e(C,w){if(t){var A=C.deletions;A===null?(C.deletions=[w],C.flags|=16):A.push(w)}}function n(C,w){if(!t)return null;for(;w!==null;)e(C,w),w=w.sibling;return null}function r(C,w){for(C=new Map;w!==null;)w.key!==null?C.set(w.key,w):C.set(w.index,w),w=w.sibling;return C}function i(C,w){return C=Qi(C,w),C.index=0,C.sibling=null,C}function s(C,w,A){return C.index=A,t?(A=C.alternate,A!==null?(A=A.index,A<w?(C.flags|=2,w):A):(C.flags|=2,w)):(C.flags|=1048576,w)}function o(C){return t&&C.alternate===null&&(C.flags|=2),C}function a(C,w,A,V){return w===null||w.tag!==6?(w=hp(A,C.mode,V),w.return=C,w):(w=i(w,A),w.return=C,w)}function l(C,w,A,V){var q=A.type;return q===Xo?f(C,w,A.props.children,V,A.key):w!==null&&(w.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===bi&&lv(q)===w.type)?(V=i(w,A.props),V.ref=xl(C,w,A),V.return=C,V):(V=yd(A.type,A.key,A.props,null,C.mode,V),V.ref=xl(C,w,A),V.return=C,V)}function u(C,w,A,V){return w===null||w.tag!==4||w.stateNode.containerInfo!==A.containerInfo||w.stateNode.implementation!==A.implementation?(w=fp(A,C.mode,V),w.return=C,w):(w=i(w,A.children||[]),w.return=C,w)}function f(C,w,A,V,q){return w===null||w.tag!==7?(w=Xs(A,C.mode,V,q),w.return=C,w):(w=i(w,A),w.return=C,w)}function m(C,w,A){if(typeof w=="string"&&w!==""||typeof w=="number")return w=hp(""+w,C.mode,A),w.return=C,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Fc:return A=yd(w.type,w.key,w.props,null,C.mode,A),A.ref=xl(C,null,w),A.return=C,A;case Yo:return w=fp(w,C.mode,A),w.return=C,w;case bi:var V=w._init;return m(C,V(w._payload),A)}if(Vl(w)||Tl(w))return w=Xs(w,C.mode,A,null),w.return=C,w;Kc(C,w)}return null}function _(C,w,A,V){var q=w!==null?w.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return q!==null?null:a(C,w,""+A,V);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Fc:return A.key===q?l(C,w,A,V):null;case Yo:return A.key===q?u(C,w,A,V):null;case bi:return q=A._init,_(C,w,q(A._payload),V)}if(Vl(A)||Tl(A))return q!==null?null:f(C,w,A,V,null);Kc(C,A)}return null}function v(C,w,A,V,q){if(typeof V=="string"&&V!==""||typeof V=="number")return C=C.get(A)||null,a(w,C,""+V,q);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Fc:return C=C.get(V.key===null?A:V.key)||null,l(w,C,V,q);case Yo:return C=C.get(V.key===null?A:V.key)||null,u(w,C,V,q);case bi:var z=V._init;return v(C,w,A,z(V._payload),q)}if(Vl(V)||Tl(V))return C=C.get(A)||null,f(w,C,V,q,null);Kc(w,V)}return null}function E(C,w,A,V){for(var q=null,z=null,S=w,x=w=0,R=null;S!==null&&x<A.length;x++){S.index>x?(R=S,S=null):R=S.sibling;var N=_(C,S,A[x],V);if(N===null){S===null&&(S=R);break}t&&S&&N.alternate===null&&e(C,S),w=s(N,w,x),z===null?q=N:z.sibling=N,z=N,S=R}if(x===A.length)return n(C,S),at&&Ls(C,x),q;if(S===null){for(;x<A.length;x++)S=m(C,A[x],V),S!==null&&(w=s(S,w,x),z===null?q=S:z.sibling=S,z=S);return at&&Ls(C,x),q}for(S=r(C,S);x<A.length;x++)R=v(S,C,x,A[x],V),R!==null&&(t&&R.alternate!==null&&S.delete(R.key===null?x:R.key),w=s(R,w,x),z===null?q=R:z.sibling=R,z=R);return t&&S.forEach(function(D){return e(C,D)}),at&&Ls(C,x),q}function P(C,w,A,V){var q=Tl(A);if(typeof q!="function")throw Error(te(150));if(A=q.call(A),A==null)throw Error(te(151));for(var z=q=null,S=w,x=w=0,R=null,N=A.next();S!==null&&!N.done;x++,N=A.next()){S.index>x?(R=S,S=null):R=S.sibling;var D=_(C,S,N.value,V);if(D===null){S===null&&(S=R);break}t&&S&&D.alternate===null&&e(C,S),w=s(D,w,x),z===null?q=D:z.sibling=D,z=D,S=R}if(N.done)return n(C,S),at&&Ls(C,x),q;if(S===null){for(;!N.done;x++,N=A.next())N=m(C,N.value,V),N!==null&&(w=s(N,w,x),z===null?q=N:z.sibling=N,z=N);return at&&Ls(C,x),q}for(S=r(C,S);!N.done;x++,N=A.next())N=v(S,C,x,N.value,V),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?x:N.key),w=s(N,w,x),z===null?q=N:z.sibling=N,z=N);return t&&S.forEach(function(F){return e(C,F)}),at&&Ls(C,x),q}function M(C,w,A,V){if(typeof A=="object"&&A!==null&&A.type===Xo&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case Fc:e:{for(var q=A.key,z=w;z!==null;){if(z.key===q){if(q=A.type,q===Xo){if(z.tag===7){n(C,z.sibling),w=i(z,A.props.children),w.return=C,C=w;break e}}else if(z.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===bi&&lv(q)===z.type){n(C,z.sibling),w=i(z,A.props),w.ref=xl(C,z,A),w.return=C,C=w;break e}n(C,z);break}else e(C,z);z=z.sibling}A.type===Xo?(w=Xs(A.props.children,C.mode,V,A.key),w.return=C,C=w):(V=yd(A.type,A.key,A.props,null,C.mode,V),V.ref=xl(C,w,A),V.return=C,C=V)}return o(C);case Yo:e:{for(z=A.key;w!==null;){if(w.key===z)if(w.tag===4&&w.stateNode.containerInfo===A.containerInfo&&w.stateNode.implementation===A.implementation){n(C,w.sibling),w=i(w,A.children||[]),w.return=C,C=w;break e}else{n(C,w);break}else e(C,w);w=w.sibling}w=fp(A,C.mode,V),w.return=C,C=w}return o(C);case bi:return z=A._init,M(C,w,z(A._payload),V)}if(Vl(A))return E(C,w,A,V);if(Tl(A))return P(C,w,A,V);Kc(C,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,w!==null&&w.tag===6?(n(C,w.sibling),w=i(w,A),w.return=C,C=w):(n(C,w),w=hp(A,C.mode,V),w.return=C,C=w),o(C)):n(C,w)}return M}var Aa=mS(!0),gS=mS(!1),Jd=ps(null),Qd=null,oa=null,qg=null;function zg(){qg=oa=Qd=null}function $g(t){var e=Jd.current;rt(Jd),t._currentValue=e}function lm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ma(t,e){Qd=t,qg=oa=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(_n=!0),t.firstContext=null)}function Jn(t){var e=t._currentValue;if(qg!==t)if(t={context:t,memoizedValue:e,next:null},oa===null){if(Qd===null)throw Error(te(308));oa=t,Qd.dependencies={lanes:0,firstContext:t}}else oa=oa.next=t;return e}var Ws=null;function jg(t){Ws===null?Ws=[t]:Ws.push(t)}function _S(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,jg(e)):(n.next=i.next,i.next=n),e.interleaved=n,ni(t,r)}function ni(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Di=!1;function Hg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Wi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Le&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ni(t,n)}return i=r.interleaved,i===null?(e.next=e,jg(r)):(e.next=i.next,i.next=e),r.interleaved=e,ni(t,n)}function hd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ng(t,n)}}function uv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Yd(t,e,n,r){var i=t.updateQueue;Di=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=l))}if(s!==null){var m=i.baseState;o=0,f=u=l=null,a=s;do{var _=a.lane,v=a.eventTime;if((r&_)===_){f!==null&&(f=f.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,P=a;switch(_=e,v=n,P.tag){case 1:if(E=P.payload,typeof E=="function"){m=E.call(v,m,_);break e}m=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=P.payload,_=typeof E=="function"?E.call(v,m,_):E,_==null)break e;m=ft({},m,_);break e;case 2:Di=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,_=i.effects,_===null?i.effects=[a]:_.push(a))}else v={eventTime:v,lane:_,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=v,l=m):f=f.next=v,o|=_;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;_=a,a=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(f===null&&(l=m),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);oo|=o,t.lanes=o,t.memoizedState=m}}function cv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(te(191,i));i.call(r)}}}var Wu={},kr=ps(Wu),Iu=ps(Wu),Su=ps(Wu);function Ks(t){if(t===Wu)throw Error(te(174));return t}function Wg(t,e){switch(Ze(Su,e),Ze(Iu,t),Ze(kr,Wu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qp(e,t)}rt(kr),Ze(kr,e)}function Ra(){rt(kr),rt(Iu),rt(Su)}function vS(t){Ks(Su.current);var e=Ks(kr.current),n=qp(e,t.type);e!==n&&(Ze(Iu,t),Ze(kr,n))}function Kg(t){Iu.current===t&&(rt(kr),rt(Iu))}var ct=ps(0);function Xd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var op=[];function Jg(){for(var t=0;t<op.length;t++)op[t]._workInProgressVersionPrimary=null;op.length=0}var fd=li.ReactCurrentDispatcher,ap=li.ReactCurrentBatchConfig,so=0,ht=null,Pt=null,Lt=null,Zd=!1,Jl=!1,xu=0,ek=0;function Jt(){throw Error(te(321))}function Qg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!gr(t[n],e[n]))return!1;return!0}function Yg(t,e,n,r,i,s){if(so=s,ht=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,fd.current=t===null||t.memoizedState===null?ik:sk,t=n(r,i),Jl){s=0;do{if(Jl=!1,xu=0,25<=s)throw Error(te(301));s+=1,Lt=Pt=null,e.updateQueue=null,fd.current=ok,t=n(r,i)}while(Jl)}if(fd.current=eh,e=Pt!==null&&Pt.next!==null,so=0,Lt=Pt=ht=null,Zd=!1,e)throw Error(te(300));return t}function Xg(){var t=xu!==0;return xu=0,t}function Sr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lt===null?ht.memoizedState=Lt=t:Lt=Lt.next=t,Lt}function Qn(){if(Pt===null){var t=ht.alternate;t=t!==null?t.memoizedState:null}else t=Pt.next;var e=Lt===null?ht.memoizedState:Lt.next;if(e!==null)Lt=e,Pt=t;else{if(t===null)throw Error(te(310));Pt=t,t={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Lt===null?ht.memoizedState=Lt=t:Lt=Lt.next=t}return Lt}function Cu(t,e){return typeof e=="function"?e(t):e}function lp(t){var e=Qn(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=Pt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var f=u.lane;if((so&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=m,o=r):l=l.next=m,ht.lanes|=f,oo|=f}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,gr(r,e.memoizedState)||(_n=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ht.lanes|=s,oo|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function up(t){var e=Qn(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);gr(s,e.memoizedState)||(_n=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function TS(){}function ES(t,e){var n=ht,r=Qn(),i=e(),s=!gr(r.memoizedState,i);if(s&&(r.memoizedState=i,_n=!0),r=r.queue,Zg(SS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Lt!==null&&Lt.memoizedState.tag&1){if(n.flags|=2048,Au(9,IS.bind(null,n,r,i,e),void 0,null),Ft===null)throw Error(te(349));so&30||wS(n,e,i)}return i}function wS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ht.updateQueue,e===null?(e={lastEffect:null,stores:null},ht.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function IS(t,e,n,r){e.value=n,e.getSnapshot=r,xS(e)&&CS(t)}function SS(t,e,n){return n(function(){xS(e)&&CS(t)})}function xS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!gr(t,n)}catch{return!0}}function CS(t){var e=ni(t,1);e!==null&&hr(e,t,1,-1)}function dv(t){var e=Sr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cu,lastRenderedState:t},e.queue=t,t=t.dispatch=rk.bind(null,ht,t),[e.memoizedState,t]}function Au(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ht.updateQueue,e===null?(e={lastEffect:null,stores:null},ht.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function AS(){return Qn().memoizedState}function pd(t,e,n,r){var i=Sr();ht.flags|=t,i.memoizedState=Au(1|e,n,void 0,r===void 0?null:r)}function qh(t,e,n,r){var i=Qn();r=r===void 0?null:r;var s=void 0;if(Pt!==null){var o=Pt.memoizedState;if(s=o.destroy,r!==null&&Qg(r,o.deps)){i.memoizedState=Au(e,n,s,r);return}}ht.flags|=t,i.memoizedState=Au(1|e,n,s,r)}function hv(t,e){return pd(8390656,8,t,e)}function Zg(t,e){return qh(2048,8,t,e)}function RS(t,e){return qh(4,2,t,e)}function PS(t,e){return qh(4,4,t,e)}function kS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function NS(t,e,n){return n=n!=null?n.concat([t]):null,qh(4,4,kS.bind(null,e,t),n)}function e_(){}function bS(t,e){var n=Qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function DS(t,e){var n=Qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function MS(t,e,n){return so&21?(gr(n,e)||(n=OI(),ht.lanes|=n,oo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,_n=!0),t.memoizedState=n)}function tk(t,e){var n=He;He=n!==0&&4>n?n:4,t(!0);var r=ap.transition;ap.transition={};try{t(!1),e()}finally{He=n,ap.transition=r}}function VS(){return Qn().memoizedState}function nk(t,e,n){var r=Ji(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},LS(t))FS(e,n);else if(n=_S(t,e,n,r),n!==null){var i=cn();hr(n,t,r,i),US(n,e,r)}}function rk(t,e,n){var r=Ji(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(LS(t))FS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,gr(a,o)){var l=e.interleaved;l===null?(i.next=i,jg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=_S(t,e,i,r),n!==null&&(i=cn(),hr(n,t,r,i),US(n,e,r))}}function LS(t){var e=t.alternate;return t===ht||e!==null&&e===ht}function FS(t,e){Jl=Zd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function US(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ng(t,n)}}var eh={readContext:Jn,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},ik={readContext:Jn,useCallback:function(t,e){return Sr().memoizedState=[t,e===void 0?null:e],t},useContext:Jn,useEffect:hv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,pd(4194308,4,kS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return pd(4194308,4,t,e)},useInsertionEffect:function(t,e){return pd(4,2,t,e)},useMemo:function(t,e){var n=Sr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Sr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=nk.bind(null,ht,t),[r.memoizedState,t]},useRef:function(t){var e=Sr();return t={current:t},e.memoizedState=t},useState:dv,useDebugValue:e_,useDeferredValue:function(t){return Sr().memoizedState=t},useTransition:function(){var t=dv(!1),e=t[0];return t=tk.bind(null,t[1]),Sr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ht,i=Sr();if(at){if(n===void 0)throw Error(te(407));n=n()}else{if(n=e(),Ft===null)throw Error(te(349));so&30||wS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,hv(SS.bind(null,r,s,t),[t]),r.flags|=2048,Au(9,IS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Sr(),e=Ft.identifierPrefix;if(at){var n=Kr,r=Wr;n=(r&~(1<<32-dr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=xu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=ek++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},sk={readContext:Jn,useCallback:bS,useContext:Jn,useEffect:Zg,useImperativeHandle:NS,useInsertionEffect:RS,useLayoutEffect:PS,useMemo:DS,useReducer:lp,useRef:AS,useState:function(){return lp(Cu)},useDebugValue:e_,useDeferredValue:function(t){var e=Qn();return MS(e,Pt.memoizedState,t)},useTransition:function(){var t=lp(Cu)[0],e=Qn().memoizedState;return[t,e]},useMutableSource:TS,useSyncExternalStore:ES,useId:VS,unstable_isNewReconciler:!1},ok={readContext:Jn,useCallback:bS,useContext:Jn,useEffect:Zg,useImperativeHandle:NS,useInsertionEffect:RS,useLayoutEffect:PS,useMemo:DS,useReducer:up,useRef:AS,useState:function(){return up(Cu)},useDebugValue:e_,useDeferredValue:function(t){var e=Qn();return Pt===null?e.memoizedState=t:MS(e,Pt.memoizedState,t)},useTransition:function(){var t=up(Cu)[0],e=Qn().memoizedState;return[t,e]},useMutableSource:TS,useSyncExternalStore:ES,useId:VS,unstable_isNewReconciler:!1};function sr(t,e){if(t&&t.defaultProps){e=ft({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function um(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ft({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var zh={isMounted:function(t){return(t=t._reactInternals)?vo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=cn(),i=Ji(t),s=Xr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Wi(t,s,i),e!==null&&(hr(e,t,i,r),hd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=cn(),i=Ji(t),s=Xr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Wi(t,s,i),e!==null&&(hr(e,t,i,r),hd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=cn(),r=Ji(t),i=Xr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Wi(t,i,r),e!==null&&(hr(e,t,r,n),hd(e,t,r))}};function fv(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!vu(n,r)||!vu(i,s):!0}function OS(t,e,n){var r=!1,i=ss,s=e.contextType;return typeof s=="object"&&s!==null?s=Jn(s):(i=Tn(e)?ro:rn.current,r=e.contextTypes,s=(r=r!=null)?xa(t,i):ss),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function pv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&zh.enqueueReplaceState(e,e.state,null)}function cm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Hg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Jn(s):(s=Tn(e)?ro:rn.current,i.context=xa(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(um(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&zh.enqueueReplaceState(i,i.state,null),Yd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Pa(t,e){try{var n="",r=e;do n+=MR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function cp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function dm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ak=typeof WeakMap=="function"?WeakMap:Map;function BS(t,e,n){n=Xr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){nh||(nh=!0,Em=r),dm(t,e)},n}function GS(t,e,n){n=Xr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){dm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){dm(t,e),typeof r!="function"&&(Ki===null?Ki=new Set([this]):Ki.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function mv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ak;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Ek.bind(null,t,e,n),e.then(t,t))}function gv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function _v(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Xr(-1,1),e.tag=2,Wi(n,e,1))),n.lanes|=1),t)}var lk=li.ReactCurrentOwner,_n=!1;function an(t,e,n,r){e.child=t===null?gS(e,null,n,r):Aa(e,t.child,n,r)}function yv(t,e,n,r,i){n=n.render;var s=e.ref;return ma(e,i),r=Yg(t,e,n,r,s,i),n=Xg(),t!==null&&!_n?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ri(t,e,i)):(at&&n&&Og(e),e.flags|=1,an(t,e,r,i),e.child)}function vv(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!l_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,qS(t,e,s,r,i)):(t=yd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:vu,n(o,r)&&t.ref===e.ref)return ri(t,e,i)}return e.flags|=1,t=Qi(s,r),t.ref=e.ref,t.return=e,e.child=t}function qS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(vu(s,r)&&t.ref===e.ref)if(_n=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(_n=!0);else return e.lanes=t.lanes,ri(t,e,i)}return hm(t,e,n,r,i)}function zS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(la,An),An|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ze(la,An),An|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ze(la,An),An|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ze(la,An),An|=r;return an(t,e,i,n),e.child}function $S(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function hm(t,e,n,r,i){var s=Tn(n)?ro:rn.current;return s=xa(e,s),ma(e,i),n=Yg(t,e,n,r,s,i),r=Xg(),t!==null&&!_n?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ri(t,e,i)):(at&&r&&Og(e),e.flags|=1,an(t,e,n,i),e.child)}function Tv(t,e,n,r,i){if(Tn(n)){var s=!0;Hd(e)}else s=!1;if(ma(e,i),e.stateNode===null)md(t,e),OS(e,n,r),cm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Jn(u):(u=Tn(n)?ro:rn.current,u=xa(e,u));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&pv(e,o,r,u),Di=!1;var _=e.memoizedState;o.state=_,Yd(e,r,o,i),l=e.memoizedState,a!==r||_!==l||vn.current||Di?(typeof f=="function"&&(um(e,n,f,r),l=e.memoizedState),(a=Di||fv(e,n,a,r,_,l,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,yS(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:sr(e.type,a),o.props=u,m=e.pendingProps,_=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Jn(l):(l=Tn(n)?ro:rn.current,l=xa(e,l));var v=n.getDerivedStateFromProps;(f=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||_!==l)&&pv(e,o,r,l),Di=!1,_=e.memoizedState,o.state=_,Yd(e,r,o,i);var E=e.memoizedState;a!==m||_!==E||vn.current||Di?(typeof v=="function"&&(um(e,n,v,r),E=e.memoizedState),(u=Di||fv(e,n,u,r,_,E,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),r=!1)}return fm(t,e,n,r,s,i)}function fm(t,e,n,r,i,s){$S(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&sv(e,n,!1),ri(t,e,s);r=e.stateNode,lk.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Aa(e,t.child,null,s),e.child=Aa(e,null,a,s)):an(t,e,a,s),e.memoizedState=r.state,i&&sv(e,n,!0),e.child}function jS(t){var e=t.stateNode;e.pendingContext?iv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&iv(t,e.context,!1),Wg(t,e.containerInfo)}function Ev(t,e,n,r,i){return Ca(),Gg(i),e.flags|=256,an(t,e,n,r),e.child}var pm={dehydrated:null,treeContext:null,retryLane:0};function mm(t){return{baseLanes:t,cachePool:null,transitions:null}}function HS(t,e,n){var r=e.pendingProps,i=ct.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ze(ct,i&1),t===null)return am(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Hh(o,r,0,null),t=Xs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=mm(n),e.memoizedState=pm,t):t_(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return uk(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Qi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Qi(a,s):(s=Xs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?mm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=pm,r}return s=t.child,t=s.sibling,r=Qi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function t_(t,e){return e=Hh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Jc(t,e,n,r){return r!==null&&Gg(r),Aa(e,t.child,null,n),t=t_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function uk(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=cp(Error(te(422))),Jc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Hh({mode:"visible",children:r.children},i,0,null),s=Xs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Aa(e,t.child,null,o),e.child.memoizedState=mm(o),e.memoizedState=pm,s);if(!(e.mode&1))return Jc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(te(419)),r=cp(s,r,void 0),Jc(t,e,o,r)}if(a=(o&t.childLanes)!==0,_n||a){if(r=Ft,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ni(t,i),hr(r,t,i,-1))}return a_(),r=cp(Error(te(421))),Jc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=wk.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,kn=Hi(i.nextSibling),bn=e,at=!0,lr=null,t!==null&&(Gn[qn++]=Wr,Gn[qn++]=Kr,Gn[qn++]=io,Wr=t.id,Kr=t.overflow,io=e),e=t_(e,r.children),e.flags|=4096,e)}function wv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),lm(t.return,e,n)}function dp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function WS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(an(t,e,r.children,n),r=ct.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wv(t,n,e);else if(t.tag===19)wv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ze(ct,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Xd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),dp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Xd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}dp(e,!0,n,null,s);break;case"together":dp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function md(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ri(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),oo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(te(153));if(e.child!==null){for(t=e.child,n=Qi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Qi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ck(t,e,n){switch(e.tag){case 3:jS(e),Ca();break;case 5:vS(e);break;case 1:Tn(e.type)&&Hd(e);break;case 4:Wg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ze(Jd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ze(ct,ct.current&1),e.flags|=128,null):n&e.child.childLanes?HS(t,e,n):(Ze(ct,ct.current&1),t=ri(t,e,n),t!==null?t.sibling:null);Ze(ct,ct.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return WS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ze(ct,ct.current),r)break;return null;case 22:case 23:return e.lanes=0,zS(t,e,n)}return ri(t,e,n)}var KS,gm,JS,QS;KS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gm=function(){};JS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ks(kr.current);var s=null;switch(n){case"input":i=Up(t,i),r=Up(t,r),s=[];break;case"select":i=ft({},i,{value:void 0}),r=ft({},r,{value:void 0}),s=[];break;case"textarea":i=Gp(t,i),r=Gp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=$d)}zp(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(hu.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(hu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&tt("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};QS=function(t,e,n,r){n!==r&&(e.flags|=4)};function Cl(t,e){if(!at)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function dk(t,e,n){var r=e.pendingProps;switch(Bg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(e),null;case 1:return Tn(e.type)&&jd(),Qt(e),null;case 3:return r=e.stateNode,Ra(),rt(vn),rt(rn),Jg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Wc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,lr!==null&&(Sm(lr),lr=null))),gm(t,e),Qt(e),null;case 5:Kg(e);var i=Ks(Su.current);if(n=e.type,t!==null&&e.stateNode!=null)JS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(te(166));return Qt(e),null}if(t=Ks(kr.current),Wc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Cr]=e,r[wu]=s,t=(e.mode&1)!==0,n){case"dialog":tt("cancel",r),tt("close",r);break;case"iframe":case"object":case"embed":tt("load",r);break;case"video":case"audio":for(i=0;i<Fl.length;i++)tt(Fl[i],r);break;case"source":tt("error",r);break;case"img":case"image":case"link":tt("error",r),tt("load",r);break;case"details":tt("toggle",r);break;case"input":Ny(r,s),tt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},tt("invalid",r);break;case"textarea":Dy(r,s),tt("invalid",r)}zp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Hc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Hc(r.textContent,a,t),i=["children",""+a]):hu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&tt("scroll",r)}switch(n){case"input":Uc(r),by(r,s,!0);break;case"textarea":Uc(r),My(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=$d)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=SI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Cr]=e,t[wu]=r,KS(t,e,!1,!1),e.stateNode=t;e:{switch(o=$p(n,r),n){case"dialog":tt("cancel",t),tt("close",t),i=r;break;case"iframe":case"object":case"embed":tt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Fl.length;i++)tt(Fl[i],t);i=r;break;case"source":tt("error",t),i=r;break;case"img":case"image":case"link":tt("error",t),tt("load",t),i=r;break;case"details":tt("toggle",t),i=r;break;case"input":Ny(t,r),i=Up(t,r),tt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ft({},r,{value:void 0}),tt("invalid",t);break;case"textarea":Dy(t,r),i=Gp(t,r),tt("invalid",t);break;default:i=r}zp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?AI(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&xI(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&fu(t,l):typeof l=="number"&&fu(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(hu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&tt("scroll",t):l!=null&&xg(t,s,l,o))}switch(n){case"input":Uc(t),by(t,r,!1);break;case"textarea":Uc(t),My(t);break;case"option":r.value!=null&&t.setAttribute("value",""+is(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?da(t,!!r.multiple,s,!1):r.defaultValue!=null&&da(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=$d)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qt(e),null;case 6:if(t&&e.stateNode!=null)QS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(te(166));if(n=Ks(Su.current),Ks(kr.current),Wc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Cr]=e,(s=r.nodeValue!==n)&&(t=bn,t!==null))switch(t.tag){case 3:Hc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Hc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Cr]=e,e.stateNode=r}return Qt(e),null;case 13:if(rt(ct),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(at&&kn!==null&&e.mode&1&&!(e.flags&128))pS(),Ca(),e.flags|=98560,s=!1;else if(s=Wc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(te(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(te(317));s[Cr]=e}else Ca(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qt(e),s=!1}else lr!==null&&(Sm(lr),lr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ct.current&1?kt===0&&(kt=3):a_())),e.updateQueue!==null&&(e.flags|=4),Qt(e),null);case 4:return Ra(),gm(t,e),t===null&&Tu(e.stateNode.containerInfo),Qt(e),null;case 10:return $g(e.type._context),Qt(e),null;case 17:return Tn(e.type)&&jd(),Qt(e),null;case 19:if(rt(ct),s=e.memoizedState,s===null)return Qt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Cl(s,!1);else{if(kt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Xd(t),o!==null){for(e.flags|=128,Cl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ze(ct,ct.current&1|2),e.child}t=t.sibling}s.tail!==null&&Et()>ka&&(e.flags|=128,r=!0,Cl(s,!1),e.lanes=4194304)}else{if(!r)if(t=Xd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Cl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!at)return Qt(e),null}else 2*Et()-s.renderingStartTime>ka&&n!==1073741824&&(e.flags|=128,r=!0,Cl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Et(),e.sibling=null,n=ct.current,Ze(ct,r?n&1|2:n&1),e):(Qt(e),null);case 22:case 23:return o_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?An&1073741824&&(Qt(e),e.subtreeFlags&6&&(e.flags|=8192)):Qt(e),null;case 24:return null;case 25:return null}throw Error(te(156,e.tag))}function hk(t,e){switch(Bg(e),e.tag){case 1:return Tn(e.type)&&jd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ra(),rt(vn),rt(rn),Jg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Kg(e),null;case 13:if(rt(ct),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(te(340));Ca()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rt(ct),null;case 4:return Ra(),null;case 10:return $g(e.type._context),null;case 22:case 23:return o_(),null;case 24:return null;default:return null}}var Qc=!1,Zt=!1,fk=typeof WeakSet=="function"?WeakSet:Set,se=null;function aa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){_t(t,e,r)}else n.current=null}function _m(t,e,n){try{n()}catch(r){_t(t,e,r)}}var Iv=!1;function pk(t,e){if(em=Gd,t=tS(),Ug(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,f=0,m=t,_=null;t:for(;;){for(var v;m!==n||i!==0&&m.nodeType!==3||(a=o+i),m!==s||r!==0&&m.nodeType!==3||(l=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)_=m,m=v;for(;;){if(m===t)break t;if(_===n&&++u===i&&(a=o),_===s&&++f===r&&(l=o),(v=m.nextSibling)!==null)break;m=_,_=m.parentNode}m=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(tm={focusedElem:t,selectionRange:n},Gd=!1,se=e;se!==null;)if(e=se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,se=t;else for(;se!==null;){e=se;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var P=E.memoizedProps,M=E.memoizedState,C=e.stateNode,w=C.getSnapshotBeforeUpdate(e.elementType===e.type?P:sr(e.type,P),M);C.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(V){_t(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,se=t;break}se=e.return}return E=Iv,Iv=!1,E}function Ql(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&_m(e,n,s)}i=i.next}while(i!==r)}}function $h(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ym(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function YS(t){var e=t.alternate;e!==null&&(t.alternate=null,YS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Cr],delete e[wu],delete e[im],delete e[QP],delete e[YP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function XS(t){return t.tag===5||t.tag===3||t.tag===4}function Sv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||XS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function vm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$d));else if(r!==4&&(t=t.child,t!==null))for(vm(t,e,n),t=t.sibling;t!==null;)vm(t,e,n),t=t.sibling}function Tm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Tm(t,e,n),t=t.sibling;t!==null;)Tm(t,e,n),t=t.sibling}var $t=null,or=!1;function Ci(t,e,n){for(n=n.child;n!==null;)ZS(t,e,n),n=n.sibling}function ZS(t,e,n){if(Pr&&typeof Pr.onCommitFiberUnmount=="function")try{Pr.onCommitFiberUnmount(Lh,n)}catch{}switch(n.tag){case 5:Zt||aa(n,e);case 6:var r=$t,i=or;$t=null,Ci(t,e,n),$t=r,or=i,$t!==null&&(or?(t=$t,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):$t.removeChild(n.stateNode));break;case 18:$t!==null&&(or?(t=$t,n=n.stateNode,t.nodeType===8?ip(t.parentNode,n):t.nodeType===1&&ip(t,n),_u(t)):ip($t,n.stateNode));break;case 4:r=$t,i=or,$t=n.stateNode.containerInfo,or=!0,Ci(t,e,n),$t=r,or=i;break;case 0:case 11:case 14:case 15:if(!Zt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&_m(n,e,o),i=i.next}while(i!==r)}Ci(t,e,n);break;case 1:if(!Zt&&(aa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){_t(n,e,a)}Ci(t,e,n);break;case 21:Ci(t,e,n);break;case 22:n.mode&1?(Zt=(r=Zt)||n.memoizedState!==null,Ci(t,e,n),Zt=r):Ci(t,e,n);break;default:Ci(t,e,n)}}function xv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new fk),e.forEach(function(r){var i=Ik.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ir(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:$t=a.stateNode,or=!1;break e;case 3:$t=a.stateNode.containerInfo,or=!0;break e;case 4:$t=a.stateNode.containerInfo,or=!0;break e}a=a.return}if($t===null)throw Error(te(160));ZS(s,o,i),$t=null,or=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){_t(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)e0(e,t),e=e.sibling}function e0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ir(e,t),Ir(t),r&4){try{Ql(3,t,t.return),$h(3,t)}catch(P){_t(t,t.return,P)}try{Ql(5,t,t.return)}catch(P){_t(t,t.return,P)}}break;case 1:ir(e,t),Ir(t),r&512&&n!==null&&aa(n,n.return);break;case 5:if(ir(e,t),Ir(t),r&512&&n!==null&&aa(n,n.return),t.flags&32){var i=t.stateNode;try{fu(i,"")}catch(P){_t(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&wI(i,s),$p(a,o);var u=$p(a,s);for(o=0;o<l.length;o+=2){var f=l[o],m=l[o+1];f==="style"?AI(i,m):f==="dangerouslySetInnerHTML"?xI(i,m):f==="children"?fu(i,m):xg(i,f,m,u)}switch(a){case"input":Op(i,s);break;case"textarea":II(i,s);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?da(i,!!s.multiple,v,!1):_!==!!s.multiple&&(s.defaultValue!=null?da(i,!!s.multiple,s.defaultValue,!0):da(i,!!s.multiple,s.multiple?[]:"",!1))}i[wu]=s}catch(P){_t(t,t.return,P)}}break;case 6:if(ir(e,t),Ir(t),r&4){if(t.stateNode===null)throw Error(te(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(P){_t(t,t.return,P)}}break;case 3:if(ir(e,t),Ir(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{_u(e.containerInfo)}catch(P){_t(t,t.return,P)}break;case 4:ir(e,t),Ir(t);break;case 13:ir(e,t),Ir(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(i_=Et())),r&4&&xv(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Zt=(u=Zt)||f,ir(e,t),Zt=u):ir(e,t),Ir(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(se=t,f=t.child;f!==null;){for(m=se=f;se!==null;){switch(_=se,v=_.child,_.tag){case 0:case 11:case 14:case 15:Ql(4,_,_.return);break;case 1:aa(_,_.return);var E=_.stateNode;if(typeof E.componentWillUnmount=="function"){r=_,n=_.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(P){_t(r,n,P)}}break;case 5:aa(_,_.return);break;case 22:if(_.memoizedState!==null){Av(m);continue}}v!==null?(v.return=_,se=v):Av(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{i=m.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=CI("display",o))}catch(P){_t(t,t.return,P)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(P){_t(t,t.return,P)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:ir(e,t),Ir(t),r&4&&xv(t);break;case 21:break;default:ir(e,t),Ir(t)}}function Ir(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(XS(n)){var r=n;break e}n=n.return}throw Error(te(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(fu(i,""),r.flags&=-33);var s=Sv(t);Tm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Sv(t);vm(t,a,o);break;default:throw Error(te(161))}}catch(l){_t(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function mk(t,e,n){se=t,t0(t)}function t0(t,e,n){for(var r=(t.mode&1)!==0;se!==null;){var i=se,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Qc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Zt;a=Qc;var u=Zt;if(Qc=o,(Zt=l)&&!u)for(se=i;se!==null;)o=se,l=o.child,o.tag===22&&o.memoizedState!==null?Rv(i):l!==null?(l.return=o,se=l):Rv(i);for(;s!==null;)se=s,t0(s),s=s.sibling;se=i,Qc=a,Zt=u}Cv(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,se=s):Cv(t)}}function Cv(t){for(;se!==null;){var e=se;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Zt||$h(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:sr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&cv(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}cv(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&_u(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}Zt||e.flags&512&&ym(e)}catch(_){_t(e,e.return,_)}}if(e===t){se=null;break}if(n=e.sibling,n!==null){n.return=e.return,se=n;break}se=e.return}}function Av(t){for(;se!==null;){var e=se;if(e===t){se=null;break}var n=e.sibling;if(n!==null){n.return=e.return,se=n;break}se=e.return}}function Rv(t){for(;se!==null;){var e=se;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{$h(4,e)}catch(l){_t(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){_t(e,i,l)}}var s=e.return;try{ym(e)}catch(l){_t(e,s,l)}break;case 5:var o=e.return;try{ym(e)}catch(l){_t(e,o,l)}}}catch(l){_t(e,e.return,l)}if(e===t){se=null;break}var a=e.sibling;if(a!==null){a.return=e.return,se=a;break}se=e.return}}var gk=Math.ceil,th=li.ReactCurrentDispatcher,n_=li.ReactCurrentOwner,Hn=li.ReactCurrentBatchConfig,Le=0,Ft=null,St=null,Wt=0,An=0,la=ps(0),kt=0,Ru=null,oo=0,jh=0,r_=0,Yl=null,gn=null,i_=0,ka=1/0,$r=null,nh=!1,Em=null,Ki=null,Yc=!1,Gi=null,rh=0,Xl=0,wm=null,gd=-1,_d=0;function cn(){return Le&6?Et():gd!==-1?gd:gd=Et()}function Ji(t){return t.mode&1?Le&2&&Wt!==0?Wt&-Wt:ZP.transition!==null?(_d===0&&(_d=OI()),_d):(t=He,t!==0||(t=window.event,t=t===void 0?16:HI(t.type)),t):1}function hr(t,e,n,r){if(50<Xl)throw Xl=0,wm=null,Error(te(185));$u(t,n,r),(!(Le&2)||t!==Ft)&&(t===Ft&&(!(Le&2)&&(jh|=n),kt===4&&Vi(t,Wt)),En(t,r),n===1&&Le===0&&!(e.mode&1)&&(ka=Et()+500,Gh&&ms()))}function En(t,e){var n=t.callbackNode;ZR(t,e);var r=Bd(t,t===Ft?Wt:0);if(r===0)n!==null&&Fy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Fy(n),e===1)t.tag===0?XP(Pv.bind(null,t)):dS(Pv.bind(null,t)),KP(function(){!(Le&6)&&ms()}),n=null;else{switch(BI(r)){case 1:n=kg;break;case 4:n=FI;break;case 16:n=Od;break;case 536870912:n=UI;break;default:n=Od}n=u0(n,n0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function n0(t,e){if(gd=-1,_d=0,Le&6)throw Error(te(327));var n=t.callbackNode;if(ga()&&t.callbackNode!==n)return null;var r=Bd(t,t===Ft?Wt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ih(t,r);else{e=r;var i=Le;Le|=2;var s=i0();(Ft!==t||Wt!==e)&&($r=null,ka=Et()+500,Ys(t,e));do try{vk();break}catch(a){r0(t,a)}while(!0);zg(),th.current=s,Le=i,St!==null?e=0:(Ft=null,Wt=0,e=kt)}if(e!==0){if(e===2&&(i=Jp(t),i!==0&&(r=i,e=Im(t,i))),e===1)throw n=Ru,Ys(t,0),Vi(t,r),En(t,Et()),n;if(e===6)Vi(t,r);else{if(i=t.current.alternate,!(r&30)&&!_k(i)&&(e=ih(t,r),e===2&&(s=Jp(t),s!==0&&(r=s,e=Im(t,s))),e===1))throw n=Ru,Ys(t,0),Vi(t,r),En(t,Et()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(te(345));case 2:Fs(t,gn,$r);break;case 3:if(Vi(t,r),(r&130023424)===r&&(e=i_+500-Et(),10<e)){if(Bd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){cn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=rm(Fs.bind(null,t,gn,$r),e);break}Fs(t,gn,$r);break;case 4:if(Vi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-dr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Et()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*gk(r/1960))-r,10<r){t.timeoutHandle=rm(Fs.bind(null,t,gn,$r),r);break}Fs(t,gn,$r);break;case 5:Fs(t,gn,$r);break;default:throw Error(te(329))}}}return En(t,Et()),t.callbackNode===n?n0.bind(null,t):null}function Im(t,e){var n=Yl;return t.current.memoizedState.isDehydrated&&(Ys(t,e).flags|=256),t=ih(t,e),t!==2&&(e=gn,gn=n,e!==null&&Sm(e)),t}function Sm(t){gn===null?gn=t:gn.push.apply(gn,t)}function _k(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!gr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vi(t,e){for(e&=~r_,e&=~jh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-dr(e),r=1<<n;t[n]=-1,e&=~r}}function Pv(t){if(Le&6)throw Error(te(327));ga();var e=Bd(t,0);if(!(e&1))return En(t,Et()),null;var n=ih(t,e);if(t.tag!==0&&n===2){var r=Jp(t);r!==0&&(e=r,n=Im(t,r))}if(n===1)throw n=Ru,Ys(t,0),Vi(t,e),En(t,Et()),n;if(n===6)throw Error(te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Fs(t,gn,$r),En(t,Et()),null}function s_(t,e){var n=Le;Le|=1;try{return t(e)}finally{Le=n,Le===0&&(ka=Et()+500,Gh&&ms())}}function ao(t){Gi!==null&&Gi.tag===0&&!(Le&6)&&ga();var e=Le;Le|=1;var n=Hn.transition,r=He;try{if(Hn.transition=null,He=1,t)return t()}finally{He=r,Hn.transition=n,Le=e,!(Le&6)&&ms()}}function o_(){An=la.current,rt(la)}function Ys(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,WP(n)),St!==null)for(n=St.return;n!==null;){var r=n;switch(Bg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&jd();break;case 3:Ra(),rt(vn),rt(rn),Jg();break;case 5:Kg(r);break;case 4:Ra();break;case 13:rt(ct);break;case 19:rt(ct);break;case 10:$g(r.type._context);break;case 22:case 23:o_()}n=n.return}if(Ft=t,St=t=Qi(t.current,null),Wt=An=e,kt=0,Ru=null,r_=jh=oo=0,gn=Yl=null,Ws!==null){for(e=0;e<Ws.length;e++)if(n=Ws[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ws=null}return t}function r0(t,e){do{var n=St;try{if(zg(),fd.current=eh,Zd){for(var r=ht.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Zd=!1}if(so=0,Lt=Pt=ht=null,Jl=!1,xu=0,n_.current=null,n===null||n.return===null){kt=1,Ru=e,St=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Wt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=a,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var _=f.alternate;_?(f.updateQueue=_.updateQueue,f.memoizedState=_.memoizedState,f.lanes=_.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=gv(o);if(v!==null){v.flags&=-257,_v(v,o,a,s,e),v.mode&1&&mv(s,u,e),e=v,l=u;var E=e.updateQueue;if(E===null){var P=new Set;P.add(l),e.updateQueue=P}else E.add(l);break e}else{if(!(e&1)){mv(s,u,e),a_();break e}l=Error(te(426))}}else if(at&&a.mode&1){var M=gv(o);if(M!==null){!(M.flags&65536)&&(M.flags|=256),_v(M,o,a,s,e),Gg(Pa(l,a));break e}}s=l=Pa(l,a),kt!==4&&(kt=2),Yl===null?Yl=[s]:Yl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var C=BS(s,l,e);uv(s,C);break e;case 1:a=l;var w=s.type,A=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ki===null||!Ki.has(A)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=GS(s,a,e);uv(s,V);break e}}s=s.return}while(s!==null)}o0(n)}catch(q){e=q,St===n&&n!==null&&(St=n=n.return);continue}break}while(!0)}function i0(){var t=th.current;return th.current=eh,t===null?eh:t}function a_(){(kt===0||kt===3||kt===2)&&(kt=4),Ft===null||!(oo&268435455)&&!(jh&268435455)||Vi(Ft,Wt)}function ih(t,e){var n=Le;Le|=2;var r=i0();(Ft!==t||Wt!==e)&&($r=null,Ys(t,e));do try{yk();break}catch(i){r0(t,i)}while(!0);if(zg(),Le=n,th.current=r,St!==null)throw Error(te(261));return Ft=null,Wt=0,kt}function yk(){for(;St!==null;)s0(St)}function vk(){for(;St!==null&&!$R();)s0(St)}function s0(t){var e=l0(t.alternate,t,An);t.memoizedProps=t.pendingProps,e===null?o0(t):St=e,n_.current=null}function o0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=hk(n,e),n!==null){n.flags&=32767,St=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{kt=6,St=null;return}}else if(n=dk(n,e,An),n!==null){St=n;return}if(e=e.sibling,e!==null){St=e;return}St=e=t}while(e!==null);kt===0&&(kt=5)}function Fs(t,e,n){var r=He,i=Hn.transition;try{Hn.transition=null,He=1,Tk(t,e,n,r)}finally{Hn.transition=i,He=r}return null}function Tk(t,e,n,r){do ga();while(Gi!==null);if(Le&6)throw Error(te(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(te(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(eP(t,s),t===Ft&&(St=Ft=null,Wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Yc||(Yc=!0,u0(Od,function(){return ga(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Hn.transition,Hn.transition=null;var o=He;He=1;var a=Le;Le|=4,n_.current=null,pk(t,n),e0(n,t),BP(tm),Gd=!!em,tm=em=null,t.current=n,mk(n),jR(),Le=a,He=o,Hn.transition=s}else t.current=n;if(Yc&&(Yc=!1,Gi=t,rh=i),s=t.pendingLanes,s===0&&(Ki=null),KR(n.stateNode),En(t,Et()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(nh)throw nh=!1,t=Em,Em=null,t;return rh&1&&t.tag!==0&&ga(),s=t.pendingLanes,s&1?t===wm?Xl++:(Xl=0,wm=t):Xl=0,ms(),null}function ga(){if(Gi!==null){var t=BI(rh),e=Hn.transition,n=He;try{if(Hn.transition=null,He=16>t?16:t,Gi===null)var r=!1;else{if(t=Gi,Gi=null,rh=0,Le&6)throw Error(te(331));var i=Le;for(Le|=4,se=t.current;se!==null;){var s=se,o=s.child;if(se.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(se=u;se!==null;){var f=se;switch(f.tag){case 0:case 11:case 15:Ql(8,f,s)}var m=f.child;if(m!==null)m.return=f,se=m;else for(;se!==null;){f=se;var _=f.sibling,v=f.return;if(YS(f),f===u){se=null;break}if(_!==null){_.return=v,se=_;break}se=v}}}var E=s.alternate;if(E!==null){var P=E.child;if(P!==null){E.child=null;do{var M=P.sibling;P.sibling=null,P=M}while(P!==null)}}se=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,se=o;else e:for(;se!==null;){if(s=se,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ql(9,s,s.return)}var C=s.sibling;if(C!==null){C.return=s.return,se=C;break e}se=s.return}}var w=t.current;for(se=w;se!==null;){o=se;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,se=A;else e:for(o=w;se!==null;){if(a=se,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:$h(9,a)}}catch(q){_t(a,a.return,q)}if(a===o){se=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,se=V;break e}se=a.return}}if(Le=i,ms(),Pr&&typeof Pr.onPostCommitFiberRoot=="function")try{Pr.onPostCommitFiberRoot(Lh,t)}catch{}r=!0}return r}finally{He=n,Hn.transition=e}}return!1}function kv(t,e,n){e=Pa(n,e),e=BS(t,e,1),t=Wi(t,e,1),e=cn(),t!==null&&($u(t,1,e),En(t,e))}function _t(t,e,n){if(t.tag===3)kv(t,t,n);else for(;e!==null;){if(e.tag===3){kv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ki===null||!Ki.has(r))){t=Pa(n,t),t=GS(e,t,1),e=Wi(e,t,1),t=cn(),e!==null&&($u(e,1,t),En(e,t));break}}e=e.return}}function Ek(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=cn(),t.pingedLanes|=t.suspendedLanes&n,Ft===t&&(Wt&n)===n&&(kt===4||kt===3&&(Wt&130023424)===Wt&&500>Et()-i_?Ys(t,0):r_|=n),En(t,e)}function a0(t,e){e===0&&(t.mode&1?(e=Gc,Gc<<=1,!(Gc&130023424)&&(Gc=4194304)):e=1);var n=cn();t=ni(t,e),t!==null&&($u(t,e,n),En(t,n))}function wk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),a0(t,n)}function Ik(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(e),a0(t,n)}var l0;l0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||vn.current)_n=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return _n=!1,ck(t,e,n);_n=!!(t.flags&131072)}else _n=!1,at&&e.flags&1048576&&hS(e,Kd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;md(t,e),t=e.pendingProps;var i=xa(e,rn.current);ma(e,n),i=Yg(null,e,r,t,i,n);var s=Xg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Tn(r)?(s=!0,Hd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Hg(e),i.updater=zh,e.stateNode=i,i._reactInternals=e,cm(e,r,t,n),e=fm(null,e,r,!0,s,n)):(e.tag=0,at&&s&&Og(e),an(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(md(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=xk(r),t=sr(r,t),i){case 0:e=hm(null,e,r,t,n);break e;case 1:e=Tv(null,e,r,t,n);break e;case 11:e=yv(null,e,r,t,n);break e;case 14:e=vv(null,e,r,sr(r.type,t),n);break e}throw Error(te(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:sr(r,i),hm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:sr(r,i),Tv(t,e,r,i,n);case 3:e:{if(jS(e),t===null)throw Error(te(387));r=e.pendingProps,s=e.memoizedState,i=s.element,yS(t,e),Yd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Pa(Error(te(423)),e),e=Ev(t,e,r,n,i);break e}else if(r!==i){i=Pa(Error(te(424)),e),e=Ev(t,e,r,n,i);break e}else for(kn=Hi(e.stateNode.containerInfo.firstChild),bn=e,at=!0,lr=null,n=gS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ca(),r===i){e=ri(t,e,n);break e}an(t,e,r,n)}e=e.child}return e;case 5:return vS(e),t===null&&am(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,nm(r,i)?o=null:s!==null&&nm(r,s)&&(e.flags|=32),$S(t,e),an(t,e,o,n),e.child;case 6:return t===null&&am(e),null;case 13:return HS(t,e,n);case 4:return Wg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Aa(e,null,r,n):an(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:sr(r,i),yv(t,e,r,i,n);case 7:return an(t,e,e.pendingProps,n),e.child;case 8:return an(t,e,e.pendingProps.children,n),e.child;case 12:return an(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ze(Jd,r._currentValue),r._currentValue=o,s!==null)if(gr(s.value,o)){if(s.children===i.children&&!vn.current){e=ri(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Xr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),lm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(te(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),lm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}an(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ma(e,n),i=Jn(i),r=r(i),e.flags|=1,an(t,e,r,n),e.child;case 14:return r=e.type,i=sr(r,e.pendingProps),i=sr(r.type,i),vv(t,e,r,i,n);case 15:return qS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:sr(r,i),md(t,e),e.tag=1,Tn(r)?(t=!0,Hd(e)):t=!1,ma(e,n),OS(e,r,i),cm(e,r,i,n),fm(null,e,r,!0,t,n);case 19:return WS(t,e,n);case 22:return zS(t,e,n)}throw Error(te(156,e.tag))};function u0(t,e){return LI(t,e)}function Sk(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(t,e,n,r){return new Sk(t,e,n,r)}function l_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xk(t){if(typeof t=="function")return l_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ag)return 11;if(t===Rg)return 14}return 2}function Qi(t,e){var n=t.alternate;return n===null?(n=zn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function yd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")l_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Xo:return Xs(n.children,i,s,e);case Cg:o=8,i|=8;break;case Mp:return t=zn(12,n,e,i|2),t.elementType=Mp,t.lanes=s,t;case Vp:return t=zn(13,n,e,i),t.elementType=Vp,t.lanes=s,t;case Lp:return t=zn(19,n,e,i),t.elementType=Lp,t.lanes=s,t;case vI:return Hh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _I:o=10;break e;case yI:o=9;break e;case Ag:o=11;break e;case Rg:o=14;break e;case bi:o=16,r=null;break e}throw Error(te(130,t==null?t:typeof t,""))}return e=zn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Xs(t,e,n,r){return t=zn(7,t,r,e),t.lanes=n,t}function Hh(t,e,n,r){return t=zn(22,t,r,e),t.elementType=vI,t.lanes=n,t.stateNode={isHidden:!1},t}function hp(t,e,n){return t=zn(6,t,null,e),t.lanes=n,t}function fp(t,e,n){return e=zn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ck(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wf(0),this.expirationTimes=Wf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function u_(t,e,n,r,i,s,o,a,l){return t=new Ck(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=zn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hg(s),t}function Ak(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function c0(t){if(!t)return ss;t=t._reactInternals;e:{if(vo(t)!==t||t.tag!==1)throw Error(te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Tn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(te(171))}if(t.tag===1){var n=t.type;if(Tn(n))return cS(t,n,e)}return e}function d0(t,e,n,r,i,s,o,a,l){return t=u_(n,r,!0,t,i,s,o,a,l),t.context=c0(null),n=t.current,r=cn(),i=Ji(n),s=Xr(r,i),s.callback=e??null,Wi(n,s,i),t.current.lanes=i,$u(t,i,r),En(t,r),t}function Wh(t,e,n,r){var i=e.current,s=cn(),o=Ji(i);return n=c0(n),e.context===null?e.context=n:e.pendingContext=n,e=Xr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Wi(i,e,o),t!==null&&(hr(t,i,o,s),hd(t,i,o)),o}function sh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Nv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function c_(t,e){Nv(t,e),(t=t.alternate)&&Nv(t,e)}function Rk(){return null}var h0=typeof reportError=="function"?reportError:function(t){console.error(t)};function d_(t){this._internalRoot=t}Kh.prototype.render=d_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(te(409));Wh(t,e,null,null)};Kh.prototype.unmount=d_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ao(function(){Wh(null,t,null,null)}),e[ti]=null}};function Kh(t){this._internalRoot=t}Kh.prototype.unstable_scheduleHydration=function(t){if(t){var e=zI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Mi.length&&e!==0&&e<Mi[n].priority;n++);Mi.splice(n,0,t),n===0&&jI(t)}};function h_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Jh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function bv(){}function Pk(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=sh(o);s.call(u)}}var o=d0(e,r,t,0,null,!1,!1,"",bv);return t._reactRootContainer=o,t[ti]=o.current,Tu(t.nodeType===8?t.parentNode:t),ao(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=sh(l);a.call(u)}}var l=u_(t,0,!1,null,null,!1,!1,"",bv);return t._reactRootContainer=l,t[ti]=l.current,Tu(t.nodeType===8?t.parentNode:t),ao(function(){Wh(e,l,n,r)}),l}function Qh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=sh(o);a.call(l)}}Wh(e,o,t,i)}else o=Pk(n,e,t,i,r);return sh(o)}GI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ll(e.pendingLanes);n!==0&&(Ng(e,n|1),En(e,Et()),!(Le&6)&&(ka=Et()+500,ms()))}break;case 13:ao(function(){var r=ni(t,1);if(r!==null){var i=cn();hr(r,t,1,i)}}),c_(t,1)}};bg=function(t){if(t.tag===13){var e=ni(t,134217728);if(e!==null){var n=cn();hr(e,t,134217728,n)}c_(t,134217728)}};qI=function(t){if(t.tag===13){var e=Ji(t),n=ni(t,e);if(n!==null){var r=cn();hr(n,t,e,r)}c_(t,e)}};zI=function(){return He};$I=function(t,e){var n=He;try{return He=t,e()}finally{He=n}};Hp=function(t,e,n){switch(e){case"input":if(Op(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Bh(r);if(!i)throw Error(te(90));EI(r),Op(r,i)}}}break;case"textarea":II(t,n);break;case"select":e=n.value,e!=null&&da(t,!!n.multiple,e,!1)}};kI=s_;NI=ao;var kk={usingClientEntryPoint:!1,Events:[Hu,na,Bh,RI,PI,s_]},Al={findFiberByHostInstance:Hs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Nk={bundleType:Al.bundleType,version:Al.version,rendererPackageName:Al.rendererPackageName,rendererConfig:Al.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:li.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=MI(t),t===null?null:t.stateNode},findFiberByHostInstance:Al.findFiberByHostInstance||Rk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xc.isDisabled&&Xc.supportsFiber)try{Lh=Xc.inject(Nk),Pr=Xc}catch{}}Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kk;Vn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h_(e))throw Error(te(200));return Ak(t,e,null,n)};Vn.createRoot=function(t,e){if(!h_(t))throw Error(te(299));var n=!1,r="",i=h0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=u_(t,1,!1,null,null,n,!1,r,i),t[ti]=e.current,Tu(t.nodeType===8?t.parentNode:t),new d_(e)};Vn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(te(188)):(t=Object.keys(t).join(","),Error(te(268,t)));return t=MI(e),t=t===null?null:t.stateNode,t};Vn.flushSync=function(t){return ao(t)};Vn.hydrate=function(t,e,n){if(!Jh(e))throw Error(te(200));return Qh(null,t,e,!0,n)};Vn.hydrateRoot=function(t,e,n){if(!h_(t))throw Error(te(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=h0;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=d0(e,null,t,1,n??null,i,!1,s,o),t[ti]=e.current,Tu(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Kh(e)};Vn.render=function(t,e,n){if(!Jh(e))throw Error(te(200));return Qh(null,t,e,!1,n)};Vn.unmountComponentAtNode=function(t){if(!Jh(t))throw Error(te(40));return t._reactRootContainer?(ao(function(){Qh(null,null,t,!1,function(){t._reactRootContainer=null,t[ti]=null})}),!0):!1};Vn.unstable_batchedUpdates=s_;Vn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Jh(n))throw Error(te(200));if(t==null||t._reactInternals===void 0)throw Error(te(38));return Qh(t,e,n,!1,r)};Vn.version="18.3.1-next-f1338f8080-20240426";function f0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f0)}catch(t){console.error(t)}}f0(),fI.exports=Vn;var bk=fI.exports,Dv=bk;bp.createRoot=Dv.createRoot,bp.hydrateRoot=Dv.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Dk,Mk;function Vk(){return{geminiUrl:Dk,vertexUrl:Mk}}function Lk(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=Vk();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class To{}function le(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function h(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const f=l[u];h(f,e.slice(s+1),n[u])}else for(const u of l)h(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];h(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function d(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>d(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function Fk(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}xm(t,i,s,0,o)}}function xm(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])xm(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,f]of Object.entries(l)){const m=[];for(const _ of n.slice(r))_==="*"?m.push(u):m.push(_);h(o,m,f)}for(const u of a)delete o[u]}}else{const o=t;s in o&&xm(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f_(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uk(t){const e={},n=d(t,["operationName"]);n!=null&&h(e,["operationName"],n);const r=d(t,["resourceName"]);return r!=null&&h(e,["_url","resourceName"],r),e}function Ok(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);s!=null&&h(e,["error"],s);const o=d(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],Gk(o)),e}function Bk(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);s!=null&&h(e,["error"],s);const o=d(t,["response"]);return o!=null&&h(e,["response"],qk(o)),e}function Gk(t){const e={},n=d(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>zk(o))),h(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function qk(t){const e={},n=d(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>$k(o))),h(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function zk(t){const e={},n=d(t,["video"]);return n!=null&&h(e,["video"],Wk(n)),e}function $k(t){const e={},n=d(t,["_self"]);return n!=null&&h(e,["video"],Kk(n)),e}function jk(t){const e={},n=d(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function Hk(t){const e={},n=d(t,["operationName"]);return n!=null&&h(e,["_url","operationName"],n),e}function Wk(t){const e={},n=d(t,["uri"]);n!=null&&h(e,["uri"],n);const r=d(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],f_(r));const i=d(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function Kk(t){const e={},n=d(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],f_(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Mv;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Mv||(Mv={}));var Vv;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Vv||(Vv={}));var Lv;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Lv||(Lv={}));var $n;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})($n||($n={}));var Fv;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Fv||(Fv={}));var Uv;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Uv||(Uv={}));var Ov;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Ov||(Ov={}));var Bv;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Bv||(Bv={}));var Gv;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Gv||(Gv={}));var qv;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(qv||(qv={}));var zv;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(zv||(zv={}));var $v;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})($v||($v={}));var jv;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(jv||(jv={}));var Hv;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Hv||(Hv={}));var Wv;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(Wv||(Wv={}));var Kv;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Kv||(Kv={}));var oh;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(oh||(oh={}));var Jv;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Jv||(Jv={}));var Qv;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Qv||(Qv={}));var Yv;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Yv||(Yv={}));var Cm;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Cm||(Cm={}));var Xv;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(Xv||(Xv={}));var Zv;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Zv||(Zv={}));var eT;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(eT||(eT={}));var tT;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(tT||(tT={}));var nT;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(nT||(nT={}));var rT;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(rT||(rT={}));var iT;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(iT||(iT={}));var sT;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(sT||(sT={}));var oT;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(oT||(oT={}));var aT;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(aT||(aT={}));var lT;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(lT||(lT={}));var uT;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(uT||(uT={}));var cT;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(cT||(cT={}));var dT;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(dT||(dT={}));var hT;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(hT||(hT={}));var fT;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(fT||(fT={}));var pT;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(pT||(pT={}));var mT;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(mT||(mT={}));var gT;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(gT||(gT={}));var _T;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(_T||(_T={}));var yT;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(yT||(yT={}));var vT;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(vT||(vT={}));var TT;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(TT||(TT={}));var ET;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(ET||(ET={}));var wT;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(wT||(wT={}));var IT;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(IT||(IT={}));var ST;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(ST||(ST={}));var xT;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(xT||(xT={}));var ua;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(ua||(ua={}));class Am{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Rl{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const m=[];for(const _ of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[v,E]of Object.entries(_))v!=="text"&&v!=="thought"&&(E!==null||E!==void 0)&&m.push(v);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;f=!0,u+=_.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[_,v]of Object.entries(m))_!=="inlineData"&&(v!==null||v!==void 0)&&f.push(_);m.inlineData&&typeof m.inlineData.data=="string"&&(u+=atob(m.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class CT{}class AT{}class Jk{}class Qk{}class Yk{}class Xk{}class RT{}class PT{}class kT{}class Zk{}class ah{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new ah;let i;const s=e;return n?i=Bk(s):i=Ok(s),Object.assign(r,i),r}}class NT{}class bT{}class DT{}class e1{}class t1{}class n1{}class MT{}class r1{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class i1{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ue(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function p0(t,e){const n=Ue(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function m0(t){return Array.isArray(t)?t.map(e=>lh(e)):[lh(t)]}function lh(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function g0(t){const e=lh(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function _0(t){const e=lh(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function VT(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function y0(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>VT(e)):[VT(t)]}function Rm(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function LT(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function FT(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function tn(t){if(t==null)throw new Error("ContentUnion is required");return Rm(t)?t:{role:"user",parts:y0(t)}}function p_(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=tn(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=tn(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>tn(n)):[tn(e)]}function Wn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(LT(t)||FT(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[tn(t)]}const e=[],n=[],r=Rm(t[0]);for(const i of t){const s=Rm(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(LT(i)||FT(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:y0(n)}),e}function s1(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values($n).includes(n[0].toUpperCase())?n[0].toUpperCase():$n.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values($n).includes(r.toUpperCase())?r.toUpperCase():$n.TYPE_UNSPECIFIED})}}function _a(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&s1(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values($n).includes(a.toUpperCase())?a.toUpperCase():$n.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=_a(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(_a(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,f]of Object.entries(a))l[u]=_a(f);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function m_(t){return _a(t)}function g_(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function __(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ya(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=_a(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=_a(e.response));return t}function Xa(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function o1(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function ui(t,e){if(typeof e!="string")throw new Error("name must be a string");return o1(t,e,"cachedContents")}function v0(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function gs(t){return f_(t)}function a1(t){return t!=null&&typeof t=="object"&&"name"in t}function l1(t){return t!=null&&typeof t=="object"&&"video"in t}function u1(t){return t!=null&&typeof t=="object"&&"uri"in t}function T0(t){var e;let n;if(a1(t)&&(n=t.name),!(u1(t)&&(n=t.uri,n===void 0))&&!(l1(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function E0(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function w0(t){for(const e of["models","tunedModels","publisherModels"])if(c1(t,e))return t[e];return[]}function c1(t,e){return t!==null&&typeof t=="object"&&e in t}function d1(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function h1(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=d1(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function I0(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function f1(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function S0(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Za(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function x0(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function p1(t){const e={},n=d(t,["responsesFile"]);n!=null&&h(e,["fileName"],n);const r=d(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>j1(o))),h(e,["inlinedResponses"],s)}const i=d(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["inlinedEmbedContentResponses"],s)}return e}function m1(t){const e={},n=d(t,["predictionsFormat"]);n!=null&&h(e,["format"],n);const r=d(t,["gcsDestination","outputUriPrefix"]);r!=null&&h(e,["gcsUri"],r);const i=d(t,["bigqueryDestination","outputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function g1(t){const e={},n=d(t,["format"]);n!=null&&h(e,["predictionsFormat"],n);const r=d(t,["gcsUri"]);r!=null&&h(e,["gcsDestination","outputUriPrefix"],r);const i=d(t,["bigqueryUri"]);if(i!=null&&h(e,["bigqueryDestination","outputUri"],i),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function vd(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["metadata","displayName"]);r!=null&&h(e,["displayName"],r);const i=d(t,["metadata","state"]);i!=null&&h(e,["state"],x0(i));const s=d(t,["metadata","createTime"]);s!=null&&h(e,["createTime"],s);const o=d(t,["metadata","endTime"]);o!=null&&h(e,["endTime"],o);const a=d(t,["metadata","updateTime"]);a!=null&&h(e,["updateTime"],a);const l=d(t,["metadata","model"]);l!=null&&h(e,["model"],l);const u=d(t,["metadata","output"]);return u!=null&&h(e,["dest"],p1(S0(u))),e}function Pm(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=d(t,["state"]);i!=null&&h(e,["state"],x0(i));const s=d(t,["error"]);s!=null&&h(e,["error"],s);const o=d(t,["createTime"]);o!=null&&h(e,["createTime"],o);const a=d(t,["startTime"]);a!=null&&h(e,["startTime"],a);const l=d(t,["endTime"]);l!=null&&h(e,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&h(e,["updateTime"],u);const f=d(t,["model"]);f!=null&&h(e,["model"],f);const m=d(t,["inputConfig"]);m!=null&&h(e,["src"],_1(m));const _=d(t,["outputConfig"]);return _!=null&&h(e,["dest"],m1(S0(_))),e}function _1(t){const e={},n=d(t,["instancesFormat"]);n!=null&&h(e,["format"],n);const r=d(t,["gcsSource","uris"]);r!=null&&h(e,["gcsUri"],r);const i=d(t,["bigquerySource","inputUri"]);return i!=null&&h(e,["bigqueryUri"],i),e}function y1(t,e){const n={};if(d(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=d(e,["fileName"]);r!=null&&h(n,["fileName"],r);const i=d(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>$1(t,o))),h(n,["requests","requests"],s)}return n}function v1(t){const e={},n=d(t,["format"]);n!=null&&h(e,["instancesFormat"],n);const r=d(t,["gcsUri"]);r!=null&&h(e,["gcsSource","uris"],r);const i=d(t,["bigqueryUri"]);if(i!=null&&h(e,["bigquerySource","inputUri"],i),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function T1(t){const e={},n=d(t,["data"]);if(n!=null&&h(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function E1(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Za(t,r)),n}function w1(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Za(t,r)),n}function I1(t){const e={},n=d(t,["content"]);n!=null&&h(e,["content"],n);const r=d(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],S1(r));const i=d(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=d(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=d(t,["avgLogprobs"]);o!=null&&h(e,["avgLogprobs"],o);const a=d(t,["groundingMetadata"]);a!=null&&h(e,["groundingMetadata"],a);const l=d(t,["index"]);l!=null&&h(e,["index"],l);const u=d(t,["logprobsResult"]);u!=null&&h(e,["logprobsResult"],u);const f=d(t,["safetyRatings"]);if(f!=null){let _=f;Array.isArray(_)&&(_=_.map(v=>v)),h(e,["safetyRatings"],_)}const m=d(t,["urlContextMetadata"]);return m!=null&&h(e,["urlContextMetadata"],m),e}function S1(t){const e={},n=d(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function C0(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>X1(s))),h(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&h(e,["role"],r),e}function x1(t,e){const n={},r=d(t,["displayName"]);if(e!==void 0&&r!=null&&h(e,["batch","displayName"],r),d(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function C1(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=d(t,["dest"]);return e!==void 0&&i!=null&&h(e,["outputConfig"],g1(f1(i))),n}function UT(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["src"]);i!=null&&h(n,["batch","inputConfig"],y1(t,I0(t,i)));const s=d(e,["config"]);return s!=null&&x1(s,n),n}function A1(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["model"],Ue(t,r));const i=d(e,["src"]);i!=null&&h(n,["inputConfig"],v1(I0(t,i)));const s=d(e,["config"]);return s!=null&&C1(s,n),n}function R1(t,e){const n={},r=d(t,["displayName"]);return e!==void 0&&r!=null&&h(e,["batch","displayName"],r),n}function P1(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["src"]);i!=null&&h(n,["batch","inputConfig"],L1(t,i));const s=d(e,["config"]);return s!=null&&R1(s,n),n}function k1(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Za(t,r)),n}function N1(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Za(t,r)),n}function b1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&h(e,["name"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);return s!=null&&h(e,["error"],s),e}function D1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&h(e,["name"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);return s!=null&&h(e,["error"],s),e}function M1(t,e){const n={},r=d(e,["contents"]);if(r!=null){let s=p_(t,r);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["requests[]","request","content"],s)}const i=d(e,["config"]);return i!=null&&(h(n,["_self"],V1(i,n)),Fk(n,{"requests[].*":"requests[].request.*"})),n}function V1(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=d(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function L1(t,e){const n={},r=d(e,["fileName"]);r!=null&&h(n,["file_name"],r);const i=d(e,["inlinedRequests"]);return i!=null&&h(n,["requests"],M1(t,i)),n}function F1(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function U1(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],C0(tn(i)));const s=d(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=d(e,["topP"]);o!=null&&h(r,["topP"],o);const a=d(e,["topK"]);a!=null&&h(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=d(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=d(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const _=d(e,["logprobs"]);_!=null&&h(r,["logprobs"],_);const v=d(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const E=d(e,["frequencyPenalty"]);E!=null&&h(r,["frequencyPenalty"],E);const P=d(e,["seed"]);P!=null&&h(r,["seed"],P);const M=d(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const C=d(e,["responseSchema"]);C!=null&&h(r,["responseSchema"],m_(C));const w=d(e,["responseJsonSchema"]);if(w!=null&&h(r,["responseJsonSchema"],w),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=d(e,["safetySettings"]);if(n!==void 0&&A!=null){let F=A;Array.isArray(F)&&(F=F.map(b=>Z1(b))),h(n,["safetySettings"],F)}const V=d(e,["tools"]);if(n!==void 0&&V!=null){let F=Xa(V);Array.isArray(F)&&(F=F.map(b=>eN(Ya(b)))),h(n,["tools"],F)}const q=d(e,["toolConfig"]);if(n!==void 0&&q!=null&&h(n,["toolConfig"],q),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=d(e,["cachedContent"]);n!==void 0&&z!=null&&h(n,["cachedContent"],ui(t,z));const S=d(e,["responseModalities"]);S!=null&&h(r,["responseModalities"],S);const x=d(e,["mediaResolution"]);x!=null&&h(r,["mediaResolution"],x);const R=d(e,["speechConfig"]);if(R!=null&&h(r,["speechConfig"],g_(R)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);N!=null&&h(r,["thinkingConfig"],N);const D=d(e,["imageConfig"]);return D!=null&&h(r,["imageConfig"],D),r}function O1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>I1(u))),h(e,["candidates"],l)}const i=d(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=d(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=d(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=d(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function B1(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Za(t,r)),n}function G1(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],Za(t,r)),n}function q1(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function z1(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function $1(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["request","model"],Ue(t,r));const i=d(e,["contents"]);if(i!=null){let a=Wn(i);Array.isArray(a)&&(a=a.map(l=>C0(l))),h(n,["request","contents"],a)}const s=d(e,["metadata"]);s!=null&&h(n,["metadata"],s);const o=d(e,["config"]);return o!=null&&h(n,["request","generationConfig"],U1(t,o,d(n,["request"],{}))),n}function j1(t){const e={},n=d(t,["response"]);n!=null&&h(e,["response"],O1(n));const r=d(t,["error"]);return r!=null&&h(e,["error"],r),e}function H1(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);if(e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),d(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function W1(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);e!==void 0&&i!=null&&h(e,["_query","pageToken"],i);const s=d(t,["filter"]);return e!==void 0&&s!=null&&h(e,["_query","filter"],s),n}function K1(t){const e={},n=d(t,["config"]);return n!=null&&H1(n,e),e}function J1(t){const e={},n=d(t,["config"]);return n!=null&&W1(n,e),e}function Q1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>vd(o))),h(e,["batchJobs"],s)}return e}function Y1(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Pm(o))),h(e,["batchJobs"],s)}return e}function X1(t){const e={},n=d(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&h(e,["fileData"],F1(s));const o=d(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&h(e,["inlineData"],T1(a));const l=d(t,["text"]);l!=null&&h(e,["text"],l);const u=d(t,["thought"]);u!=null&&h(e,["thought"],u);const f=d(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=d(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function Z1(t){const e={},n=d(t,["category"]);if(n!=null&&h(e,["category"],n),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function eN(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],q1(i));const s=d(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],z1(a));const l=d(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var lo;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_RAG_STORES="ragStores",t.PAGED_ITEM_DOCUMENTS="documents"})(lo||(lo={}));class Ku{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tN extends To{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new Ku(lo.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=UT(this.apiClient,e),r=n._url,i=le("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const f of l){const m=Object.assign({},f);if(m.systemInstruction){const _=m.systemInstruction;delete m.systemInstruction;const v=m.request;v.systemInstruction=_,m.request=v}u.push(m)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=A1(this.apiClient,e);return a=le("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Pm(f))}else{const u=UT(this.apiClient,e);return a=le("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>vd(f))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=P1(this.apiClient,e);return s=le("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>vd(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=G1(this.apiClient,e);return a=le("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Pm(f))}else{const u=B1(this.apiClient,e);return a=le("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>vd(f))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=w1(this.apiClient,e);o=le("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=E1(this.apiClient,e);o=le("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=J1(e);return a=le("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=Y1(f),_=new MT;return Object.assign(_,m),_})}else{const u=K1(e);return a=le("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=Q1(f),_=new MT;return Object.assign(_,m),_})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=N1(this.apiClient,e);return a=le("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>D1(f))}else{const u=k1(this.apiClient,e);return a=le("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>b1(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nN(t){const e={},n=d(t,["data"]);if(n!=null&&h(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function OT(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>IN(s))),h(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&h(e,["role"],r),e}function rN(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=d(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=d(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=d(t,["contents"]);if(e!==void 0&&o!=null){let f=Wn(o);Array.isArray(f)&&(f=f.map(m=>OT(m))),h(e,["contents"],f)}const a=d(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],OT(tn(a)));const l=d(t,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>SN(m))),h(e,["tools"],f)}const u=d(t,["toolConfig"]);if(e!==void 0&&u!=null&&h(e,["toolConfig"],u),d(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function iN(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=d(t,["expireTime"]);e!==void 0&&i!=null&&h(e,["expireTime"],i);const s=d(t,["displayName"]);e!==void 0&&s!=null&&h(e,["displayName"],s);const o=d(t,["contents"]);if(e!==void 0&&o!=null){let m=Wn(o);Array.isArray(m)&&(m=m.map(_=>_)),h(e,["contents"],m)}const a=d(t,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],tn(a));const l=d(t,["tools"]);if(e!==void 0&&l!=null){let m=l;Array.isArray(m)&&(m=m.map(_=>xN(_))),h(e,["tools"],m)}const u=d(t,["toolConfig"]);e!==void 0&&u!=null&&h(e,["toolConfig"],u);const f=d(t,["kmsKeyName"]);return e!==void 0&&f!=null&&h(e,["encryption_spec","kmsKeyName"],f),n}function sN(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["model"],p0(t,r));const i=d(e,["config"]);return i!=null&&rN(i,n),n}function oN(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["model"],p0(t,r));const i=d(e,["config"]);return i!=null&&iN(i,n),n}function aN(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],ui(t,r)),n}function lN(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],ui(t,r)),n}function uN(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function cN(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function dN(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function hN(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&h(e,["description"],n);const r=d(t,["name"]);r!=null&&h(e,["name"],r);const i=d(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&h(e,["response"],o);const a=d(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function fN(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],ui(t,r)),n}function pN(t,e){const n={},r=d(e,["name"]);return r!=null&&h(n,["_url","name"],ui(t,r)),n}function mN(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function gN(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function _N(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function yN(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function vN(t){const e={},n=d(t,["config"]);return n!=null&&_N(n,e),e}function TN(t){const e={},n=d(t,["config"]);return n!=null&&yN(n,e),e}function EN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function wN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["cachedContents"],s)}return e}function IN(t){const e={},n=d(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&h(e,["fileData"],dN(s));const o=d(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&h(e,["inlineData"],nN(a));const l=d(t,["text"]);l!=null&&h(e,["text"],l);const u=d(t,["thought"]);u!=null&&h(e,["thought"],u);const f=d(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=d(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function SN(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],mN(i));const s=d(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],gN(a));const l=d(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}function xN(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(_=>hN(_))),h(e,["functionDeclarations"],m)}const r=d(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&h(e,["googleSearchRetrieval"],i);const s=d(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],s);const o=d(t,["computerUse"]);o!=null&&h(e,["computerUse"],o);const a=d(t,["codeExecution"]);a!=null&&h(e,["codeExecution"],a);const l=d(t,["enterpriseWebSearch"]);l!=null&&h(e,["enterpriseWebSearch"],l);const u=d(t,["googleSearch"]);u!=null&&h(e,["googleSearch"],u);const f=d(t,["urlContext"]);return f!=null&&h(e,["urlContext"],f),e}function CN(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=d(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function AN(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&h(e,["ttl"],r);const i=d(t,["expireTime"]);return e!==void 0&&i!=null&&h(e,["expireTime"],i),n}function RN(t,e){const n={},r=d(e,["name"]);r!=null&&h(n,["_url","name"],ui(t,r));const i=d(e,["config"]);return i!=null&&CN(i,n),n}function PN(t,e){const n={},r=d(e,["name"]);r!=null&&h(n,["_url","name"],ui(t,r));const i=d(e,["config"]);return i!=null&&AN(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kN extends To{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Ku(lo.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=oN(this.apiClient,e);return a=le("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=sN(this.apiClient,e);return a=le("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=pN(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=fN(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=lN(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=cN(f),_=new bT;return Object.assign(_,m),_})}else{const u=aN(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=uN(f),_=new bT;return Object.assign(_,m),_})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=PN(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const u=RN(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=TN(e);return a=le("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=wN(f),_=new DT;return Object.assign(_,m),_})}else{const u=vN(e);return a=le("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=EN(f),_=new DT;return Object.assign(_,m),_})}}}function BT(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function nt(t){return this instanceof nt?(this.v=t,this):new nt(t)}function ya(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(E){return Promise.resolve(E).then(v,m)}}function a(v,E){r[v]&&(i[v]=function(P){return new Promise(function(M,C){s.push([v,P,M,C])>1||l(v,P)})},E&&(i[v]=E(i[v])))}function l(v,E){try{u(r[v](E))}catch(P){_(s[0][3],P)}}function u(v){v.value instanceof nt?Promise.resolve(v.value.v).then(f,m):_(s[0][2],v)}function f(v){l("next",v)}function m(v){l("throw",v)}function _(v,E){v(E),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Zl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof BT=="function"?BT(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NN(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:A0(n)}function A0(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function bN(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function GT(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!A0(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class DN{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new MN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class MN{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),bN(s)}async sendMessage(e){var n;await this.sendPromise;const r=tn(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,f=l.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let _=[];f!=null&&(_=(a=f.slice(m))!==null&&a!==void 0?a:[]);const v=u?[u]:[];this.recordHistory(r,v,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=tn(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?GT(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return ya(this,arguments,function*(){var o,a,l,u;const f=[];try{for(var m=!0,_=Zl(e),v;v=yield nt(_.next()),o=v.done,!o;m=!0){u=v.value,m=!1;const E=u;if(NN(E)){const P=(i=(r=E.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;P!==void 0&&f.push(P)}yield yield nt(E)}}catch(E){a={error:E}}finally{try{!m&&!o&&(l=_.return)&&(yield nt(l.call(_)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...GT(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Yh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Yh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VN(t){const e={},n=d(t,["file"]);return n!=null&&h(e,["file"],n),e}function LN(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function FN(t){const e={},n=d(t,["name"]);return n!=null&&h(e,["_url","file"],T0(n)),e}function UN(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function ON(t){const e={},n=d(t,["name"]);return n!=null&&h(e,["_url","file"],T0(n)),e}function BN(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&h(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&h(e,["_query","pageToken"],i),n}function GN(t){const e={},n=d(t,["config"]);return n!=null&&BN(n,e),e}function qN(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zN extends To{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Ku(lo.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=GN(e);return s=le("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=qN(l),f=new e1;return Object.assign(f,u),f})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=VN(e);return s=le("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=LN(l),f=new t1;return Object.assign(f,u),f})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ON(e);return s=le("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=FN(e);return s=le("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=UN(l),f=new n1;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Td(t){const e={},n=d(t,["data"]);if(n!=null&&h(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function $N(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>sb(s))),h(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&h(e,["role"],r),e}function jN(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function HN(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&h(e,["description"],n);const r=d(t,["name"]);r!=null&&h(e,["name"],r);const i=d(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&h(e,["response"],o);const a=d(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function WN(t){const e={},n=d(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=d(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=d(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=d(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=d(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=d(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=d(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=d(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=d(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const m=d(t,["responseJsonSchema"]);m!=null&&h(e,["responseJsonSchema"],m);const _=d(t,["responseLogprobs"]);_!=null&&h(e,["responseLogprobs"],_);const v=d(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const E=d(t,["responseModalities"]);E!=null&&h(e,["responseModalities"],E);const P=d(t,["responseSchema"]);P!=null&&h(e,["responseSchema"],P);const M=d(t,["routingConfig"]);M!=null&&h(e,["routingConfig"],M);const C=d(t,["seed"]);C!=null&&h(e,["seed"],C);const w=d(t,["speechConfig"]);w!=null&&h(e,["speechConfig"],R0(w));const A=d(t,["stopSequences"]);A!=null&&h(e,["stopSequences"],A);const V=d(t,["temperature"]);V!=null&&h(e,["temperature"],V);const q=d(t,["thinkingConfig"]);q!=null&&h(e,["thinkingConfig"],q);const z=d(t,["topK"]);z!=null&&h(e,["topK"],z);const S=d(t,["topP"]);if(S!=null&&h(e,["topP"],S),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function KN(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function JN(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function QN(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=d(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=d(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],__(m));const _=d(t,["thinkingConfig"]);e!==void 0&&_!=null&&h(e,["setup","generationConfig","thinkingConfig"],_);const v=d(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const E=d(t,["systemInstruction"]);e!==void 0&&E!=null&&h(e,["setup","systemInstruction"],$N(tn(E)));const P=d(t,["tools"]);if(e!==void 0&&P!=null){let z=Xa(P);Array.isArray(z)&&(z=z.map(S=>ab(Ya(S)))),h(e,["setup","tools"],z)}const M=d(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],ob(M));const C=d(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&h(e,["setup","inputAudioTranscription"],C);const w=d(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&h(e,["setup","outputAudioTranscription"],w);const A=d(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&h(e,["setup","realtimeInputConfig"],A);const V=d(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const q=d(t,["proactivity"]);return e!==void 0&&q!=null&&h(e,["setup","proactivity"],q),n}function YN(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],WN(r));const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=d(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=d(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],R0(__(m)));const _=d(t,["thinkingConfig"]);e!==void 0&&_!=null&&h(e,["setup","generationConfig","thinkingConfig"],_);const v=d(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const E=d(t,["systemInstruction"]);e!==void 0&&E!=null&&h(e,["setup","systemInstruction"],tn(E));const P=d(t,["tools"]);if(e!==void 0&&P!=null){let z=Xa(P);Array.isArray(z)&&(z=z.map(S=>lb(Ya(S)))),h(e,["setup","tools"],z)}const M=d(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],M);const C=d(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&h(e,["setup","inputAudioTranscription"],C);const w=d(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&h(e,["setup","outputAudioTranscription"],w);const A=d(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&h(e,["setup","realtimeInputConfig"],A);const V=d(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const q=d(t,["proactivity"]);return e!==void 0&&q!=null&&h(e,["setup","proactivity"],q),n}function XN(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["setup","model"],Ue(t,r));const i=d(e,["config"]);return i!=null&&h(n,["config"],QN(i,n)),n}function ZN(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["setup","model"],Ue(t,r));const i=d(e,["config"]);return i!=null&&h(n,["config"],YN(i,n)),n}function eb(t){const e={},n=d(t,["musicGenerationConfig"]);return n!=null&&h(e,["musicGenerationConfig"],n),e}function tb(t){const e={},n=d(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["weightedPrompts"],r)}return e}function nb(t){const e={},n=d(t,["media"]);if(n!=null){let u=m0(n);Array.isArray(u)&&(u=u.map(f=>Td(f))),h(e,["mediaChunks"],u)}const r=d(t,["audio"]);r!=null&&h(e,["audio"],Td(_0(r)));const i=d(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=d(t,["video"]);s!=null&&h(e,["video"],Td(g0(s)));const o=d(t,["text"]);o!=null&&h(e,["text"],o);const a=d(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=d(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function rb(t){const e={},n=d(t,["media"]);if(n!=null){let u=m0(n);Array.isArray(u)&&(u=u.map(f=>f)),h(e,["mediaChunks"],u)}const r=d(t,["audio"]);r!=null&&h(e,["audio"],_0(r));const i=d(t,["audioStreamEnd"]);i!=null&&h(e,["audioStreamEnd"],i);const s=d(t,["video"]);s!=null&&h(e,["video"],g0(s));const o=d(t,["text"]);o!=null&&h(e,["text"],o);const a=d(t,["activityStart"]);a!=null&&h(e,["activityStart"],a);const l=d(t,["activityEnd"]);return l!=null&&h(e,["activityEnd"],l),e}function ib(t){const e={},n=d(t,["setupComplete"]);n!=null&&h(e,["setupComplete"],n);const r=d(t,["serverContent"]);r!=null&&h(e,["serverContent"],r);const i=d(t,["toolCall"]);i!=null&&h(e,["toolCall"],i);const s=d(t,["toolCallCancellation"]);s!=null&&h(e,["toolCallCancellation"],s);const o=d(t,["usageMetadata"]);o!=null&&h(e,["usageMetadata"],ub(o));const a=d(t,["goAway"]);a!=null&&h(e,["goAway"],a);const l=d(t,["sessionResumptionUpdate"]);return l!=null&&h(e,["sessionResumptionUpdate"],l),e}function sb(t){const e={},n=d(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&h(e,["fileData"],jN(s));const o=d(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&h(e,["inlineData"],Td(a));const l=d(t,["text"]);l!=null&&h(e,["text"],l);const u=d(t,["thought"]);u!=null&&h(e,["thought"],u);const f=d(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=d(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function ob(t){const e={},n=d(t,["handle"]);if(n!=null&&h(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function R0(t){const e={},n=d(t,["languageCode"]);n!=null&&h(e,["languageCode"],n);const r=d(t,["voiceConfig"]);if(r!=null&&h(e,["voiceConfig"],r),d(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function ab(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],KN(i));const s=d(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],JN(a));const l=d(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}function lb(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(_=>HN(_))),h(e,["functionDeclarations"],m)}const r=d(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&h(e,["googleSearchRetrieval"],i);const s=d(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],s);const o=d(t,["computerUse"]);o!=null&&h(e,["computerUse"],o);const a=d(t,["codeExecution"]);a!=null&&h(e,["codeExecution"],a);const l=d(t,["enterpriseWebSearch"]);l!=null&&h(e,["enterpriseWebSearch"],l);const u=d(t,["googleSearch"]);u!=null&&h(e,["googleSearch"],u);const f=d(t,["urlContext"]);return f!=null&&h(e,["urlContext"],f),e}function ub(t){const e={},n=d(t,["promptTokenCount"]);n!=null&&h(e,["promptTokenCount"],n);const r=d(t,["cachedContentTokenCount"]);r!=null&&h(e,["cachedContentTokenCount"],r);const i=d(t,["candidatesTokenCount"]);i!=null&&h(e,["responseTokenCount"],i);const s=d(t,["toolUsePromptTokenCount"]);s!=null&&h(e,["toolUsePromptTokenCount"],s);const o=d(t,["thoughtsTokenCount"]);o!=null&&h(e,["thoughtsTokenCount"],o);const a=d(t,["totalTokenCount"]);a!=null&&h(e,["totalTokenCount"],a);const l=d(t,["promptTokensDetails"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["promptTokensDetails"],v)}const u=d(t,["cacheTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["cacheTokensDetails"],v)}const f=d(t,["candidatesTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["responseTokensDetails"],v)}const m=d(t,["toolUsePromptTokensDetails"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(E=>E)),h(e,["toolUsePromptTokensDetails"],v)}const _=d(t,["trafficType"]);return _!=null&&h(e,["trafficType"],_),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cb(t){const e={},n=d(t,["data"]);if(n!=null&&h(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function db(t){const e={},n=d(t,["content"]);n!=null&&h(e,["content"],n);const r=d(t,["citationMetadata"]);r!=null&&h(e,["citationMetadata"],hb(r));const i=d(t,["tokenCount"]);i!=null&&h(e,["tokenCount"],i);const s=d(t,["finishReason"]);s!=null&&h(e,["finishReason"],s);const o=d(t,["avgLogprobs"]);o!=null&&h(e,["avgLogprobs"],o);const a=d(t,["groundingMetadata"]);a!=null&&h(e,["groundingMetadata"],a);const l=d(t,["index"]);l!=null&&h(e,["index"],l);const u=d(t,["logprobsResult"]);u!=null&&h(e,["logprobsResult"],u);const f=d(t,["safetyRatings"]);if(f!=null){let _=f;Array.isArray(_)&&(_=_.map(v=>v)),h(e,["safetyRatings"],_)}const m=d(t,["urlContextMetadata"]);return m!=null&&h(e,["urlContextMetadata"],m),e}function hb(t){const e={},n=d(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),h(e,["citations"],r)}return e}function fb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["contents"]);if(i!=null){let s=Wn(i);Array.isArray(s)&&(s=s.map(o=>o)),h(n,["contents"],s)}return n}function pb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["tokensInfo"],i)}return e}function mb(t){const e={},n=d(t,["values"]);n!=null&&h(e,["values"],n);const r=d(t,["statistics"]);return r!=null&&h(e,["statistics"],gb(r)),e}function gb(t){const e={},n=d(t,["truncated"]);n!=null&&h(e,["truncated"],n);const r=d(t,["token_count"]);return r!=null&&h(e,["tokenCount"],r),e}function Xh(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ED(s))),h(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&h(e,["role"],r),e}function _b(t){const e={},n=d(t,["controlType"]);n!=null&&h(e,["controlType"],n);const r=d(t,["enableControlImageComputation"]);return r!=null&&h(e,["computeControl"],r),e}function yb(t){const e={};if(d(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function vb(t,e){const n={},r=d(t,["systemInstruction"]);e!==void 0&&r!=null&&h(e,["systemInstruction"],tn(r));const i=d(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>D0(a))),h(e,["tools"],o)}const s=d(t,["generationConfig"]);return e!==void 0&&s!=null&&h(e,["generationConfig"],lD(s)),n}function Tb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["contents"]);if(i!=null){let o=Wn(i);Array.isArray(o)&&(o=o.map(a=>Xh(a))),h(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&yb(s),n}function Eb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["contents"]);if(i!=null){let o=Wn(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&vb(s,n),n}function wb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["totalTokens"]);r!=null&&h(e,["totalTokens"],r);const i=d(t,["cachedContentTokenCount"]);return i!=null&&h(e,["cachedContentTokenCount"],i),e}function Ib(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["totalTokens"]);return r!=null&&h(e,["totalTokens"],r),e}function Sb(t,e){const n={},r=d(e,["model"]);return r!=null&&h(n,["_url","name"],Ue(t,r)),n}function xb(t,e){const n={},r=d(e,["model"]);return r!=null&&h(n,["_url","name"],Ue(t,r)),n}function Cb(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function Ab(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&h(e,["sdkHttpResponse"],n),e}function Rb(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=d(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=d(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=d(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=d(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=d(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=d(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=d(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=d(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&h(e,["parameters","includeSafetyAttributes"],m);const _=d(t,["includeRaiReason"]);e!==void 0&&_!=null&&h(e,["parameters","includeRaiReason"],_);const v=d(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const E=d(t,["outputMimeType"]);e!==void 0&&E!=null&&h(e,["parameters","outputOptions","mimeType"],E);const P=d(t,["outputCompressionQuality"]);e!==void 0&&P!=null&&h(e,["parameters","outputOptions","compressionQuality"],P);const M=d(t,["addWatermark"]);e!==void 0&&M!=null&&h(e,["parameters","addWatermark"],M);const C=d(t,["labels"]);e!==void 0&&C!=null&&h(e,["labels"],C);const w=d(t,["editMode"]);e!==void 0&&w!=null&&h(e,["parameters","editMode"],w);const A=d(t,["baseSteps"]);return e!==void 0&&A!=null&&h(e,["parameters","editConfig","baseSteps"],A),n}function Pb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=d(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>AD(l))),h(n,["instances[0]","referenceImages"],a)}const o=d(e,["config"]);return o!=null&&Rb(o,n),n}function kb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Zh(s))),h(e,["generatedImages"],i)}return e}function Nb(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&h(e,["requests[]","taskType"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&h(e,["requests[]","title"],i);const s=d(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&h(e,["requests[]","outputDimensionality"],s),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function bb(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&h(e,["instances[]","task_type"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&h(e,["instances[]","title"],i);const s=d(t,["outputDimensionality"]);e!==void 0&&s!=null&&h(e,["parameters","outputDimensionality"],s);const o=d(t,["mimeType"]);e!==void 0&&o!=null&&h(e,["instances[]","mimeType"],o);const a=d(t,["autoTruncate"]);return e!==void 0&&a!=null&&h(e,["parameters","autoTruncate"],a),n}function Db(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["contents"]);if(i!=null){let a=p_(t,i);Array.isArray(a)&&(a=a.map(l=>l)),h(n,["requests[]","content"],a)}const s=d(e,["config"]);s!=null&&Nb(s,n);const o=d(e,["model"]);return o!==void 0&&h(n,["requests[]","model"],Ue(t,o)),n}function Mb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["contents"]);if(i!=null){let o=p_(t,i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["instances[]","content"],o)}const s=d(e,["config"]);return s!=null&&bb(s,n),n}function Vb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),h(e,["embeddings"],s)}const i=d(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function Lb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>mb(o))),h(e,["embeddings"],s)}const i=d(t,["metadata"]);return i!=null&&h(e,["metadata"],i),e}function Fb(t){const e={},n=d(t,["endpoint"]);n!=null&&h(e,["name"],n);const r=d(t,["deployedModelId"]);return r!=null&&h(e,["deployedModelId"],r),e}function Ub(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function Ob(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&h(e,["description"],n);const r=d(t,["name"]);r!=null&&h(e,["name"],r);const i=d(t,["parameters"]);i!=null&&h(e,["parameters"],i);const s=d(t,["parametersJsonSchema"]);s!=null&&h(e,["parametersJsonSchema"],s);const o=d(t,["response"]);o!=null&&h(e,["response"],o);const a=d(t,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function Bb(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],Xh(tn(i)));const s=d(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=d(e,["topP"]);o!=null&&h(r,["topP"],o);const a=d(e,["topK"]);a!=null&&h(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=d(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=d(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const _=d(e,["logprobs"]);_!=null&&h(r,["logprobs"],_);const v=d(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const E=d(e,["frequencyPenalty"]);E!=null&&h(r,["frequencyPenalty"],E);const P=d(e,["seed"]);P!=null&&h(r,["seed"],P);const M=d(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const C=d(e,["responseSchema"]);C!=null&&h(r,["responseSchema"],m_(C));const w=d(e,["responseJsonSchema"]);if(w!=null&&h(r,["responseJsonSchema"],w),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=d(e,["safetySettings"]);if(n!==void 0&&A!=null){let F=A;Array.isArray(F)&&(F=F.map(b=>RD(b))),h(n,["safetySettings"],F)}const V=d(e,["tools"]);if(n!==void 0&&V!=null){let F=Xa(V);Array.isArray(F)&&(F=F.map(b=>MD(Ya(b)))),h(n,["tools"],F)}const q=d(e,["toolConfig"]);if(n!==void 0&&q!=null&&h(n,["toolConfig"],q),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=d(e,["cachedContent"]);n!==void 0&&z!=null&&h(n,["cachedContent"],ui(t,z));const S=d(e,["responseModalities"]);S!=null&&h(r,["responseModalities"],S);const x=d(e,["mediaResolution"]);x!=null&&h(r,["mediaResolution"],x);const R=d(e,["speechConfig"]);if(R!=null&&h(r,["speechConfig"],g_(R)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);N!=null&&h(r,["thinkingConfig"],N);const D=d(e,["imageConfig"]);return D!=null&&h(r,["imageConfig"],D),r}function Gb(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&h(n,["systemInstruction"],tn(i));const s=d(e,["temperature"]);s!=null&&h(r,["temperature"],s);const o=d(e,["topP"]);o!=null&&h(r,["topP"],o);const a=d(e,["topK"]);a!=null&&h(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&h(r,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&h(r,["maxOutputTokens"],u);const f=d(e,["stopSequences"]);f!=null&&h(r,["stopSequences"],f);const m=d(e,["responseLogprobs"]);m!=null&&h(r,["responseLogprobs"],m);const _=d(e,["logprobs"]);_!=null&&h(r,["logprobs"],_);const v=d(e,["presencePenalty"]);v!=null&&h(r,["presencePenalty"],v);const E=d(e,["frequencyPenalty"]);E!=null&&h(r,["frequencyPenalty"],E);const P=d(e,["seed"]);P!=null&&h(r,["seed"],P);const M=d(e,["responseMimeType"]);M!=null&&h(r,["responseMimeType"],M);const C=d(e,["responseSchema"]);C!=null&&h(r,["responseSchema"],m_(C));const w=d(e,["responseJsonSchema"]);w!=null&&h(r,["responseJsonSchema"],w);const A=d(e,["routingConfig"]);A!=null&&h(r,["routingConfig"],A);const V=d(e,["modelSelectionConfig"]);V!=null&&h(r,["modelConfig"],V);const q=d(e,["safetySettings"]);if(n!==void 0&&q!=null){let Fe=q;Array.isArray(Fe)&&(Fe=Fe.map(Te=>Te)),h(n,["safetySettings"],Fe)}const z=d(e,["tools"]);if(n!==void 0&&z!=null){let Fe=Xa(z);Array.isArray(Fe)&&(Fe=Fe.map(Te=>D0(Ya(Te)))),h(n,["tools"],Fe)}const S=d(e,["toolConfig"]);n!==void 0&&S!=null&&h(n,["toolConfig"],S);const x=d(e,["labels"]);n!==void 0&&x!=null&&h(n,["labels"],x);const R=d(e,["cachedContent"]);n!==void 0&&R!=null&&h(n,["cachedContent"],ui(t,R));const N=d(e,["responseModalities"]);N!=null&&h(r,["responseModalities"],N);const D=d(e,["mediaResolution"]);D!=null&&h(r,["mediaResolution"],D);const F=d(e,["speechConfig"]);F!=null&&h(r,["speechConfig"],b0(g_(F)));const b=d(e,["audioTimestamp"]);b!=null&&h(r,["audioTimestamp"],b);const Se=d(e,["thinkingConfig"]);Se!=null&&h(r,["thinkingConfig"],Se);const Qe=d(e,["imageConfig"]);return Qe!=null&&h(r,["imageConfig"],Qe),r}function qT(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["contents"]);if(i!=null){let o=Wn(i);Array.isArray(o)&&(o=o.map(a=>Xh(a))),h(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&h(n,["generationConfig"],Bb(t,s,n)),n}function zT(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["contents"]);if(i!=null){let o=Wn(i);Array.isArray(o)&&(o=o.map(a=>a)),h(n,["contents"],o)}const s=d(e,["config"]);return s!=null&&h(n,["generationConfig"],Gb(t,s,n)),n}function $T(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>db(u))),h(e,["candidates"],l)}const i=d(t,["modelVersion"]);i!=null&&h(e,["modelVersion"],i);const s=d(t,["promptFeedback"]);s!=null&&h(e,["promptFeedback"],s);const o=d(t,["responseId"]);o!=null&&h(e,["responseId"],o);const a=d(t,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function jT(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["candidates"],u)}const i=d(t,["createTime"]);i!=null&&h(e,["createTime"],i);const s=d(t,["modelVersion"]);s!=null&&h(e,["modelVersion"],s);const o=d(t,["promptFeedback"]);o!=null&&h(e,["promptFeedback"],o);const a=d(t,["responseId"]);a!=null&&h(e,["responseId"],a);const l=d(t,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function qb(t,e){const n={};if(d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=d(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=d(t,["aspectRatio"]);e!==void 0&&i!=null&&h(e,["parameters","aspectRatio"],i);const s=d(t,["guidanceScale"]);if(e!==void 0&&s!=null&&h(e,["parameters","guidanceScale"],s),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=d(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&h(e,["parameters","safetySetting"],o);const a=d(t,["personGeneration"]);e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a);const l=d(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&h(e,["parameters","includeSafetyAttributes"],l);const u=d(t,["includeRaiReason"]);e!==void 0&&u!=null&&h(e,["parameters","includeRaiReason"],u);const f=d(t,["language"]);e!==void 0&&f!=null&&h(e,["parameters","language"],f);const m=d(t,["outputMimeType"]);e!==void 0&&m!=null&&h(e,["parameters","outputOptions","mimeType"],m);const _=d(t,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&h(e,["parameters","outputOptions","compressionQuality"],_),d(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=d(t,["imageSize"]);if(e!==void 0&&v!=null&&h(e,["parameters","sampleImageSize"],v),d(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function zb(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=d(t,["negativePrompt"]);e!==void 0&&i!=null&&h(e,["parameters","negativePrompt"],i);const s=d(t,["numberOfImages"]);e!==void 0&&s!=null&&h(e,["parameters","sampleCount"],s);const o=d(t,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=d(t,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=d(t,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const u=d(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&h(e,["parameters","safetySetting"],u);const f=d(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=d(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&h(e,["parameters","includeSafetyAttributes"],m);const _=d(t,["includeRaiReason"]);e!==void 0&&_!=null&&h(e,["parameters","includeRaiReason"],_);const v=d(t,["language"]);e!==void 0&&v!=null&&h(e,["parameters","language"],v);const E=d(t,["outputMimeType"]);e!==void 0&&E!=null&&h(e,["parameters","outputOptions","mimeType"],E);const P=d(t,["outputCompressionQuality"]);e!==void 0&&P!=null&&h(e,["parameters","outputOptions","compressionQuality"],P);const M=d(t,["addWatermark"]);e!==void 0&&M!=null&&h(e,["parameters","addWatermark"],M);const C=d(t,["labels"]);e!==void 0&&C!=null&&h(e,["labels"],C);const w=d(t,["imageSize"]);e!==void 0&&w!=null&&h(e,["parameters","sampleImageSize"],w);const A=d(t,["enhancePrompt"]);return e!==void 0&&A!=null&&h(e,["parameters","enhancePrompt"],A),n}function $b(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=d(e,["config"]);return s!=null&&qb(s,n),n}function jb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=d(e,["config"]);return s!=null&&zb(s,n),n}function Hb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>iD(o))),h(e,["generatedImages"],s)}const i=d(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],k0(i)),e}function Wb(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Zh(o))),h(e,["generatedImages"],s)}const i=d(t,["positivePromptSafetyAttributes"]);return i!=null&&h(e,["positivePromptSafetyAttributes"],N0(i)),e}function Kb(t,e){const n={},r=d(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r),d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=d(t,["durationSeconds"]);if(e!==void 0&&i!=null&&h(e,["parameters","durationSeconds"],i),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=d(t,["aspectRatio"]);e!==void 0&&s!=null&&h(e,["parameters","aspectRatio"],s);const o=d(t,["resolution"]);e!==void 0&&o!=null&&h(e,["parameters","resolution"],o);const a=d(t,["personGeneration"]);if(e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a),d(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=d(t,["negativePrompt"]);e!==void 0&&l!=null&&h(e,["parameters","negativePrompt"],l);const u=d(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&h(e,["parameters","enhancePrompt"],u),d(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=d(t,["lastFrame"]);e!==void 0&&f!=null&&h(e,["instances[0]","lastFrame"],ef(f));const m=d(t,["referenceImages"]);if(e!==void 0&&m!=null){let _=m;Array.isArray(_)&&(_=_.map(v=>WD(v))),h(e,["instances[0]","referenceImages"],_)}if(d(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function Jb(t,e){const n={},r=d(t,["numberOfVideos"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=d(t,["outputGcsUri"]);e!==void 0&&i!=null&&h(e,["parameters","storageUri"],i);const s=d(t,["fps"]);e!==void 0&&s!=null&&h(e,["parameters","fps"],s);const o=d(t,["durationSeconds"]);e!==void 0&&o!=null&&h(e,["parameters","durationSeconds"],o);const a=d(t,["seed"]);e!==void 0&&a!=null&&h(e,["parameters","seed"],a);const l=d(t,["aspectRatio"]);e!==void 0&&l!=null&&h(e,["parameters","aspectRatio"],l);const u=d(t,["resolution"]);e!==void 0&&u!=null&&h(e,["parameters","resolution"],u);const f=d(t,["personGeneration"]);e!==void 0&&f!=null&&h(e,["parameters","personGeneration"],f);const m=d(t,["pubsubTopic"]);e!==void 0&&m!=null&&h(e,["parameters","pubsubTopic"],m);const _=d(t,["negativePrompt"]);e!==void 0&&_!=null&&h(e,["parameters","negativePrompt"],_);const v=d(t,["enhancePrompt"]);e!==void 0&&v!=null&&h(e,["parameters","enhancePrompt"],v);const E=d(t,["generateAudio"]);e!==void 0&&E!=null&&h(e,["parameters","generateAudio"],E);const P=d(t,["lastFrame"]);e!==void 0&&P!=null&&h(e,["instances[0]","lastFrame"],_r(P));const M=d(t,["referenceImages"]);if(e!==void 0&&M!=null){let A=M;Array.isArray(A)&&(A=A.map(V=>KD(V))),h(e,["instances[0]","referenceImages"],A)}const C=d(t,["mask"]);e!==void 0&&C!=null&&h(e,["instances[0]","mask"],HD(C));const w=d(t,["compressionQuality"]);return e!==void 0&&w!=null&&h(e,["parameters","compressionQuality"],w),n}function Qb(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);s!=null&&h(e,["error"],s);const o=d(t,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],eD(o)),e}function Yb(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["metadata"]);r!=null&&h(e,["metadata"],r);const i=d(t,["done"]);i!=null&&h(e,["done"],i);const s=d(t,["error"]);s!=null&&h(e,["error"],s);const o=d(t,["response"]);return o!=null&&h(e,["response"],tD(o)),e}function Xb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=d(e,["image"]);s!=null&&h(n,["instances[0]","image"],ef(s));const o=d(e,["video"]);o!=null&&h(n,["instances[0]","video"],M0(o));const a=d(e,["source"]);a!=null&&nD(a,n);const l=d(e,["config"]);return l!=null&&Kb(l,n),n}function Zb(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["prompt"]);i!=null&&h(n,["instances[0]","prompt"],i);const s=d(e,["image"]);s!=null&&h(n,["instances[0]","image"],_r(s));const o=d(e,["video"]);o!=null&&h(n,["instances[0]","video"],V0(o));const a=d(e,["source"]);a!=null&&rD(a,n);const l=d(e,["config"]);return l!=null&&Jb(l,n),n}function eD(t){const e={},n=d(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>oD(o))),h(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function tD(t){const e={},n=d(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>aD(o))),h(e,["generatedVideos"],s)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&h(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&h(e,["raiMediaFilteredReasons"],i),e}function nD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],ef(i));const s=d(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],M0(s)),n}function rD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],_r(i));const s=d(t,["video"]);return e!==void 0&&s!=null&&h(e,["instances[0]","video"],V0(s)),n}function iD(t){const e={},n=d(t,["_self"]);n!=null&&h(e,["image"],fD(n));const r=d(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=d(t,["_self"]);return i!=null&&h(e,["safetyAttributes"],k0(i)),e}function Zh(t){const e={},n=d(t,["_self"]);n!=null&&h(e,["image"],P0(n));const r=d(t,["raiFilteredReason"]);r!=null&&h(e,["raiFilteredReason"],r);const i=d(t,["_self"]);i!=null&&h(e,["safetyAttributes"],N0(i));const s=d(t,["prompt"]);return s!=null&&h(e,["enhancedPrompt"],s),e}function sD(t){const e={},n=d(t,["_self"]);n!=null&&h(e,["mask"],P0(n));const r=d(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(e,["labels"],i)}return e}function oD(t){const e={},n=d(t,["video"]);return n!=null&&h(e,["video"],$D(n)),e}function aD(t){const e={},n=d(t,["_self"]);return n!=null&&h(e,["video"],jD(n)),e}function lD(t){const e={},n=d(t,["modelSelectionConfig"]);n!=null&&h(e,["modelConfig"],n);const r=d(t,["audioTimestamp"]);r!=null&&h(e,["audioTimestamp"],r);const i=d(t,["candidateCount"]);i!=null&&h(e,["candidateCount"],i);const s=d(t,["enableAffectiveDialog"]);s!=null&&h(e,["enableAffectiveDialog"],s);const o=d(t,["frequencyPenalty"]);o!=null&&h(e,["frequencyPenalty"],o);const a=d(t,["logprobs"]);a!=null&&h(e,["logprobs"],a);const l=d(t,["maxOutputTokens"]);l!=null&&h(e,["maxOutputTokens"],l);const u=d(t,["mediaResolution"]);u!=null&&h(e,["mediaResolution"],u);const f=d(t,["presencePenalty"]);f!=null&&h(e,["presencePenalty"],f);const m=d(t,["responseJsonSchema"]);m!=null&&h(e,["responseJsonSchema"],m);const _=d(t,["responseLogprobs"]);_!=null&&h(e,["responseLogprobs"],_);const v=d(t,["responseMimeType"]);v!=null&&h(e,["responseMimeType"],v);const E=d(t,["responseModalities"]);E!=null&&h(e,["responseModalities"],E);const P=d(t,["responseSchema"]);P!=null&&h(e,["responseSchema"],P);const M=d(t,["routingConfig"]);M!=null&&h(e,["routingConfig"],M);const C=d(t,["seed"]);C!=null&&h(e,["seed"],C);const w=d(t,["speechConfig"]);w!=null&&h(e,["speechConfig"],b0(w));const A=d(t,["stopSequences"]);A!=null&&h(e,["stopSequences"],A);const V=d(t,["temperature"]);V!=null&&h(e,["temperature"],V);const q=d(t,["thinkingConfig"]);q!=null&&h(e,["thinkingConfig"],q);const z=d(t,["topK"]);z!=null&&h(e,["topK"],z);const S=d(t,["topP"]);if(S!=null&&h(e,["topP"],S),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function uD(t,e){const n={},r=d(e,["model"]);return r!=null&&h(n,["_url","name"],Ue(t,r)),n}function cD(t,e){const n={},r=d(e,["model"]);return r!=null&&h(n,["_url","name"],Ue(t,r)),n}function dD(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function hD(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function fD(t){const e={},n=d(t,["bytesBase64Encoded"]);n!=null&&h(e,["imageBytes"],gs(n));const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function P0(t){const e={},n=d(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&h(e,["imageBytes"],gs(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function ef(t){const e={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=d(t,["imageBytes"]);n!=null&&h(e,["bytesBase64Encoded"],gs(n));const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function _r(t){const e={},n=d(t,["gcsUri"]);n!=null&&h(e,["gcsUri"],n);const r=d(t,["imageBytes"]);r!=null&&h(e,["bytesBase64Encoded"],gs(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function pD(t,e,n){const r={},i=d(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=d(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=d(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=d(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],E0(t,a)),r}function mD(t,e,n){const r={},i=d(e,["pageSize"]);n!==void 0&&i!=null&&h(n,["_query","pageSize"],i);const s=d(e,["pageToken"]);n!==void 0&&s!=null&&h(n,["_query","pageToken"],s);const o=d(e,["filter"]);n!==void 0&&o!=null&&h(n,["_query","filter"],o);const a=d(e,["queryBase"]);return n!==void 0&&a!=null&&h(n,["_url","models_url"],E0(t,a)),r}function gD(t,e){const n={},r=d(e,["config"]);return r!=null&&pD(t,r,n),n}function _D(t,e){const n={},r=d(e,["config"]);return r!=null&&mD(t,r,n),n}function yD(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["_self"]);if(i!=null){let s=w0(i);Array.isArray(s)&&(s=s.map(o=>km(o))),h(e,["models"],s)}return e}function vD(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&h(e,["nextPageToken"],r);const i=d(t,["_self"]);if(i!=null){let s=w0(i);Array.isArray(s)&&(s=s.map(o=>Nm(o))),h(e,["models"],s)}return e}function TD(t){const e={},n=d(t,["maskMode"]);n!=null&&h(e,["maskMode"],n);const r=d(t,["segmentationClasses"]);r!=null&&h(e,["maskClasses"],r);const i=d(t,["maskDilation"]);return i!=null&&h(e,["dilation"],i),e}function km(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=d(t,["description"]);i!=null&&h(e,["description"],i);const s=d(t,["version"]);s!=null&&h(e,["version"],s);const o=d(t,["_self"]);o!=null&&h(e,["tunedModelInfo"],VD(o));const a=d(t,["inputTokenLimit"]);a!=null&&h(e,["inputTokenLimit"],a);const l=d(t,["outputTokenLimit"]);l!=null&&h(e,["outputTokenLimit"],l);const u=d(t,["supportedGenerationMethods"]);return u!=null&&h(e,["supportedActions"],u),e}function Nm(t){const e={},n=d(t,["name"]);n!=null&&h(e,["name"],n);const r=d(t,["displayName"]);r!=null&&h(e,["displayName"],r);const i=d(t,["description"]);i!=null&&h(e,["description"],i);const s=d(t,["versionId"]);s!=null&&h(e,["version"],s);const o=d(t,["deployedModels"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(_=>Fb(_))),h(e,["endpoints"],m)}const a=d(t,["labels"]);a!=null&&h(e,["labels"],a);const l=d(t,["_self"]);l!=null&&h(e,["tunedModelInfo"],LD(l));const u=d(t,["defaultCheckpointId"]);u!=null&&h(e,["defaultCheckpointId"],u);const f=d(t,["checkpoints"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(_=>_)),h(e,["checkpoints"],m)}return e}function ED(t){const e={},n=d(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&h(e,["fileData"],Ub(s));const o=d(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&h(e,["inlineData"],cb(a));const l=d(t,["text"]);l!=null&&h(e,["text"],l);const u=d(t,["thought"]);u!=null&&h(e,["thought"],u);const f=d(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=d(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function wD(t){const e={},n=d(t,["productImage"]);return n!=null&&h(e,["image"],_r(n)),e}function ID(t,e){const n={},r=d(t,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const i=d(t,["baseSteps"]);e!==void 0&&i!=null&&h(e,["parameters","editConfig","baseSteps"],i);const s=d(t,["outputGcsUri"]);e!==void 0&&s!=null&&h(e,["parameters","storageUri"],s);const o=d(t,["seed"]);e!==void 0&&o!=null&&h(e,["parameters","seed"],o);const a=d(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&h(e,["parameters","safetySetting"],a);const l=d(t,["personGeneration"]);e!==void 0&&l!=null&&h(e,["parameters","personGeneration"],l);const u=d(t,["addWatermark"]);e!==void 0&&u!=null&&h(e,["parameters","addWatermark"],u);const f=d(t,["outputMimeType"]);e!==void 0&&f!=null&&h(e,["parameters","outputOptions","mimeType"],f);const m=d(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&h(e,["parameters","outputOptions","compressionQuality"],m);const _=d(t,["enhancePrompt"]);e!==void 0&&_!=null&&h(e,["parameters","enhancePrompt"],_);const v=d(t,["labels"]);return e!==void 0&&v!=null&&h(e,["labels"],v),n}function SD(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["source"]);i!=null&&CD(i,n);const s=d(e,["config"]);return s!=null&&ID(s,n),n}function xD(t){const e={},n=d(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Zh(i))),h(e,["generatedImages"],r)}return e}function CD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=d(t,["personImage"]);e!==void 0&&i!=null&&h(e,["instances[0]","personImage","image"],_r(i));const s=d(t,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>wD(a))),h(e,["instances[0]","productImages"],o)}return n}function AD(t){const e={},n=d(t,["referenceImage"]);n!=null&&h(e,["referenceImage"],_r(n));const r=d(t,["referenceId"]);r!=null&&h(e,["referenceId"],r);const i=d(t,["referenceType"]);i!=null&&h(e,["referenceType"],i);const s=d(t,["maskImageConfig"]);s!=null&&h(e,["maskImageConfig"],TD(s));const o=d(t,["controlImageConfig"]);o!=null&&h(e,["controlImageConfig"],_b(o));const a=d(t,["styleImageConfig"]);a!=null&&h(e,["styleImageConfig"],a);const l=d(t,["subjectImageConfig"]);return l!=null&&h(e,["subjectImageConfig"],l),e}function k0(t){const e={},n=d(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=d(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=d(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function N0(t){const e={},n=d(t,["safetyAttributes","categories"]);n!=null&&h(e,["categories"],n);const r=d(t,["safetyAttributes","scores"]);r!=null&&h(e,["scores"],r);const i=d(t,["contentType"]);return i!=null&&h(e,["contentType"],i),e}function RD(t){const e={},n=d(t,["category"]);if(n!=null&&h(e,["category"],n),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(t,["threshold"]);return r!=null&&h(e,["threshold"],r),e}function PD(t){const e={},n=d(t,["image"]);return n!=null&&h(e,["image"],_r(n)),e}function kD(t,e){const n={},r=d(t,["mode"]);e!==void 0&&r!=null&&h(e,["parameters","mode"],r);const i=d(t,["maxPredictions"]);e!==void 0&&i!=null&&h(e,["parameters","maxPredictions"],i);const s=d(t,["confidenceThreshold"]);e!==void 0&&s!=null&&h(e,["parameters","confidenceThreshold"],s);const o=d(t,["maskDilation"]);e!==void 0&&o!=null&&h(e,["parameters","maskDilation"],o);const a=d(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&h(e,["parameters","binaryColorThreshold"],a);const l=d(t,["labels"]);return e!==void 0&&l!=null&&h(e,["labels"],l),n}function ND(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["source"]);i!=null&&DD(i,n);const s=d(e,["config"]);return s!=null&&kD(s,n),n}function bD(t){const e={},n=d(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>sD(i))),h(e,["generatedMasks"],r)}return e}function DD(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&h(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&h(e,["instances[0]","image"],_r(i));const s=d(t,["scribbleImage"]);return e!==void 0&&s!=null&&h(e,["instances[0]","scribble"],PD(s)),n}function b0(t){const e={},n=d(t,["languageCode"]);n!=null&&h(e,["languageCode"],n);const r=d(t,["voiceConfig"]);if(r!=null&&h(e,["voiceConfig"],r),d(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function MD(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],dD(i));const s=d(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],hD(a));const l=d(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}function D0(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(_=>Ob(_))),h(e,["functionDeclarations"],m)}const r=d(t,["retrieval"]);r!=null&&h(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&h(e,["googleSearchRetrieval"],i);const s=d(t,["googleMaps"]);s!=null&&h(e,["googleMaps"],s);const o=d(t,["computerUse"]);o!=null&&h(e,["computerUse"],o);const a=d(t,["codeExecution"]);a!=null&&h(e,["codeExecution"],a);const l=d(t,["enterpriseWebSearch"]);l!=null&&h(e,["enterpriseWebSearch"],l);const u=d(t,["googleSearch"]);u!=null&&h(e,["googleSearch"],u);const f=d(t,["urlContext"]);return f!=null&&h(e,["urlContext"],f),e}function VD(t){const e={},n=d(t,["baseModel"]);n!=null&&h(e,["baseModel"],n);const r=d(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=d(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function LD(t){const e={},n=d(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&h(e,["baseModel"],n);const r=d(t,["createTime"]);r!=null&&h(e,["createTime"],r);const i=d(t,["updateTime"]);return i!=null&&h(e,["updateTime"],i),e}function FD(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=d(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=d(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function UD(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const i=d(t,["description"]);e!==void 0&&i!=null&&h(e,["description"],i);const s=d(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&h(e,["defaultCheckpointId"],s),n}function OD(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","name"],Ue(t,r));const i=d(e,["config"]);return i!=null&&FD(i,n),n}function BD(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["config"]);return i!=null&&UD(i,n),n}function GD(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const i=d(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&h(e,["parameters","safetySetting"],i);const s=d(t,["personGeneration"]);e!==void 0&&s!=null&&h(e,["parameters","personGeneration"],s);const o=d(t,["includeRaiReason"]);e!==void 0&&o!=null&&h(e,["parameters","includeRaiReason"],o);const a=d(t,["outputMimeType"]);e!==void 0&&a!=null&&h(e,["parameters","outputOptions","mimeType"],a);const l=d(t,["outputCompressionQuality"]);e!==void 0&&l!=null&&h(e,["parameters","outputOptions","compressionQuality"],l);const u=d(t,["enhanceInputImage"]);e!==void 0&&u!=null&&h(e,["parameters","upscaleConfig","enhanceInputImage"],u);const f=d(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&h(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const m=d(t,["labels"]);e!==void 0&&m!=null&&h(e,["labels"],m);const _=d(t,["numberOfImages"]);e!==void 0&&_!=null&&h(e,["parameters","sampleCount"],_);const v=d(t,["mode"]);return e!==void 0&&v!=null&&h(e,["parameters","mode"],v),n}function qD(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["_url","model"],Ue(t,r));const i=d(e,["image"]);i!=null&&h(n,["instances[0]","image"],_r(i));const s=d(e,["upscaleFactor"]);s!=null&&h(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=d(e,["config"]);return o!=null&&GD(o,n),n}function zD(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&h(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Zh(s))),h(e,["generatedImages"],i)}return e}function $D(t){const e={},n=d(t,["uri"]);n!=null&&h(e,["uri"],n);const r=d(t,["encodedVideo"]);r!=null&&h(e,["videoBytes"],gs(r));const i=d(t,["encoding"]);return i!=null&&h(e,["mimeType"],i),e}function jD(t){const e={},n=d(t,["gcsUri"]);n!=null&&h(e,["uri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&h(e,["videoBytes"],gs(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function HD(t){const e={},n=d(t,["image"]);n!=null&&h(e,["_self"],_r(n));const r=d(t,["maskMode"]);return r!=null&&h(e,["maskMode"],r),e}function WD(t){const e={},n=d(t,["image"]);n!=null&&h(e,["image"],ef(n));const r=d(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function KD(t){const e={},n=d(t,["image"]);n!=null&&h(e,["image"],_r(n));const r=d(t,["referenceType"]);return r!=null&&h(e,["referenceType"],r),e}function M0(t){const e={},n=d(t,["uri"]);n!=null&&h(e,["uri"],n);const r=d(t,["videoBytes"]);r!=null&&h(e,["encodedVideo"],gs(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["encoding"],i),e}function V0(t){const e={},n=d(t,["uri"]);n!=null&&h(e,["gcsUri"],n);const r=d(t,["videoBytes"]);r!=null&&h(e,["bytesBase64Encoded"],gs(r));const i=d(t,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const JD="Content-Type",QD="X-Server-Timeout",YD="User-Agent",bm="x-goog-api-client",XD="1.28.0",ZD=`google-genai-sdk/${XD}`,eM="v1beta1",tM="v1beta",HT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class nM{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:eM,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:tM,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,i){if(n&&n.timeout||i){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=o}return n&&n.extraBody!==null&&rM(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await WT(i),new Am(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await WT(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return ya(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield nt(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const m=JSON.parse(u);if("error"in m){const _=JSON.parse(JSON.stringify(m.error)),v=_.status,E=_.code,P=`got status: ${v}. ${JSON.stringify(m)}`;if(E>=400&&E<600)throw new Yh({message:P,status:E})}}catch(m){if(m.name==="ApiError")throw m}o+=u;let f=o.match(HT);for(;f;){const m=f[1];try{const _=new Response(m,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield nt(new Am(_)),o=o.slice(f[0].length),f=o.match(HT)}catch(_){throw new Error(`exception parsing stream chunk ${m}. ${_}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=ZD+" "+this.clientOptions.userAgentExtra;return e[YD]=n,e[bm]=n,e[JD]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))r.append(i,s);e.timeout&&e.timeout>0&&r.append(QD,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}async uploadFile(e,n){var r,i;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,a=await o.stat(e);s.sizeBytes=String(a.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:a.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;let u="";typeof e=="string"&&(u=e.replace(/[/\\]+$/,""),u=(i=u.split(/[/\\]/).pop())!==null&&i!==void 0?i:"");const f=await this.fetchUploadUrl(s,u,n);return o.upload(e,f,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r){var i;let s={};r!=null&&r.httpOptions?s=r.httpOptions:s={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`},n?{"X-Goog-Upload-File-Name":n}:{})};const o={file:e},a=await this.request({path:le("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:s});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(i=a==null?void 0:a.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function WT(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Yh({message:i,status:n}):new Error(i)}}function rM(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],f=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?a[l]=r(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iM="mcp_used/unknown";let sM=!1;function L0(t){for(const e of t)if(oM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return sM}function F0(t){var e;const n=(e=t[bm])!==null&&e!==void 0?e:"";t[bm]=(n+` ${iM}`).trimStart()}function oM(t){return t!==null&&typeof t=="object"&&t instanceof y_}function aM(t,e=100){return ya(this,arguments,function*(){let r,i=0;for(;i<e;){const s=yield nt(t.listTools({cursor:r}));for(const o of s.tools)yield yield nt(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class y_{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new y_(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const f of this.mcpClients)try{for(var a=!0,l=(n=void 0,Zl(aM(f))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const m=i;o.push(m);const _=m.name;if(s[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);s[_]=f}}catch(m){n={error:m}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),h1(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function lM(t,e,n){const r=new i1;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class uM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=hM(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const f=new Promise(A=>{u=A}),m=e.callbacks,_=function(){u({})},v=this.apiClient,E={onopen:_,onmessage:A=>{lM(v,m.onmessage,A)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(A){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(A){}},P=this.webSocketFactory.create(l,dM(o),E);P.connect(),await f;const w={setup:{model:Ue(this.apiClient,e.model)}};return P.send(JSON.stringify(w)),new cM(P,this.apiClient)}}class cM{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=tb(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=eb(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(ua.PLAY)}pause(){this.sendPlaybackControl(ua.PAUSE)}stop(){this.sendPlaybackControl(ua.STOP)}resetContext(){this.sendPlaybackControl(ua.RESET_CONTEXT)}close(){this.conn.close()}}function dM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function hM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function pM(t,e,n){const r=new r1;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=ib(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class mM{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new uM(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&L0(e.config.tools)&&F0(m);const _=vM(m);if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_,f);else{const R=this.apiClient.getApiKey();let N="BidiGenerateContent",D="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),N="BidiGenerateContentConstrained",D="access_token"),f=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${N}?${D}=${R}`}let v=()=>{};const E=new Promise(R=>{v=R}),P=e.callbacks,M=function(){var R;(R=P==null?void 0:P.onopen)===null||R===void 0||R.call(P),v({})},C=this.apiClient,w={onopen:M,onmessage:R=>{pM(C,P.onmessage,R)},onerror:(n=P==null?void 0:P.onerror)!==null&&n!==void 0?n:function(R){},onclose:(r=P==null?void 0:P.onclose)!==null&&r!==void 0?r:function(R){}},A=this.webSocketFactory.create(f,yM(_),w);A.connect(),await E;let V=Ue(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&V.startsWith("publishers/")){const R=this.apiClient.getProject(),N=this.apiClient.getLocation();V=`projects/${R}/locations/${N}/`+V}let q={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[oh.AUDIO]}:e.config.responseModalities=[oh.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const z=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],S=[];for(const R of z)if(this.isCallableTool(R)){const N=R;S.push(await N.tool())}else S.push(R);S.length>0&&(e.config.tools=S);const x={model:V,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?q=ZN(this.apiClient,x):q=XN(this.apiClient,x),delete q.config,A.send(JSON.stringify(q)),new _M(A,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const gM={turnComplete:!0};class _M{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Wn(n.turns),e.isVertexAI()||(r=r.map(i=>Xh(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(fM)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},gM),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:rb(e)}:n={realtimeInput:nb(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function yM(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function vM(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KT=10;function JT(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(va(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function va(t){return"callTool"in t&&typeof t.callTool=="function"}function TM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>va(i)))!==null&&r!==void 0?r:!1}function EM(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!va(i)))!==null&&r!==void 0?r:!1}function QT(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wM extends To{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!TM(n)||JT(n.config))return await this.generateContentInternal(l);if(EM(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,f;const m=Wn(l.contents),_=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:KT;let v=0;for(;v<_&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const E=u.candidates[0].content,P=[];for(const M of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(va(M)){const w=await M.callTool(u.functionCalls);P.push(...w)}v++,f={role:"user",parts:P},l.contents=Wn(l.contents),l.contents.push(E),l.contents.push(f),QT(l.config)&&(m.push(E),m.push(f))}return QT(l.config)&&(u.automaticFunctionCallingHistory=m),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),JT(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Ku(lo.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>va(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&L0(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),F0(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(va(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:KT;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,f,m){var _,v;return ya(this,arguments,function*(){for(var E,P,M,C;a<s;){o&&(a++,o=!1);const q=yield nt(u.processParamsMaybeAddMcpUsage(m)),z=yield nt(u.generateContentStreamInternal(q)),S=[],x=[];try{for(var w=!0,A=(P=void 0,Zl(z)),V;V=yield nt(A.next()),E=V.done,!E;w=!0){C=V.value,w=!1;const R=C;if(yield yield nt(R),R.candidates&&(!((_=R.candidates[0])===null||_===void 0)&&_.content)){x.push(R.candidates[0].content);for(const N of(v=R.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<s&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(N.functionCall.name)){const D=yield nt(f.get(N.functionCall.name).callTool([N.functionCall]));S.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(R){P={error:R}}finally{try{!w&&!E&&(M=A.return)&&(yield nt(M.call(A)))}finally{if(P)throw P.error}}if(S.length>0){o=!0;const R=new Rl;R.candidates=[{content:{role:"user",parts:S}}],yield yield nt(R);const N=[];N.push(...x),N.push({role:"user",parts:S});const D=Wn(m.contents).concat(N);m.contents=D}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=zT(this.apiClient,e);return a=le("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=jT(f),_=new Rl;return Object.assign(_,m),_})}else{const u=qT(this.apiClient,e);return a=le("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=$T(f),_=new Rl;return Object.assign(_,m),_})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=zT(this.apiClient,e);return a=le("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(m){return ya(this,arguments,function*(){var _,v,E,P;try{for(var M=!0,C=Zl(m),w;w=yield nt(C.next()),_=w.done,!_;M=!0){P=w.value,M=!1;const A=P,V=jT(yield nt(A.json()));V.sdkHttpResponse={headers:A.headers};const q=new Rl;Object.assign(q,V),yield yield nt(q)}}catch(A){v={error:A}}finally{try{!M&&!_&&(E=C.return)&&(yield nt(E.call(C)))}finally{if(v)throw v.error}}})})}else{const u=qT(this.apiClient,e);return a=le("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(m){return ya(this,arguments,function*(){var _,v,E,P;try{for(var M=!0,C=Zl(m),w;w=yield nt(C.next()),_=w.done,!_;M=!0){P=w.value,M=!1;const A=P,V=$T(yield nt(A.json()));V.sdkHttpResponse={headers:A.headers};const q=new Rl;Object.assign(q,V),yield yield nt(q)}}catch(A){v={error:A}}finally{try{!M&&!_&&(E=C.return)&&(yield nt(E.call(C)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Mb(this.apiClient,e);return a=le("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=Lb(f),_=new CT;return Object.assign(_,m),_})}else{const u=Db(this.apiClient,e);return a=le("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=Vb(f),_=new CT;return Object.assign(_,m),_})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=jb(this.apiClient,e);return a=le("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=Wb(f),_=new AT;return Object.assign(_,m),_})}else{const u=$b(this.apiClient,e);return a=le("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=Hb(f),_=new AT;return Object.assign(_,m),_})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Pb(this.apiClient,e);return s=le("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=kb(l),f=new Jk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=qD(this.apiClient,e);return s=le("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=zD(l),f=new Qk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=SD(this.apiClient,e);return s=le("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=xD(l),f=new Yk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=ND(this.apiClient,e);return s=le("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=bD(l),f=new Xk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=cD(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Nm(f))}else{const u=uD(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>km(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=_D(this.apiClient,e);return a=le("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=vD(f),_=new RT;return Object.assign(_,m),_})}else{const u=gD(this.apiClient,e);return a=le("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=yD(f),_=new RT;return Object.assign(_,m),_})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=BD(this.apiClient,e);return a=le("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>Nm(f))}else{const u=OD(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>km(f))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=xb(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=Ab(f),_=new PT;return Object.assign(_,m),_})}else{const u=Sb(this.apiClient,e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=Cb(f),_=new PT;return Object.assign(_,m),_})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Eb(this.apiClient,e);return a=le("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=Ib(f),_=new kT;return Object.assign(_,m),_})}else{const u=Tb(this.apiClient,e);return a=le("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=wb(f),_=new kT;return Object.assign(_,m),_})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=fb(this.apiClient,e);return s=le("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=pb(l),f=new Zk;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Zb(this.apiClient,e);return a=le("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>{const m=Yb(f),_=new ah;return Object.assign(_,m),_})}else{const u=Xb(this.apiClient,e);return a=le("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{const m=Qb(f),_=new ah;return Object.assign(_,m),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IM extends To{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Hk(e);return a=le("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o}else{const u=jk(e);return a=le("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Uk(e);return s=le("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SM(t){const e={},n=d(t,["data"]);if(n!=null&&h(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function xM(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>DM(s))),h(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&h(e,["role"],r),e}function CM(t,e,n){const r={},i=d(e,["expireTime"]);n!==void 0&&i!=null&&h(n,["expireTime"],i);const s=d(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&h(n,["newSessionExpireTime"],s);const o=d(e,["uses"]);n!==void 0&&o!=null&&h(n,["uses"],o);const a=d(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&h(n,["bidiGenerateContentSetup"],bM(t,a));const l=d(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&h(n,["fieldMask"],l),r}function AM(t,e){const n={},r=d(e,["config"]);return r!=null&&h(n,["config"],CM(t,r,n)),n}function RM(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&h(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&h(e,["mimeType"],r),e}function PM(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&h(e,["enableWidget"],n),e}function kM(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&h(e,["timeRangeFilter"],n),e}function NM(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig"],r);const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig","responseModalities"],i);const s=d(t,["temperature"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","temperature"],s);const o=d(t,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=d(t,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=d(t,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","mediaResolution"],u);const f=d(t,["seed"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","seed"],f);const m=d(t,["speechConfig"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","speechConfig"],__(m));const _=d(t,["thinkingConfig"]);e!==void 0&&_!=null&&h(e,["setup","generationConfig","thinkingConfig"],_);const v=d(t,["enableAffectiveDialog"]);e!==void 0&&v!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],v);const E=d(t,["systemInstruction"]);e!==void 0&&E!=null&&h(e,["setup","systemInstruction"],xM(tn(E)));const P=d(t,["tools"]);if(e!==void 0&&P!=null){let z=Xa(P);Array.isArray(z)&&(z=z.map(S=>VM(Ya(S)))),h(e,["setup","tools"],z)}const M=d(t,["sessionResumption"]);e!==void 0&&M!=null&&h(e,["setup","sessionResumption"],MM(M));const C=d(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&h(e,["setup","inputAudioTranscription"],C);const w=d(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&h(e,["setup","outputAudioTranscription"],w);const A=d(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&h(e,["setup","realtimeInputConfig"],A);const V=d(t,["contextWindowCompression"]);e!==void 0&&V!=null&&h(e,["setup","contextWindowCompression"],V);const q=d(t,["proactivity"]);return e!==void 0&&q!=null&&h(e,["setup","proactivity"],q),n}function bM(t,e){const n={},r=d(e,["model"]);r!=null&&h(n,["setup","model"],Ue(t,r));const i=d(e,["config"]);return i!=null&&h(n,["config"],NM(i,n)),n}function DM(t){const e={},n=d(t,["functionCall"]);n!=null&&h(e,["functionCall"],n);const r=d(t,["codeExecutionResult"]);r!=null&&h(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&h(e,["executableCode"],i);const s=d(t,["fileData"]);s!=null&&h(e,["fileData"],RM(s));const o=d(t,["functionResponse"]);o!=null&&h(e,["functionResponse"],o);const a=d(t,["inlineData"]);a!=null&&h(e,["inlineData"],SM(a));const l=d(t,["text"]);l!=null&&h(e,["text"],l);const u=d(t,["thought"]);u!=null&&h(e,["thought"],u);const f=d(t,["thoughtSignature"]);f!=null&&h(e,["thoughtSignature"],f);const m=d(t,["videoMetadata"]);return m!=null&&h(e,["videoMetadata"],m),e}function MM(t){const e={},n=d(t,["handle"]);if(n!=null&&h(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function VM(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>f)),h(e,["functionDeclarations"],u)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],r);const i=d(t,["googleMaps"]);i!=null&&h(e,["googleMaps"],PM(i));const s=d(t,["computerUse"]);s!=null&&h(e,["computerUse"],s);const o=d(t,["codeExecution"]);if(o!=null&&h(e,["codeExecution"],o),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(t,["googleSearch"]);a!=null&&h(e,["googleSearch"],kM(a));const l=d(t,["urlContext"]);return l!=null&&h(e,["urlContext"],l),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LM(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function FM(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=LM(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class UM extends To{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=AM(this.apiClient,e);s=le("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=FM(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OM(t,e){const n={},r=d(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function BM(t,e){const n={},r=d(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function GM(t,e,n){const r={};if(d(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=d(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&h(e,["displayName"],i),d(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=d(t,["epochCount"]);e!==void 0&&s!=null&&h(e,["tuningTask","hyperparameters","epochCount"],s);const o=d(t,["learningRateMultiplier"]);if(o!=null&&h(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),d(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=d(t,["batchSize"]);e!==void 0&&a!=null&&h(e,["tuningTask","hyperparameters","batchSize"],a);const l=d(t,["learningRate"]);if(e!==void 0&&l!=null&&h(e,["tuningTask","hyperparameters","learningRate"],l),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function qM(t,e,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const v=d(t,["validationDataset"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec"],YT(v))}else if(i==="PREFERENCE_TUNING"){const v=d(t,["validationDataset"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec"],YT(v))}const s=d(t,["tunedModelDisplayName"]);e!==void 0&&s!=null&&h(e,["tunedModelDisplayName"],s);const o=d(t,["description"]);e!==void 0&&o!=null&&h(e,["description"],o);let a=d(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const v=d(t,["epochCount"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","hyperParameters","epochCount"],v)}else if(a==="PREFERENCE_TUNING"){const v=d(t,["epochCount"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],v)}let l=d(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const v=d(t,["learningRateMultiplier"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],v)}else if(l==="PREFERENCE_TUNING"){const v=d(t,["learningRateMultiplier"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],v)}let u=d(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const v=d(t,["exportLastCheckpointOnly"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","exportLastCheckpointOnly"],v)}else if(u==="PREFERENCE_TUNING"){const v=d(t,["exportLastCheckpointOnly"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],v)}let f=d(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const v=d(t,["adapterSize"]);e!==void 0&&v!=null&&h(e,["supervisedTuningSpec","hyperParameters","adapterSize"],v)}else if(f==="PREFERENCE_TUNING"){const v=d(t,["adapterSize"]);e!==void 0&&v!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],v)}if(d(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=d(t,["labels"]);e!==void 0&&m!=null&&h(e,["labels"],m);const _=d(t,["beta"]);return e!==void 0&&_!=null&&h(e,["preferenceOptimizationSpec","hyperParameters","beta"],_),r}function zM(t,e){const n={},r=d(t,["baseModel"]);r!=null&&h(n,["baseModel"],r);const i=d(t,["preTunedModel"]);i!=null&&h(n,["preTunedModel"],i);const s=d(t,["trainingDataset"]);s!=null&&e2(s);const o=d(t,["config"]);return o!=null&&GM(o,n),n}function $M(t,e){const n={},r=d(t,["baseModel"]);r!=null&&h(n,["baseModel"],r);const i=d(t,["preTunedModel"]);i!=null&&h(n,["preTunedModel"],i);const s=d(t,["trainingDataset"]);s!=null&&t2(s,n,e);const o=d(t,["config"]);return o!=null&&qM(o,n,e),n}function jM(t,e){const n={},r=d(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function HM(t,e){const n={},r=d(t,["name"]);return r!=null&&h(n,["_url","name"],r),n}function WM(t,e,n){const r={},i=d(t,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(t,["pageToken"]);e!==void 0&&s!=null&&h(e,["_query","pageToken"],s);const o=d(t,["filter"]);return e!==void 0&&o!=null&&h(e,["_query","filter"],o),r}function KM(t,e,n){const r={},i=d(t,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(t,["pageToken"]);e!==void 0&&s!=null&&h(e,["_query","pageToken"],s);const o=d(t,["filter"]);return e!==void 0&&o!=null&&h(e,["_query","filter"],o),r}function JM(t,e){const n={},r=d(t,["config"]);return r!=null&&WM(r,n),n}function QM(t,e){const n={},r=d(t,["config"]);return r!=null&&KM(r,n),n}function YM(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&h(n,["nextPageToken"],i);const s=d(t,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>U0(a))),h(n,["tuningJobs"],o)}return n}function XM(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&h(n,["nextPageToken"],i);const s=d(t,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Dm(a))),h(n,["tuningJobs"],o)}return n}function ZM(t,e){const n={},r=d(t,["name"]);r!=null&&h(n,["model"],r);const i=d(t,["name"]);return i!=null&&h(n,["endpoint"],i),n}function e2(t,e){const n={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=d(t,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),h(n,["examples","examples"],i)}return n}function t2(t,e,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=d(t,["gcsUri"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=d(t,["gcsUri"]);e!==void 0&&o!=null&&h(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=d(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=d(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=d(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&h(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(d(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function U0(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&h(n,["name"],i);const s=d(t,["state"]);s!=null&&h(n,["state"],v0(s));const o=d(t,["createTime"]);o!=null&&h(n,["createTime"],o);const a=d(t,["tuningTask","startTime"]);a!=null&&h(n,["startTime"],a);const l=d(t,["tuningTask","completeTime"]);l!=null&&h(n,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&h(n,["updateTime"],u);const f=d(t,["description"]);f!=null&&h(n,["description"],f);const m=d(t,["baseModel"]);m!=null&&h(n,["baseModel"],m);const _=d(t,["_self"]);return _!=null&&h(n,["tunedModel"],ZM(_)),n}function Dm(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&h(n,["name"],i);const s=d(t,["state"]);s!=null&&h(n,["state"],v0(s));const o=d(t,["createTime"]);o!=null&&h(n,["createTime"],o);const a=d(t,["startTime"]);a!=null&&h(n,["startTime"],a);const l=d(t,["endTime"]);l!=null&&h(n,["endTime"],l);const u=d(t,["updateTime"]);u!=null&&h(n,["updateTime"],u);const f=d(t,["error"]);f!=null&&h(n,["error"],f);const m=d(t,["description"]);m!=null&&h(n,["description"],m);const _=d(t,["baseModel"]);_!=null&&h(n,["baseModel"],_);const v=d(t,["tunedModel"]);v!=null&&h(n,["tunedModel"],v);const E=d(t,["preTunedModel"]);E!=null&&h(n,["preTunedModel"],E);const P=d(t,["supervisedTuningSpec"]);P!=null&&h(n,["supervisedTuningSpec"],P);const M=d(t,["preferenceOptimizationSpec"]);M!=null&&h(n,["preferenceOptimizationSpec"],M);const C=d(t,["tuningDataStats"]);C!=null&&h(n,["tuningDataStats"],C);const w=d(t,["encryptionSpec"]);w!=null&&h(n,["encryptionSpec"],w);const A=d(t,["partnerModelTuningSpec"]);A!=null&&h(n,["partnerModelTuningSpec"],A);const V=d(t,["customBaseModel"]);V!=null&&h(n,["customBaseModel"],V);const q=d(t,["experiment"]);q!=null&&h(n,["experiment"],q);const z=d(t,["labels"]);z!=null&&h(n,["labels"],z);const S=d(t,["outputUri"]);S!=null&&h(n,["outputUri"],S);const x=d(t,["pipelineJob"]);x!=null&&h(n,["pipelineJob"],x);const R=d(t,["serviceAccount"]);R!=null&&h(n,["serviceAccount"],R);const N=d(t,["tunedModelDisplayName"]);N!=null&&h(n,["tunedModelDisplayName"],N);const D=d(t,["veoTuningSpec"]);return D!=null&&h(n,["veoTuningSpec"],D),n}function n2(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&h(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&h(n,["name"],i);const s=d(t,["metadata"]);s!=null&&h(n,["metadata"],s);const o=d(t,["done"]);o!=null&&h(n,["done"],o);const a=d(t,["error"]);return a!=null&&h(n,["error"],a),n}function YT(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&h(n,["validationDatasetUri"],r);const i=d(t,["vertexDatasetResource"]);return i!=null&&h(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r2 extends To{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Ku(lo.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:Cm.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HM(e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>Dm(f))}else{const u=jM(e);return a=le("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>U0(f))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=QM(e);return a=le("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=XM(f),_=new NT;return Object.assign(_,m),_})}else{const u=JM(e);return a=le("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const _=m;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const m=YM(f),_=new NT;return Object.assign(_,m),_})}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=BM(e);o=le("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=OM(e);o=le("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=$M(e,e);return s=le("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>Dm(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=zM(e);return s=le("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>n2(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i2{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const s2=1024*1024*8,o2=3,a2=1e3,l2=2,pp="x-goog-upload-status";async function u2(t,e,n){var r,i,s;let o=0,a=0,l=new Am(new Response),u="upload";for(o=t.size;a<o;){const m=Math.min(s2,o-a),_=t.slice(a,a+m);a+m>=o&&(u+=", finalize");let v=0,E=a2;for(;v<o2&&(l=await n.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(m)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[pp]));)v++,await d2(E),E=E*l2;if(a+=m,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[pp])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(l==null?void 0:l.json());if(((s=l==null?void 0:l.headers)===null||s===void 0?void 0:s[pp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function c2(t){return{size:t.size,type:t.type}}function d2(t){return new Promise(e=>setTimeout(e,t))}class h2{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await u2(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await c2(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class f2{create(e,n,r){return new p2(e,n,r)}}class p2{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const XT="x-goog-api-key";class m2{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(XT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(XT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const g2="gl-node/";class _2{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=Lk(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new m2(this.apiKey);this.apiClient=new nM({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:g2+"web",uploader:new h2,downloader:new i2}),this.models=new wM(this.apiClient),this.live=new mM(this.apiClient,i,new f2),this.batches=new tN(this.apiClient),this.chats=new DN(this.models,this.apiClient),this.caches=new kN(this.apiClient),this.files=new zN(this.apiClient),this.operations=new IM(this.apiClient),this.authTokens=new UM(this.apiClient),this.tunings=new r2(this.apiClient)}}const y2=()=>{};var ZT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},v2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},B0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,m=(s&3)<<4|a>>4;let _=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(_=64)),r.push(n[f],n[m],n[_],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(O0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):v2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const m=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||m==null)throw new T2;const _=s<<2|a>>4;if(r.push(_),u!==64){const v=a<<4&240|u>>2;if(r.push(v),m!==64){const E=u<<6&192|m;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class T2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const E2=function(t){const e=O0(t);return B0.encodeByteArray(e,!0)},uh=function(t){return E2(t).replace(/\./g,"")},G0=function(t){try{return B0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=()=>q0().__FIREBASE_DEFAULTS__,I2=()=>{if(typeof process>"u"||typeof ZT>"u")return;const t=ZT.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},S2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&G0(t[1]);return e&&JSON.parse(e)},tf=()=>{try{return y2()||w2()||I2()||S2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},z0=t=>{var e,n;return(n=(e=tf())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},x2=t=>{const e=z0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},$0=()=>{var t;return(t=tf())==null?void 0:t.config},j0=t=>{var e;return(e=tf())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function el(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function H0(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[uh(JSON.stringify(n)),uh(JSON.stringify(o)),""].join(".")}const eu={};function R2(){const t={prod:[],emulator:[]};for(const e of Object.keys(eu))eu[e]?t.emulator.push(e):t.prod.push(e);return t}function P2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let eE=!1;function W0(t,e){if(typeof window>"u"||typeof document>"u"||!el(window.location.host)||eu[t]===e||eu[t]||eE)return;eu[t]=e;function n(_){return`__firebase__banner__${_}`}const r="__firebase__banner",s=R2().prod.length>0;function o(){const _=document.getElementById(r);_&&_.remove()}function a(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function l(_,v){_.setAttribute("width","24"),_.setAttribute("id",v),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function u(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{eE=!0,o()},_}function f(_,v){_.setAttribute("id",v),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function m(){const _=P2(r),v=n("text"),E=document.getElementById(v)||document.createElement("span"),P=n("learnmore"),M=document.getElementById(P)||document.createElement("a"),C=n("preprendIcon"),w=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const A=_.element;a(A),f(M,P);const V=u();l(w,C),A.append(w,E,M,V),document.body.appendChild(A)}s?(E.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function k2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nt())}function K0(){var e;const t=(e=tf())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function N2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function b2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function D2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function M2(){const t=Nt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function J0(){return!K0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Q0(){return!K0()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Y0(){try{return typeof indexedDB=="object"}catch{return!1}}function V2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2="FirebaseError";class ci extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=L2,Object.setPrototypeOf(this,ci.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ju.prototype.create)}}class Ju{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?F2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ci(i,a,r)}}function F2(t,e){return t.replace(U2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const U2=/\{\$([^}]+)}/g;function O2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function uo(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(tE(s)&&tE(o)){if(!uo(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function tE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function B2(t,e){const n=new G2(t,e);return n.subscribe.bind(n)}class G2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");q2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=mp),i.error===void 0&&(i.error=mp),i.complete===void 0&&(i.complete=mp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function q2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function mp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(t){return t&&t._delegate?t._delegate:t}class co{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new C2;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(j2(e))try{this.getOrInitializeService({instanceIdentifier:Us})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Us){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Us){return this.instances.has(e)}getOptions(e=Us){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Us){return this.component?this.component.multipleInstances?e:Us:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $2(t){return t===Us?void 0:t}function j2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new z2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Pe||(Pe={}));const W2={debug:Pe.DEBUG,verbose:Pe.VERBOSE,info:Pe.INFO,warn:Pe.WARN,error:Pe.ERROR,silent:Pe.SILENT},K2=Pe.INFO,J2={[Pe.DEBUG]:"log",[Pe.VERBOSE]:"log",[Pe.INFO]:"info",[Pe.WARN]:"warn",[Pe.ERROR]:"error"},Q2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=J2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class v_{constructor(e){this.name=e,this._logLevel=K2,this._logHandler=Q2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?W2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pe.DEBUG,...e),this._logHandler(this,Pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pe.VERBOSE,...e),this._logHandler(this,Pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pe.INFO,...e),this._logHandler(this,Pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pe.WARN,...e),this._logHandler(this,Pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pe.ERROR,...e),this._logHandler(this,Pe.ERROR,...e)}}const Y2=(t,e)=>e.some(n=>t instanceof n);let nE,rE;function X2(){return nE||(nE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Z2(){return rE||(rE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const X0=new WeakMap,Mm=new WeakMap,Z0=new WeakMap,gp=new WeakMap,T_=new WeakMap;function eV(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Yi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&X0.set(n,t)}).catch(()=>{}),T_.set(e,t),e}function tV(t){if(Mm.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Mm.set(t,e)}let Vm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Mm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Z0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Yi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function nV(t){Vm=t(Vm)}function rV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(_p(this),e,...n);return Z0.set(r,e.sort?e.sort():[e]),Yi(r)}:Z2().includes(t)?function(...e){return t.apply(_p(this),e),Yi(X0.get(this))}:function(...e){return Yi(t.apply(_p(this),e))}}function iV(t){return typeof t=="function"?rV(t):(t instanceof IDBTransaction&&tV(t),Y2(t,X2())?new Proxy(t,Vm):t)}function Yi(t){if(t instanceof IDBRequest)return eV(t);if(gp.has(t))return gp.get(t);const e=iV(t);return e!==t&&(gp.set(t,e),T_.set(e,t)),e}const _p=t=>T_.get(t);function sV(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Yi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Yi(o.result),l.oldVersion,l.newVersion,Yi(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const oV=["get","getKey","getAll","getAllKeys","count"],aV=["put","add","delete","clear"],yp=new Map;function iE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(yp.get(e))return yp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=aV.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||oV.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return yp.set(e,s),s}nV(t=>({...t,get:(e,n,r)=>iE(e,n)||t.get(e,n,r),has:(e,n)=>!!iE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(uV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function uV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Lm="@firebase/app",sE="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ii=new v_("@firebase/app"),cV="@firebase/app-compat",dV="@firebase/analytics-compat",hV="@firebase/analytics",fV="@firebase/app-check-compat",pV="@firebase/app-check",mV="@firebase/auth",gV="@firebase/auth-compat",_V="@firebase/database",yV="@firebase/data-connect",vV="@firebase/database-compat",TV="@firebase/functions",EV="@firebase/functions-compat",wV="@firebase/installations",IV="@firebase/installations-compat",SV="@firebase/messaging",xV="@firebase/messaging-compat",CV="@firebase/performance",AV="@firebase/performance-compat",RV="@firebase/remote-config",PV="@firebase/remote-config-compat",kV="@firebase/storage",NV="@firebase/storage-compat",bV="@firebase/firestore",DV="@firebase/ai",MV="@firebase/firestore-compat",VV="firebase",LV="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm="[DEFAULT]",FV={[Lm]:"fire-core",[cV]:"fire-core-compat",[hV]:"fire-analytics",[dV]:"fire-analytics-compat",[pV]:"fire-app-check",[fV]:"fire-app-check-compat",[mV]:"fire-auth",[gV]:"fire-auth-compat",[_V]:"fire-rtdb",[yV]:"fire-data-connect",[vV]:"fire-rtdb-compat",[TV]:"fire-fn",[EV]:"fire-fn-compat",[wV]:"fire-iid",[IV]:"fire-iid-compat",[SV]:"fire-fcm",[xV]:"fire-fcm-compat",[CV]:"fire-perf",[AV]:"fire-perf-compat",[RV]:"fire-rc",[PV]:"fire-rc-compat",[kV]:"fire-gcs",[NV]:"fire-gcs-compat",[bV]:"fire-fst",[MV]:"fire-fst-compat",[DV]:"fire-vertex","fire-js":"fire-js",[VV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch=new Map,UV=new Map,Um=new Map;function oE(t,e){try{t.container.addComponent(e)}catch(n){ii.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Na(t){const e=t.name;if(Um.has(e))return ii.debug(`There were multiple attempts to register component ${e}.`),!1;Um.set(e,t);for(const n of ch.values())oE(n,t);for(const n of UV.values())oE(n,t);return!0}function E_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ur(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xi=new Ju("app","Firebase",OV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new co("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl=LV;function ex(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Fm,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Xi.create("bad-app-name",{appName:String(i)});if(n||(n=$0()),!n)throw Xi.create("no-options");const s=ch.get(i);if(s){if(uo(n,s.options)&&uo(r,s.config))return s;throw Xi.create("duplicate-app",{appName:i})}const o=new H2(i);for(const l of Um.values())o.addComponent(l);const a=new BV(n,r,o);return ch.set(i,a),a}function tx(t=Fm){const e=ch.get(t);if(!e&&t===Fm&&$0())return ex();if(!e)throw Xi.create("no-app",{appName:t});return e}function Zi(t,e,n){let r=FV[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ii.warn(o.join(" "));return}Na(new co(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GV="firebase-heartbeat-database",qV=1,Pu="firebase-heartbeat-store";let vp=null;function nx(){return vp||(vp=sV(GV,qV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Pu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Xi.create("idb-open",{originalErrorMessage:t.message})})),vp}async function zV(t){try{const n=(await nx()).transaction(Pu),r=await n.objectStore(Pu).get(rx(t));return await n.done,r}catch(e){if(e instanceof ci)ii.warn(e.message);else{const n=Xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ii.warn(n.message)}}}async function aE(t,e){try{const r=(await nx()).transaction(Pu,"readwrite");await r.objectStore(Pu).put(e,rx(t)),await r.done}catch(n){if(n instanceof ci)ii.warn(n.message);else{const r=Xi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ii.warn(r.message)}}}function rx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V=1024,jV=30;class HV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new KV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=lE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>jV){const o=JV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ii.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=lE(),{heartbeatsToSend:r,unsentEntries:i}=WV(this._heartbeatsCache.heartbeats),s=uh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return ii.warn(n),""}}}function lE(){return new Date().toISOString().substring(0,10)}function WV(t,e=$V){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),uE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),uE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class KV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Y0()?V2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await zV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return aE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return aE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function uE(t){return uh(JSON.stringify({version:2,heartbeats:t})).length}function JV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(t){Na(new co("platform-logger",e=>new lV(e),"PRIVATE")),Na(new co("heartbeat",e=>new HV(e),"PRIVATE")),Zi(Lm,sE,t),Zi(Lm,sE,"esm2020"),Zi("fire-js","")}QV("");var YV="firebase",XV="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zi(YV,XV,"app");function ix(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZV=ix,sx=new Ju("auth","Firebase",ix());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh=new v_("@firebase/auth");function eL(t,...e){dh.logLevel<=Pe.WARN&&dh.warn(`Auth (${tl}): ${t}`,...e)}function Ed(t,...e){dh.logLevel<=Pe.ERROR&&dh.error(`Auth (${tl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(t,...e){throw I_(t,...e)}function fr(t,...e){return I_(t,...e)}function w_(t,e,n){const r={...ZV(),[e]:n};return new Ju("auth","Firebase",r).create(e,{appName:t.name})}function Zs(t){return w_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tL(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Dr(t,"argument-error"),w_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function I_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return sx.create(t,...e)}function _e(t,e,...n){if(!t)throw I_(e,...n)}function Jr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ed(e),new Error(e)}function si(t,e){t||Jr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Om(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function nL(){return cE()==="http:"||cE()==="https:"}function cE(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nL()||b2()||"connection"in navigator)?navigator.onLine:!0}function iL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,n){this.shortDelay=e,this.longDelay=n,si(n>e,"Short delay should be less than long delay!"),this.isMobile=k2()||D2()}get(){return rL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S_(t,e){si(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Jr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Jr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Jr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],aL=new Yu(3e4,6e4);function x_(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function nl(t,e,n,r,i={}){return ax(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Qu({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return N2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&el(t.emulatorConfig.host)&&(u.credentials="include"),ox.fetch()(await lx(t,t.config.apiHost,n,a),u)})}async function ax(t,e,n){t._canInitEmulator=!1;const r={...sL,...e};try{const i=new uL(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Zc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Zc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Zc(t,"user-disabled",o);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw w_(t,f,u);Dr(t,f)}}catch(i){if(i instanceof ci)throw i;Dr(t,"network-request-failed",{message:String(i)})}}async function lL(t,e,n,r,i={}){const s=await nl(t,e,n,r,i);return"mfaPendingCredential"in s&&Dr(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function lx(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?S_(t.config,i):`${t.config.apiScheme}://${i}`;return oL.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class uL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(fr(this.auth,"network-request-failed")),aL.get())})}}function Zc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=fr(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cL(t,e){return nl(t,"POST","/v1/accounts:delete",e)}async function hh(t,e){return nl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function dL(t,e=!1){const n=bt(t),r=await n.getIdToken(e),i=C_(r);_e(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:tu(Tp(i.auth_time)),issuedAtTime:tu(Tp(i.iat)),expirationTime:tu(Tp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Tp(t){return Number(t)*1e3}function C_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ed("JWT malformed, contained fewer than 3 sections"),null;try{const i=G0(n);return i?JSON.parse(i):(Ed("Failed to decode base64 JWT payload"),null)}catch(i){return Ed("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function dE(t){const e=C_(t);return _e(e,"internal-error"),_e(typeof e.exp<"u","internal-error"),_e(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ku(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ci&&hL(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function hL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=tu(this.lastLoginAt),this.creationTime=tu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fh(t){var m;const e=t.auth,n=await t.getIdToken(),r=await ku(t,hh(e,{idToken:n}));_e(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(m=i.providerUserInfo)!=null&&m.length?ux(i.providerUserInfo):[],o=mL(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Bm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function pL(t){const e=bt(t);await fh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mL(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function ux(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gL(t,e){const n=await ax(t,{},async()=>{const r=Qu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await lx(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&el(t.emulatorConfig.host)&&(l.credentials="include"),ox.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function _L(t,e){return nl(t,"POST","/v2/accounts:revokeToken",x_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_e(e.idToken,"internal-error"),_e(typeof e.idToken<"u","internal-error"),_e(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):dE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){_e(e.length!==0,"internal-error");const n=dE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(_e(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await gL(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Ta;return r&&(_e(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(_e(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(_e(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ta,this.toJSON())}_performRefresh(){return Jr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(t,e){_e(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class cr{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new fL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Bm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ku(this,this.stsTokenManager.getToken(this.auth,e));return _e(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return dL(this,e)}reload(){return pL(this)}_assign(e){this!==e&&(_e(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new cr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){_e(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await fh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ur(this.auth.app))return Promise.reject(Zs(this.auth));const e=await this.getIdToken();return await ku(this,cL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:m,emailVerified:_,isAnonymous:v,providerData:E,stsTokenManager:P}=n;_e(m&&P,e,"internal-error");const M=Ta.fromJSON(this.name,P);_e(typeof m=="string",e,"internal-error"),Ai(r,e.name),Ai(i,e.name),_e(typeof _=="boolean",e,"internal-error"),_e(typeof v=="boolean",e,"internal-error"),Ai(s,e.name),Ai(o,e.name),Ai(a,e.name),Ai(l,e.name),Ai(u,e.name),Ai(f,e.name);const C=new cr({uid:m,auth:e,email:i,emailVerified:_,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:M,createdAt:u,lastLoginAt:f});return E&&Array.isArray(E)&&(C.providerData=E.map(w=>({...w}))),l&&(C._redirectEventId=l),C}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ta;i.updateFromServerResponse(n);const s=new cr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await fh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];_e(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?ux(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Ta;a.updateFromIdToken(r);const l=new cr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Bm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hE=new Map;function Qr(t){si(t instanceof Function,"Expected a class definition");let e=hE.get(t);return e?(si(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,hE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}cx.type="NONE";const fE=cx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wd(t,e,n){return`firebase:${t}:${e}:${n}`}class Ea{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=wd(this.userKey,i.apiKey,s),this.fullPersistenceKey=wd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await hh(this.auth,{idToken:e}).catch(()=>{});return n?cr._fromGetAccountInfoResponse(this.auth,n,e):null}return cr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ea(Qr(fE),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Qr(fE);const o=wd(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const f=await u._get(o);if(f){let m;if(typeof f=="string"){const _=await hh(e,{idToken:f}).catch(()=>{});if(!_)break;m=await cr._fromGetAccountInfoResponse(e,_,f)}else m=cr._fromJSON(e,f);u!==s&&(a=m),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Ea(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new Ea(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(px(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(dx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gx(e))return"Blackberry";if(_x(e))return"Webos";if(hx(e))return"Safari";if((e.includes("chrome/")||fx(e))&&!e.includes("edge/"))return"Chrome";if(mx(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function dx(t=Nt()){return/firefox\//i.test(t)}function hx(t=Nt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fx(t=Nt()){return/crios\//i.test(t)}function px(t=Nt()){return/iemobile/i.test(t)}function mx(t=Nt()){return/android/i.test(t)}function gx(t=Nt()){return/blackberry/i.test(t)}function _x(t=Nt()){return/webos/i.test(t)}function A_(t=Nt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function yL(t=Nt()){var e;return A_(t)&&!!((e=window.navigator)!=null&&e.standalone)}function vL(){return M2()&&document.documentMode===10}function yx(t=Nt()){return A_(t)||mx(t)||_x(t)||gx(t)||/windows phone/i.test(t)||px(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(t,e=[]){let n;switch(t){case"Browser":n=pE(Nt());break;case"Worker":n=`${pE(Nt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${tl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EL(t,e={}){return nl(t,"GET","/v2/passwordPolicy",x_(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL=6;class IL{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??wL,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mE(this),this.idTokenSubscription=new mE(this),this.beforeStateQueue=new TL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Qr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Ea.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await hh(this,{idToken:e}),r=await cr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(ur(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return _e(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await fh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ur(this.app))return Promise.reject(Zs(this));const n=e?bt(e):null;return n&&_e(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&_e(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ur(this.app)?Promise.reject(Zs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ur(this.app)?Promise.reject(Zs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Qr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await EL(this),n=new IL(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ju("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await _L(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Qr(e)||this._popupRedirectResolver;_e(n,this,"argument-error"),this.redirectPersistenceManager=await Ea.create(this,[Qr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(_e(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _e(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(ur(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&eL(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function nf(t){return bt(t)}class mE{constructor(e){this.auth=e,this.observer=null,this.addObserver=B2(n=>this.observer=n)}get next(){return _e(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xL(t){R_=t}function CL(t){return R_.loadJS(t)}function AL(){return R_.gapiScript}function RL(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(t,e){const n=E_(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(uo(s,e??{}))return i;Dr(i,"already-initialized")}return n.initialize({options:e})}function kL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Qr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function NL(t,e,n){const r=nf(t);_e(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=Tx(e),{host:o,port:a}=bL(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},f=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){_e(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),_e(uo(u,r.config.emulator)&&uo(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,el(o)?(H0(`${s}//${o}${l}`),W0("Auth",!0)):DL()}function Tx(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function bL(t){const e=Tx(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:gE(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:gE(o)}}}function gE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function DL(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Jr("not implemented")}_getIdTokenResponse(e){return Jr("not implemented")}_linkToIdToken(e,n){return Jr("not implemented")}_getReauthenticationResolver(e){return Jr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wa(t,e){return lL(t,"POST","/v1/accounts:signInWithIdp",x_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML="http://localhost";class ho extends Ex{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ho(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Dr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new ho(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return wa(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,wa(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,wa(e,n)}buildRequest(){const e={requestUri:ML,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Qu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu extends P_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li extends Xu{constructor(){super("facebook.com")}static credential(e){return ho._fromParams({providerId:Li.PROVIDER_ID,signInMethod:Li.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Li.credentialFromTaggedObject(e)}static credentialFromError(e){return Li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Li.credential(e.oauthAccessToken)}catch{return null}}}Li.FACEBOOK_SIGN_IN_METHOD="facebook.com";Li.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr extends Xu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ho._fromParams({providerId:Hr.PROVIDER_ID,signInMethod:Hr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Hr.credentialFromTaggedObject(e)}static credentialFromError(e){return Hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Hr.credential(n,r)}catch{return null}}}Hr.GOOGLE_SIGN_IN_METHOD="google.com";Hr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends Xu{constructor(){super("github.com")}static credential(e){return ho._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fi.credential(e.oauthAccessToken)}catch{return null}}}Fi.GITHUB_SIGN_IN_METHOD="github.com";Fi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui extends Xu{constructor(){super("twitter.com")}static credential(e,n){return ho._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ui.credential(n,r)}catch{return null}}}Ui.TWITTER_SIGN_IN_METHOD="twitter.com";Ui.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await cr._fromIdTokenResponse(e,r,i),o=_E(r);return new ba({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=_E(r);return new ba({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function _E(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph extends ci{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,ph.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new ph(e,n,r,i)}}function wx(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?ph._fromErrorAndOperation(t,s,e,r):s})}async function VL(t,e,n=!1){const r=await ku(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ba._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LL(t,e,n=!1){const{auth:r}=t;if(ur(r.app))return Promise.reject(Zs(r));const i="reauthenticate";try{const s=await ku(t,wx(r,i,e,t),n);_e(s.idToken,r,"internal-error");const o=C_(s.idToken);_e(o,r,"internal-error");const{sub:a}=o;return _e(t.uid===a,r,"user-mismatch"),ba._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Dr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FL(t,e,n=!1){if(ur(t.app))return Promise.reject(Zs(t));const r="signIn",i=await wx(t,r,e),s=await ba._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UL(t,e){return bt(t).setPersistence(e)}function OL(t,e,n,r){return bt(t).onIdTokenChanged(e,n,r)}function BL(t,e,n){return bt(t).beforeAuthStateChanged(e,n)}function GL(t,e,n,r){return bt(t).onAuthStateChanged(e,n,r)}function yE(t){return bt(t).signOut()}const mh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ix{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(mh,"1"),this.storage.removeItem(mh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL=1e3,zL=10;class Sx extends Ix{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);vL()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,zL):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},qL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Sx.type="LOCAL";const xx=Sx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx extends Ix{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Cx.type="SESSION";const Ax=Cx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $L(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new rf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await $L(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=k_("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const _=m;if(_.data.eventId===u)switch(_.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(_.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(){return window}function HL(t){Nr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(){return typeof Nr().WorkerGlobalScope<"u"&&typeof Nr().importScripts=="function"}async function WL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function KL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function JL(){return Rx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px="firebaseLocalStorageDb",QL=1,gh="firebaseLocalStorage",kx="fbase_key";class Zu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function sf(t,e){return t.transaction([gh],e?"readwrite":"readonly").objectStore(gh)}function YL(){const t=indexedDB.deleteDatabase(Px);return new Zu(t).toPromise()}function Gm(){const t=indexedDB.open(Px,QL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(gh,{keyPath:kx})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(gh)?e(r):(r.close(),await YL(),e(await Gm()))})})}async function vE(t,e,n){const r=sf(t,!0).put({[kx]:e,value:n});return new Zu(r).toPromise()}async function XL(t,e){const n=sf(t,!1).get(e),r=await new Zu(n).toPromise();return r===void 0?null:r.value}function TE(t,e){const n=sf(t,!0).delete(e);return new Zu(n).toPromise()}const ZL=800,eF=3;class Nx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Gm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>eF)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Rx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rf._getInstance(JL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await WL(),!this.activeServiceWorker)return;this.sender=new jL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||KL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Gm();return await vE(e,mh,"1"),await TE(e,mh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>vE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>XL(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>TE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=sf(i,!1).getAll();return new Zu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Nx.type="LOCAL";const tF=Nx;new Yu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bx(t,e){return e?Qr(e):(_e(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_ extends Ex{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return wa(e,this._buildIdpRequest())}_linkToIdToken(e,n){return wa(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return wa(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function nF(t){return FL(t.auth,new N_(t),t.bypassAuthState)}function rF(t){const{auth:e,user:n}=t;return _e(n,e,"internal-error"),LL(n,new N_(t),t.bypassAuthState)}async function iF(t){const{auth:e,user:n}=t;return _e(n,e,"internal-error"),VL(n,new N_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return nF;case"linkViaPopup":case"linkViaRedirect":return iF;case"reauthViaPopup":case"reauthViaRedirect":return rF;default:Dr(this.auth,"internal-error")}}resolve(e){si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF=new Yu(2e3,1e4);async function oF(t,e,n){if(ur(t.app))return Promise.reject(fr(t,"operation-not-supported-in-this-environment"));const r=nf(t);tL(t,e,P_);const i=bx(r,n);return new Js(r,"signInViaPopup",e,i).executeNotNull()}class Js extends Dx{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Js.currentPopupAction&&Js.currentPopupAction.cancel(),Js.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _e(e,this.auth,"internal-error"),e}async onExecution(){si(this.filter.length===1,"Popup operations only handle one event");const e=k_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(fr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(fr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Js.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sF.get())};e()}}Js.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aF="pendingRedirect",Id=new Map;class lF extends Dx{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Id.get(this.auth._key());if(!e){try{const r=await uF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Id.set(this.auth._key(),e)}return this.bypassAuthState||Id.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uF(t,e){const n=hF(e),r=dF(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function cF(t,e){Id.set(t._key(),e)}function dF(t){return Qr(t._redirectPersistence)}function hF(t){return wd(aF,t.config.apiKey,t.name)}async function fF(t,e,n=!1){if(ur(t.app))return Promise.reject(Zs(t));const r=nf(t),i=bx(r,e),o=await new lF(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF=10*60*1e3;class mF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!gF(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Mx(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(fr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=pF&&this.cachedEventUids.clear(),this.cachedEventUids.has(EE(e))}saveEventToCache(e){this.cachedEventUids.add(EE(e)),this.lastProcessedEventTime=Date.now()}}function EE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Mx({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function gF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Mx(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _F(t,e={}){return nl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vF=/^https?/;async function TF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _F(t);for(const n of e)try{if(EF(n))return}catch{}Dr(t,"unauthorized-domain")}function EF(t){const e=Om(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!vF.test(n))return!1;if(yF.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=new Yu(3e4,6e4);function wE(){const t=Nr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function IF(t){return new Promise((e,n)=>{var i,s,o;function r(){wE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wE(),n(fr(t,"network-request-failed"))},timeout:wF.get()})}if((s=(i=Nr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Nr().gapi)!=null&&o.load)r();else{const a=RL("iframefcb");return Nr()[a]=()=>{gapi.load?r():n(fr(t,"network-request-failed"))},CL(`${AL()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Sd=null,e})}let Sd=null;function SF(t){return Sd=Sd||IF(t),Sd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xF=new Yu(5e3,15e3),CF="__/auth/iframe",AF="emulator/auth/iframe",RF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kF(t){const e=t.config;_e(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?S_(e,AF):`https://${t.config.authDomain}/${CF}`,r={apiKey:e.apiKey,appName:t.name,v:tl},i=PF.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Qu(r).slice(1)}`}async function NF(t){const e=await SF(t),n=Nr().gapi;return _e(n,t,"internal-error"),e.open({where:document.body,url:kF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RF,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=fr(t,"network-request-failed"),a=Nr().setTimeout(()=>{s(o)},xF.get());function l(){Nr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DF=500,MF=600,VF="_blank",LF="http://localhost";class IE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FF(t,e,n,r=DF,i=MF){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...bF,width:r.toString(),height:i.toString(),top:s,left:o},u=Nt().toLowerCase();n&&(a=fx(u)?VF:n),dx(u)&&(e=e||LF,l.scrollbars="yes");const f=Object.entries(l).reduce((_,[v,E])=>`${_}${v}=${E},`,"");if(yL(u)&&a!=="_self")return UF(e||"",a),new IE(null);const m=window.open(e||"",a,f);_e(m,t,"popup-blocked");try{m.focus()}catch{}return new IE(m)}function UF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OF="__/auth/handler",BF="emulator/auth/handler",GF=encodeURIComponent("fac");async function SE(t,e,n,r,i,s){_e(t.config.authDomain,t,"auth-domain-config-required"),_e(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:tl,eventId:i};if(e instanceof P_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",O2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof Xu){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const l=await t._getAppCheckToken(),u=l?`#${GF}=${encodeURIComponent(l)}`:"";return`${qF(t)}?${Qu(a).slice(1)}${u}`}function qF({config:t}){return t.emulator?S_(t,BF):`https://${t.authDomain}/${OF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep="webStorageSupport";class zF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ax,this._completeRedirectFn=fF,this._overrideRedirectResult=cF}async _openPopup(e,n,r,i){var o;si((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await SE(e,n,r,Om(),i);return FF(e,s,k_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await SE(e,n,r,Om(),i);return HL(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(si(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await NF(e),r=new mF(e);return n.register("authEvent",i=>(_e(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ep,{type:Ep},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[Ep];s!==void 0&&n(!!s),Dr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=TF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return yx()||hx()||A_()}}const $F=zF;var xE="@firebase/auth",CE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){_e(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function WF(t){Na(new co("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;_e(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vx(t)},u=new SL(r,i,s,l);return kL(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Na(new co("auth-internal",e=>{const n=nf(e.getProvider("auth").getImmediate());return(r=>new jF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zi(xE,CE,HF(t)),Zi(xE,CE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF=5*60,JF=j0("authIdTokenMaxAge")||KF;let AE=null;const QF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>JF)return;const i=n==null?void 0:n.token;AE!==i&&(AE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function YF(t=tx()){const e=E_(t,"auth");if(e.isInitialized())return e.getImmediate();const n=PL(t,{popupRedirectResolver:$F,persistence:[tF,xx,Ax]}),r=j0("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=QF(s.toString());BL(n,o,()=>o(n.currentUser)),OL(n,a=>o(a))}}const i=z0("auth");return i&&NL(n,`http://${i}`),n}function XF(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}xL({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=fr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",XF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});WF("Browser");var RE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var es,Vx;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,x){function R(){}R.prototype=x.prototype,S.F=x.prototype,S.prototype=new R,S.prototype.constructor=S,S.D=function(N,D,F){for(var b=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)b[Se-2]=arguments[Se];return x.prototype[D].apply(N,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,x,R){R||(R=0);const N=Array(16);if(typeof x=="string")for(var D=0;D<16;++D)N[D]=x.charCodeAt(R++)|x.charCodeAt(R++)<<8|x.charCodeAt(R++)<<16|x.charCodeAt(R++)<<24;else for(D=0;D<16;++D)N[D]=x[R++]|x[R++]<<8|x[R++]<<16|x[R++]<<24;x=S.g[0],R=S.g[1],D=S.g[2];let F=S.g[3],b;b=x+(F^R&(D^F))+N[0]+3614090360&4294967295,x=R+(b<<7&4294967295|b>>>25),b=F+(D^x&(R^D))+N[1]+3905402710&4294967295,F=x+(b<<12&4294967295|b>>>20),b=D+(R^F&(x^R))+N[2]+606105819&4294967295,D=F+(b<<17&4294967295|b>>>15),b=R+(x^D&(F^x))+N[3]+3250441966&4294967295,R=D+(b<<22&4294967295|b>>>10),b=x+(F^R&(D^F))+N[4]+4118548399&4294967295,x=R+(b<<7&4294967295|b>>>25),b=F+(D^x&(R^D))+N[5]+1200080426&4294967295,F=x+(b<<12&4294967295|b>>>20),b=D+(R^F&(x^R))+N[6]+2821735955&4294967295,D=F+(b<<17&4294967295|b>>>15),b=R+(x^D&(F^x))+N[7]+4249261313&4294967295,R=D+(b<<22&4294967295|b>>>10),b=x+(F^R&(D^F))+N[8]+1770035416&4294967295,x=R+(b<<7&4294967295|b>>>25),b=F+(D^x&(R^D))+N[9]+2336552879&4294967295,F=x+(b<<12&4294967295|b>>>20),b=D+(R^F&(x^R))+N[10]+4294925233&4294967295,D=F+(b<<17&4294967295|b>>>15),b=R+(x^D&(F^x))+N[11]+2304563134&4294967295,R=D+(b<<22&4294967295|b>>>10),b=x+(F^R&(D^F))+N[12]+1804603682&4294967295,x=R+(b<<7&4294967295|b>>>25),b=F+(D^x&(R^D))+N[13]+4254626195&4294967295,F=x+(b<<12&4294967295|b>>>20),b=D+(R^F&(x^R))+N[14]+2792965006&4294967295,D=F+(b<<17&4294967295|b>>>15),b=R+(x^D&(F^x))+N[15]+1236535329&4294967295,R=D+(b<<22&4294967295|b>>>10),b=x+(D^F&(R^D))+N[1]+4129170786&4294967295,x=R+(b<<5&4294967295|b>>>27),b=F+(R^D&(x^R))+N[6]+3225465664&4294967295,F=x+(b<<9&4294967295|b>>>23),b=D+(x^R&(F^x))+N[11]+643717713&4294967295,D=F+(b<<14&4294967295|b>>>18),b=R+(F^x&(D^F))+N[0]+3921069994&4294967295,R=D+(b<<20&4294967295|b>>>12),b=x+(D^F&(R^D))+N[5]+3593408605&4294967295,x=R+(b<<5&4294967295|b>>>27),b=F+(R^D&(x^R))+N[10]+38016083&4294967295,F=x+(b<<9&4294967295|b>>>23),b=D+(x^R&(F^x))+N[15]+3634488961&4294967295,D=F+(b<<14&4294967295|b>>>18),b=R+(F^x&(D^F))+N[4]+3889429448&4294967295,R=D+(b<<20&4294967295|b>>>12),b=x+(D^F&(R^D))+N[9]+568446438&4294967295,x=R+(b<<5&4294967295|b>>>27),b=F+(R^D&(x^R))+N[14]+3275163606&4294967295,F=x+(b<<9&4294967295|b>>>23),b=D+(x^R&(F^x))+N[3]+4107603335&4294967295,D=F+(b<<14&4294967295|b>>>18),b=R+(F^x&(D^F))+N[8]+1163531501&4294967295,R=D+(b<<20&4294967295|b>>>12),b=x+(D^F&(R^D))+N[13]+2850285829&4294967295,x=R+(b<<5&4294967295|b>>>27),b=F+(R^D&(x^R))+N[2]+4243563512&4294967295,F=x+(b<<9&4294967295|b>>>23),b=D+(x^R&(F^x))+N[7]+1735328473&4294967295,D=F+(b<<14&4294967295|b>>>18),b=R+(F^x&(D^F))+N[12]+2368359562&4294967295,R=D+(b<<20&4294967295|b>>>12),b=x+(R^D^F)+N[5]+4294588738&4294967295,x=R+(b<<4&4294967295|b>>>28),b=F+(x^R^D)+N[8]+2272392833&4294967295,F=x+(b<<11&4294967295|b>>>21),b=D+(F^x^R)+N[11]+1839030562&4294967295,D=F+(b<<16&4294967295|b>>>16),b=R+(D^F^x)+N[14]+4259657740&4294967295,R=D+(b<<23&4294967295|b>>>9),b=x+(R^D^F)+N[1]+2763975236&4294967295,x=R+(b<<4&4294967295|b>>>28),b=F+(x^R^D)+N[4]+1272893353&4294967295,F=x+(b<<11&4294967295|b>>>21),b=D+(F^x^R)+N[7]+4139469664&4294967295,D=F+(b<<16&4294967295|b>>>16),b=R+(D^F^x)+N[10]+3200236656&4294967295,R=D+(b<<23&4294967295|b>>>9),b=x+(R^D^F)+N[13]+681279174&4294967295,x=R+(b<<4&4294967295|b>>>28),b=F+(x^R^D)+N[0]+3936430074&4294967295,F=x+(b<<11&4294967295|b>>>21),b=D+(F^x^R)+N[3]+3572445317&4294967295,D=F+(b<<16&4294967295|b>>>16),b=R+(D^F^x)+N[6]+76029189&4294967295,R=D+(b<<23&4294967295|b>>>9),b=x+(R^D^F)+N[9]+3654602809&4294967295,x=R+(b<<4&4294967295|b>>>28),b=F+(x^R^D)+N[12]+3873151461&4294967295,F=x+(b<<11&4294967295|b>>>21),b=D+(F^x^R)+N[15]+530742520&4294967295,D=F+(b<<16&4294967295|b>>>16),b=R+(D^F^x)+N[2]+3299628645&4294967295,R=D+(b<<23&4294967295|b>>>9),b=x+(D^(R|~F))+N[0]+4096336452&4294967295,x=R+(b<<6&4294967295|b>>>26),b=F+(R^(x|~D))+N[7]+1126891415&4294967295,F=x+(b<<10&4294967295|b>>>22),b=D+(x^(F|~R))+N[14]+2878612391&4294967295,D=F+(b<<15&4294967295|b>>>17),b=R+(F^(D|~x))+N[5]+4237533241&4294967295,R=D+(b<<21&4294967295|b>>>11),b=x+(D^(R|~F))+N[12]+1700485571&4294967295,x=R+(b<<6&4294967295|b>>>26),b=F+(R^(x|~D))+N[3]+2399980690&4294967295,F=x+(b<<10&4294967295|b>>>22),b=D+(x^(F|~R))+N[10]+4293915773&4294967295,D=F+(b<<15&4294967295|b>>>17),b=R+(F^(D|~x))+N[1]+2240044497&4294967295,R=D+(b<<21&4294967295|b>>>11),b=x+(D^(R|~F))+N[8]+1873313359&4294967295,x=R+(b<<6&4294967295|b>>>26),b=F+(R^(x|~D))+N[15]+4264355552&4294967295,F=x+(b<<10&4294967295|b>>>22),b=D+(x^(F|~R))+N[6]+2734768916&4294967295,D=F+(b<<15&4294967295|b>>>17),b=R+(F^(D|~x))+N[13]+1309151649&4294967295,R=D+(b<<21&4294967295|b>>>11),b=x+(D^(R|~F))+N[4]+4149444226&4294967295,x=R+(b<<6&4294967295|b>>>26),b=F+(R^(x|~D))+N[11]+3174756917&4294967295,F=x+(b<<10&4294967295|b>>>22),b=D+(x^(F|~R))+N[2]+718787259&4294967295,D=F+(b<<15&4294967295|b>>>17),b=R+(F^(D|~x))+N[9]+3951481745&4294967295,S.g[0]=S.g[0]+x&4294967295,S.g[1]=S.g[1]+(D+(b<<21&4294967295|b>>>11))&4294967295,S.g[2]=S.g[2]+D&4294967295,S.g[3]=S.g[3]+F&4294967295}r.prototype.v=function(S,x){x===void 0&&(x=S.length);const R=x-this.blockSize,N=this.C;let D=this.h,F=0;for(;F<x;){if(D==0)for(;F<=R;)i(this,S,F),F+=this.blockSize;if(typeof S=="string"){for(;F<x;)if(N[D++]=S.charCodeAt(F++),D==this.blockSize){i(this,N),D=0;break}}else for(;F<x;)if(N[D++]=S[F++],D==this.blockSize){i(this,N),D=0;break}}this.h=D,this.o+=x},r.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var x=1;x<S.length-8;++x)S[x]=0;x=this.o*8;for(var R=S.length-8;R<S.length;++R)S[R]=x&255,x/=256;for(this.v(S),S=Array(16),x=0,R=0;R<4;++R)for(let N=0;N<32;N+=8)S[x++]=this.g[R]>>>N&255;return S};function s(S,x){var R=a;return Object.prototype.hasOwnProperty.call(R,S)?R[S]:R[S]=x(S)}function o(S,x){this.h=x;const R=[];let N=!0;for(let D=S.length-1;D>=0;D--){const F=S[D]|0;N&&F==x||(R[D]=F,N=!1)}this.g=R}var a={};function l(S){return-128<=S&&S<128?s(S,function(x){return new o([x|0],x<0?-1:0)}):new o([S|0],S<0?-1:0)}function u(S){if(isNaN(S)||!isFinite(S))return m;if(S<0)return M(u(-S));const x=[];let R=1;for(let N=0;S>=R;N++)x[N]=S/R|0,R*=4294967296;return new o(x,0)}function f(S,x){if(S.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(S.charAt(0)=="-")return M(f(S.substring(1),x));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=u(Math.pow(x,8));let N=m;for(let F=0;F<S.length;F+=8){var D=Math.min(8,S.length-F);const b=parseInt(S.substring(F,F+D),x);D<8?(D=u(Math.pow(x,D)),N=N.j(D).add(u(b))):(N=N.j(R),N=N.add(u(b)))}return N}var m=l(0),_=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(P(this))return-M(this).m();let S=0,x=1;for(let R=0;R<this.g.length;R++){const N=this.i(R);S+=(N>=0?N:4294967296+N)*x,x*=4294967296}return S},t.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(E(this))return"0";if(P(this))return"-"+M(this).toString(S);const x=u(Math.pow(S,6));var R=this;let N="";for(;;){const D=V(R,x).g;R=C(R,D.j(x));let F=((R.g.length>0?R.g[0]:R.h)>>>0).toString(S);if(R=D,E(R))return F+N;for(;F.length<6;)F="0"+F;N=F+N}},t.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function E(S){if(S.h!=0)return!1;for(let x=0;x<S.g.length;x++)if(S.g[x]!=0)return!1;return!0}function P(S){return S.h==-1}t.l=function(S){return S=C(this,S),P(S)?-1:E(S)?0:1};function M(S){const x=S.g.length,R=[];for(let N=0;N<x;N++)R[N]=~S.g[N];return new o(R,~S.h).add(_)}t.abs=function(){return P(this)?M(this):this},t.add=function(S){const x=Math.max(this.g.length,S.g.length),R=[];let N=0;for(let D=0;D<=x;D++){let F=N+(this.i(D)&65535)+(S.i(D)&65535),b=(F>>>16)+(this.i(D)>>>16)+(S.i(D)>>>16);N=b>>>16,F&=65535,b&=65535,R[D]=b<<16|F}return new o(R,R[R.length-1]&-2147483648?-1:0)};function C(S,x){return S.add(M(x))}t.j=function(S){if(E(this)||E(S))return m;if(P(this))return P(S)?M(this).j(M(S)):M(M(this).j(S));if(P(S))return M(this.j(M(S)));if(this.l(v)<0&&S.l(v)<0)return u(this.m()*S.m());const x=this.g.length+S.g.length,R=[];for(var N=0;N<2*x;N++)R[N]=0;for(N=0;N<this.g.length;N++)for(let D=0;D<S.g.length;D++){const F=this.i(N)>>>16,b=this.i(N)&65535,Se=S.i(D)>>>16,Qe=S.i(D)&65535;R[2*N+2*D]+=b*Qe,w(R,2*N+2*D),R[2*N+2*D+1]+=F*Qe,w(R,2*N+2*D+1),R[2*N+2*D+1]+=b*Se,w(R,2*N+2*D+1),R[2*N+2*D+2]+=F*Se,w(R,2*N+2*D+2)}for(S=0;S<x;S++)R[S]=R[2*S+1]<<16|R[2*S];for(S=x;S<2*x;S++)R[S]=0;return new o(R,0)};function w(S,x){for(;(S[x]&65535)!=S[x];)S[x+1]+=S[x]>>>16,S[x]&=65535,x++}function A(S,x){this.g=S,this.h=x}function V(S,x){if(E(x))throw Error("division by zero");if(E(S))return new A(m,m);if(P(S))return x=V(M(S),x),new A(M(x.g),M(x.h));if(P(x))return x=V(S,M(x)),new A(M(x.g),x.h);if(S.g.length>30){if(P(S)||P(x))throw Error("slowDivide_ only works with positive integers.");for(var R=_,N=x;N.l(S)<=0;)R=q(R),N=q(N);var D=z(R,1),F=z(N,1);for(N=z(N,2),R=z(R,2);!E(N);){var b=F.add(N);b.l(S)<=0&&(D=D.add(R),F=b),N=z(N,1),R=z(R,1)}return x=C(S,D.j(x)),new A(D,x)}for(D=m;S.l(x)>=0;){for(R=Math.max(1,Math.floor(S.m()/x.m())),N=Math.ceil(Math.log(R)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),F=u(R),b=F.j(x);P(b)||b.l(S)>0;)R-=N,F=u(R),b=F.j(x);E(F)&&(F=_),D=D.add(F),S=C(S,b)}return new A(D,S)}t.B=function(S){return V(this,S).h},t.and=function(S){const x=Math.max(this.g.length,S.g.length),R=[];for(let N=0;N<x;N++)R[N]=this.i(N)&S.i(N);return new o(R,this.h&S.h)},t.or=function(S){const x=Math.max(this.g.length,S.g.length),R=[];for(let N=0;N<x;N++)R[N]=this.i(N)|S.i(N);return new o(R,this.h|S.h)},t.xor=function(S){const x=Math.max(this.g.length,S.g.length),R=[];for(let N=0;N<x;N++)R[N]=this.i(N)^S.i(N);return new o(R,this.h^S.h)};function q(S){const x=S.g.length+1,R=[];for(let N=0;N<x;N++)R[N]=S.i(N)<<1|S.i(N-1)>>>31;return new o(R,S.h)}function z(S,x){const R=x>>5;x%=32;const N=S.g.length-R,D=[];for(let F=0;F<N;F++)D[F]=x>0?S.i(F+R)>>>x|S.i(F+R+1)<<32-x:S.i(F+R);return new o(D,S.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Vx=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,es=o}).apply(typeof RE<"u"?RE:typeof self<"u"?self:typeof window<"u"?window:{});var ed=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Lx,Ul,Fx,xd,qm,Ux,Ox,Bx;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof ed=="object"&&ed];for(var g=0;g<c.length;++g){var y=c[g];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(c,g){if(g)e:{var y=r;c=c.split(".");for(var I=0;I<c.length-1;I++){var L=c[I];if(!(L in y))break e;y=y[L]}c=c[c.length-1],I=y[c],g=g(I),g!=I&&g!=null&&e(y,c,{configurable:!0,writable:!0,value:g})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(g){var y=[],I;for(I in g)Object.prototype.hasOwnProperty.call(g,I)&&y.push([I,g[I]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(c){var g=typeof c;return g=="object"&&c!=null||g=="function"}function l(c,g,y){return c.call.apply(c.bind,arguments)}function u(c,g,y){return u=l,u.apply(null,arguments)}function f(c,g){var y=Array.prototype.slice.call(arguments,1);return function(){var I=y.slice();return I.push.apply(I,arguments),c.apply(this,I)}}function m(c,g){function y(){}y.prototype=g.prototype,c.Z=g.prototype,c.prototype=new y,c.prototype.constructor=c,c.Ob=function(I,L,U){for(var Y=Array(arguments.length-2),de=2;de<arguments.length;de++)Y[de-2]=arguments[de];return g.prototype[L].apply(I,Y)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function v(c){const g=c.length;if(g>0){const y=Array(g);for(let I=0;I<g;I++)y[I]=c[I];return y}return[]}function E(c,g){for(let I=1;I<arguments.length;I++){const L=arguments[I];var y=typeof L;if(y=y!="object"?y:L?Array.isArray(L)?"array":y:"null",y=="array"||y=="object"&&typeof L.length=="number"){y=c.length||0;const U=L.length||0;c.length=y+U;for(let Y=0;Y<U;Y++)c[y+Y]=L[Y]}else c.push(L)}}class P{constructor(g,y){this.i=g,this.j=y,this.h=0,this.g=null}get(){let g;return this.h>0?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function M(c){o.setTimeout(()=>{throw c},0)}function C(){var c=S;let g=null;return c.g&&(g=c.g,c.g=c.g.next,c.g||(c.h=null),g.next=null),g}class w{constructor(){this.h=this.g=null}add(g,y){const I=A.get();I.set(g,y),this.h?this.h.next=I:this.g=I,this.h=I}}var A=new P(()=>new V,c=>c.reset());class V{constructor(){this.next=this.g=this.h=null}set(g,y){this.h=g,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let q,z=!1,S=new w,x=()=>{const c=Promise.resolve(void 0);q=()=>{c.then(R)}};function R(){for(var c;c=C();){try{c.h.call(c.g)}catch(y){M(y)}var g=A;g.j(c),g.h<100&&(g.h++,c.next=g.g,g.g=c)}z=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(c,g){this.type=c,this.g=this.target=g,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var F=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,g=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const y=()=>{};o.addEventListener("test",y,g),o.removeEventListener("test",y,g)}catch{}return c}();function b(c){return/^[\s\xa0]*$/.test(c)}function Se(c,g){D.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,g)}m(Se,D),Se.prototype.init=function(c,g){const y=this.type=c.type,I=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=g,g=c.relatedTarget,g||(y=="mouseover"?g=c.fromElement:y=="mouseout"&&(g=c.toElement)),this.relatedTarget=g,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Se.Z.h.call(this)},Se.prototype.h=function(){Se.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Qe="closure_listenable_"+(Math.random()*1e6|0),Fe=0;function Te(c,g,y,I,L){this.listener=c,this.proxy=null,this.src=g,this.type=y,this.capture=!!I,this.ha=L,this.key=++Fe,this.da=this.fa=!1}function Z(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ce(c,g,y){for(const I in c)g.call(y,c[I],I,c)}function he(c,g){for(const y in c)g.call(void 0,c[y],y,c)}function xe(c){const g={};for(const y in c)g[y]=c[y];return g}const Me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ct(c,g){let y,I;for(let L=1;L<arguments.length;L++){I=arguments[L];for(y in I)c[y]=I[y];for(let U=0;U<Me.length;U++)y=Me[U],Object.prototype.hasOwnProperty.call(I,y)&&(c[y]=I[y])}}function be(c){this.src=c,this.g={},this.h=0}be.prototype.add=function(c,g,y,I,L){const U=c.toString();c=this.g[U],c||(c=this.g[U]=[],this.h++);const Y=Ce(c,g,I,L);return Y>-1?(g=c[Y],y||(g.fa=!1)):(g=new Te(g,this.src,U,!!I,L),g.fa=y,c.push(g)),g};function Mt(c,g){const y=g.type;if(y in c.g){var I=c.g[y],L=Array.prototype.indexOf.call(I,g,void 0),U;(U=L>=0)&&Array.prototype.splice.call(I,L,1),U&&(Z(g),c.g[y].length==0&&(delete c.g[y],c.h--))}}function Ce(c,g,y,I){for(let L=0;L<c.length;++L){const U=c[L];if(!U.da&&U.listener==g&&U.capture==!!y&&U.ha==I)return L}return-1}var Oe="closure_lm_"+(Math.random()*1e6|0),Ut={};function Ot(c,g,y,I,L){if(Array.isArray(g)){for(let U=0;U<g.length;U++)Ot(c,g[U],y,I,L);return null}return y=Ae(y),c&&c[Qe]?c.J(g,y,a(I)?!!I.capture:!1,L):wn(c,g,y,!1,I,L)}function wn(c,g,y,I,L,U){if(!g)throw Error("Invalid event type");const Y=a(L)?!!L.capture:!!L;let de=In(c);if(de||(c[Oe]=de=new be(c)),y=de.add(g,y,I,Y,U),y.proxy)return y;if(I=Yn(),y.proxy=I,I.src=c,I.listener=y,c.addEventListener)F||(L=Y),L===void 0&&(L=!1),c.addEventListener(g.toString(),I,L);else if(c.attachEvent)c.attachEvent(Ke(g.toString()),I);else if(c.addListener&&c.removeListener)c.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return y}function Yn(){function c(y){return g.call(c.src,c.listener,y)}const g=yr;return c}function pt(c,g,y,I,L){if(Array.isArray(g))for(var U=0;U<g.length;U++)pt(c,g[U],y,I,L);else I=a(I)?!!I.capture:!!I,y=Ae(y),c&&c[Qe]?(c=c.i,U=String(g).toString(),U in c.g&&(g=c.g[U],y=Ce(g,y,I,L),y>-1&&(Z(g[y]),Array.prototype.splice.call(g,y,1),g.length==0&&(delete c.g[U],c.h--)))):c&&(c=In(c))&&(g=c.g[g.toString()],c=-1,g&&(c=Ce(g,y,I,L)),(y=c>-1?g[c]:null)&&oe(y))}function oe(c){if(typeof c!="number"&&c&&!c.da){var g=c.src;if(g&&g[Qe])Mt(g.i,c);else{var y=c.type,I=c.proxy;g.removeEventListener?g.removeEventListener(y,I,c.capture):g.detachEvent?g.detachEvent(Ke(y),I):g.addListener&&g.removeListener&&g.removeListener(I),(y=In(g))?(Mt(y,c),y.h==0&&(y.src=null,g[Oe]=null)):Z(c)}}}function Ke(c){return c in Ut?Ut[c]:Ut[c]="on"+c}function yr(c,g){if(c.da)c=!0;else{g=new Se(g,this);const y=c.listener,I=c.ha||c.src;c.fa&&oe(c),c=y.call(I,g)}return c}function In(c){return c=c[Oe],c instanceof be?c:null}var Xn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ae(c){return typeof c=="function"?c:(c[Xn]||(c[Xn]=function(g){return c.handleEvent(g)}),c[Xn])}function Be(){N.call(this),this.i=new be(this),this.M=this,this.G=null}m(Be,N),Be.prototype[Qe]=!0,Be.prototype.removeEventListener=function(c,g,y,I){pt(this,c,g,y,I)};function Ge(c,g){var y,I=c.G;if(I)for(y=[];I;I=I.G)y.push(I);if(c=c.M,I=g.type||g,typeof g=="string")g=new D(g,c);else if(g instanceof D)g.target=g.target||c;else{var L=g;g=new D(I,c),Ct(g,L)}L=!0;let U,Y;if(y)for(Y=y.length-1;Y>=0;Y--)U=g.g=y[Y],L=sn(U,I,!0,g)&&L;if(U=g.g=c,L=sn(U,I,!0,g)&&L,L=sn(U,I,!1,g)&&L,y)for(Y=0;Y<y.length;Y++)U=g.g=y[Y],L=sn(U,I,!1,g)&&L}Be.prototype.N=function(){if(Be.Z.N.call(this),this.i){var c=this.i;for(const g in c.g){const y=c.g[g];for(let I=0;I<y.length;I++)Z(y[I]);delete c.g[g],c.h--}}this.G=null},Be.prototype.J=function(c,g,y,I){return this.i.add(String(c),g,!1,y,I)},Be.prototype.K=function(c,g,y,I){return this.i.add(String(c),g,!0,y,I)};function sn(c,g,y,I){if(g=c.i.g[String(g)],!g)return!0;g=g.concat();let L=!0;for(let U=0;U<g.length;++U){const Y=g[U];if(Y&&!Y.da&&Y.capture==y){const de=Y.listener,$e=Y.ha||Y.src;Y.fa&&Mt(c.i,Y),L=de.call($e,I)!==!1&&L}}return L&&!I.defaultPrevented}function Zn(c,g){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(g)>2147483647?-1:o.setTimeout(c,g||0)}function mn(c){c.g=Zn(()=>{c.g=null,c.i&&(c.i=!1,mn(c))},c.l);const g=c.h;c.h=null,c.m.apply(null,g)}class on extends N{constructor(g,y){super(),this.m=g,this.l=y,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:mn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fn(c){N.call(this),this.h=c,this.g={}}m(Fn,N);var Je=[];function Es(c){ce(c.g,function(g,y){this.g.hasOwnProperty(y)&&oe(g)},c),c.g={}}Fn.prototype.N=function(){Fn.Z.N.call(this),Es(this)},Fn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vt=o.JSON.stringify,ge=o.JSON.parse,fi=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Lr(){}function vr(){}var Un={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Sn(){D.call(this,"d")}m(Sn,D);function Ee(){D.call(this,"c")}m(Ee,D);var xn={},er=null;function Fr(){return er=er||new Be}xn.Ia="serverreachability";function ae(c){D.call(this,xn.Ia,c)}m(ae,D);function et(c){const g=Fr();Ge(g,new ae(g))}xn.STAT_EVENT="statevent";function pi(c,g){D.call(this,xn.STAT_EVENT,c),this.stat=g}m(pi,D);function Bt(c){const g=Fr();Ge(g,new pi(g,c))}xn.Ja="timingevent";function mc(c,g){D.call(this,xn.Ja,c),this.size=g}m(mc,D);function ws(c,g){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},g)}function Ur(){this.g=!0}Ur.prototype.ua=function(){this.g=!1};function Is(c,g,y,I,L,U){c.info(function(){if(c.g)if(U){var Y="",de=U.split("&");for(let Ve=0;Ve<de.length;Ve++){var $e=de[Ve].split("=");if($e.length>1){const mt=$e[0];$e=$e[1];const At=mt.split("_");Y=At.length>=2&&At[1]=="type"?Y+(mt+"="+$e+"&"):Y+(mt+"=redacted&")}}}else Y=null;else Y=U;return"XMLHTTP REQ ("+I+") [attempt "+L+"]: "+g+`
`+y+`
`+Y})}function ol(c,g,y,I,L,U,Y){c.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+L+"]: "+g+`
`+y+`
`+U+" "+Y})}function mi(c,g,y,I){c.info(function(){return"XMLHTTP TEXT ("+g+"): "+gi(c,y)+(I?" "+I:"")})}function gc(c,g){c.info(function(){return"TIMEOUT: "+g})}Ur.prototype.info=function(){};function gi(c,g){if(!c.g)return g;if(!g)return null;try{const U=JSON.parse(g);if(U){for(c=0;c<U.length;c++)if(Array.isArray(U[c])){var y=U[c];if(!(y.length<2)){var I=y[1];if(Array.isArray(I)&&!(I.length<1)){var L=I[0];if(L!="noop"&&L!="stop"&&L!="close")for(let Y=1;Y<I.length;Y++)I[Y]=""}}}}return vt(U)}catch{return g}}var Tr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},_i={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},al;function yi(){}m(yi,Lr),yi.prototype.g=function(){return new XMLHttpRequest},al=new yi;function vi(c){return encodeURIComponent(String(c))}function Pf(c){var g=1;c=c.split(":");const y=[];for(;g>0&&c.length;)y.push(c.shift()),g--;return c.length&&y.push(c.join(":")),y}function tr(c,g,y,I){this.j=c,this.i=g,this.l=y,this.S=I||1,this.V=new Fn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Q}function Q(){this.i=null,this.g="",this.h=!1}var Ss={},_c={};function yc(c,g,y){c.M=1,c.A=Bn(nr(g)),c.u=y,c.R=!0,kf(c,null)}function kf(c,g){c.F=Date.now(),xo(c),c.B=nr(c.A);var y=c.B,I=c.S;Array.isArray(I)||(I=[String(I)]),Ii(y.i,"t",I),c.C=0,y=c.j.L,c.h=new Q,c.g=O(c.j,y?g:null,!c.u),c.P>0&&(c.O=new on(u(c.Y,c,c.g),c.P)),g=c.V,y=c.g,I=c.ba;var L="readystatechange";Array.isArray(L)||(L&&(Je[0]=L.toString()),L=Je);for(let U=0;U<L.length;U++){const Y=Ot(y,L[U],I||g.handleEvent,!1,g.h||g);if(!Y)break;g.g[Y.key]=Y}g=c.J?xe(c.J):{},c.u?(c.v||(c.v="POST"),g["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,g)):(c.v="GET",c.g.ea(c.B,c.v,null,g)),et(),Is(c.i,c.v,c.B,c.l,c.S,c.u)}tr.prototype.ba=function(c){c=c.target;const g=this.O;g&&wr(c)==3?g.j():this.Y(c)},tr.prototype.Y=function(c){try{if(c==this.g)e:{const de=wr(this.g),$e=this.g.ya(),Ve=this.g.ca();if(!(de<3)&&(de!=3||this.g&&(this.h.h||this.g.la()||Rc(this.g)))){this.K||de!=4||$e==7||($e==8||Ve<=0?et(3):et(2)),Cs(this);var g=this.g.ca();this.X=g;var y=Iy(this);if(this.o=g==200,ol(this.i,this.v,this.B,this.l,this.S,de,g),this.o){if(this.U&&!this.L){t:{if(this.g){var I,L=this.g;if((I=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(I)){var U=I;break t}}U=null}if(c=U)mi(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,As(this,c);else{this.o=!1,this.m=3,Bt(12),Or(this),Ye(this);break e}}if(this.R){c=!0;let mt;for(;!this.K&&this.C<y.length;)if(mt=So(this,y),mt==_c){de==4&&(this.m=4,Bt(14),c=!1),mi(this.i,this.l,null,"[Incomplete Response]");break}else if(mt==Ss){this.m=4,Bt(15),mi(this.i,this.l,y,"[Invalid Chunk]"),c=!1;break}else mi(this.i,this.l,mt,null),As(this,mt);if(vc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),de!=4||y.length!=0||this.h.h||(this.m=1,Bt(16),c=!1),this.o=this.o&&c,!c)mi(this.i,this.l,y,"[Invalid Chunked Response]"),Or(this),Ye(this);else if(y.length>0&&!this.W){this.W=!0;var Y=this.j;Y.g==this&&Y.aa&&!Y.P&&(Y.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),vl(Y),Y.P=!0,Bt(11))}}else mi(this.i,this.l,y,null),As(this,y);de==4&&Or(this),this.o&&!this.K&&(de==4?Dc(this.j,this):(this.o=!1,xo(this)))}else Bf(this.g),g==400&&y.indexOf("Unknown SID")>0?(this.m=3,Bt(12)):(this.m=0,Bt(13)),Or(this),Ye(this)}}}catch{}finally{}};function Iy(c){if(!vc(c))return c.g.la();const g=Rc(c.g);if(g==="")return"";let y="";const I=g.length,L=wr(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Or(c),Ye(c),"";c.h.i=new o.TextDecoder}for(let U=0;U<I;U++)c.h.h=!0,y+=c.h.i.decode(g[U],{stream:!(L&&U==I-1)});return g.length=0,c.h.g+=y,c.C=0,c.h.g}function vc(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function So(c,g){var y=c.C,I=g.indexOf(`
`,y);return I==-1?_c:(y=Number(g.substring(y,I)),isNaN(y)?Ss:(I+=1,I+y>g.length?_c:(g=g.slice(I,I+y),c.C=I+y,g)))}tr.prototype.cancel=function(){this.K=!0,Or(this)};function xo(c){c.T=Date.now()+c.H,xs(c,c.H)}function xs(c,g){if(c.D!=null)throw Error("WatchDog timer not null");c.D=ws(u(c.aa,c),g)}function Cs(c){c.D&&(o.clearTimeout(c.D),c.D=null)}tr.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(gc(this.i,this.B),this.M!=2&&(et(),Bt(17)),Or(this),this.m=2,Ye(this)):xs(this,this.T-c)};function Ye(c){c.j.I==0||c.K||Dc(c.j,c)}function Or(c){Cs(c);var g=c.O;g&&typeof g.dispose=="function"&&g.dispose(),c.O=null,Es(c.V),c.g&&(g=c.g,c.g=null,g.abort(),g.dispose())}function As(c,g){try{var y=c.j;if(y.I!=0&&(y.g==c||Ec(y.h,c))){if(!c.L&&Ec(y.h,c)&&y.I==3){try{var I=y.Ba.g.parse(g)}catch{I=null}if(Array.isArray(I)&&I.length==3){var L=I;if(L[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<c.F)Fo(y),Vo(y);else break e;yl(y),Bt(18)}}else y.xa=L[1],0<y.xa-y.K&&L[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=ws(u(y.Va,y),6e3));bf(y.h)<=1&&y.ta&&(y.ta=void 0)}else rr(y,11)}else if((c.L||y.g==c)&&Fo(y),!b(g))for(L=y.Ba.g.parse(g),g=0;g<L.length;g++){let Ve=L[g];const mt=Ve[0];if(!(mt<=y.K))if(y.K=mt,Ve=Ve[1],y.I==2)if(Ve[0]=="c"){y.M=Ve[1],y.ba=Ve[2];const At=Ve[3];At!=null&&(y.ka=At,y.j.info("VER="+y.ka));const Gt=Ve[4];Gt!=null&&(y.za=Gt,y.j.info("SVER="+y.za));const qt=Ve[5];qt!=null&&typeof qt=="number"&&qt>0&&(I=1.5*qt,y.O=I,y.j.info("backChannelRequestTimeoutMs_="+I)),I=y;const Tt=c.g;if(Tt){const bs=Tt.g?Tt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bs){var U=I.h;U.g||bs.indexOf("spdy")==-1&&bs.indexOf("quic")==-1&&bs.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(ul(U,U.h),U.h=null))}if(I.G){const Uo=Tt.g?Tt.g.getResponseHeader("X-HTTP-Session-Id"):null;Uo&&(I.wa=Uo,Xe(I.J,I.G,Uo))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-c.F,y.j.info("Handshake RTT: "+y.T+"ms")),I=y;var Y=c;if(I.na=k(I,I.L?I.ba:null,I.W),Y.L){Df(I.h,Y);var de=Y,$e=I.O;$e&&(de.H=$e),de.D&&(Cs(de),xo(de)),I.g=Y}else _l(I);y.i.length>0&&Lo(y)}else Ve[0]!="stop"&&Ve[0]!="close"||rr(y,7);else y.I==3&&(Ve[0]=="stop"||Ve[0]=="close"?Ve[0]=="stop"?rr(y,7):ml(y):Ve[0]!="noop"&&y.l&&y.l.qa(Ve),y.A=0)}}et(4)}catch{}}var ll=class{constructor(c,g){this.g=c,this.map=g}};function Tc(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Nf(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function bf(c){return c.h?1:c.g?c.g.size:0}function Ec(c,g){return c.h?c.h==g:c.g?c.g.has(g):!1}function ul(c,g){c.g?c.g.add(g):c.h=g}function Df(c,g){c.h&&c.h==g?c.h=null:c.g&&c.g.has(g)&&c.g.delete(g)}Tc.prototype.cancel=function(){if(this.i=cl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function cl(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let g=c.i;for(const y of c.g.values())g=g.concat(y.G);return g}return v(c.i)}var Co=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mf(c,g){if(c){c=c.split("&");for(let y=0;y<c.length;y++){const I=c[y].indexOf("=");let L,U=null;I>=0?(L=c[y].substring(0,I),U=c[y].substring(I+1)):L=c[y],g(L,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function On(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let g;c instanceof On?(this.l=c.l,Ao(this,c.j),this.o=c.o,this.g=c.g,Ti(this,c.u),this.h=c.h,Ro(this,Ps(c.i)),this.m=c.m):c&&(g=String(c).match(Co))?(this.l=!1,Ao(this,g[1]||"",!0),this.o=Ei(g[2]||""),this.g=Ei(g[3]||"",!0),Ti(this,g[4]),this.h=Ei(g[5]||"",!0),Ro(this,g[6]||"",!0),this.m=Ei(g[7]||"")):(this.l=!1,this.i=new Cn(null,this.l))}On.prototype.toString=function(){const c=[];var g=this.j;g&&c.push(Br(g,wc,!0),":");var y=this.g;return(y||g=="file")&&(c.push("//"),(g=this.o)&&c.push(Br(g,wc,!0),"@"),c.push(vi(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&c.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&c.push("/"),c.push(Br(y,y.charAt(0)=="/"?dl:Rs,!0))),(y=this.i.toString())&&c.push("?",y),(y=this.m)&&c.push("#",Br(y,ne)),c.join("")},On.prototype.resolve=function(c){const g=nr(this);let y=!!c.j;y?Ao(g,c.j):y=!!c.o,y?g.o=c.o:y=!!c.g,y?g.g=c.g:y=c.u!=null;var I=c.h;if(y)Ti(g,c.u);else if(y=!!c.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var L=g.h.lastIndexOf("/");L!=-1&&(I=g.h.slice(0,L+1)+I)}if(L=I,L==".."||L==".")I="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){I=L.lastIndexOf("/",0)==0,L=L.split("/");const U=[];for(let Y=0;Y<L.length;){const de=L[Y++];de=="."?I&&Y==L.length&&U.push(""):de==".."?((U.length>1||U.length==1&&U[0]!="")&&U.pop(),I&&Y==L.length&&U.push("")):(U.push(de),I=!0)}I=U.join("/")}else I=L}return y?g.h=I:y=c.i.toString()!=="",y?Ro(g,Ps(c.i)):y=!!c.m,y&&(g.m=c.m),g};function nr(c){return new On(c)}function Ao(c,g,y){c.j=y?Ei(g,!0):g,c.j&&(c.j=c.j.replace(/:$/,""))}function Ti(c,g){if(g){if(g=Number(g),isNaN(g)||g<0)throw Error("Bad port number "+g);c.u=g}else c.u=null}function Ro(c,g,y){g instanceof Cn?(c.i=g,Ff(c.i,c.l)):(y||(g=Br(g,Lf)),c.i=new Cn(g,c.l))}function Xe(c,g,y){c.i.set(g,y)}function Bn(c){return Xe(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Ei(c,g){return c?g?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Br(c,g,y){return typeof c=="string"?(c=encodeURI(c).replace(g,Vf),y&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Vf(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var wc=/[#\/\?@]/g,Rs=/[#\?:]/g,dl=/[#\?]/g,Lf=/[#\?@]/g,ne=/#/g;function Cn(c,g){this.h=this.g=null,this.i=c||null,this.j=!!g}function Gr(c){c.g||(c.g=new Map,c.h=0,c.i&&Mf(c.i,function(g,y){c.add(decodeURIComponent(g.replace(/\+/g," ")),y)}))}t=Cn.prototype,t.add=function(c,g){Gr(this),this.i=null,c=qr(this,c);let y=this.g.get(c);return y||this.g.set(c,y=[]),y.push(g),this.h+=1,this};function Po(c,g){Gr(c),g=qr(c,g),c.g.has(g)&&(c.i=null,c.h-=c.g.get(g).length,c.g.delete(g))}function Ic(c,g){return Gr(c),g=qr(c,g),c.g.has(g)}t.forEach=function(c,g){Gr(this),this.g.forEach(function(y,I){y.forEach(function(L){c.call(g,L,I,this)},this)},this)};function wi(c,g){Gr(c);let y=[];if(typeof g=="string")Ic(c,g)&&(y=y.concat(c.g.get(qr(c,g))));else for(c=Array.from(c.g.values()),g=0;g<c.length;g++)y=y.concat(c[g]);return y}t.set=function(c,g){return Gr(this),this.i=null,c=qr(this,c),Ic(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[g]),this.h+=1,this},t.get=function(c,g){return c?(c=wi(this,c),c.length>0?String(c[0]):g):g};function Ii(c,g,y){Po(c,g),y.length>0&&(c.i=null,c.g.set(qr(c,g),v(y)),c.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],g=Array.from(this.g.keys());for(let I=0;I<g.length;I++){var y=g[I];const L=vi(y);y=wi(this,y);for(let U=0;U<y.length;U++){let Y=L;y[U]!==""&&(Y+="="+vi(y[U])),c.push(Y)}}return this.i=c.join("&")};function Ps(c){const g=new Cn;return g.i=c.i,c.g&&(g.g=new Map(c.g),g.h=c.h),g}function qr(c,g){return g=String(g),c.j&&(g=g.toLowerCase()),g}function Ff(c,g){g&&!c.j&&(Gr(c),c.i=null,c.g.forEach(function(y,I){const L=I.toLowerCase();I!=L&&(Po(this,I),Ii(this,L,y))},c)),c.j=g}function Uf(c,g){const y=new Ur;if(o.Image){const I=new Image;I.onload=f(Er,y,"TestLoadImage: loaded",!0,g,I),I.onerror=f(Er,y,"TestLoadImage: error",!1,g,I),I.onabort=f(Er,y,"TestLoadImage: abort",!1,g,I),I.ontimeout=f(Er,y,"TestLoadImage: timeout",!1,g,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=c}else g(!1)}function Sc(c,g){const y=new Ur,I=new AbortController,L=setTimeout(()=>{I.abort(),Er(y,"TestPingServer: timeout",!1,g)},1e4);fetch(c,{signal:I.signal}).then(U=>{clearTimeout(L),U.ok?Er(y,"TestPingServer: ok",!0,g):Er(y,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(L),Er(y,"TestPingServer: error",!1,g)})}function Er(c,g,y,I,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),I(y)}catch{}}function xc(){this.g=new fi}function ko(c){this.i=c.Sb||null,this.h=c.ab||!1}m(ko,Lr),ko.prototype.g=function(){return new No(this.i,this.h)};function No(c,g){Be.call(this),this.H=c,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(No,Be),t=No.prototype,t.open=function(c,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=g,this.readyState=1,xi(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const g={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(g.body=c),(this.H||o).fetch(new Request(this.D,g)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Si(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,xi(this)),this.g&&(this.readyState=3,xi(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Cc(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Cc(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var g=c.value?c.value:new Uint8Array(0);(g=this.B.decode(g,{stream:!c.done}))&&(this.response=this.responseText+=g)}c.done?Si(this):xi(this),this.readyState==3&&Cc(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,Si(this))},t.Na=function(c){this.g&&(this.response=c,Si(this))},t.ga=function(){this.g&&Si(this)};function Si(c){c.readyState=4,c.l=null,c.j=null,c.B=null,xi(c)}t.setRequestHeader=function(c,g){this.A.append(c,g)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],g=this.h.entries();for(var y=g.next();!y.done;)y=y.value,c.push(y[0]+": "+y[1]),y=g.next();return c.join(`\r
`)};function xi(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(No.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function bo(c){let g="";return ce(c,function(y,I){g+=I,g+=":",g+=y,g+=`\r
`}),g}function Do(c,g,y){e:{for(I in y){var I=!1;break e}I=!0}I||(y=bo(y),typeof c=="string"?y!=null&&vi(y):Xe(c,g,y))}function it(c){Be.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(it,Be);var hl=/^https?$/i,Of=["POST","PUT"];t=it.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,g,y,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);g=g?g.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():al.g(),this.g.onreadystatechange=_(u(this.Ca,this));try{this.B=!0,this.g.open(g,String(c),!0),this.B=!1}catch(U){Ac(this,U);return}if(c=y||"",y=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var L in I)y.set(L,I[L]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const U of I.keys())y.set(U,I.get(U));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(y.keys()).find(U=>U.toLowerCase()=="content-type"),L=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Of,g,void 0)>=0)||I||L||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,Y]of y)this.g.setRequestHeader(U,Y);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(U){Ac(this,U)}};function Ac(c,g){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=g,c.o=5,fl(c),Mo(c)}function fl(c){c.A||(c.A=!0,Ge(c,"complete"),Ge(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,Ge(this,"complete"),Ge(this,"abort"),Mo(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mo(this,!0)),it.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?pl(this):this.Xa())},t.Xa=function(){pl(this)};function pl(c){if(c.h&&typeof s<"u"){if(c.v&&wr(c)==4)setTimeout(c.Ca.bind(c),0);else if(Ge(c,"readystatechange"),wr(c)==4){c.h=!1;try{const U=c.ca();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var y;if(!(y=g)){var I;if(I=U===0){let Y=String(c.D).match(Co)[1]||null;!Y&&o.self&&o.self.location&&(Y=o.self.location.protocol.slice(0,-1)),I=!hl.test(Y?Y.toLowerCase():"")}y=I}if(y)Ge(c,"complete"),Ge(c,"success");else{c.o=6;try{var L=wr(c)>2?c.g.statusText:""}catch{L=""}c.l=L+" ["+c.ca()+"]",fl(c)}}finally{Mo(c)}}}}function Mo(c,g){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const y=c.g;c.g=null,g||Ge(c,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function wr(c){return c.g?c.g.readyState:0}t.ca=function(){try{return wr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var g=this.g.responseText;return c&&g.indexOf(c)==0&&(g=g.substring(c.length)),ge(g)}};function Rc(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Bf(c){const g={};c=(c.g&&wr(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<c.length;I++){if(b(c[I]))continue;var y=Pf(c[I]);const L=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const U=g[L]||[];g[L]=U,U.push(y)}he(g,function(I){return I.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ks(c,g,y){return y&&y.internalChannelParams&&y.internalChannelParams[c]||g}function Pc(c){this.za=0,this.i=[],this.j=new Ur,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ks("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ks("baseRetryDelayMs",5e3,c),this.Za=ks("retryDelaySeedMs",1e4,c),this.Ta=ks("forwardChannelMaxRetries",2,c),this.va=ks("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Tc(c&&c.concurrentRequestLimit),this.Ba=new xc,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Pc.prototype,t.ka=8,t.I=1,t.connect=function(c,g,y,I){Bt(0),this.W=c,this.H=g||{},y&&I!==void 0&&(this.H.OSID=y,this.H.OAID=I),this.F=this.X,this.J=k(this,null,this.W),Lo(this)};function ml(c){if(kc(c),c.I==3){var g=c.V++,y=nr(c.J);if(Xe(y,"SID",c.M),Xe(y,"RID",g),Xe(y,"TYPE","terminate"),Ns(c,y),g=new tr(c,c.j,g),g.M=2,g.A=Bn(nr(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(g.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=g.A,y=!0),y||(g.g=O(g.j,null),g.g.ea(g.A)),g.F=Date.now(),xo(g)}T(c)}function Vo(c){c.g&&(vl(c),c.g.cancel(),c.g=null)}function kc(c){Vo(c),c.v&&(o.clearTimeout(c.v),c.v=null),Fo(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Lo(c){if(!Nf(c.h)&&!c.m){c.m=!0;var g=c.Ea;q||x(),z||(q(),z=!0),S.add(g,c),c.D=0}}function Gf(c,g){return bf(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=g.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=ws(u(c.Ea,c,g),Mc(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const L=new tr(this,this.j,c);let U=this.o;if(this.U&&(U?(U=xe(U),Ct(U,this.U)):U=this.U),this.u!==null||this.R||(L.J=U,U=null),this.S)e:{for(var g=0,y=0;y<this.i.length;y++){t:{var I=this.i[y];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(g+=I,g>4096){g=y;break e}if(g===4096||y===this.i.length-1){g=y+1;break e}}g=1e3}else g=1e3;g=Nc(this,L,g),y=nr(this.J),Xe(y,"RID",c),Xe(y,"CVER",22),this.G&&Xe(y,"X-HTTP-Session-Id",this.G),Ns(this,y),U&&(this.R?g="headers="+vi(bo(U))+"&"+g:this.u&&Do(y,this.u,U)),ul(this.h,L),this.Ra&&Xe(y,"TYPE","init"),this.S?(Xe(y,"$req",g),Xe(y,"SID","null"),L.U=!0,yc(L,y,null)):yc(L,y,g),this.I=2}}else this.I==3&&(c?gl(this,c):this.i.length==0||Nf(this.h)||gl(this))};function gl(c,g){var y;g?y=g.l:y=c.V++;const I=nr(c.J);Xe(I,"SID",c.M),Xe(I,"RID",y),Xe(I,"AID",c.K),Ns(c,I),c.u&&c.o&&Do(I,c.u,c.o),y=new tr(c,c.j,y,c.D+1),c.u===null&&(y.J=c.o),g&&(c.i=g.G.concat(c.i)),g=Nc(c,y,1e3),y.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),ul(c.h,y),yc(y,I,g)}function Ns(c,g){c.H&&ce(c.H,function(y,I){Xe(g,I,y)}),c.l&&ce({},function(y,I){Xe(g,I,y)})}function Nc(c,g,y){y=Math.min(c.i.length,y);const I=c.l?u(c.l.Ka,c.l,c):null;e:{var L=c.i;let de=-1;for(;;){const $e=["count="+y];de==-1?y>0?(de=L[0].g,$e.push("ofs="+de)):de=0:$e.push("ofs="+de);let Ve=!0;for(let mt=0;mt<y;mt++){var U=L[mt].g;const At=L[mt].map;if(U-=de,U<0)de=Math.max(0,L[mt].g-100),Ve=!1;else try{U="req"+U+"_"||"";try{var Y=At instanceof Map?At:Object.entries(At);for(const[Gt,qt]of Y){let Tt=qt;a(qt)&&(Tt=vt(qt)),$e.push(U+Gt+"="+encodeURIComponent(Tt))}}catch(Gt){throw $e.push(U+"type="+encodeURIComponent("_badmap")),Gt}}catch{I&&I(At)}}if(Ve){Y=$e.join("&");break e}}Y=void 0}return c=c.i.splice(0,y),g.G=c,Y}function _l(c){if(!c.g&&!c.v){c.Y=1;var g=c.Da;q||x(),z||(q(),z=!0),S.add(g,c),c.A=0}}function yl(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=ws(u(c.Da,c),Mc(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,bc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=ws(u(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Bt(10),Vo(this),bc(this))};function vl(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function bc(c){c.g=new tr(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var g=nr(c.na);Xe(g,"RID","rpc"),Xe(g,"SID",c.M),Xe(g,"AID",c.K),Xe(g,"CI",c.F?"0":"1"),!c.F&&c.ia&&Xe(g,"TO",c.ia),Xe(g,"TYPE","xmlhttp"),Ns(c,g),c.u&&c.o&&Do(g,c.u,c.o),c.O&&(c.g.H=c.O);var y=c.g;c=c.ba,y.M=1,y.A=Bn(nr(g)),y.u=null,y.R=!0,kf(y,c)}t.Va=function(){this.C!=null&&(this.C=null,Vo(this),yl(this),Bt(19))};function Fo(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function Dc(c,g){var y=null;if(c.g==g){Fo(c),vl(c),c.g=null;var I=2}else if(Ec(c.h,g))y=g.G,Df(c.h,g),I=1;else return;if(c.I!=0){if(g.o)if(I==1){y=g.u?g.u.length:0,g=Date.now()-g.F;var L=c.D;I=Fr(),Ge(I,new mc(I,y)),Lo(c)}else _l(c);else if(L=g.m,L==3||L==0&&g.X>0||!(I==1&&Gf(c,g)||I==2&&yl(c)))switch(y&&y.length>0&&(g=c.h,g.i=g.i.concat(y)),L){case 1:rr(c,5);break;case 4:rr(c,10);break;case 3:rr(c,6);break;default:rr(c,2)}}}function Mc(c,g){let y=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(y*=2),y*g}function rr(c,g){if(c.j.info("Error code "+g),g==2){var y=u(c.bb,c),I=c.Ua;const L=!I;I=new On(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ao(I,"https"),Bn(I),L?Uf(I.toString(),y):Sc(I.toString(),y)}else Bt(2);c.I=0,c.l&&c.l.pa(g),T(c),kc(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Bt(2)):(this.j.info("Failed to ping google.com"),Bt(1))};function T(c){if(c.I=0,c.ja=[],c.l){const g=cl(c.h);(g.length!=0||c.i.length!=0)&&(E(c.ja,g),E(c.ja,c.i),c.h.i.length=0,v(c.i),c.i.length=0),c.l.oa()}}function k(c,g,y){var I=y instanceof On?nr(y):new On(y);if(I.g!="")g&&(I.g=g+"."+I.g),Ti(I,I.u);else{var L=o.location;I=L.protocol,g=g?g+"."+L.hostname:L.hostname,L=+L.port;const U=new On(null);I&&Ao(U,I),g&&(U.g=g),L&&Ti(U,L),y&&(U.h=y),I=U}return y=c.G,g=c.wa,y&&g&&Xe(I,y,g),Xe(I,"VER",c.ka),Ns(c,I),I}function O(c,g,y){if(g&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return g=c.Aa&&!c.ma?new it(new ko({ab:y})):new it(c.ma),g.Fa(c.L),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function B(){}t=B.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function j(){}j.prototype.g=function(c,g){return new H(c,g)};function H(c,g){Be.call(this),this.g=new Pc(g),this.l=c,this.h=g&&g.messageUrlParams||null,c=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(c?c["X-WebChannel-Content-Type"]=g.messageContentType:c={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.sa&&(c?c["X-WebChannel-Client-Profile"]=g.sa:c={"X-WebChannel-Client-Profile":g.sa}),this.g.U=c,(c=g&&g.Qb)&&!b(c)&&(this.g.u=c),this.A=g&&g.supportsCrossDomainXhr||!1,this.v=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!b(g)&&(this.g.G=g,c=this.h,c!==null&&g in c&&(c=this.h,g in c&&delete c[g])),this.j=new W(this)}m(H,Be),H.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},H.prototype.close=function(){ml(this.g)},H.prototype.o=function(c){var g=this.g;if(typeof c=="string"){var y={};y.__data__=c,c=y}else this.v&&(y={},y.__data__=vt(c),c=y);g.i.push(new ll(g.Ya++,c)),g.I==3&&Lo(g)},H.prototype.N=function(){this.g.l=null,delete this.j,ml(this.g),delete this.g,H.Z.N.call(this)};function K(c){Sn.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var g=c.__sm__;if(g){e:{for(const y in g){c=y;break e}c=void 0}(this.i=c)&&(c=this.i,g=g!==null&&c in g?g[c]:void 0),this.data=g}else this.data=c}m(K,Sn);function X(){Ee.call(this),this.status=1}m(X,Ee);function W(c){this.g=c}m(W,B),W.prototype.ra=function(){Ge(this.g,"a")},W.prototype.qa=function(c){Ge(this.g,new K(c))},W.prototype.pa=function(c){Ge(this.g,new X)},W.prototype.oa=function(){Ge(this.g,"b")},j.prototype.createWebChannel=j.prototype.g,H.prototype.send=H.prototype.o,H.prototype.open=H.prototype.m,H.prototype.close=H.prototype.close,Bx=function(){return new j},Ox=function(){return Fr()},Ux=xn,qm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Tr.NO_ERROR=0,Tr.TIMEOUT=8,Tr.HTTP_ERROR=6,xd=Tr,_i.COMPLETE="complete",Fx=_i,vr.EventType=Un,Un.OPEN="a",Un.CLOSE="b",Un.ERROR="c",Un.MESSAGE="d",Be.prototype.listen=Be.prototype.J,Ul=vr,it.prototype.listenOnce=it.prototype.K,it.prototype.getLastError=it.prototype.Ha,it.prototype.getLastErrorCode=it.prototype.ya,it.prototype.getStatus=it.prototype.ca,it.prototype.getResponseJson=it.prototype.La,it.prototype.getResponseText=it.prototype.la,it.prototype.send=it.prototype.ea,it.prototype.setWithCredentials=it.prototype.Fa,Lx=it}).apply(typeof ed<"u"?ed:typeof self<"u"?self:typeof window<"u"?window:{});const PE="@firebase/firestore",kE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jt.UNAUTHENTICATED=new jt(null),jt.GOOGLE_CREDENTIALS=new jt("google-credentials-uid"),jt.FIRST_PARTY=new jt("first-party-uid"),jt.MOCK_USER=new jt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rl="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const os=new v_("@firebase/firestore");function Ho(){return os.logLevel}function Gx(t){os.setLogLevel(t)}function ee(t,...e){if(os.logLevel<=Pe.DEBUG){const n=e.map(b_);os.debug(`Firestore (${rl}): ${t}`,...n)}}function ln(t,...e){if(os.logLevel<=Pe.ERROR){const n=e.map(b_);os.error(`Firestore (${rl}): ${t}`,...n)}}function as(t,...e){if(os.logLevel<=Pe.WARN){const n=e.map(b_);os.warn(`Firestore (${rl}): ${t}`,...n)}}function b_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,qx(t,r,n)}function qx(t,e,n){let r=`FIRESTORE (${rl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ln(r),new Error(r)}function pe(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||qx(e,i,r)}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends ci{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $x{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(jt.UNAUTHENTICATED))}shutdown(){}}class ZF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class eU{constructor(e){this.t=e,this.currentUser=jt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){pe(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new br;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new br,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new br)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(pe(typeof r.accessToken=="string",31837,{l:r}),new zx(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pe(e===null||typeof e=="string",2055,{h:e}),new jt(e)}}class tU{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=jt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class nU{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new tU(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(jt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class NE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rU{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ur(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){pe(this.o===void 0,3512);const r=s=>{s.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new NE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(pe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new NE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=iU(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function ye(t,e){return t<e?-1:t>e?1:0}function zm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return wp(i)===wp(s)?ye(i,s):wp(i)?1:-1}return ye(t.length,e.length)}const sU=55296,oU=57343;function wp(t){const e=t.charCodeAt(0);return e>=sU&&e<=oU}function Da(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function jx(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE="__name__";class xr{constructor(e,n,r){n===void 0?n=0:n>e.length&&ue(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ue(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return xr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof xr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=xr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return ye(e.length,n.length)}static compareSegments(e,n){const r=xr.isNumericId(e),i=xr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?xr.extractNumericId(e).compare(xr.extractNumericId(n)):zm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return es.fromString(e.substring(4,e.length-2))}}class qe extends xr{construct(e,n,r){return new qe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(J.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new qe(n)}static emptyPath(){return new qe([])}}const aU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lt extends xr{construct(e,n,r){return new lt(e,n,r)}static isValidIdentifier(e){return aU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bE}static keyField(){return new lt([bE])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new re(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new re(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new re(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new lt(n)}static emptyPath(){return new lt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie(qe.fromString(e))}static fromName(e){return new ie(qe.fromString(e).popFirst(5))}static empty(){return new ie(qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return qe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new qe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hx(t,e,n){if(!n)throw new re(J.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Wx(t,e,n,r){if(e===!0&&r===!0)throw new re(J.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function DE(t){if(!ie.isDocumentKey(t))throw new re(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ME(t){if(ie.isDocumentKey(t))throw new re(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Kx(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function af(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ue(12329,{type:typeof t})}function dn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=af(t);throw new re(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t,e){const n={typeString:t};return e&&(n.value=e),n}function ec(t,e){if(!Kx(t))throw new re(J.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new re(J.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VE=-62135596800,LE=1e6;class ze{static now(){return ze.fromMillis(Date.now())}static fromDate(e){return ze.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*LE);return new ze(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<VE)throw new re(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/LE}_compareTo(e){return this.seconds===e.seconds?ye(this.nanoseconds,e.nanoseconds):ye(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ze._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ec(e,ze._jsonSchema))return new ze(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-VE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ze._jsonSchemaVersion="firestore/timestamp/1.0",ze._jsonSchema={type:xt("string",ze._jsonSchemaVersion),seconds:xt("number"),nanoseconds:xt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{static fromTimestamp(e){return new me(e)}static min(){return new me(new ze(0,0))}static max(){return new me(new ze(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nu=-1;class _h{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function $m(t){return t.fields.find(e=>e.kind===2)}function Os(t){return t.fields.filter(e=>e.kind!==2)}_h.UNKNOWN_ID=-1;class Cd{constructor(e,n){this.fieldPath=e,this.kind=n}}class bu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new bu(0,Mn.min())}}function lU(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=me.fromTimestamp(r===1e9?new ze(n+1,0):new ze(n,r));return new Mn(i,ie.empty(),e)}function Jx(t){return new Mn(t.readTime,t.key,Nu)}class Mn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Mn(me.min(),ie.empty(),Nu)}static max(){return new Mn(me.max(),ie.empty(),Nu)}}function D_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ie.comparator(t.documentKey,e.documentKey),n!==0?n:ye(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qx="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Yx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eo(t){if(t.code!==J.FAILED_PRECONDITION||t.message!==Qx)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ue(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(i=>i?$.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new $((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(f=>{o[u]=f,++a,a===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new $((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn="SimpleDb";class lf{static open(e,n,r,i){try{return new lf(n,e.transaction(i,r))}catch(s){throw new nu(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new br,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new nu(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=M_(r.target.error);this.S.reject(new nu(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ee(Rn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new cU(n)}}class ts{static delete(e){return ee(Rn,"Removing database:",e),qs(q0().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Y0())return!1;if(ts.F())return!0;const e=Nt(),n=ts.M(e),r=0<n&&n<10,i=Xx(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,ts.M(Nt())===12.2&&ln("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ee(Rn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new nu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new re(J.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new re(J.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new nu(e,o))},i.onupgradeneeded=s=>{ee(Rn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{ee(Rn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=lf.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),$.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(ee(Rn,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Xx(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class uU{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return qs(this.U.delete())}}class nu extends re{constructor(e,n){super(J.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function _s(t){return t.name==="IndexedDbTransactionError"}class cU{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ee(Rn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(ee(Rn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),qs(r)}add(e){return ee(Rn,"ADD",this.store.name,e,e),qs(this.store.add(e))}get(e){return qs(this.store.get(e)).next(n=>(n===void 0&&(n=null),ee(Rn,"GET",this.store.name,e,n),n))}delete(e){return ee(Rn,"DELETE",this.store.name,e),qs(this.store.delete(e))}count(){return ee(Rn,"COUNT",this.store.name),qs(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new $((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new $((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){ee(Rn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new $((r,i)=>{n.onerror=s=>{const o=M_(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new $((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new uU(a),u=n(a.primaryKey,a.value,l);if(u instanceof $){const f=u.catch(m=>(l.done(),$.reject(m)));r.push(f)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>$.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function qs(t){return new $((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=M_(r.target.error);n(i)}})}let FE=!1;function M_(t){const e=ts.M(Nt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return FE||(FE=!0,setTimeout(()=>{throw r},0)),r}}return t}const ru="IndexBackfiller";class dU{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ee(ru,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();ee(ru,`Documents written: ${n}`)}catch(n){_s(n)?ee(ru,"Ignoring IndexedDB error during index backfill: ",n):await Eo(n)}await this.re(6e4)})}}class hU{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return $.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return ee(ru,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(ee(ru,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=Jx(s);D_(o,r)>0&&(r=o)}),new Mn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}jn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo=-1;function uf(t){return t==null}function Du(t){return t===0&&1/t==-1/0}function fU(t){return typeof t=="number"&&Number.isInteger(t)&&!Du(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh="";function nn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=UE(e)),e=pU(t.get(n),e);return UE(e)}function pU(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case yh:n+="";break;default:n+=s}}return n}function UE(t){return t+yh+""}function Ar(t){const e=t.length;if(pe(e>=2,64408,{path:t}),e===2)return pe(t.charAt(0)===yh&&t.charAt(1)==="",56145,{path:t}),qe.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(yh,s);switch((o<0||o>n)&&ue(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:ue(61167,{path:t})}s=o+2}return new qe(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs="remoteDocuments",tc="owner",Bo="owner",Mu="mutationQueues",mU="userId",ar="mutations",OE="batchId",Qs="userMutationsIndex",BE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t,e){return[t,nn(e)]}function Zx(t,e,n){return[t,nn(e),n]}const gU={},Ma="documentMutations",vh="remoteDocumentsV14",_U=["prefixPath","collectionGroup","readTime","documentId"],Rd="documentKeyIndex",yU=["prefixPath","collectionGroup","documentId"],eC="collectionGroupIndex",vU=["collectionGroup","readTime","prefixPath","documentId"],Vu="remoteDocumentGlobal",jm="remoteDocumentGlobalKey",Va="targets",tC="queryTargetsIndex",TU=["canonicalId","targetId"],La="targetDocuments",EU=["targetId","path"],V_="documentTargetsIndex",wU=["path","targetId"],Th="targetGlobalKey",to="targetGlobal",Lu="collectionParents",IU=["collectionId","parent"],Fa="clientMetadata",SU="clientId",cf="bundles",xU="bundleId",df="namedQueries",CU="name",L_="indexConfiguration",AU="indexId",Hm="collectionGroupIndex",RU="collectionGroup",iu="indexState",PU=["indexId","uid"],nC="sequenceNumberIndex",kU=["uid","sequenceNumber"],su="indexEntries",NU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],rC="documentKeyIndex",bU=["indexId","uid","orderedDocumentKey"],hf="documentOverlays",DU=["userId","collectionPath","documentId"],Wm="collectionPathOverlayIndex",MU=["userId","collectionPath","largestBatchId"],iC="collectionGroupOverlayIndex",VU=["userId","collectionGroup","largestBatchId"],F_="globals",LU="name",sC=[Mu,ar,Ma,Bs,Va,tc,to,La,Fa,Vu,Lu,cf,df],FU=[...sC,hf],oC=[Mu,ar,Ma,vh,Va,tc,to,La,Fa,Vu,Lu,cf,df,hf],aC=oC,U_=[...aC,L_,iu,su],UU=U_,lC=[...U_,F_],OU=lC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km extends Yx{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Dt(t,e){const n=ve(t);return ts.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ys(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function uC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e,n){this.comparator=e,this.root=n||Ht.EMPTY}insert(e,n){return new ut(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ht.BLACK,null,null))}remove(e){return new ut(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ht.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new td(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new td(this.root,e,this.comparator,!1)}getReverseIterator(){return new td(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new td(this.root,e,this.comparator,!0)}}class td{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ht{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ht.RED,this.left=i??Ht.EMPTY,this.right=s??Ht.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ht(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ht.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ht.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ue(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ue(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ue(27949);return e+(this.isRed()?0:1)}}Ht.EMPTY=null,Ht.RED=!0,Ht.BLACK=!1;Ht.EMPTY=new class{constructor(){this.size=0}get key(){throw ue(57766)}get value(){throw ue(16141)}get color(){throw ue(16727)}get left(){throw ue(29726)}get right(){throw ue(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ht(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.comparator=e,this.data=new ut(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new qE(this.data.getIterator())}getIteratorFrom(e){return new qE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof We)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new We(this.comparator);return n.data=e,n}}class qE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Go(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.fields=e,e.sort(lt.comparator)}static empty(){return new yn([])}unionWith(e){let n=new We(lt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new yn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Da(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new cC("Invalid base64 string: "+s):s}}(e);return new wt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new wt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ye(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}wt.EMPTY_BYTE_STRING=new wt("");const BU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oi(t){if(pe(!!t,39018),typeof t=="string"){let e=0;const n=BU.exec(t);if(pe(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ot(t.seconds),nanos:ot(t.nanos)}}function ot(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ai(t){return typeof t=="string"?wt.fromBase64String(t):wt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC="server_timestamp",hC="__type__",fC="__previous_value__",pC="__local_write_time__";function O_(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[hC])==null?void 0:r.stringValue)===dC}function ff(t){const e=t.mapValue.fields[fC];return O_(e)?ff(e):e}function Fu(t){const e=oi(t.mapValue.fields[pC].timestampValue);return new ze(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(e,n,r,i,s,o,a,l,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=f}}const Eh="(default)";class ls{constructor(e,n){this.projectId=e,this.database=n||Eh}static empty(){return new ls("","")}get isDefaultDatabase(){return this.database===Eh}isEqual(e){return e instanceof ls&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_="__type__",mC="__max__",qi={mapValue:{fields:{__type__:{stringValue:mC}}}},G_="__vector__",Ua="value",Pd={nullValue:"NULL_VALUE"};function us(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?O_(t)?4:gC(t)?9007199254740991:pf(t)?10:11:ue(28295,{value:t})}function Mr(t,e){if(t===e)return!0;const n=us(t);if(n!==us(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Fu(t).isEqual(Fu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=oi(i.timestampValue),a=oi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ai(i.bytesValue).isEqual(ai(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ot(i.geoPointValue.latitude)===ot(s.geoPointValue.latitude)&&ot(i.geoPointValue.longitude)===ot(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ot(i.integerValue)===ot(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ot(i.doubleValue),a=ot(s.doubleValue);return o===a?Du(o)===Du(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Da(t.arrayValue.values||[],e.arrayValue.values||[],Mr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(GE(o)!==GE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Mr(o[l],a[l])))return!1;return!0}(t,e);default:return ue(52216,{left:t})}}function Uu(t,e){return(t.values||[]).find(n=>Mr(n,e))!==void 0}function cs(t,e){if(t===e)return 0;const n=us(t),r=us(e);if(n!==r)return ye(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ye(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ot(s.integerValue||s.doubleValue),l=ot(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return zE(t.timestampValue,e.timestampValue);case 4:return zE(Fu(t),Fu(e));case 5:return zm(t.stringValue,e.stringValue);case 6:return function(s,o){const a=ai(s),l=ai(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const f=ye(a[u],l[u]);if(f!==0)return f}return ye(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ye(ot(s.latitude),ot(o.latitude));return a!==0?a:ye(ot(s.longitude),ot(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return $E(t.arrayValue,e.arrayValue);case 10:return function(s,o){var _,v,E,P;const a=s.fields||{},l=o.fields||{},u=(_=a[Ua])==null?void 0:_.arrayValue,f=(v=l[Ua])==null?void 0:v.arrayValue,m=ye(((E=u==null?void 0:u.values)==null?void 0:E.length)||0,((P=f==null?void 0:f.values)==null?void 0:P.length)||0);return m!==0?m:$E(u,f)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===qi.mapValue&&o===qi.mapValue)return 0;if(s===qi.mapValue)return 1;if(o===qi.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let m=0;m<l.length&&m<f.length;++m){const _=zm(l[m],f[m]);if(_!==0)return _;const v=cs(a[l[m]],u[f[m]]);if(v!==0)return v}return ye(l.length,f.length)}(t.mapValue,e.mapValue);default:throw ue(23264,{he:n})}}function zE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ye(t,e);const n=oi(t),r=oi(e),i=ye(n.seconds,r.seconds);return i!==0?i:ye(n.nanos,r.nanos)}function $E(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=cs(n[i],r[i]);if(s)return s}return ye(n.length,r.length)}function Oa(t){return Jm(t)}function Jm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=oi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ai(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Jm(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Jm(n.fields[o])}`;return i+"}"}(t.mapValue):ue(61005,{value:t})}function kd(t){switch(us(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ff(t);return e?16+kd(e):16;case 5:return 2*t.stringValue.length;case 6:return ai(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+kd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return ys(r.fields,(s,o)=>{i+=s.length+kd(o)}),i}(t.mapValue);default:throw ue(13486,{value:t})}}function Ou(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Qm(t){return!!t&&"integerValue"in t}function Bu(t){return!!t&&"arrayValue"in t}function jE(t){return!!t&&"nullValue"in t}function HE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Nd(t){return!!t&&"mapValue"in t}function pf(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[B_])==null?void 0:r.stringValue)===G_}function ou(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ys(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ou(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ou(t.arrayValue.values[n]);return e}return{...t}}function gC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===mC}const _C={mapValue:{fields:{[B_]:{stringValue:G_},[Ua]:{arrayValue:{}}}}};function qU(t){return"nullValue"in t?Pd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ou(ls.empty(),ie.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?pf(t)?_C:{mapValue:{}}:ue(35942,{value:t})}function zU(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ou(ls.empty(),ie.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?_C:"mapValue"in t?pf(t)?{mapValue:{}}:qi:ue(61959,{value:t})}function WE(t,e){const n=cs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function KE(t,e){const n=cs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.value=e}static empty(){return new en({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Nd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ou(n)}setAll(e){let n=lt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ou(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Nd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Nd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ys(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new en(ou(this.value))}}function yC(t){const e=[];return ys(t.fields,(n,r)=>{const i=new lt([n]);if(Nd(r)){const s=yC(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new yn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new yt(e,0,me.min(),me.min(),me.min(),en.empty(),0)}static newFoundDocument(e,n,r,i){return new yt(e,1,n,me.min(),r,i,0)}static newNoDocument(e,n){return new yt(e,2,n,me.min(),me.min(),en.empty(),0)}static newUnknownDocument(e,n){return new yt(e,3,n,me.min(),me.min(),en.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=en.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=en.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e,n){this.position=e,this.inclusive=n}}function JE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ie.comparator(ie.fromName(o.referenceValue),n.key):r=cs(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function QE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e,n="asc"){this.field=e,this.dir=n}}function $U(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{}class ke extends vC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new jU(e,n,r):n==="array-contains"?new KU(e,r):n==="in"?new xC(e,r):n==="not-in"?new JU(e,r):n==="array-contains-any"?new QU(e,r):new ke(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new HU(e,r):new WU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(cs(n,this.value)):n!==null&&us(this.value)===us(n)&&this.matchesComparison(cs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class je extends vC{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new je(e,n)}matches(e){return Ga(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ga(t){return t.op==="and"}function Ym(t){return t.op==="or"}function q_(t){return TC(t)&&Ga(t)}function TC(t){for(const e of t.filters)if(e instanceof je)return!1;return!0}function Xm(t){if(t instanceof ke)return t.field.canonicalString()+t.op.toString()+Oa(t.value);if(q_(t))return t.filters.map(e=>Xm(e)).join(",");{const e=t.filters.map(n=>Xm(n)).join(",");return`${t.op}(${e})`}}function EC(t,e){return t instanceof ke?function(r,i){return i instanceof ke&&r.op===i.op&&r.field.isEqual(i.field)&&Mr(r.value,i.value)}(t,e):t instanceof je?function(r,i){return i instanceof je&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&EC(o,i.filters[a]),!0):!1}(t,e):void ue(19439)}function wC(t,e){const n=t.filters.concat(e);return je.create(n,t.op)}function IC(t){return t instanceof ke?function(n){return`${n.field.canonicalString()} ${n.op} ${Oa(n.value)}`}(t):t instanceof je?function(n){return n.op.toString()+" {"+n.getFilters().map(IC).join(" ,")+"}"}(t):"Filter"}class jU extends ke{constructor(e,n,r){super(e,n,r),this.key=ie.fromName(r.referenceValue)}matches(e){const n=ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class HU extends ke{constructor(e,n){super(e,"in",n),this.keys=SC("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class WU extends ke{constructor(e,n){super(e,"not-in",n),this.keys=SC("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function SC(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ie.fromName(r.referenceValue))}class KU extends ke{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Bu(n)&&Uu(n.arrayValue,this.value)}}class xC extends ke{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Uu(this.value.arrayValue,n)}}class JU extends ke{constructor(e,n){super(e,"not-in",n)}matches(e){if(Uu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Uu(this.value.arrayValue,n)}}class QU extends ke{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Bu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Uu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Zm(t,e=null,n=[],r=[],i=null,s=null,o=null){return new YU(t,e,n,r,i,s,o)}function fo(t){const e=ve(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Xm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),uf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Oa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Oa(r)).join(",")),e.Te=n}return e.Te}function nc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!$U(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!EC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!QE(t.startAt,e.startAt)&&QE(t.endAt,e.endAt)}function Ih(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Sh(t,e){return t.filters.filter(n=>n instanceof ke&&n.field.isEqual(e))}function YE(t,e,n){let r=Pd,i=!0;for(const s of Sh(t,e)){let o=Pd,a=!0;switch(s.op){case"<":case"<=":o=qU(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Pd}WE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];WE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function XE(t,e,n){let r=qi,i=!0;for(const s of Sh(t,e)){let o=qi,a=!0;switch(s.op){case">=":case">":o=zU(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=qi}KE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];KE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function XU(t,e,n,r,i,s,o,a){return new rc(t,e,n,r,i,s,o,a)}function ic(t){return new rc(t)}function ZE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function CC(t){return t.collectionGroup!==null}function au(t){const e=ve(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new We(lt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new wh(s,r))}),n.has(lt.keyField().canonicalString())||e.Ie.push(new wh(lt.keyField(),r))}return e.Ie}function Kn(t){const e=ve(t);return e.Ee||(e.Ee=ZU(e,au(t))),e.Ee}function ZU(t,e){if(t.limitType==="F")return Zm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new wh(i.field,s)});const n=t.endAt?new Ba(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ba(t.startAt.position,t.startAt.inclusive):null;return Zm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function eg(t,e){const n=t.filters.concat([e]);return new rc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function tg(t,e,n){return new rc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mf(t,e){return nc(Kn(t),Kn(e))&&t.limitType===e.limitType}function AC(t){return`${fo(Kn(t))}|lt:${t.limitType}`}function Wo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>IC(i)).join(", ")}]`),uf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Oa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Oa(i)).join(",")),`Target(${r})`}(Kn(t))}; limitType=${t.limitType})`}function sc(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ie.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of au(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=JE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,au(r),i)||r.endAt&&!function(o,a,l){const u=JE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,au(r),i))}(t,e)}function e4(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function RC(t){return(e,n)=>{let r=!1;for(const i of au(t)){const s=t4(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function t4(t,e,n){const r=t.field.isKeyField()?ie.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?cs(l,u):ue(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ue(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ys(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return uC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4=new ut(ie.comparator);function Nn(){return n4}const PC=new ut(ie.comparator);function Ol(...t){let e=PC;for(const n of t)e=e.insert(n.key,n);return e}function kC(t){let e=PC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Rr(){return lu()}function NC(){return lu()}function lu(){return new di(t=>t.toString(),(t,e)=>t.isEqual(e))}const r4=new ut(ie.comparator),i4=new We(ie.comparator);function Ie(...t){let e=i4;for(const n of t)e=e.add(n);return e}const s4=new We(ye);function o4(){return s4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Du(e)?"-0":e}}function bC(t){return{integerValue:""+t}}function a4(t,e){return fU(e)?bC(e):z_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(){this._=void 0}}function l4(t,e,n){return t instanceof qa?function(i,s){const o={fields:{[hC]:{stringValue:dC},[pC]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&O_(s)&&(s=ff(s)),s&&(o.fields[fC]=s),{mapValue:o}}(n,e):t instanceof za?MC(t,e):t instanceof $a?VC(t,e):function(i,s){const o=DC(i,s),a=ew(o)+ew(i.Ae);return Qm(o)&&Qm(i.Ae)?bC(a):z_(i.serializer,a)}(t,e)}function u4(t,e,n){return t instanceof za?MC(t,e):t instanceof $a?VC(t,e):n}function DC(t,e){return t instanceof Gu?function(r){return Qm(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class qa extends gf{}class za extends gf{constructor(e){super(),this.elements=e}}function MC(t,e){const n=LC(e);for(const r of t.elements)n.some(i=>Mr(i,r))||n.push(r);return{arrayValue:{values:n}}}class $a extends gf{constructor(e){super(),this.elements=e}}function VC(t,e){let n=LC(e);for(const r of t.elements)n=n.filter(i=>!Mr(i,r));return{arrayValue:{values:n}}}class Gu extends gf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function ew(t){return ot(t.integerValue||t.doubleValue)}function LC(t){return Bu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(e,n){this.field=e,this.transform=n}}function c4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof za&&i instanceof za||r instanceof $a&&i instanceof $a?Da(r.elements,i.elements,Mr):r instanceof Gu&&i instanceof Gu?Mr(r.Ae,i.Ae):r instanceof qa&&i instanceof qa}(t.transform,e.transform)}class d4{constructor(e,n){this.version=e,this.transformResults=n}}class un{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new un}static exists(e){return new un(void 0,e)}static updateTime(e){return new un(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class _f{}function UC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new yf(t.key,un.none()):new il(t.key,t.data,un.none());{const n=t.data,r=en.empty();let i=new We(lt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new hi(t.key,r,new yn(i.toArray()),un.none())}}function h4(t,e,n){t instanceof il?function(i,s,o){const a=i.value.clone(),l=nw(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof hi?function(i,s,o){if(!bd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=nw(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(OC(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function uu(t,e,n,r){return t instanceof il?function(s,o,a,l){if(!bd(s.precondition,o))return a;const u=s.value.clone(),f=rw(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof hi?function(s,o,a,l){if(!bd(s.precondition,o))return a;const u=rw(s.fieldTransforms,l,o),f=o.data;return f.setAll(OC(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(s,o,a){return bd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function f4(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=DC(r.transform,i||null);s!=null&&(n===null&&(n=en.empty()),n.set(r.field,s))}return n||null}function tw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Da(r,i,(s,o)=>c4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class il extends _f{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class hi extends _f{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function OC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function nw(t,e,n){const r=new Map;pe(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,u4(o,a,n[i]))}return r}function rw(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,l4(s,o,e))}return r}class yf extends _f{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class BC extends _f{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&h4(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=uu(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=uu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=NC();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=UC(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(me.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ie())}isEqual(e){return this.batchId===e.batchId&&Da(this.mutations,e.mutations,(n,r)=>tw(n,r))&&Da(this.baseMutations,e.baseMutations,(n,r)=>tw(n,r))}}class j_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){pe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return r4}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new j_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It,De;function m4(t){switch(t){case J.OK:return ue(64938);case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0;default:return ue(15467,{code:t})}}function GC(t){if(t===void 0)return ln("GRPC error has no .code"),J.UNKNOWN;switch(t){case It.OK:return J.OK;case It.CANCELLED:return J.CANCELLED;case It.UNKNOWN:return J.UNKNOWN;case It.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case It.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case It.INTERNAL:return J.INTERNAL;case It.UNAVAILABLE:return J.UNAVAILABLE;case It.UNAUTHENTICATED:return J.UNAUTHENTICATED;case It.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case It.NOT_FOUND:return J.NOT_FOUND;case It.ALREADY_EXISTS:return J.ALREADY_EXISTS;case It.PERMISSION_DENIED:return J.PERMISSION_DENIED;case It.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case It.ABORTED:return J.ABORTED;case It.OUT_OF_RANGE:return J.OUT_OF_RANGE;case It.UNIMPLEMENTED:return J.UNIMPLEMENTED;case It.DATA_LOSS:return J.DATA_LOSS;default:return ue(39323,{code:t})}}(De=It||(It={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=new es([4294967295,4294967295],0);function iw(t){const e=g4().encode(t),n=new Vx;return n.update(e),new Uint8Array(n.digest())}function sw(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new es([n,r],0),new es([i,s],0)]}class W_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Bl(`Invalid padding: ${n}`);if(r<0)throw new Bl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Bl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Bl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=es.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(es.fromNumber(r)));return i.compare(_4)===1&&(i=new es([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=iw(e),[r,i]=sw(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new W_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=iw(e),[r,i]=sw(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Bl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,oc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new vf(me.min(),i,new ut(ye),Nn(),Ie())}}class oc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new oc(r,n,Ie(),Ie(),Ie())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class qC{constructor(e,n){this.targetId=e,this.Ce=n}}class zC{constructor(e,n,r=wt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class ow{constructor(){this.ve=0,this.Fe=aw(),this.Me=wt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ie(),n=Ie(),r=Ie();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ue(38017,{changeType:s})}}),new oc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=aw()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,pe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class y4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Nn(),this.Je=nd(),this.He=nd(),this.Ye=new ut(ye)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ue(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(Ih(s))if(r===0){const o=new ie(s.path);this.et(n,o,yt.newNoDocument(o,me.min()))}else pe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=ai(r).toUint8Array()}catch(l){if(l instanceof cC)return as("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new W_(o,i,s)}catch(l){return as(l instanceof Bl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&Ih(a.target)){const l=new ie(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,yt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Ie();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new vf(e,n,this.Ye,this.je,r);return this.je=Nn(),this.Je=nd(),this.He=nd(),this.Ye=new ut(ye),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new ow,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new We(ye),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new We(ye),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ow),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function nd(){return new ut(ie.comparator)}function aw(){return new ut(ie.comparator)}const v4={asc:"ASCENDING",desc:"DESCENDING"},T4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},E4={and:"AND",or:"OR"};class w4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ng(t,e){return t.useProto3Json||uf(e)?e:{value:e}}function ja(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $C(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function I4(t,e){return ja(t,e.toTimestamp())}function hn(t){return pe(!!t,49232),me.fromTimestamp(function(n){const r=oi(n);return new ze(r.seconds,r.nanos)}(t))}function K_(t,e){return rg(t,e).canonicalString()}function rg(t,e){const n=function(i){return new qe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function jC(t){const e=qe.fromString(t);return pe(eA(e),10190,{key:e.toString()}),e}function xh(t,e){return K_(t.databaseId,e.path)}function no(t,e){const n=jC(e);if(n.get(1)!==t.databaseId.projectId)throw new re(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ie(KC(n))}function HC(t,e){return K_(t.databaseId,e)}function WC(t){const e=jC(t);return e.length===4?qe.emptyPath():KC(e)}function ig(t){return new qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function KC(t){return pe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function lw(t,e,n){return{name:xh(t,e),fields:n.value.mapValue.fields}}function S4(t,e,n){const r=no(t,e.name),i=hn(e.updateTime),s=e.createTime?hn(e.createTime):me.min(),o=new en({mapValue:{fields:e.fields}}),a=yt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function x4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ue(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(pe(f===void 0||typeof f=="string",58123),wt.fromBase64String(f||"")):(pe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),wt.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const f=u.code===void 0?J.UNKNOWN:GC(u.code);return new re(f,u.message||"")}(o);n=new zC(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=no(t,r.document.name),s=hn(r.document.updateTime),o=r.document.createTime?hn(r.document.createTime):me.min(),a=new en({mapValue:{fields:r.document.fields}}),l=yt.newFoundDocument(i,s,o,a),u=r.targetIds||[],f=r.removedTargetIds||[];n=new Dd(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=no(t,r.document),s=r.readTime?hn(r.readTime):me.min(),o=yt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Dd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=no(t,r.document),s=r.removedTargetIds||[];n=new Dd([],s,i,null)}else{if(!("filter"in e))return ue(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new p4(i,s),a=r.targetId;n=new qC(a,o)}}return n}function Ch(t,e){let n;if(e instanceof il)n={update:lw(t,e.key,e.value)};else if(e instanceof yf)n={delete:xh(t,e.key)};else if(e instanceof hi)n={update:lw(t,e.key,e.data),updateMask:N4(e.fieldMask)};else{if(!(e instanceof BC))return ue(16599,{Vt:e.type});n={verify:xh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof qa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof za)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof $a)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Gu)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw ue(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:I4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ue(27497)}(t,e.precondition)),n}function sg(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?un.updateTime(hn(s.updateTime)):s.exists!==void 0?un.exists(s.exists):un.none()}(e.currentDocument):un.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)pe(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new qa;else if("appendMissingElements"in a){const f=a.appendMissingElements.values||[];l=new za(f)}else if("removeAllFromArray"in a){const f=a.removeAllFromArray.values||[];l=new $a(f)}else"increment"in a?l=new Gu(o,a.increment):ue(16584,{proto:a});const u=lt.fromServerFormat(a.fieldPath);return new FC(u,l)}(t,i)):[];if(e.update){e.update.name;const i=no(t,e.update.name),s=new en({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new yn(u.map(f=>lt.fromServerFormat(f)))}(e.updateMask);return new hi(i,s,o,n,r)}return new il(i,s,n,r)}if(e.delete){const i=no(t,e.delete);return new yf(i,n)}if(e.verify){const i=no(t,e.verify);return new BC(i,n)}return ue(1463,{proto:e})}function C4(t,e){return t&&t.length>0?(pe(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?hn(i.updateTime):hn(s);return o.isEqual(me.min())&&(o=hn(s)),new d4(o,i.transformResults||[])}(n,e))):[]}function JC(t,e){return{documents:[HC(t,e.path)]}}function QC(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=HC(t,i);const s=function(u){if(u.length!==0)return ZC(je.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(_){return{field:Ko(_.field),direction:R4(_.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=ng(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function YC(t){let e=WC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){pe(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(m){const _=XC(m);return _ instanceof je&&q_(_)?_.getFilters():[_]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(_=>function(E){return new wh(Jo(E.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(_))}(n.orderBy));let a=null;n.limit&&(a=function(m){let _;return _=typeof m=="object"?m.value:m,uf(_)?null:_}(n.limit));let l=null;n.startAt&&(l=function(m){const _=!!m.before,v=m.values||[];return new Ba(v,_)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const _=!m.before,v=m.values||[];return new Ba(v,_)}(n.endAt)),XU(e,i,o,s,a,"F",l,u)}function A4(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function XC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Jo(n.unaryFilter.field);return ke.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Jo(n.unaryFilter.field);return ke.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Jo(n.unaryFilter.field);return ke.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Jo(n.unaryFilter.field);return ke.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ue(61313);default:return ue(60726)}}(t):t.fieldFilter!==void 0?function(n){return ke.create(Jo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ue(58110);default:return ue(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return je.create(n.compositeFilter.filters.map(r=>XC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue(1026)}}(n.compositeFilter.op))}(t):ue(30097,{filter:t})}function R4(t){return v4[t]}function P4(t){return T4[t]}function k4(t){return E4[t]}function Ko(t){return{fieldPath:t.canonicalString()}}function Jo(t){return lt.fromServerFormat(t.fieldPath)}function ZC(t){return t instanceof ke?function(n){if(n.op==="=="){if(HE(n.value))return{unaryFilter:{field:Ko(n.field),op:"IS_NAN"}};if(jE(n.value))return{unaryFilter:{field:Ko(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(HE(n.value))return{unaryFilter:{field:Ko(n.field),op:"IS_NOT_NAN"}};if(jE(n.value))return{unaryFilter:{field:Ko(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ko(n.field),op:P4(n.op),value:n.value}}}(t):t instanceof je?function(n){const r=n.getFilters().map(i=>ZC(i));return r.length===1?r[0]:{compositeFilter:{op:k4(n.op),filters:r}}}(t):ue(54877,{filter:t})}function N4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function eA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,n,r,i,s=me.min(),o=me.min(),a=wt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Yr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Yr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e){this.yt=e}}function b4(t,e){let n;if(e.document)n=S4(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ie.fromSegments(e.noDocument.path),i=mo(e.noDocument.readTime);n=yt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ue(56709);{const r=ie.fromSegments(e.unknownDocument.path),i=mo(e.unknownDocument.version);n=yt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new ze(i[0],i[1]);return me.fromTimestamp(s)}(e.readTime)),n}function uw(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ah(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:xh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ja(s,o.version.toTimestamp()),createTime:ja(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:po(e.version)};else{if(!e.isUnknownDocument())return ue(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:po(e.version)}}return r}function Ah(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function po(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function mo(t){const e=new ze(t.seconds,t.nanoseconds);return me.fromTimestamp(e)}function zs(t,e){const n=(e.baseMutations||[]).map(s=>sg(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>sg(t.yt,s)),i=ze.fromMillis(e.localWriteTimeMs);return new $_(e.batchId,i,n,r)}function Gl(t){const e=mo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?mo(t.lastLimboFreeSnapshotVersion):me.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return pe(o===1,1966,{count:o}),Kn(ic(WC(s.documents[0])))}(t.query):function(s){return Kn(YC(s))}(t.query),new Yr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,wt.fromBase64String(t.resumeToken))}function nA(t,e){const n=po(e.snapshotVersion),r=po(e.lastLimboFreeSnapshotVersion);let i;i=Ih(e.target)?JC(t.yt,e.target):QC(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:fo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function rA(t){const e=YC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?tg(e,e.limit,"L"):e}function Ip(t,e){return new H_(e.largestBatchId,sg(t.yt,e.overlayMutation))}function cw(t,e){const n=e.path.lastSegment();return[t,nn(e.path.popLast()),n]}function dw(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:po(r.readTime),documentKey:nn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{getBundleMetadata(e,n){return hw(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:mo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return hw(e).put(function(i){return{bundleId:i.id,createTime:po(hn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return fw(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:rA(s.bundledQuery),readTime:mo(s.readTime)}}(r)})}saveNamedQuery(e,n){return fw(e).put(function(i){return{name:i.name,readTime:po(hn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function hw(t){return Dt(t,cf)}function fw(t){return Dt(t,df)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Tf(e,r)}getOverlay(e,n){return Pl(e).get(cw(this.userId,n)).next(r=>r?Ip(this.serializer,r):null)}getOverlays(e,n){const r=Rr();return $.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new H_(n,o);i.push(this.St(e,a))}),$.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(nn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Pl(e).Z(Wm,a))}),$.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Rr(),s=nn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Pl(e).J(Wm,o).next(a=>{for(const l of a){const u=Ip(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Rr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Pl(e).ee({index:iC,range:a},(l,u,f)=>{const m=Ip(this.serializer,u);s.size()<i||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()}).next(()=>s)}St(e,n){return Pl(e).put(function(i,s,o){const[a,l,u]=cw(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ch(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Pl(t){return Dt(t,hf)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{bt(e){return Dt(e,F_)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?wt.fromUint8Array(r):wt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ot(e.integerValue));else if("doubleValue"in e){const r=ot(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Du(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=oi(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(ai(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?gC(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):pf(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):ue(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=Ua,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ot(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),ie.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}$s.Kt=new $s;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo=255;function V4(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function pw(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=V4(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class L4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=pw(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=pw(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(qo),this.sn(255)}_n(){this.an(qo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===qo?(this.sn(qo),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===qo?(this.an(qo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class F4{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class U4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class kl{constructor(){this.cn=new L4,this.ln=new F4(this.cn),this.hn=new U4(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new js(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Md(this.En),directionalValue:Md(this.dn),orderedDocumentKey:Md(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Ri(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=mw(t.En,e.En),n!==0?n:(n=mw(t.dn,e.dn),n!==0?n:ie.comparator(t.In,e.In)))}function mw(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Md(t){return Q0()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function gw(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class _w{constructor(e){this.mn=new We((n,r)=>lt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(pe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=$m(e);if(n!==void 0&&!this.wn(n))return!1;const r=Os(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new We(lt.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Cd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Cd(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Cd(r.field,r.dir==="asc"?0:1)));return new _h(_h.UNKNOWN_ID,this.collectionId,n,bu.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(t){var n,r;if(pe(t instanceof ke||t instanceof je,20012),t instanceof ke){if(t instanceof xC){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>ke.create(t.field,"==",s)))||[];return je.create(i,"or")}return t}const e=t.filters.map(i=>iA(i));return je.create(e,t.op)}function O4(t){if(t.getFilters().length===0)return[];const e=lg(iA(t));return pe(sA(e),7391),og(e)||ag(e)?[e]:e.getFilters()}function og(t){return t instanceof ke}function ag(t){return t instanceof je&&q_(t)}function sA(t){return og(t)||ag(t)||function(n){if(n instanceof je&&Ym(n)){for(const r of n.getFilters())if(!og(r)&&!ag(r))return!1;return!0}return!1}(t)}function lg(t){if(pe(t instanceof ke||t instanceof je,34018),t instanceof ke)return t;if(t.filters.length===1)return lg(t.filters[0]);const e=t.filters.map(r=>lg(r));let n=je.create(e,t.op);return n=Rh(n),sA(n)?n:(pe(n instanceof je,64498),pe(Ga(n),40251),pe(n.filters.length>1,57927),n.filters.reduce((r,i)=>J_(r,i)))}function J_(t,e){let n;return pe(t instanceof ke||t instanceof je,38388),pe(e instanceof ke||e instanceof je,25473),n=t instanceof ke?e instanceof ke?function(i,s){return je.create([i,s],"and")}(t,e):yw(t,e):e instanceof ke?yw(e,t):function(i,s){if(pe(i.filters.length>0&&s.filters.length>0,48005),Ga(i)&&Ga(s))return wC(i,s.getFilters());const o=Ym(i)?i:s,a=Ym(i)?s:i,l=o.filters.map(u=>J_(u,a));return je.create(l,"or")}(t,e),Rh(n)}function yw(t,e){if(Ga(e))return wC(e,t.getFilters());{const n=e.filters.map(r=>J_(t,r));return je.create(n,"or")}}function Rh(t){if(pe(t instanceof ke||t instanceof je,11850),t instanceof ke)return t;const e=t.getFilters();if(e.length===1)return Rh(e[0]);if(TC(t))return t;const n=e.map(i=>Rh(i)),r=[];return n.forEach(i=>{i instanceof ke?r.push(i):i instanceof je&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:je.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(){this.Cn=new Q_}addToCollectionParentIndex(e,n){return this.Cn.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(Mn.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(Mn.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class Q_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new We(qe.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new We(qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw="IndexedDbIndexManager",rd=new Uint8Array(0);class G4{constructor(e,n){this.databaseId=n,this.vn=new Q_,this.Fn=new di(r=>fo(r),(r,i)=>nc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:nn(i)};return Tw(e).put(s)}return $.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[jx(n),""],!1,!0);return Tw(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Ar(o.parent))}return r})}addFieldIndex(e,n){const r=Nl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=$o(e);return s.next(a=>{o.put(dw(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Nl(e),i=$o(e),s=zo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Nl(e),r=zo(e),i=$o(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return $.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new _w(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=zo(e);let i=!0;const s=new Map;return $.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Ie();const a=[];return $.forEach(s,(l,u)=>{ee(vw,`Using index ${function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(l)} to execute ${fo(n)}`);const f=function(A,V){const q=$m(V);if(q===void 0)return null;for(const z of Sh(A,q.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null}(u,l),m=function(A,V){const q=new Map;for(const z of Os(V))for(const S of Sh(A,z.fieldPath))switch(S.op){case"==":case"in":q.set(z.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return q.set(z.fieldPath.canonicalString(),S.value),Array.from(q.values())}return null}(u,l),_=function(A,V){const q=[];let z=!0;for(const S of Os(V)){const x=S.kind===0?YE(A,S.fieldPath,A.startAt):XE(A,S.fieldPath,A.startAt);q.push(x.value),z&&(z=x.inclusive)}return new Ba(q,z)}(u,l),v=function(A,V){const q=[];let z=!0;for(const S of Os(V)){const x=S.kind===0?XE(A,S.fieldPath,A.endAt):YE(A,S.fieldPath,A.endAt);q.push(x.value),z&&(z=x.inclusive)}return new Ba(q,z)}(u,l),E=this.On(l,u,_),P=this.On(l,u,v),M=this.Nn(l,u,m),C=this.Bn(l.indexId,f,E,_.inclusive,P,v.inclusive,M);return $.forEach(C,w=>r.Y(w,n.limit).next(A=>{A.forEach(V=>{const q=ie.fromSegments(V.documentKey);o.has(q)||(o=o.add(q),a.push(q))})}))}).next(()=>a)}return $.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=O4(je.create(e.filters,"and")).map(r=>Zm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),f=[];for(let m=0;m<l;++m){const _=n?this.Ln(n[m/u]):rd,v=this.kn(e,_,r[m%u],i),E=this.qn(e,_,s[m%u],o),P=a.map(M=>this.kn(e,_,M,!0));f.push(...this.createRange(v,E,P))}return f}kn(e,n,r,i){const s=new js(e,ie.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new js(e,ie.empty(),n,r);return i?s.An():s}xn(e,n){const r=new _w(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return $.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new We(lt.comparator),f=!1;for(const m of l.filters)for(const _ of m.getFlattenedFilters())_.field.isKeyField()||(_.op==="array-contains"||_.op==="array-contains-any"?f=!0:u=u.add(_.field));for(const m of l.orderBy)m.field.isKeyField()||(u=u.add(m.field));return u.size+(f?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new kl;for(const i of Os(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);$s.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new kl;return $s.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new kl;return $s.Kt.Dt(Ou(this.databaseId,n),r.Pn(function(s){const o=Os(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new kl);let s=0;for(const o of Os(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&Bu(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);$s.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new kl;l.seed(a.un()),$s.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof ke&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Nl(e),i=$o(e);return(n?r.J(Hm,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return $.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(f,m){const _=m?new bu(m.sequenceNumber,new Mn(mo(m.readTime),new ie(Ar(m.documentKey)),m.largestBatchId)):bu.empty(),v=f.fields.map(([E,P])=>new Cd(lt.fromServerFormat(E),P));return new _h(f.indexId,f.collectionGroup,v,_)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ye(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Nl(e),s=$o(e);return this.Gn(e).next(o=>i.J(Hm,IDBKeyRange.bound(n,n)).next(a=>$.forEach(a,l=>s.put(dw(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return $.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),$.forEach(a,l=>this.zn(e,i,l).next(u=>{const f=this.jn(s,l);return u.isEqual(f)?$.resolve():this.Jn(e,s,l,u,f)}))))})}Hn(e,n,r,i){return zo(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return zo(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=zo(e);let s=new We(Ri);return i.ee({index:rC,range:IDBKeyRange.only([r.indexId,this.uid,Md(this.$n(r,n))])},(o,a)=>{s=s.add(new js(r.indexId,n,gw(a.arrayValue),gw(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new We(Ri);const i=this.Qn(n,e);if(i==null)return r;const s=$m(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Bu(o))for(const a of o.arrayValue.values||[])r=r.add(new js(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new js(n.indexId,e.key,rd,i));return r}Jn(e,n,r,i,s){ee(vw,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,f,m,_){const v=l.getIterator(),E=u.getIterator();let P=Go(v),M=Go(E);for(;P||M;){let C=!1,w=!1;if(P&&M){const A=f(P,M);A<0?w=!0:A>0&&(C=!0)}else P!=null?w=!0:C=!0;C?(m(M),M=Go(E)):w?(_(P),P=Go(v)):(P=Go(v),M=Go(E))}}(i,s,Ri,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),$.waitFor(o)}Gn(e){let n=1;return $o(e).ee({index:nC,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ri(o,a)).filter((o,a,l)=>!a||Ri(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Ri(o,e),l=Ri(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,rd,ie.empty()),l=i[o+1].Vn(this.uid,rd,ie.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return Ri(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Ew)}getMinOffset(e,n){return $.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||ue(44426))).next(Ew)}}function Tw(t){return Dt(t,Lu)}function zo(t){return Dt(t,su)}function Nl(t){return Dt(t,L_)}function $o(t){return Dt(t,iu)}function Ew(t){pe(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;D_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Mn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},oA=41943040;class Xt{static withCacheSize(e){return new Xt(e,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aA(t,e,n){const r=t.store(ar),i=t.store(Ma),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(f,m,_)=>(a++,_.delete()));s.push(l.next(()=>{pe(a===1,47070,{batchId:n.batchId})}));const u=[];for(const f of n.mutations){const m=Zx(e,f.key.path,n.batchId);s.push(i.delete(m)),u.push(f.key)}return $.waitFor(s).next(()=>u)}function Ph(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ue(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xt.DEFAULT_COLLECTION_PERCENTILE=10,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xt.DEFAULT=new Xt(oA,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xt.DISABLED=new Xt(-1,0,0);class Ef{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){pe(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Ef(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pi(e).ee({index:Qs,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Qo(e),o=Pi(e);return o.add({}).next(a=>{pe(typeof a=="number",49019);const l=new $_(a,n,r,i),u=function(v,E,P){const M=P.baseMutations.map(w=>Ch(v.yt,w)),C=P.mutations.map(w=>Ch(v.yt,w));return{userId:E,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:M,mutations:C}}(this.serializer,this.userId,l),f=[];let m=new We((_,v)=>ye(_.canonicalString(),v.canonicalString()));for(const _ of i){const v=Zx(this.userId,_.key.path,a);m=m.add(_.key.path.popLast()),f.push(o.put(u)),f.push(s.put(v,gU))}return m.forEach(_=>{f.push(this.indexManager.addToCollectionParentIndex(e,_))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),$.waitFor(f).next(()=>l)})}lookupMutationBatch(e,n){return Pi(e).get(n).next(r=>r?(pe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),zs(this.serializer,r)):null)}er(e,n){return this.Xn[n]?$.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Pi(e).ee({index:Qs,range:i},(o,a,l)=>{a.userId===this.userId&&(pe(a.batchId>=r,47524,{tr:r}),s=zs(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=eo;return Pi(e).ee({index:Qs,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,eo],[this.userId,Number.POSITIVE_INFINITY]);return Pi(e).J(Qs,n).next(r=>r.map(i=>zs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Ad(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Qo(e).ee({range:i},(o,a,l)=>{const[u,f,m]=o,_=Ar(f);if(u===this.userId&&n.path.isEqual(_))return Pi(e).get(m).next(v=>{if(!v)throw ue(61480,{nr:o,batchId:m});pe(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:m}),s.push(zs(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new We(ye);const i=[];return n.forEach(s=>{const o=Ad(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Qo(e).ee({range:a},(u,f,m)=>{const[_,v,E]=u,P=Ar(v);_===this.userId&&s.path.isEqual(P)?r=r.add(E):m.done()});i.push(l)}),$.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Ad(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new We(ye);return Qo(e).ee({range:o},(l,u,f)=>{const[m,_,v]=l,E=Ar(_);m===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(v)):f.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Pi(e).get(s).next(o=>{if(o===null)throw ue(35274,{batchId:s});pe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(zs(this.serializer,o))}))}),$.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return aA(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),$.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return $.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Qo(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Ar(s[1]);i.push(l)}else a.done()}).next(()=>{pe(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return lA(e,this.userId,n)}_r(e){return uA(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:eo,lastStreamToken:""})}}function lA(t,e,n){const r=Ad(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Qo(t).ee({range:s,X:!0},(a,l,u)=>{const[f,m,_]=a;f===e&&m===i&&(o=!0),u.done()}).next(()=>o)}function Pi(t){return Dt(t,ar)}function Qo(t){return Dt(t,Ma)}function uA(t){return Dt(t,Mu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new go(0)}static cr(){return new go(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new go(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>me.fromTimestamp(new ze(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>jo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(pe(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return jo(e).ee((o,a)=>{const l=Gl(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>$.waitFor(s)).next(()=>i)}forEachTarget(e,n){return jo(e).ee((r,i)=>{const s=Gl(i);n(s)})}lr(e){return Iw(e).get(Th).next(n=>(pe(n!==null,2888),n))}hr(e,n){return Iw(e).put(Th,n)}Pr(e,n){return jo(e).put(nA(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=fo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return jo(e).ee({range:i,index:tC},(o,a,l)=>{const u=Gl(a);nc(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Oi(e);return n.forEach(o=>{const a=nn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),$.waitFor(i)}removeMatchingKeys(e,n,r){const i=Oi(e);return $.forEach(n,s=>{const o=nn(s.path);return $.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Oi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Oi(e);let s=Ie();return i.ee({range:r,X:!0},(o,a,l)=>{const u=Ar(o[1]),f=new ie(u);s=s.add(f)}).next(()=>s)}containsKey(e,n){const r=nn(n.path),i=IDBKeyRange.bound([r],[jx(r)],!1,!0);let s=0;return Oi(e).ee({index:V_,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return jo(e).get(n).next(r=>r?Gl(r):null)}}function jo(t){return Dt(t,Va)}function Iw(t){return Dt(t,to)}function Oi(t){return Dt(t,La)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sw="LruGarbageCollector",z4=1048576;function xw([t,e],[n,r]){const i=ye(t,n);return i===0?ye(e,r):i}class $4{constructor(e){this.Ir=e,this.buffer=new We(xw),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();xw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class cA{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(Sw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){_s(n)?ee(Sw,"Ignoring IndexedDB error during garbage collection: ",n):await Eo(n)}await this.Vr(3e5)})}}class j4{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return $.resolve(jn.ce);const r=new $4(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(ww)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ww):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(s=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(u=Date.now(),Ho()<=Pe.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${m} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function dA(t,e){return new j4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e,n){this.db=e,this.garbageCollector=dA(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return id(e,r)}removeReference(e,n,r){return id(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return id(e,n)}br(e,n){return function(i,s){let o=!1;return uA(i).te(a=>lA(i,a,s).next(l=>(l&&(o=!0),$.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,me.min()),Oi(e).delete(function(m){return[0,nn(m.path)]}(o))))});i.push(l)}}).next(()=>$.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return id(e,n)}Sr(e,n){const r=Oi(e);let i,s=jn.ce;return r.ee({index:V_},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==jn.ce&&n(new ie(Ar(i)),s),s=u,i=l):s=jn.ce}).next(()=>{s!==jn.ce&&n(new ie(Ar(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function id(t,e){return Oi(t).put(function(r,i){return{targetId:0,path:nn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(){this.changes=new di(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ms(e).put(r)}removeEntry(e,n,r){return Ms(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Ah(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=yt.newInvalidDocument(n);return Ms(e).ee({index:Rd,range:IDBKeyRange.only(bl(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:yt.newInvalidDocument(n)};return Ms(e).ee({index:Rd,range:IDBKeyRange.only(bl(n))},(i,s)=>{r={document:this.Cr(n,s),size:Ph(s)}}).next(()=>r)}getEntries(e,n){let r=Nn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=Nn(),i=new ut(ie.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,Ph(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return $.resolve();let i=new We(Rw);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(bl(i.first()),bl(i.last())),o=i.getIterator();let a=o.getNext();return Ms(e).ee({index:Rd,range:s},(l,u,f)=>{const m=ie.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&Rw(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?f.j(bl(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Ah(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ms(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let f=Nn();for(const m of u){const _=this.Cr(ie.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);_.isFoundDocument()&&(sc(n,_)||i.has(_.key))&&(f=f.insert(_.key,_))}return f})}getAllFromCollectionGroup(e,n,r,i){let s=Nn();const o=Aw(n,r),a=Aw(n,Mn.max());return Ms(e).ee({index:eC,range:IDBKeyRange.bound(o,a,!0)},(l,u,f)=>{const m=this.Cr(ie.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(m.key,m),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new K4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Cw(e).get(jm).next(n=>(pe(!!n,20021),n))}Dr(e,n){return Cw(e).put(jm,n)}Cr(e,n){if(n){const r=b4(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(me.min())))return r}return yt.newInvalidDocument(e)}}function fA(t){return new W4(t)}class K4 extends hA{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new di(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new We((s,o)=>ye(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=uw(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=Ph(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=uw(this.Nr.serializer,o.convertToNoDocument(me.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),$.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function Cw(t){return Dt(t,Vu)}function Ms(t){return Dt(t,vh)}function bl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Aw(t,e){const n=e.documentKey.path.toArray();return[t,Ah(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Rw(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ye(n[s],r[s]),i)return i;return i=ye(n.length,r.length),i||(i=ye(n[n.length-2],r[r.length-2]),i||ye(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&uu(r.mutation,i,yn.empty(),ze.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ie()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ie()){const i=Rr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Ol();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Rr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ie()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Nn();const o=lu(),a=function(){return lu()}();return n.forEach((l,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof hi)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),uu(f.mutation,u,f.mutation.getFieldMask(),ze.now())):o.set(u.key,yn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>a.set(u,new J4(f,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=lu();let i=new ut((o,a)=>o-a),s=Ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let f=r.get(l)||yn.empty();f=a.applyToLocalView(u,f),r.set(l,f);const m=(i.get(a.batchId)||Ie()).add(l);i=i.insert(a.batchId,m)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,f=l.value,m=NC();f.forEach(_=>{if(!s.has(_)){const v=UC(n.get(_),r.get(_));v!==null&&m.set(_,v),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return $.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):CC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):$.resolve(Rr());let a=Nu,l=s;return o.next(u=>$.forEach(u,(f,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),s.get(f)?$.resolve():this.remoteDocumentCache.getEntry(e,f).next(_=>{l=l.insert(f,_)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Ie())).next(f=>({batchId:a,changes:kC(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ie(n)).next(r=>{let i=Ol();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Ol();return this.indexManager.getCollectionParents(e,s).next(a=>$.forEach(a,l=>{const u=function(m,_){return new rc(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((m,_)=>{o=o.insert(m,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,yt.newInvalidDocument(f)))});let a=Ol();return o.forEach((l,u)=>{const f=s.get(l);f!==void 0&&uu(f.mutation,u,yn.empty(),ze.now()),sc(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return $.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:hn(i.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:rA(i.bundledQuery),readTime:hn(i.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(){this.overlays=new ut(ie.comparator),this.qr=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Rr();return $.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const i=Rr(),s=n.length+1,o=new ie(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return $.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new ut((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=Rr(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const a=Rr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>a.set(u,f)),!(a.size()>=i)););return $.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new H_(n,r));let s=this.qr.get(n);s===void 0&&(s=Ie(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(){this.sessionToken=wt.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(){this.Qr=new We(Vt.$r),this.Ur=new We(Vt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Vt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Vt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ie(new qe([])),r=new Vt(n,e),i=new Vt(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ie(new qe([])),r=new Vt(n,e),i=new Vt(n,e+1);let s=Ie();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Vt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Vt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ie.comparator(e.key,n.key)||ye(e.Yr,n.Yr)}static Kr(e,n){return ye(e.Yr,n.Yr)||ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new We(Vt.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new $_(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Vt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,n){return $.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return $.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?eo:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Vt(n,0),i=new Vt(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),$.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new We(ye);return n.forEach(i=>{const s=new Vt(i,0),o=new Vt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),$.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ie.isDocumentKey(s)||(s=s.child(""));const o=new Vt(new ie(s),0);let a=new We(ye);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),$.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){pe(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return $.forEach(n.mutations,i=>{const s=new Vt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Vt(n,0),i=this.Zr.firstAfterOrEqual(r);return $.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e){this.ri=e,this.docs=function(){return new ut(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():yt.newInvalidDocument(n))}getEntries(e,n){let r=Nn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():yt.newInvalidDocument(i))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Nn();const o=n.path,a=new ie(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||D_(Jx(f),r)<=0||(i.has(f.key)||sc(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return $.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ue(9500)}ii(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new tO(this)}getSize(e){return $.resolve(this.size)}}class tO extends hA{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e){this.persistence=e,this.si=new di(n=>fo(n),nc),this.lastRemoteSnapshotVersion=me.min(),this.highestTargetId=0,this.oi=0,this._i=new Y_,this.targetCount=0,this.ai=go.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),$.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new go(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Pr(n),$.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),$.waitFor(s).next(()=>i)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),$.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e,n){this.ui={},this.overlays={},this.ci=new jn(0),this.li=!1,this.li=!0,this.hi=new X4,this.referenceDelegate=e(this),this.Pi=new nO(this),this.indexManager=new B4,this.remoteDocumentCache=function(i){return new eO(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new tA(n),this.Ii=new Q4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Y4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Z4(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const i=new rO(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return $.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class rO extends Yx{constructor(e){super(),this.currentSequenceNumber=e}}class wf{constructor(e){this.persistence=e,this.Ri=new Y_,this.Vi=null}static mi(e){return new wf(e)}get fi(){if(this.Vi)return this.Vi;throw ue(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),$.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,r=>{const i=ie.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,me.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return $.or([()=>$.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class kh{constructor(e,n){this.persistence=e,this.pi=new di(r=>nn(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=dA(this,n)}static mi(e,n){return new kh(e,n)}Ei(){}di(e){return $.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return $.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?$.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,me.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),$.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),$.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=kd(e.data.value)),n}br(e,n,r){return $.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return $.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e){this.serializer=e}k(e,n,r,i){const s=new lf("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(tc)}(e),function(l){l.createObjectStore(Mu,{keyPath:mU}),l.createObjectStore(ar,{keyPath:OE,autoIncrement:!0}).createIndex(Qs,BE,{unique:!0}),l.createObjectStore(Ma)}(e),Pw(e),function(l){l.createObjectStore(Bs)}(e));let o=$.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(La),l.deleteObjectStore(Va),l.deleteObjectStore(to)}(e),Pw(e)),o=o.next(()=>function(l){const u=l.store(to),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:me.min().toTimestamp(),targetCount:0};return u.put(Th,f)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(ar).J().next(m=>{l.deleteObjectStore(ar),l.createObjectStore(ar,{keyPath:OE,autoIncrement:!0}).createIndex(Qs,BE,{unique:!0});const _=u.store(ar),v=m.map(E=>_.put(E));return $.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(Fa,{keyPath:SU})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Vu)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(cf,{keyPath:xU})})(e),function(l){l.createObjectStore(df,{keyPath:CU})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(hf,{keyPath:DU});u.createIndex(Wm,MU,{unique:!1}),u.createIndex(iC,VU,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(vh,{keyPath:_U});u.createIndex(Rd,yU),u.createIndex(eC,vU)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(Bs))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(L_,{keyPath:AU,autoIncrement:!0}).createIndex(Hm,RU,{unique:!1}),l.createObjectStore(iu,{keyPath:PU}).createIndex(nC,kU,{unique:!1}),l.createObjectStore(su,{keyPath:NU}).createIndex(rC,bU,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(iu).clear()}).next(()=>{n.objectStore(su).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(F_,{keyPath:LU})})(e)})),r<18&&i>=18&&Q0()&&(o=o.next(()=>{n.objectStore(iu).clear()}).next(()=>{n.objectStore(su).clear()})),o}wi(e){let n=0;return e.store(Bs).ee((r,i)=>{n+=Ph(i)}).next(()=>{const r={byteSize:n};return e.store(Vu).put(jm,r)})}yi(e){const n=e.store(Mu),r=e.store(ar);return n.J().next(i=>$.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,eo],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Qs,o).next(a=>$.forEach(a,l=>{pe(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=zs(this.serializer,l);return aA(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(La),r=e.store(Bs);return e.store(to).get(Th).next(i=>{const s=[];return r.ee((o,a)=>{const l=new qe(o),u=function(m){return[0,nn(m)]}(l);s.push(n.get(u).next(f=>f?$.resolve():(m=>n.put({targetId:0,path:nn(m),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>$.waitFor(s))})}bi(e,n){e.createObjectStore(Lu,{keyPath:IU});const r=n.store(Lu),i=new Q_,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:nn(l)})}};return n.store(Bs).ee({X:!0},(o,a)=>{const l=new qe(o);return s(l.popLast())}).next(()=>n.store(Ma).ee({X:!0},([o,a,l],u)=>{const f=Ar(a);return s(f.popLast())}))}Di(e){const n=e.store(Va);return n.ee((r,i)=>{const s=Gl(i),o=nA(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(Bs),i=[];return r.ee((s,o)=>{const a=n.store(vh),l=function(m){return m.document?new ie(qe.fromString(m.document.name).popFirst(5)):m.noDocument?ie.fromSegments(m.noDocument.path):m.unknownDocument?ie.fromSegments(m.unknownDocument.path):ue(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>$.waitFor(i))}Fi(e,n){const r=n.store(ar),i=fA(this.serializer),s=new X_(wf.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??Ie();zs(this.serializer,l).keys().forEach(f=>u=u.add(f)),a.set(l.userId,u)}),$.forEach(a,(l,u)=>{const f=new jt(u),m=Tf.wt(this.serializer,f),_=s.getIndexManager(f),v=Ef.wt(f,this.serializer,_,s.referenceDelegate);return new pA(i,v,m,_).recalculateAndSaveOverlaysForDocumentKeys(new Km(n,jn.ce),l).next()})})}}function Pw(t){t.createObjectStore(La,{keyPath:EU}).createIndex(V_,wU,{unique:!0}),t.createObjectStore(Va,{keyPath:"targetId"}).createIndex(tC,TU,{unique:!0}),t.createObjectStore(to)}const ki="IndexedDbPersistence",Sp=18e5,xp=5e3,Cp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",sO="main";class Z_{constructor(e,n,r,i,s,o,a,l,u,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=_=>Promise.resolve(),!Z_.v())throw new re(J.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new H4(this,i),this.$i=n+sO,this.serializer=new tA(l),this.Ui=new ts(this.$i,this.Ni,new iO(this.serializer)),this.hi=new M4,this.Pi=new q4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=fA(this.serializer),this.Ii=new D4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&ln(ki,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new re(J.FAILED_PRECONDITION,Cp);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new jn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>sd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(_s(e))return ee(ki,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ee(ki,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Dl(e).get(Bo).next(n=>$.resolve(this.es(n)))}ts(e){return sd(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Sp)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Dt(n,Fa);return r.J().next(i=>{const s=this.ss(i,Sp),o=i.filter(a=>s.indexOf(a)===-1);return $.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?$.resolve(!0):Dl(e).get(Bo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,xp)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new re(J.FAILED_PRECONDITION,Cp);return!1}}return!(!this.networkEnabled||!this.inForeground)||sd(e).J().next(r=>this.ss(r,xp).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&ee(ki,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[tc,Fa],e=>{const n=new Km(e,jn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>sd(e).J().next(n=>this.ss(n,Sp).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Ef.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new G4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Tf.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee(ki,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?OU:l===17?lC:l===16?UU:l===15?U_:l===14?aC:l===13?oC:l===12?FU:l===11?sC:void ue(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new Km(a,this.ci?this.ci.next():jn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw ln(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new re(J.FAILED_PRECONDITION,Qx);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Dl(e).get(Bo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,xp)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new re(J.FAILED_PRECONDITION,Cp)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Dl(e).put(Bo,n)}static v(){return ts.v()}Zi(e){const n=Dl(e);return n.get(Bo).next(r=>this.es(r)?(ee(ki,"Releasing primary lease."),n.delete(Bo)):$.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(ln(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;J0()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return ee(ki,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ln(ki,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){ln("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Dl(t){return Dt(t,tc)}function sd(t){return Dt(t,Fa)}function oO(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Ie(),i=Ie();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new ey(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return J0()?8:Xx(Nt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new aO;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(Ho()<=Pe.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",Wo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(Ho()<=Pe.DEBUG&&ee("QueryEngine","Query:",Wo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Ho()<=Pe.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",Wo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Kn(n))):$.resolve())}ys(e,n){if(ZE(n))return $.resolve(null);let r=Kn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=tg(n,null,"F"),r=Kn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ie(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,tg(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return ZE(n)||i.isEqual(me.min())?$.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?$.resolve(null):(Ho()<=Pe.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Wo(n)),this.vs(e,o,n,lU(i,Nu)).next(a=>a))})}Ds(e,n){let r=new We(RC(e));return n.forEach((i,s)=>{sc(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return Ho()<=Pe.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",Wo(n)),this.ps.getDocumentsMatchingQuery(e,n,Mn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="LocalStore",lO=3e8;class uO{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new ut(ye),this.xs=new di(s=>fo(s),nc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function gA(t,e,n,r){return new uO(t,e,n,r)}async function _A(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Ie();for(const u of i){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function cO(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,f){const m=u.batch,_=m.keys();let v=$.resolve();return _.forEach(E=>{v=v.next(()=>f.getEntry(l,E)).next(P=>{const M=u.docVersions.get(E);pe(M!==null,48541),P.version.compareTo(M)<0&&(m.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),f.addEntry(P)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,m))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ie();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function yA(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function dO(t,e){const n=ve(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((f,m)=>{const _=i.get(m);if(!_)return;a.push(n.Pi.removeMatchingKeys(s,f.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(s,f.addedDocuments,m)));let v=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(wt.EMPTY_BYTE_STRING,me.min()).withLastLimboFreeSnapshotVersion(me.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,r)),i=i.insert(m,v),function(P,M,C){return P.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=lO?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(_,v,f)&&a.push(n.Pi.updateTargetData(s,v))});let l=Nn(),u=Ie();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(hO(s,o,e.documentUpdates).next(f=>{l=f.ks,u=f.qs})),!r.isEqual(me.min())){const f=n.Pi.getLastRemoteSnapshotVersion(s).next(m=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(f)}return $.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function hO(t,e,n){let r=Ie(),i=Ie();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Nn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(me.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ee(ty,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function fO(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=eo),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function pO(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,$.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Yr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function ug(t,e,n){const r=ve(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!_s(o))throw o;ee(ty,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function kw(t,e,n){const r=ve(t);let i=me.min(),s=Ie();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){const m=ve(l),_=m.xs.get(f);return _!==void 0?$.resolve(m.Ms.get(_)):m.Pi.getTargetData(u,f)}(r,o,Kn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:me.min(),n?s:Ie())).next(a=>(mO(r,e4(e),a),{documents:a,Qs:s})))}function mO(t,e,n){let r=t.Os.get(e)||me.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class Nw{constructor(){this.activeTargetIds=o4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vA{constructor(){this.Mo=new Nw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Nw,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw="ConnectivityMonitor";class Dw{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(bw,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(bw,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let od=null;function cg(){return od===null?od=function(){return 268435456+Math.round(2147483648*Math.random())}():od++,"0x"+od.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap="RestConnection",_O={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class yO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Eh?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=cg(),a=this.zo(e,n.toUriEncodedString());ee(Ap,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),f=el(u);return this.Jo(e,a,l,r,f).then(m=>(ee(Ap,`Received RPC '${e}' ${o}: `,m),m),m=>{throw as(Ap,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+rl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=_O[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class TO extends yO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=cg();return new Promise((a,l)=>{const u=new Lx;u.setWithCredentials(!0),u.listenOnce(Fx.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case xd.NO_ERROR:const m=u.getResponseJson();ee(Yt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case xd.TIMEOUT:ee(Yt,`RPC '${e}' ${o} timed out`),l(new re(J.DEADLINE_EXCEEDED,"Request time out"));break;case xd.HTTP_ERROR:const _=u.getStatus();if(ee(Yt,`RPC '${e}' ${o} failed with status:`,_,"response text:",u.getResponseText()),_>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const E=v==null?void 0:v.error;if(E&&E.status&&E.message){const P=function(C){const w=C.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(w)>=0?w:J.UNKNOWN}(E.status);l(new re(P,E.message))}else l(new re(J.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new re(J.UNAVAILABLE,"Connection failed."));break;default:ue(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{ee(Yt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(i);ee(Yt,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",f,r,15)})}T_(e,n,r){const i=cg(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Bx(),a=Ox(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const f=s.join("");ee(Yt,`Creating RPC '${e}' stream ${i}: ${f}`,l);const m=o.createWebChannel(f,l);this.I_(m);let _=!1,v=!1;const E=new vO({Yo:M=>{v?ee(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(_||(ee(Yt,`Opening RPC '${e}' stream ${i} transport.`),m.open(),_=!0),ee(Yt,`RPC '${e}' stream ${i} sending:`,M),m.send(M))},Zo:()=>m.close()}),P=(M,C,w)=>{M.listen(C,A=>{try{w(A)}catch(V){setTimeout(()=>{throw V},0)}})};return P(m,Ul.EventType.OPEN,()=>{v||(ee(Yt,`RPC '${e}' stream ${i} transport opened.`),E.o_())}),P(m,Ul.EventType.CLOSE,()=>{v||(v=!0,ee(Yt,`RPC '${e}' stream ${i} transport closed`),E.a_(),this.E_(m))}),P(m,Ul.EventType.ERROR,M=>{v||(v=!0,as(Yt,`RPC '${e}' stream ${i} transport errored. Name:`,M.name,"Message:",M.message),E.a_(new re(J.UNAVAILABLE,"The operation could not be completed")))}),P(m,Ul.EventType.MESSAGE,M=>{var C;if(!v){const w=M.data[0];pe(!!w,16349);const A=w,V=(A==null?void 0:A.error)||((C=A[0])==null?void 0:C.error);if(V){ee(Yt,`RPC '${e}' stream ${i} received error:`,V);const q=V.status;let z=function(R){const N=It[R];if(N!==void 0)return GC(N)}(q),S=V.message;z===void 0&&(z=J.INTERNAL,S="Unknown error status: "+q+" with message "+V.message),v=!0,E.a_(new re(z,S)),m.close()}else ee(Yt,`RPC '${e}' stream ${i} received:`,w),E.u_(w)}}),P(a,Ux.STAT_EVENT,M=>{M.stat===qm.PROXY?ee(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===qm.NOPROXY&&ee(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.__()},0),E}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(){return typeof window<"u"?window:null}function Vd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function If(t){return new w4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw="PersistentStream";class EA{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new TA(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===J.RESOURCE_EXHAUSTED?(ln(n.toString()),ln("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new re(J.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(Mw,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee(Mw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class wO extends EA{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=x4(this.serializer,e),r=function(s){if(!("targetChange"in s))return me.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?me.min():o.readTime?hn(o.readTime):me.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=ig(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Ih(l)?{documents:JC(s,l)}:{query:QC(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=$C(s,o.resumeToken);const u=ng(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(me.min())>0){a.readTime=ja(s,o.snapshotVersion.toTimestamp());const u=ng(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=A4(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=ig(this.serializer),n.removeTarget=e,this.q_(n)}}class IO extends EA{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=C4(e.writeResults,e.commitTime),r=hn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=ig(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Ch(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{}class xO extends SO{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(J.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,rg(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(J.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,rg(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(J.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class CO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ln(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _o="RemoteStore";class AO{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{wo(this)&&(ee(_o,"Restarting streams for network reachability change."),await async function(l){const u=ve(l);u.Ea.add(4),await ac(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Sf(u)}(this))})}),this.Ra=new CO(r,i)}}async function Sf(t){if(wo(t))for(const e of t.da)await e(!0)}async function ac(t){for(const e of t.da)await e(!1)}function wA(t,e){const n=ve(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),sy(n)?iy(n):sl(n).O_()&&ry(n,e))}function ny(t,e){const n=ve(t),r=sl(n);n.Ia.delete(e),r.O_()&&IA(n,e),n.Ia.size===0&&(r.O_()?r.L_():wo(n)&&n.Ra.set("Unknown"))}function ry(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(me.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}sl(t).Y_(e)}function IA(t,e){t.Va.Ue(e),sl(t).Z_(e)}function iy(t){t.Va=new y4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),sl(t).start(),t.Ra.ua()}function sy(t){return wo(t)&&!sl(t).x_()&&t.Ia.size>0}function wo(t){return ve(t).Ea.size===0}function SA(t){t.Va=void 0}async function RO(t){t.Ra.set("Online")}async function PO(t){t.Ia.forEach((e,n)=>{ry(t,e)})}async function kO(t,e){SA(t),sy(t)?(t.Ra.ha(e),iy(t)):t.Ra.set("Unknown")}async function NO(t,e,n){if(t.Ra.set("Online"),e instanceof zC&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){ee(_o,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Nh(t,r)}else if(e instanceof Dd?t.Va.Ze(e):e instanceof qC?t.Va.st(e):t.Va.tt(e),!n.isEqual(me.min()))try{const r=await yA(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(u);f&&s.Ia.set(u,f.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(wt.EMPTY_BYTE_STRING,f.snapshotVersion)),IA(s,l);const m=new Yr(f.target,l,u,f.sequenceNumber);ry(s,m)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ee(_o,"Failed to raise snapshot:",r),await Nh(t,r)}}async function Nh(t,e,n){if(!_s(e))throw e;t.Ea.add(1),await ac(t),t.Ra.set("Offline"),n||(n=()=>yA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(_o,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Sf(t)})}function xA(t,e){return e().catch(n=>Nh(t,n,e))}async function lc(t){const e=ve(t),n=ds(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:eo;for(;bO(e);)try{const i=await fO(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,DO(e,i)}catch(i){await Nh(e,i)}CA(e)&&AA(e)}function bO(t){return wo(t)&&t.Ta.length<10}function DO(t,e){t.Ta.push(e);const n=ds(t);n.O_()&&n.X_&&n.ea(e.mutations)}function CA(t){return wo(t)&&!ds(t).x_()&&t.Ta.length>0}function AA(t){ds(t).start()}async function MO(t){ds(t).ra()}async function VO(t){const e=ds(t);for(const n of t.Ta)e.ea(n.mutations)}async function LO(t,e,n){const r=t.Ta.shift(),i=j_.from(r,e,n);await xA(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await lc(t)}async function FO(t,e){e&&ds(t).X_&&await async function(r,i){if(function(o){return m4(o)&&o!==J.ABORTED}(i.code)){const s=r.Ta.shift();ds(r).B_(),await xA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await lc(r)}}(t,e),CA(t)&&AA(t)}async function Vw(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),ee(_o,"RemoteStore received new credentials");const r=wo(n);n.Ea.add(3),await ac(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Sf(n)}async function UO(t,e){const n=ve(t);e?(n.Ea.delete(2),await Sf(n)):e||(n.Ea.add(2),await ac(n),n.Ra.set("Unknown"))}function sl(t){return t.ma||(t.ma=function(n,r,i){const s=ve(n);return s.sa(),new wO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:RO.bind(null,t),t_:PO.bind(null,t),r_:kO.bind(null,t),H_:NO.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),sy(t)?iy(t):t.Ra.set("Unknown")):(await t.ma.stop(),SA(t))})),t.ma}function ds(t){return t.fa||(t.fa=function(n,r,i){const s=ve(n);return s.sa(),new IO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:MO.bind(null,t),r_:FO.bind(null,t),ta:VO.bind(null,t),na:LO.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await lc(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(_o,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new br,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new oy(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ay(t,e){if(ln("AsyncQueue",`${e}: ${t}`),_s(t))return new re(J.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{static emptySet(e){return new Ia(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ie.comparator(n.key,r.key):(n,r)=>ie.comparator(n.key,r.key),this.keyedMap=Ol(),this.sortedSet=new ut(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ia)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ia;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(){this.ga=new ut(ie.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ue(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ha{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ha(e,n,Ia.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class BO{constructor(){this.queries=Fw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=ve(n),s=i.queries;i.queries=Fw(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new re(J.ABORTED,"Firestore shutting down"))}}function Fw(){return new di(t=>AC(t),mf)}async function ly(t,e){const n=ve(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new OO,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=ay(o,`Initialization of query '${Wo(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&cy(n)}async function uy(t,e){const n=ve(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function GO(t,e){const n=ve(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&cy(n)}function qO(t,e,n){const r=ve(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function cy(t){t.Ca.forEach(e=>{e.next()})}var dg,Uw;(Uw=dg||(dg={})).Ma="default",Uw.Cache="cache";class dy{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ha(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ha.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==dg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e){this.key=e}}class PA{constructor(e){this.key=e}}class zO{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ie(),this.mutatedKeys=Ie(),this.eu=RC(e),this.tu=new Ia(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Lw,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,m)=>{const _=i.get(f),v=sc(this.query,m)?m:null,E=!!_&&this.mutatedKeys.has(_.key),P=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let M=!1;_&&v?_.data.isEqual(v.data)?E!==P&&(r.track({type:3,doc:v}),M=!0):this.su(_,v)||(r.track({type:2,doc:v}),M=!0,(l&&this.eu(v,l)>0||u&&this.eu(v,u)<0)&&(a=!0)):!_&&v?(r.track({type:0,doc:v}),M=!0):_&&!v&&(r.track({type:1,doc:_}),M=!0,(l||u)&&(a=!0)),M&&(v?(o=o.add(v),s=P?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,m)=>function(v,E){const P=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue(20277,{Rt:M})}};return P(v)-P(E)}(f.type,m.type)||this.eu(f.doc,m.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new Ha(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Lw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ie(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new PA(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new RA(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ie();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ha.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const hy="SyncEngine";class $O{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class jO{constructor(e){this.key=e,this.hu=!1}}class HO{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new di(a=>AC(a),mf),this.Iu=new Map,this.Eu=new Set,this.du=new ut(ie.comparator),this.Au=new Map,this.Ru=new Y_,this.Vu={},this.mu=new Map,this.fu=go.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function WO(t,e,n=!0){const r=VA(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await kA(r,e,n,!0),i}async function KO(t,e){const n=VA(t);await kA(n,e,!0,!1)}async function kA(t,e,n,r){const i=await pO(t.localStore,Kn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await JO(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&wA(t.remoteStore,i),a}async function JO(t,e,n,r,i){t.pu=(m,_,v)=>async function(P,M,C,w){let A=M.view.ru(C);A.Cs&&(A=await kw(P.localStore,M.query,!1).then(({documents:S})=>M.view.ru(S,A)));const V=w&&w.targetChanges.get(M.targetId),q=w&&w.targetMismatches.get(M.targetId)!=null,z=M.view.applyChanges(A,P.isPrimaryClient,V,q);return Bw(P,M.targetId,z.au),z.snapshot}(t,m,_,v);const s=await kw(t.localStore,e,!0),o=new zO(e,s.Qs),a=o.ru(s.documents),l=oc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);Bw(t,n,u.au);const f=new $O(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function QO(t,e,n){const r=ve(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!mf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ug(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ny(r.remoteStore,i.targetId),hg(r,i.targetId)}).catch(Eo)):(hg(r,i.targetId),await ug(r.localStore,i.targetId,!0))}async function YO(t,e){const n=ve(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ny(n.remoteStore,r.targetId))}async function XO(t,e,n){const r=LA(t);try{const i=await function(o,a){const l=ve(o),u=ze.now(),f=a.reduce((v,E)=>v.add(E.key),Ie());let m,_;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let E=Nn(),P=Ie();return l.Ns.getEntries(v,f).next(M=>{E=M,E.forEach((C,w)=>{w.isValidDocument()||(P=P.add(C))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,E)).next(M=>{m=M;const C=[];for(const w of a){const A=f4(w,m.get(w.key).overlayedDocument);A!=null&&C.push(new hi(w.key,A,yC(A.value.mapValue),un.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,C,a)}).next(M=>{_=M;const C=M.applyToLocalDocumentSet(m,P);return l.documentOverlayCache.saveOverlays(v,M.batchId,C)})}).then(()=>({batchId:_.batchId,changes:kC(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new ut(ye)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await uc(r,i.changes),await lc(r.remoteStore)}catch(i){const s=ay(i,"Failed to persist write");n.reject(s)}}async function NA(t,e){const n=ve(t);try{const r=await dO(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?pe(o.hu,14607):i.removedDocuments.size>0&&(pe(o.hu,42227),o.hu=!1))}),await uc(n,r,e)}catch(r){await Eo(r)}}function Ow(t,e,n){const r=ve(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=ve(o);l.onlineState=a;let u=!1;l.queries.forEach((f,m)=>{for(const _ of m.Sa)_.va(a)&&(u=!0)}),u&&cy(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ZO(t,e,n){const r=ve(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new ut(ie.comparator);o=o.insert(s,yt.newNoDocument(s,me.min()));const a=Ie().add(s),l=new vf(me.min(),new Map,new ut(ye),o,a);await NA(r,l),r.du=r.du.remove(s),r.Au.delete(e),fy(r)}else await ug(r.localStore,e,!1).then(()=>hg(r,e,n)).catch(Eo)}async function e6(t,e){const n=ve(t),r=e.batch.batchId;try{const i=await cO(n.localStore,e);DA(n,r,null),bA(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await uc(n,i)}catch(i){await Eo(i)}}async function t6(t,e,n){const r=ve(t);try{const i=await function(o,a){const l=ve(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,a).next(m=>(pe(m!==null,37113),f=m.keys(),l.mutationQueue.removeMutationBatch(u,m))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(r.localStore,e);DA(r,e,n),bA(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await uc(r,i)}catch(i){await Eo(i)}}function bA(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function DA(t,e,n){const r=ve(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function hg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||MA(t,r)})}function MA(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(ny(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),fy(t))}function Bw(t,e,n){for(const r of n)r instanceof RA?(t.Ru.addReference(r.key,e),n6(t,r)):r instanceof PA?(ee(hy,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||MA(t,r.key)):ue(19791,{wu:r})}function n6(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(hy,"New document in limbo: "+n),t.Eu.add(r),fy(t))}function fy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ie(qe.fromString(e)),r=t.fu.next();t.Au.set(r,new jO(n)),t.du=t.du.insert(n,r),wA(t.remoteStore,new Yr(Kn(ic(n.path)),r,"TargetPurposeLimboResolution",jn.ce))}}async function uc(t,e,n){const r=ve(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(u){i.push(u);const m=ey.As(l.targetId,u);s.push(m)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const f=ve(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>$.forEach(u,_=>$.forEach(_.Es,v=>f.persistence.referenceDelegate.addReference(m,_.targetId,v)).next(()=>$.forEach(_.ds,v=>f.persistence.referenceDelegate.removeReference(m,_.targetId,v)))))}catch(m){if(!_s(m))throw m;ee(ty,"Failed to update sequence numbers: "+m)}for(const m of u){const _=m.targetId;if(!m.fromCache){const v=f.Ms.get(_),E=v.snapshotVersion,P=v.withLastLimboFreeSnapshotVersion(E);f.Ms=f.Ms.insert(_,P)}}}(r.localStore,s))}async function r6(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){ee(hy,"User change. New user:",e.toKey());const r=await _A(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new re(J.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await uc(n,r.Ls)}}function i6(t,e){const n=ve(t),r=n.Au.get(e);if(r&&r.hu)return Ie().add(r.key);{let i=Ie();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function VA(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=NA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=i6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZO.bind(null,e),e.Pu.H_=GO.bind(null,e.eventManager),e.Pu.yu=qO.bind(null,e.eventManager),e}function LA(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=e6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=t6.bind(null,e),e}class qu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=If(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return gA(this.persistence,new mA,e.initialUser,this.serializer)}Cu(e){return new X_(wf.mi,this.serializer)}Du(e){return new vA}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qu.provider={build:()=>new qu};class s6 extends qu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){pe(this.persistence.referenceDelegate instanceof kh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new cA(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Xt.withCacheSize(this.cacheSizeBytes):Xt.DEFAULT;return new X_(r=>kh.mi(r,n),this.serializer)}}class o6 extends qu{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await LA(this.xu.syncEngine),await lc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return gA(this.persistence,new mA,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new cA(r,e.asyncQueue,n)}Mu(e,n){const r=new hU(n,this.persistence);return new dU(e.asyncQueue,r)}Cu(e){const n=oO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Xt.withCacheSize(this.cacheSizeBytes):Xt.DEFAULT;return new Z_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,EO(),Vd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new vA}}class bh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ow(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=r6.bind(null,this.syncEngine),await UO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BO}()}createDatastore(e){const n=If(e.databaseInfo.databaseId),r=function(s){return new TO(s)}(e.databaseInfo);return function(s,o,a,l){return new xO(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new AO(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Ow(this.syncEngine,n,0),function(){return Dw.v()?new Dw:new gO}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,f){const m=new HO(i,s,o,a,l,u);return f&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ve(i);ee(_o,"RemoteStore shutting down."),s.Ea.add(5),await ac(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}bh.provider={build:()=>new bh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ln("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs="FirestoreClient";class a6{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=jt.UNAUTHENTICATED,this.clientId=of.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ee(hs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(hs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new br;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ay(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Rp(t,e){t.asyncQueue.verifyOperationInProgress(),ee(hs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await _A(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Gw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await l6(t);ee(hs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Vw(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Vw(e.remoteStore,i)),t._onlineComponents=e}async function l6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(hs,"Using user provided OfflineComponentProvider");try{await Rp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===J.FAILED_PRECONDITION||i.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;as("Error using user provided cache. Falling back to memory cache: "+n),await Rp(t,new qu)}}else ee(hs,"Using default OfflineComponentProvider"),await Rp(t,new s6(void 0));return t._offlineComponents}async function FA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(hs,"Using user provided OnlineComponentProvider"),await Gw(t,t._uninitializedComponentsProvider._online)):(ee(hs,"Using default OnlineComponentProvider"),await Gw(t,new bh))),t._onlineComponents}function u6(t){return FA(t).then(e=>e.syncEngine)}async function Dh(t){const e=await FA(t),n=e.eventManager;return n.onListen=WO.bind(null,e.syncEngine),n.onUnlisten=QO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=KO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=YO.bind(null,e.syncEngine),n}function c6(t,e,n={}){const r=new br;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new py({next:_=>{f.Nu(),o.enqueueAndForget(()=>uy(s,m));const v=_.docs.has(a);!v&&_.fromCache?u.reject(new re(J.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&_.fromCache&&l&&l.source==="server"?u.reject(new re(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(_)},error:_=>u.reject(_)}),m=new dy(ic(a.path),f,{includeMetadataChanges:!0,qa:!0});return ly(s,m)}(await Dh(t),t.asyncQueue,e,n,r)),r.promise}function d6(t,e,n={}){const r=new br;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const f=new py({next:_=>{f.Nu(),o.enqueueAndForget(()=>uy(s,m)),_.fromCache&&l.source==="server"?u.reject(new re(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(_)},error:_=>u.reject(_)}),m=new dy(a,f,{includeMetadataChanges:!0,qa:!0});return ly(s,m)}(await Dh(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA="firestore.googleapis.com",zw=!0;class $w{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=OA,this.ssl=zw}else this.host=e.host,this.ssl=e.ssl??zw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=oA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<z4)throw new re(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Wx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=UA(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new re(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new re(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new re(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $w({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $w(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new $x;switch(r.type){case"firstParty":return new nU(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=qw.get(n);r&&(ee("ComponentProvider","Removing Datastore"),qw.delete(n),r.terminate())}(this),Promise.resolve()}}function BA(t,e,n,r={}){var u;t=dn(t,xf);const i=el(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(H0(`https://${a}`),W0("Firestore",!0)),s.host!==OA&&s.host!==a&&as("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!uo(l,o)&&(t._setSettings(l),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=jt.MOCK_USER;else{f=A2(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const _=r.mockUserToken.sub||r.mockUserToken.user_id;if(!_)throw new re(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new jt(_)}t._authCredentials=new ZF(new zx(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new vs(this.firestore,e,this._query)}}class dt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new dt(this.firestore,e,this._key)}toJSON(){return{type:dt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(ec(n,dt._jsonSchema))return new dt(e,r||null,new ie(qe.fromString(n.referencePath)))}}dt._jsonSchemaVersion="firestore/documentReference/1.0",dt._jsonSchema={type:xt("string",dt._jsonSchemaVersion),referencePath:xt("string")};class Zr extends vs{constructor(e,n,r){super(e,n,ic(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new dt(this.firestore,null,new ie(e))}withConverter(e){return new Zr(this.firestore,e,this._path)}}function st(t,e,...n){if(t=bt(t),Hx("collection","path",e),t instanceof xf){const r=qe.fromString(e,...n);return ME(r),new Zr(t,null,r)}{if(!(t instanceof dt||t instanceof Zr))throw new re(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(qe.fromString(e,...n));return ME(r),new Zr(t.firestore,null,r)}}function Ne(t,e,...n){if(t=bt(t),arguments.length===1&&(e=of.newId()),Hx("doc","path",e),t instanceof xf){const r=qe.fromString(e,...n);return DE(r),new dt(t,null,new ie(r))}{if(!(t instanceof dt||t instanceof Zr))throw new re(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(qe.fromString(e,...n));return DE(r),new dt(t.firestore,t instanceof Zr?t.converter:null,new ie(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw="AsyncQueue";class Hw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new TA(this,"async_queue_retry"),this._c=()=>{const r=Vd();r&&ee(jw,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Vd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Vd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new br;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!_s(e))throw e;ee(jw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,ln("INTERNAL UNHANDLED ERROR: ",Ww(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=oy.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&ue(47125,{Pc:Ww(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Ww(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Vr extends xf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Hw,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Hw(e),this._firestoreClient=void 0,await e}}}function GA(t,e){const n=typeof t=="object"?t:tx(),r=typeof t=="string"?t:Eh,i=E_(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=x2("firestore");s&&BA(i,...s)}return i}function cc(t){if(t._terminated)throw new re(J.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||qA(t),t._firestoreClient}function qA(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,f){return new GU(a,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,UA(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new a6(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function zA(t,e){as("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return h6(t,bh.provider,{build:r=>new o6(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function h6(t,e,n){if((t=dn(t,Vr))._firestoreClient||t._terminated)throw new re(J.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new re(J.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},qA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pn(wt.fromBase64String(e))}catch(n){throw new re(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Pn(wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Pn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ec(e,Pn._jsonSchema))return Pn.fromBase64String(e.bytes)}}Pn._jsonSchemaVersion="firestore/bytes/1.0",Pn._jsonSchema={type:xt("string",Pn._jsonSchemaVersion),bytes:xt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ye(this._lat,e._lat)||ye(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:pr._jsonSchemaVersion}}static fromJSON(e){if(ec(e,pr._jsonSchema))return new pr(e.latitude,e.longitude)}}pr._jsonSchemaVersion="firestore/geoPoint/1.0",pr._jsonSchema={type:xt("string",pr._jsonSchemaVersion),latitude:xt("number"),longitude:xt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:mr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ec(e,mr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new mr(e.vectorValues);throw new re(J.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}mr._jsonSchemaVersion="firestore/vectorValue/1.0",mr._jsonSchema={type:xt("string",mr._jsonSchemaVersion),vectorValues:xt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f6=/^__.*__$/;class p6{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new hi(e,this.data,this.fieldMask,n,this.fieldTransforms):new il(e,this.data,n,this.fieldTransforms)}}class $A{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new hi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function jA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue(40011,{Ac:t})}}class my{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new my({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Mh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(jA(this.Ac)&&f6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class m6{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||If(e)}Cc(e,n,r,i=!1){return new my({Ac:e,methodName:n,Dc:r,path:lt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gy(t){const e=t._freezeSettings(),n=If(t._databaseId);return new m6(t._databaseId,!!e.ignoreUndefinedProperties,n)}function g6(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);yy("Data must be an object, but it was:",o,r);const a=HA(r,o);let l,u;if(s.merge)l=new yn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const m of s.mergeFields){const _=fg(e,m,n);if(!o.contains(_))throw new re(J.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);KA(f,_)||f.push(_)}l=new yn(f),u=o.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,u=o.fieldTransforms;return new p6(new en(a),l,u)}class Cf extends hc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cf}}class _y extends hc{_toFieldTransform(e){return new FC(e.path,new qa)}isEqual(e){return e instanceof _y}}function _6(t,e,n,r){const i=t.Cc(1,e,n);yy("Data must be an object, but it was:",i,r);const s=[],o=en.empty();ys(r,(l,u)=>{const f=vy(e,l,n);u=bt(u);const m=i.yc(f);if(u instanceof Cf)s.push(f);else{const _=fc(u,m);_!=null&&(s.push(f),o.set(f,_))}});const a=new yn(s);return new $A(o,a,i.fieldTransforms)}function y6(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[fg(e,r,n)],l=[i];if(s.length%2!=0)throw new re(J.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)a.push(fg(e,s[_])),l.push(s[_+1]);const u=[],f=en.empty();for(let _=a.length-1;_>=0;--_)if(!KA(u,a[_])){const v=a[_];let E=l[_];E=bt(E);const P=o.yc(v);if(E instanceof Cf)u.push(v);else{const M=fc(E,P);M!=null&&(u.push(v),f.set(v,M))}}const m=new yn(u);return new $A(f,m,o.fieldTransforms)}function v6(t,e,n,r=!1){return fc(n,t.Cc(r?4:3,e))}function fc(t,e){if(WA(t=bt(t)))return yy("Unsupported field value:",e,t),HA(t,e);if(t instanceof hc)return function(r,i){if(!jA(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=fc(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=bt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return a4(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=ze.fromDate(r);return{timestampValue:ja(i.serializer,s)}}if(r instanceof ze){const s=new ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ja(i.serializer,s)}}if(r instanceof pr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pn)return{bytesValue:$C(i.serializer,r._byteString)};if(r instanceof dt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:K_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof mr)return function(o,a){return{mapValue:{fields:{[B_]:{stringValue:G_},[Ua]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return z_(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${af(r)}`)}(t,e)}function HA(t,e){const n={};return uC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ys(t,(r,i)=>{const s=fc(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function WA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ze||t instanceof pr||t instanceof Pn||t instanceof dt||t instanceof hc||t instanceof mr)}function yy(t,e,n){if(!WA(n)||!Kx(n)){const r=af(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function fg(t,e,n){if((e=bt(e))instanceof dc)return e._internalPath;if(typeof e=="string")return vy(t,e);throw Mh("Field path arguments must be of type string or ",t,!1,void 0,n)}const T6=new RegExp("[~\\*/\\[\\]]");function vy(t,e,n){if(e.search(T6)>=0)throw Mh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new dc(...e.split("."))._internalPath}catch{throw Mh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Mh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new re(J.INVALID_ARGUMENT,a+t+l)}function KA(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new dt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new E6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ty("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class E6 extends JA{data(){return super.data()}}function Ty(t,e){return typeof e=="string"?vy(t,e):e instanceof dc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ey{}class YA extends Ey{}function ql(t,e,...n){let r=[];e instanceof Ey&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof Af).length,a=s.filter(l=>l instanceof pc).length;if(o>1||o>0&&a>0)throw new re(J.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class pc extends YA{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new pc(e,n,r)}_apply(e){const n=this._parse(e);return XA(e._query,n),new vs(e.firestore,e.converter,eg(e._query,n))}_parse(e){const n=gy(e.firestore);return function(s,o,a,l,u,f,m){let _;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new re(J.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Qw(m,f);const E=[];for(const P of m)E.push(Jw(l,s,P));_={arrayValue:{values:E}}}else _=Jw(l,s,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Qw(m,f),_=v6(a,o,m,f==="in"||f==="not-in");return ke.create(u,f,_)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function zl(t,e,n){const r=e,i=Ty("where",t);return pc._create(i,r,n)}class Af extends Ey{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Af(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:je.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)XA(o,l),o=eg(o,l)}(e._query,n),new vs(e.firestore,e.converter,eg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Jw(t,e,n){if(typeof(n=bt(n))=="string"){if(n==="")throw new re(J.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!CC(e)&&n.indexOf("/")!==-1)throw new re(J.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(qe.fromString(n));if(!ie.isDocumentKey(r))throw new re(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ou(t,new ie(r))}if(n instanceof dt)return Ou(t,n._key);throw new re(J.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${af(n)}.`)}function Qw(t,e){if(!Array.isArray(t)||t.length===0)throw new re(J.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XA(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(J.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(J.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class ZA{convertValue(e,n="none"){switch(us(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ot(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ai(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ue(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ys(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[Ua].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>ot(o.doubleValue));return new mr(n)}convertGeoPoint(e){return new pr(ot(e.latitude),ot(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=ff(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Fu(e));default:return null}}convertTimestamp(e){const n=oi(e);return new ze(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=qe.fromString(e);pe(eA(r),9688,{name:e});const i=new ls(r.get(1),r.get(3)),s=new ie(r.popFirst(5));return i.isEqual(n)||ln(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w6(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class ca{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ns extends JA{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new cu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ty("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(J.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ns._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ns._jsonSchemaVersion="firestore/documentSnapshot/1.0",ns._jsonSchema={type:xt("string",ns._jsonSchemaVersion),bundleSource:xt("string","DocumentSnapshot"),bundleName:xt("string"),bundle:xt("string")};class cu extends ns{data(e={}){return super.data(e)}}class rs{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ca(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new cu(this._firestore,this._userDataWriter,r.key,r,new ca(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new cu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ca(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new cu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ca(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:I6(a.type),doc:l,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(J.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=rs._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=of.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function I6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pg(t){t=dn(t,dt);const e=dn(t.firestore,Vr);return c6(cc(e),t._key).then(n=>eR(e,t,n))}rs._jsonSchemaVersion="firestore/querySnapshot/1.0",rs._jsonSchema={type:xt("string",rs._jsonSchemaVersion),bundleSource:xt("string","QuerySnapshot"),bundleName:xt("string"),bundle:xt("string")};class wy extends ZA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new dt(this.firestore,null,n)}}function Ni(t){t=dn(t,vs);const e=dn(t.firestore,Vr),n=cc(e),r=new wy(e);return QA(t._query),d6(n,t._query).then(i=>new rs(e,r,t,i))}function gt(t,e,n){t=dn(t,dt);const r=dn(t.firestore,Vr),i=w6(t.converter,e,n);return Rf(r,[g6(gy(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,un.none())])}function mg(t,e,n,...r){t=dn(t,dt);const i=dn(t.firestore,Vr),s=gy(i);let o;return o=typeof(e=bt(e))=="string"||e instanceof dc?y6(s,"updateDoc",t._key,e,n,r):_6(s,"updateDoc",t._key,e),Rf(i,[o.toMutation(t._key,un.exists(!0))])}function zt(t){return Rf(dn(t.firestore,Vr),[new yf(t._key,un.none())])}function zr(t,...e){var l,u,f;t=bt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Kw(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Kw(e[r])){const m=e[r];e[r]=(l=m.next)==null?void 0:l.bind(m),e[r+1]=(u=m.error)==null?void 0:u.bind(m),e[r+2]=(f=m.complete)==null?void 0:f.bind(m)}let s,o,a;if(t instanceof dt)o=dn(t.firestore,Vr),a=ic(t._key.path),s={next:m=>{e[r]&&e[r](eR(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=dn(t,vs);o=dn(m.firestore,Vr),a=m._query;const _=new wy(o);s={next:v=>{e[r]&&e[r](new rs(o,_,m,v))},error:e[r+1],complete:e[r+2]},QA(t._query)}return function(_,v,E,P){const M=new py(P),C=new dy(v,M,E);return _.asyncQueue.enqueueAndForget(async()=>ly(await Dh(_),C)),()=>{M.Nu(),_.asyncQueue.enqueueAndForget(async()=>uy(await Dh(_),C))}}(cc(o),a,i,s)}function Rf(t,e){return function(r,i){const s=new br;return r.asyncQueue.enqueueAndForget(async()=>XO(await u6(r),i,s)),s.promise}(cc(t),e)}function eR(t,e,n){const r=n.docs.get(e._key),i=new wy(t);return new ns(t,i,e._key,r,new ca(n.hasPendingWrites,n.fromCache),e.converter)}function S6(){return new _y("serverTimestamp")}(function(e,n=!0){(function(i){rl=i})(tl),Na(new co("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Vr(new eU(r.getProvider("auth-internal")),new rU(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new re(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ls(u.options.projectId,f)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Zi(PE,kE,e),Zi(PE,kE,"esm2020")})();const Vs=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:ZA,Bytes:Pn,CollectionReference:Zr,DocumentReference:dt,DocumentSnapshot:ns,FieldPath:dc,FieldValue:hc,Firestore:Vr,FirestoreError:re,GeoPoint:pr,Query:vs,QueryCompositeFilterConstraint:Af,QueryConstraint:YA,QueryDocumentSnapshot:cu,QueryFieldFilterConstraint:pc,QuerySnapshot:rs,SnapshotMetadata:ca,Timestamp:ze,VectorValue:mr,_AutoId:of,_ByteString:wt,_DatabaseId:ls,_DocumentKey:ie,_EmptyAuthCredentialsProvider:$x,_FieldPath:lt,_cast:dn,_logWarn:as,_validateIsNotUsedTogether:Wx,collection:st,connectFirestoreEmulator:BA,deleteDoc:zt,doc:Ne,enableIndexedDbPersistence:zA,ensureFirestoreConfigured:cc,executeWrite:Rf,getDoc:pg,getDocs:Ni,getFirestore:GA,onSnapshot:zr,query:ql,serverTimestamp:S6,setDoc:gt,setLogLevel:Gx,updateDoc:mg,where:zl},Symbol.toStringTag,{value:"Module"}));Gx("error");const x6={apiKey:"AIzaSyC1zhlBnbOxP_PCaHU6L-UsDOBRTjGgpfk",authDomain:"my-apss-da774.firebaseapp.com",projectId:"my-apss-da774",storageBucket:"my-apss-da774.firebasestorage.app",messagingSenderId:"528434940137",appId:"1:528434940137:web:56be66185a46f390b60878",measurementId:"G-WPGZGF4ZBG"},tR=ex(x6),Gs=YF(tR);UL(Gs,xx).catch(t=>console.error("Persistence error:",t));const Wa=new Hr;Wa.addScope("profile");Wa.addScope("email");Wa.setCustomParameters({prompt:"select_account",access_type:"offline"});if(typeof window<"u"){const t=navigator.userAgent.toLowerCase();t.includes("safari")&&!t.includes("chrome")&&!t.includes("firefox")&&Wa.setCustomParameters({prompt:"consent"})}const fe=GA(tR);zA(fe).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore: Multiple tabs open, persistence disabled"):t.code==="unimplemented"&&console.warn("Firestore: Browser does not support persistence")});const Rt=t=>{if(t==null)return;if(typeof t!="object")return t;if(Array.isArray(t)){const r=t.filter(i=>i!==void 0).map(i=>Rt(i)).filter(i=>i!==void 0);return r.length>0?r:void 0}let e;try{e=Object.entries(t)}catch(r){console.error("sanitizeFirestoreData: failed to enumerate object",r,t);return}const n={};for(const[r,i]of e)if(!(i===void 0||typeof i=="string"&&i.trim()===""))if(typeof i=="object"&&i!==null){const s=Rt(i);s!==void 0&&(n[r]=s)}else n[r]=i;return Object.keys(n).length>0?n:void 0},C6=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i,Pp=()=>{const t=C6.test(navigator.userAgent),e=navigator.maxTouchPoints&&navigator.maxTouchPoints>2,n=window.innerWidth<=768;return t||e&&n},Yw=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,kp=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",A6=({onClose:t})=>{const[e,n]=G.useState(null),[r,i]=G.useState(!1),[s,o]=G.useState(!1);G.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent),f=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(navigator.userAgent);i(l),o(f);const m=_=>{_.preventDefault(),n(_)};return window.addEventListener("beforeinstallprompt",m),()=>{window.removeEventListener("beforeinstallprompt",m)}},[]);const a=async()=>{if(e){e.prompt();const{outcome:l}=await e.userChoice;l==="accepted"&&(n(null),t())}};return s?p.jsx("div",{className:"pwa-fullscreen-prompt",children:p.jsxs("div",{className:"pwa-fullscreen-content",children:[p.jsxs("div",{className:"pwa-fullscreen-header",children:[p.jsx("div",{className:"w-20 h-20 bg-indigo-600 rounded-lg mx-auto mb-6 flex items-center justify-center",children:p.jsx("span",{className:"text-white text-4xl font-bold",children:"N"})}),p.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Nova  "}),p.jsx("p",{className:"text-lg text-gray-200 mb-4",children:"     "})]}),p.jsx("div",{className:"pwa-fullscreen-body",children:r?p.jsxs("div",{children:[p.jsx("div",{className:"pwa-instruction-box mb-6",children:p.jsx("p",{className:"text-white font-semibold mb-4",children:"iOS  :"})}),p.jsxs("ol",{className:"pwa-instruction-steps",children:[p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"1"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"   "}),p.jsx("p",{className:"text-sm",children:"    () "})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"2"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"   "}),p.jsx("p",{className:"text-sm",children:'   "  " '})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"3"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"  "}),p.jsx("p",{className:"text-sm",children:'  ""    '})]})]})]})]}):p.jsxs("div",{children:[p.jsx("div",{className:"pwa-instruction-box mb-6",children:p.jsx("p",{className:"text-white font-semibold mb-4",children:"Android  :"})}),p.jsxs("ol",{className:"pwa-instruction-steps",children:[p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"1"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"  "}),p.jsx("p",{className:"text-sm",children:"    ()    "})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"2"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:"  "}),p.jsx("p",{className:"text-sm",children:'"  "  " "  '})]})]}),p.jsxs("li",{className:"pwa-instruction-step",children:[p.jsx("div",{className:"step-number",children:"3"}),p.jsxs("div",{className:"step-content",children:[p.jsx("p",{className:"font-semibold",children:" "}),p.jsx("p",{className:"text-sm",children:'  ""   '})]})]})]}),e&&p.jsx("button",{onClick:a,className:"pwa-install-button mt-6",children:" "})]})}),p.jsx("div",{className:"pwa-fullscreen-footer",children:p.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"       "})})]})}):p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:p.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm w-full",children:[p.jsxs("div",{className:"text-center mb-4",children:[p.jsx("div",{className:"w-16 h-16 bg-indigo-600 rounded-lg mx-auto mb-4 flex items-center justify-center",children:p.jsx("span",{className:"text-white text-2xl font-bold",children:"N"})}),p.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:" "}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Nova AI Planner      ."})]}),r?p.jsxs("div",{className:"mb-4",children:[p.jsx("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-3",children:p.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"iOS  :"})}),p.jsxs("ol",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-2",children:[p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"1"}),"   () "]}),p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),'"  " ']}),p.jsxs("li",{className:"flex items-center",children:[p.jsx("span",{className:"w-6 h-6 bg-indigo-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),'""  ']})]})]}):p.jsx("div",{className:"mb-4",children:e?p.jsx("button",{onClick:a,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors",children:" "}):p.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:'  "  "  " " .'})})}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsx("button",{onClick:t,className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:""}),p.jsx("button",{onClick:()=>{localStorage.setItem("pwa-prompt-dismissed","true"),t()},className:"flex-1 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"  "})]})]})})},R6=({todos:t,onEditTodo:e,t:n})=>{const r=G.useMemo(()=>t.filter(i=>i.wish&&i.wish.trim()||i.outcome&&i.outcome.trim()||i.obstacle&&i.obstacle.trim()||i.plan&&i.plan.trim()),[t]);return r.length===0?null:p.jsxs("div",{className:"woop-section",children:[p.jsx("div",{className:"woop-title",children:"WOOP "}),p.jsx("div",{className:"woop-cards-container",children:r.map(i=>p.jsxs("div",{className:"woop-card-item",onClick:()=>e(i),style:{cursor:"pointer"},children:[p.jsxs("div",{className:"woop-field",children:[p.jsx("div",{className:"woop-field-label",children:" Wish ()"}),p.jsx("div",{className:"woop-field-content",children:i.wish?p.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.wish}):p.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),p.jsxs("div",{className:"woop-field",children:[p.jsx("div",{className:"woop-field-label",children:"Outcome ()"}),p.jsx("div",{className:"woop-field-content",children:i.outcome?p.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.outcome}):p.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),p.jsxs("div",{className:"woop-field",children:[p.jsx("div",{className:"woop-field-label",children:"Obstacle ()"}),p.jsx("div",{className:"woop-field-content",children:i.obstacle?p.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.obstacle}):p.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),p.jsxs("div",{className:"woop-field",children:[p.jsx("div",{className:"woop-field-label",children:"plan ()"}),p.jsx("div",{className:"woop-field-content",children:i.plan?p.jsx("div",{style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i.plan}):p.jsx("span",{className:"woop-empty",children:n("woop_not_set")})})]}),p.jsx("button",{className:"woop-card-btn",onClick:s=>{s.stopPropagation(),e(i)},style:{marginTop:"auto",width:"100%"},children:""})]},i.id))})]})},P6={ko:{language_selection_title:"",error_wish_required:" ",error_outcome_required:" ",error_obstacle_required:" ",error_plan_required:" ",error_deadline_required:" ",error_day_required:" ",my_goals_title:"",all_goals_label:" ",all_goals_button:"",sort_label_manual:"",sort_label_deadline:"",sort_label_newest:"",sort_label_alphabetical:"",sort_label_ai:"",ai_sorting_button:" ",add_new_goal_button_label:" ",filter_all:" ",filter_active:" ",filter_completed:"",filter_category:"",category_all:" ",category_school:"",category_work:"",category_personal:"",category_other:"",category_label:"",empty_message_all:"  ",empty_message_active:"   ",empty_message_completed:"  ",empty_encouragement_1:"  ",empty_encouragement_2:"    ",empty_encouragement_3:"   ",empty_encouragement_4:"  ",delete_button:"",edit_button_aria:"",info_button_aria:"",filter_title:"",sort_title:"",filter_sort_button_aria:"  ",category_filter_button_aria:" ",calendar_view_button_aria:"",list_view_button_aria:"",more_options_button_aria:"",select_button_label:"",cancel_selection_button_label:"",delete_selected_button_label:"{count} ",selection_summary_label:"{count}/{total} ",select_all_button_label:" ",delete_selected_confirm_title:" ",delete_selected_confirm_message:"{count}  .     .",days_left:"{count} ",d_day:"",days_overdue:"{count} ",month_names:["1","2","3","4","5","6","7","8","9","10","11","12"],day_names_short:["","","","","","",""],day_names_long:["","","","","","",""],calendar_header_month_format:"{year} {month}",calendar_view_day3:"3",calendar_view_week:"",calendar_view_month:"",settings_title:"",sort_alert_title:"  ",sort_alert_message:"2   ",ai_sort_error_title:" ",ai_sort_error_message:"  .  .",confirm_button:"",new_goal_modal_title:" ",edit_goal_modal_title:" ",wish_label:"",outcome_label:"",obstacle_label:"",plan_label:"",deadline_label:"",cancel_button:"",add_button:"",save_button:"",goal_details_modal_title:" ",todo_details_title:" ",task_title_label:"",due_date_label:"",time_label:"",completion_status_label:" ",completed:"",pending:" ",ai_coach_suggestion:" ",ai_analyzing:" ",close_button:"",ai_sort_reason_modal_title:"AI ",ai_sort_criteria:" ",delete_account_final_confirm_title:"  ",delete_account_final_confirm_message:"   .     .",delete_all_data_button:"  ",settings_done_button:"",settings_section_data:"",settings_section_account:"",settings_sync_data:" ",settings_syncing:" ",settings_save_to_cloud:"Google ",settings_loading:" ",settings_load_from_cloud:" ",settings_auto_sync:" ",settings_auto_sync_desc:"  ",settings_cloud_sync_header:"Google ",woop_not_set:"",settings_logout:"",settings_export_data:"",settings_import_data:"",import_confirm_title:" ",import_confirm_message:"    .   .",import_success_toast:" ",import_error_alert_title:" ",import_error_alert_message:"   .  .",settings_section_general:"",settings_section_info:"",settings_section_help:"",settings_theme_mode:"",theme_mode_light:"",theme_mode_light_desc:" ",theme_mode_dark:"",theme_mode_dark_desc:" ",theme_mode_system:"",theme_mode_system_desc:"  ",settings_dark_mode:" ",settings_language:"",settings_api_key:"AI ",settings_api_key_placeholder:"API  ",settings_offline_mode:" ",settings_offline_mode_desc:"AI  ",settings_notifications:"",settings_notifications_desc:" ",notification_settings_title:" ",notification_permission_denied:" ",notification_permission_denied_desc:"     ",notification_permission_request:"  ",reminder_add_title:" ",reminder_step_title:"{step}/5 ",reminder_step1_title:" ",reminder_step1_desc:"  ",reminder_step2_title:"  &  ",reminder_step2_desc:"    ()",reminder_step2_date_toggle:" ",reminder_step2_time_toggle:" ",reminder_step3_title:"  ",reminder_step3_desc:"    ",reminder_step3_enable_recurring:" ",reminder_step4_title:" ",reminder_step4_desc:"   ()",reminder_step5_title:" ",reminder_step5_desc:"   ",reminder_next_button:"",reminder_back_button:"",reminder_submit_button:"",reminder_form_title:"",reminder_form_date:"",reminder_form_time:"",reminder_form_recurring:"",reminder_form_description:"",reminder_form_enabled:"",recurring_type_none:" ",recurring_type_daily:"",recurring_type_weekly:"",recurring_type_monthly:"",notification_deadline:"  ",notification_deadline_desc:"     .",notification_suggestion:" ",notification_suggestion_desc:"   .",notification_achievement:"  ",notification_achievement_desc:"    .",notification_reminder:" ",notification_reminder_desc:"    .",reminder_time_settings_title:"  ",reminder_start_time:" ",reminder_end_time:" ",language_name:" ()",language_modal_title:"",settings_section_background:"",settings_bg_default:"",settings_bg_default_dark:"",settings_bg_pink:"",settings_bg_cherry_noir:" ",settings_bg_blue:"",settings_bg_deep_ocean:"",settings_bg_green:"",settings_bg_forest_green:" ",settings_bg_purple:"",settings_bg_royal_purple:" ",settings_version:"",folder_manage_title:" ",folder_manage_info:" ",folder_manage_collaborators:"",folder_manage_settings:"",folder_name_edit:"  ",folder_invite_new:"  ",assignment_management:" ",add_assignment:" ",assignment_name:"",subject:"",estimated_time:" ()",difficulty:"",due_date:" ",today_schedule:"   ",minutes:"",difficulty_level:" ",auto_allocated:" ",ai_analysis:"AI ",ai_estimate_time:" AI ",ai_estimate_difficulty:" AI ",ai_optimize_schedule:" AI ",ai_suggestion:"AI ",assignment_description:" ",assignment_description_placeholder:"    (AI     )",folder_invite_email:"   ",folder_invite_role:"",folder_role_owner:"",folder_role_editor:"",folder_role_viewer:"",folder_invite_button:"",folder_leave:" ",folder_delete:" ",folder_share_link:" ",folder_share_link_desc:"      ",folder_copy_link:" ",folder_leave_confirm:" ?",folder_delete_confirm:" ?       .",settings_developer:"",developer_name:"Kim Kyumin",settings_copyright:"",copyright_notice:" 2025 Kim Kyumin. All Rights Reserved.",build_number:" ",settings_data_header:" ",settings_data_header_desc:"   ,  .",settings_background_header:"",settings_background_header_desc:"     .",data_importing:" ...",data_exporting:" ...",data_deleting:" ...",url_import_title:"URL  ",url_import_message:"URL     ?",url_import_confirm:"",url_import_success:"URL   !",url_import_error:"URL   .",settings_share_link_header:" ",settings_generate_link:"  ",settings_copy_link:"",link_copied_toast:" .",short_url_created:"URL !",share_link_created:"URL ",short_url_failed:"URL     .",no_data_to_share:"  .",usage_guide_tab:"",usage_guide_title:" ",usage_basic_title:" ",usage_basic_desc:`1.   "   "  .
2. , , ,   .
3.    .
4. ""    .`,usage_ai_title:"Gemini AI  ",usage_ai_desc:`    ""  Gemini AI   .
   " "     .
 Gemini AI       .

 Gemini AI    API   .`,usage_ai_setup_title:"Gemini AI ",usage_ai_setup_desc:`1.  >  "Gemini AI "  .
2. Google Gemini API  .
3. API     Google   :
   https://ai.google.dev/gemini-api/docs/api-key
4.    Gemini AI  .`,usage_share_title:" ",usage_share_desc:`1.  >  "  "  .
2.     .
3. " "   .
4.    .`,usage_theme_title:" ",usage_theme_desc:`1.  >     .
2.     .
3. , , , ,     .
4.    .`,usage_calendar_title:"  ",usage_calendar_desc:`1.     .
2. 3//    .
3.      .
4.      .`,usage_offline_title:"  ",usage_offline_desc:`1.  >  " "  .
2. API    , ,  .
3. AI         .
4.    .`,goal_assistant_title:" ",goal_assistant_mode_woop:"WOOP",goal_assistant_mode_automation:" ",automation_title:"  ",automation_base_name_label:" ",automation_base_name_placeholder:":   ",automation_total_units_label:" ",automation_total_units_placeholder:": 30",automation_units_per_day_label:" ",automation_period_label:"",automation_start_date_label:"",automation_end_date_label:"",automation_generate_button:"{count} ",automation_error_all_fields:"   .",automation_error_start_after_end:"   .",automation_error_short_period:"  . (1 )",next_button:"",back_button:"",wish_tip:"  ,    .",wish_example:": 3  5kg ,   90  ",outcome_tip:"          .",outcome_example:":     ,   ",obstacle_tip:"      (,  ) ?",obstacle_example:":       ,    ",plan_tip:"' ~, ~'       .",plan_example:":      ,    10 .",recurrence_label:"",recurrence_tip:"     ?      .",recurrence_example:":  ,,  ",recurrence_option_daily:" ",deadline_tip:"    .     .",deadline_option_no_deadline:" ",day_names_short_picker:["","","","","","",""],settings_delete_account:"   ",edit_todo_title:" ",todo_title_label:" ",todo_title_placeholder:" ",recurring_label:" ",recurring_days_label:" ",delete_account_header:" ",delete_account_header_desc:"    ,     .",version_update_title:" ",version_update_1_title:"Firebase  ",version_update_1_desc:"Google        .   Google     .",version_update_2_title:"  ",version_update_2_desc:", ,           .",version_update_3_title:" ",version_update_3_desc:"     ,      .",version_update_4_title:"  UI",version_update_4_desc:", ,           ."},en:{language_selection_title:"Language",error_wish_required:"Enter your goal",error_outcome_required:"Enter the outcome",error_obstacle_required:"Enter the obstacle",error_plan_required:"Enter your plan",error_deadline_required:"Select a date",error_day_required:"Select a day",my_goals_title:"Goals",all_goals_label:"All",all_goals_button:"All",sort_label_manual:"Manual",sort_label_deadline:"By Date",sort_label_newest:"Recent",sort_label_alphabetical:"Name",sort_label_ai:"Priority",ai_sorting_button:"Sorting",add_new_goal_button_label:"Add Goal",filter_all:"All Goals",filter_active:"In Progress",filter_completed:"Complete",filter_category:"Category",category_all:"All Categories",category_school:"School",category_work:"Work",category_personal:"Personal",category_other:"Other",category_label:"Category",empty_message_all:"Add your first goal",empty_message_active:"No goals in progress",empty_message_completed:"No completed goals",empty_encouragement_1:"Take the first step",empty_encouragement_2:"Small changes lead to big achievements",empty_encouragement_3:"Today is the perfect day to start",empty_encouragement_4:"Turn your goals into reality",delete_button:"Delete",edit_button_aria:"Edit",info_button_aria:"Info",filter_title:"Filter",sort_title:"Sort",filter_sort_button_aria:"Filter & Sort",category_filter_button_aria:"Category Filter",calendar_view_button_aria:"Calendar",list_view_button_aria:"List",more_options_button_aria:"More",select_button_label:"Select",cancel_selection_button_label:"Cancel",delete_selected_button_label:"Delete {count}",selection_summary_label:"{count} of {total} selected",select_all_button_label:"Select All",delete_selected_confirm_title:"Delete Goals",delete_selected_confirm_message:"{count} goals will be deleted. This cannot be undone.",days_left:"{count} days left",d_day:"Due Today",days_overdue:"{count} days overdue",month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],day_names_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],calendar_header_month_format:"{month} {year}",calendar_view_day3:"3-Day",calendar_view_week:"Week",calendar_view_month:"Month",settings_title:"Settings",sort_alert_title:"Unable to Sort",sort_alert_message:"Add at least two goals to use priority order.",ai_sort_error_title:"Unable to Sort",ai_sort_error_message:"Cannot connect to server. Please try again later.",confirm_button:"OK",new_goal_modal_title:"New Goal",edit_goal_modal_title:"Edit Goal",wish_label:"Wish",outcome_label:"Outcome",obstacle_label:"Obstacle",plan_label:"If-Then Plan",deadline_label:"Deadline",cancel_button:"Cancel",add_button:"Add",save_button:"Save",goal_details_modal_title:"Goal Details",todo_details_title:"Task Details",task_title_label:"Task",due_date_label:"Due Date",time_label:"Time",completion_status_label:"Status",completed:"Completed",pending:"In Progress",ai_coach_suggestion:"View Summary",ai_analyzing:"Analyzing...",close_button:"Close",ai_sort_reason_modal_title:"Sort Reason",ai_sort_criteria:" Sort Criteria",delete_account_final_confirm_title:"Delete All Data",delete_account_final_confirm_message:"All your goals and data will be permanently deleted. This action cannot be undone.",delete_all_data_button:"Delete All Data",settings_done_button:"Done",settings_section_data:"Data Management",settings_export_data:"Export",settings_import_data:"Import",import_confirm_title:"Import Data",import_confirm_message:"This will replace your current goals with new data. This action cannot be undone.",import_success_toast:"Data imported successfully.",import_error_alert_title:"Import Failed",import_error_alert_message:"There was an error reading the file, or the file format is incorrect.",settings_section_general:"General",settings_section_info:"Information",settings_section_help:"How to Use",settings_theme_mode:"Theme Mode",theme_mode_light:"Light Mode",theme_mode_light_desc:"Use bright theme",theme_mode_dark:"Dark Mode",theme_mode_dark_desc:"Use dark theme",theme_mode_system:"Follow System Settings",theme_mode_system_desc:"Automatically adjust to device settings",settings_dark_mode:"Dark Mode",settings_language:"Language",settings_api_key:"Gemini AI Setup",settings_api_key_placeholder:"Enter Gemini API key",settings_offline_mode:"Offline Mode",settings_offline_mode_desc:"Use basic features without AI",settings_notifications:"Notifications",settings_notifications_desc:"PWA notification settings",notification_settings_title:"What notifications would you like?",notification_permission_denied:"Notifications Blocked",notification_permission_denied_desc:"Enable notifications in settings to use this feature",notification_permission_request:"Request Permission",notification_deadline:"Deadline Alerts",notification_deadline_desc:"Get notified when deadlines are approaching.",notification_suggestion:"Today's Suggestions",notification_suggestion_desc:"Get suggestions on what to do today.",notification_achievement:"Achievement Celebration",notification_achievement_desc:"Celebrate when you achieve a goal.",notification_reminder:"General Todo",notification_reminder_desc:"Get notified at scheduled times.",reminder_time_settings_title:"Todo Time Settings",reminder_start_time:"Start Time",reminder_end_time:"End Time",reminder_add_title:"Add Todo",reminder_step_title:"Step {step}/5",reminder_step1_title:" Title",reminder_step1_desc:"Enter the todo title",reminder_step2_title:" Date &  Time",reminder_step2_desc:"Set the todo date and time (optional)",reminder_step2_date_toggle:"Set Date",reminder_step2_time_toggle:"Set Time",reminder_step3_title:" Recurring",reminder_step3_desc:"Choose recurrence settings",reminder_step3_enable_recurring:"Enable Recurring",reminder_step4_title:" Description",reminder_step4_desc:"Add optional description",reminder_step5_title:" Enable",reminder_step5_desc:"Choose whether to enable todo",reminder_next_button:"Next",reminder_back_button:"Back",reminder_submit_button:"Add",reminder_form_title:"Title",reminder_form_date:"Date",reminder_form_time:"Time",reminder_form_recurring:"Recurring",reminder_form_description:"Description",reminder_form_enabled:"Enabled",recurring_type_none:"No Recurrence",recurring_type_daily:"Daily",recurring_type_weekly:"Weekly",recurring_type_monthly:"Monthly",language_name:"English (US)",language_modal_title:"Language",settings_section_background:"Appearance",settings_share_link_header:"Share via Link",settings_generate_link:"Generate Share Link",settings_bg_default:"Light",settings_bg_default_dark:"Dark",settings_bg_pink:"Pink",settings_bg_cherry_noir:"Cherry Noir",settings_bg_blue:"Blue",settings_bg_deep_ocean:"Ocean",settings_bg_green:"Green",settings_bg_forest_green:"Forest",settings_bg_purple:"Purple",settings_bg_royal_purple:"Royal Purple",settings_section_account:"Nova AI Planner Account",settings_sync_data:"Sync Data",settings_syncing:"Saving...",settings_save_to_cloud:"Save to Cloud",settings_loading:"Loading...",settings_load_from_cloud:"Load from Cloud",settings_auto_sync:"Auto Sync",settings_auto_sync_desc:"Automatically save when goals change",settings_cloud_sync_header:"Cloud Sync",woop_not_set:"Not Set",settings_logout:"Sign Out",settings_delete_account:"Delete My Data",edit_todo_title:"Edit Todo",todo_title_label:"Todo Title",todo_title_placeholder:"Enter your todo",recurring_label:"Recurring",recurring_days_label:"Recurring Days",delete_account_header:"Delete Data",delete_account_header_desc:"This action is irreversible and will permanently delete all your goals and data.",data_deleting:"Deleting...",settings_version:"Version",settings_developer:"Developer",developer_name:"GimGyuMin",settings_copyright:"Copyright",copyright_notice:" 2025 GimGyuMin. All Rights Reserved.",build_number:"Build Number",settings_data_header:"Data Management",settings_data_header_desc:"Export or import your goal data.",settings_background_header:"Background",settings_background_header_desc:"Change the app's background style to express your personality.",data_importing:"Importing...",data_exporting:"Exporting..."}},we={add:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),p.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),check:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"20 6 9 17 4 12"})}),info:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"12",cy:"12",r:"10"}),p.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),p.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),delete:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("polyline",{points:"3 6 5 6 21 6"}),p.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),p.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),p.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),edit:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),p.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),close:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),p.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),back:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"15 18 9 12 15 6"})}),forward:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polyline",{points:"9 18 15 12 9 6"})}),calendar:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),p.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),p.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),p.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),list:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),p.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),p.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),p.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),p.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),p.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),settings:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"12",cy:"12",r:"3"}),p.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),filter:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),ai:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M12 3L14.34 8.66L20 11L14.34 13.34L12 19L9.66 13.34L4 11L9.66 8.66L12 3Z"}),p.jsx("path",{d:"M5 21L7 16"}),p.jsx("path",{d:"M19 21L17 16"})]}),flame:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:p.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"})}),data:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),p.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),background:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),p.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),p.jsx("polyline",{points:"21 15 16 10 5 21"})]}),exclamation:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm1-4h-2V7h2v6z"})})},du=(t,e)=>{const n=new Date(t),r=new Date(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()},k6=(t,e)=>{if(!t)return null;const n=new Date;n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=r.getTime()-n.getTime(),s=Math.ceil(i/(1e3*60*60*24));return s===0?e("d_day"):s>0?e("days_left").replace("{count}",String(s)):e("days_overdue").replace("{count}",String(Math.abs(s)))},Xw=(t,e=1)=>{const n=new Date(t),r=n.getDay(),i=(r<e?7:0)+r-e;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n},gg=t=>!!(t.wish||t.outcome||t.obstacle||t.plan),_g=t=>{try{const e=new TextEncoder().encode(t),n=Array.from(e).map(r=>String.fromCharCode(r)).join("");return btoa(n)}catch(e){return console.error("UTF-8 to Base64 encoding failed:",e),""}},Zw=t=>{try{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)}catch(e){return console.error("Base64 to UTF-8 decoding failed:",e),""}},eI=t=>{try{const n=JSON.stringify(t).replace(/\s+/g," ").trim();return _g(n)}catch(e){return console.error("Data compression failed:",e),_g(JSON.stringify(t))}},nR=async t=>{if(t.length<1500)return t;const e=[{name:"is.gd",createUrl:async n=>{const r=await fetch(`https://is.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("is.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from is.gd");return i.trim()}},{name:"tinyurl",createUrl:async n=>new Promise((r,i)=>{const s=`tinyurl_${Date.now()}`,o=document.createElement("script"),a=setTimeout(()=>{l(),i(new Error("TinyURL timeout"))},5e3),l=()=>{clearTimeout(a),o.parentNode&&document.head.removeChild(o),delete window[s]};window[s]=u=>{l(),u&&typeof u=="string"&&!u.includes("Error")&&u.startsWith("http")?r(u.trim()):i(new Error("Invalid TinyURL response"))},o.onerror=()=>{l(),i(new Error("TinyURL script load failed"))},o.src=`https://tinyurl.com/api-create.php?url=${encodeURIComponent(n)}&callback=${s}`,document.head.appendChild(o)})},{name:"v.gd",createUrl:async n=>{const r=await fetch(`https://v.gd/create.php?format=simple&url=${encodeURIComponent(n)}`);if(!r.ok)throw new Error("v.gd API failed");const i=await r.text();if(i.includes("Error")||!i.startsWith("http"))throw new Error("Invalid response from v.gd");return i.trim()}}];for(const n of e)try{console.log(`Trying ${n.name} for URL shortening...`);const r=await n.createUrl(t);return console.log(` ${n.name} success:`,r),r}catch(r){console.warn(` ${n.name} failed:`,r);continue}return console.warn("All URL shortening services failed, using original URL"),t},yg=[{id:"default",lightThemeClass:"bg-solid-default",darkThemeClass:"bg-solid-default",lightNameKey:"settings_bg_default",darkNameKey:"settings_bg_default_dark"},{id:"pink",lightThemeClass:"bg-solid-pink",darkThemeClass:"bg-solid-pink",lightNameKey:"settings_bg_pink",darkNameKey:"settings_bg_cherry_noir"},{id:"blue",lightThemeClass:"bg-solid-blue",darkThemeClass:"bg-solid-blue",lightNameKey:"settings_bg_blue",darkNameKey:"settings_bg_deep_ocean"},{id:"green",lightThemeClass:"bg-solid-green",darkThemeClass:"bg-solid-green",lightNameKey:"settings_bg_green",darkNameKey:"settings_bg_forest_green"},{id:"purple",lightThemeClass:"bg-solid-purple",darkThemeClass:"bg-solid-purple",lightNameKey:"settings_bg_purple",darkNameKey:"settings_bg_royal_purple"}],N6=()=>{const[t,e]=G.useState("ko"),[n,r]=G.useState([]),[i,s]=G.useState([]),[o,a]=G.useState([]),[l,u]=G.useState([]),[f,m]=G.useState("my-goals"),[_,v]=G.useState("all"),[E,P]=G.useState("all"),[M,C]=G.useState("manual"),[w,A]=G.useState(["school","work","personal","other"]),[V,q]=G.useState(()=>kp()==="dark"),[z,S]=G.useState("system"),[x,R]=G.useState("default"),[N,D]=G.useState([]),[F,b]=G.useState({}),[Se,Qe]=G.useState([]),[Fe,Te]=G.useState(!1),[Z,ce]=G.useState(!1),[he,xe]=G.useState(null),[Me,Ct]=G.useState(!1),[be,Mt]=G.useState(!1),[Ce,Oe]=G.useState(""),[Ut,Ot]=G.useState(!1),[wn,Yn]=G.useState(null),[pt,oe]=G.useState(""),[Ke,yr]=G.useState(""),[In,Xn]=G.useState("editor"),[Ae,Be]=G.useState(!1),[Ge,sn]=G.useState(null),[Zn,mn]=G.useState(!1),[on,Fn]=G.useState(!1),[Je,Es]=G.useState(!1),[vt,ge]=G.useState(null),[fi,Lr]=G.useState(!1),[vr,Un]=G.useState(new Set),[Sn,Ee]=G.useState(""),[xn,er]=G.useState("idle"),[Fr,ae]=G.useState(!1),[et,pi]=G.useState(!1),[Bt,mc]=G.useState(""),[ws,Ur]=G.useState(!1),[Is,ol]=G.useState(void 0),[mi,gc]=G.useState(!1),[gi,Tr]=G.useState(""),[_i,al]=G.useState(!1),[yi,vi]=G.useState(!0),[Pf,tr]=G.useState("default"),[Q,Ss]=G.useState(null),[_c,yc]=G.useState(""),[kf,Iy]=G.useState(!1),[vc,So]=G.useState(!1),[xo,xs]=G.useState(!1),[Cs,Ye]=G.useState(!1),[Or,As]=G.useState(!1),[ll,Tc]=G.useState(!0),[Nf,bf]=G.useState(!1),[Ec,ul]=G.useState(0),[Df,cl]=G.useState("activity-based"),[Co,Mf]=G.useState(null),[On,nr]=G.useState(3e3),[Ao,Ti]=G.useState(!1),[Ro,Xe]=G.useState(!1),[Bn,Ei]=G.useState("todos");G.useEffect(()=>{const T=()=>{"Notification"in window&&tr(Notification.permission)};T();const k=()=>{T()};return window.addEventListener("focus",k),()=>window.removeEventListener("focus",k)},[]),G.useEffect(()=>{let T=null,k=null,O=null;const B=GL(Gs,async j=>{if(Ss(j),Tc(!1),j){console.log("    - Firebase   "),await dl(j),console.log("      ...");let H=null,K=null;const X=Ne(fe,"users",j.uid,"data","todos");T=zr(X,c=>{H&&clearTimeout(H),H=setTimeout(()=>{if(c.exists()){const y=c.data().todos||[];r(I=>{const L=I.filter(de=>de.isSharedTodo===!0),U=y.map(de=>({...de,isSharedTodo:!1}));return JSON.stringify(I.filter(de=>!de.isSharedTodo))!==JSON.stringify(U)?(console.log("     :",U.length,"  :",L.length),[...U,...L]):I})}},2e3)});const W=st(fe,"users",j.uid,"folders");k=zr(W,async c=>{K&&clearTimeout(K),K=setTimeout(async()=>{const g=[];c.forEach(I=>{const L=I.data(),U={id:I.id,name:L.name||"  ",color:L.color||"#007AFF",...L,collaborators:L.collaborators||[],ownerId:L.ownerId||j.uid};g.push(U)});const y=g.filter(I=>I.isShared&&I.ownerId&&I.ownerId!==j.uid);if(y.length>0){console.log("     :",y.map(L=>({id:L.id,name:L.name,ownerId:L.ownerId}))),O&&O();const I=[];for(const L of y)if(L.ownerId)try{const U=Ne(fe,"users",L.ownerId,"folders",L.id),Y=zr(U,At=>{if(At.exists()){const Gt=At.data();console.log("     :",{folderId:L.id,name:Gt.name,color:Gt.color}),u(qt=>qt.map(Tt=>Tt.id===L.id?{...Tt,name:Gt.name||Tt.name||" ",color:Gt.color||Tt.color,updatedAt:Gt.updatedAt||Tt.updatedAt}:Tt))}},At=>{console.error("     :",At)});I.push(Y);const de=st(fe,"users",L.ownerId,"todos"),$e=ql(de,zl("folderId","==",L.id));let Ve=null;const mt=zr($e,At=>{Ve&&clearTimeout(Ve),Ve=setTimeout(()=>{const Gt=[];At.forEach(qt=>{const Tt=qt.data();Gt.push({id:parseInt(qt.id),...Tt,isSharedTodo:!0})}),console.log("     :",{folderId:L.id,count:Gt.length}),r(qt=>{const Tt=qt.filter(Vc=>!(Vc.folderId===L.id&&Vc.isSharedTodo===!0)),bs=Gt.filter(Vc=>!Tt.some(rR=>rR.id===Vc.id)),Uo=[...Tt,...bs];return console.log("   :",{:qt.length,:qt.length-Tt.length,:bs.length,:Uo.length}),Uo})},1500)},At=>{console.warn("     :",{folderId:L.id,error:At.code})});I.push(mt)}catch(U){console.warn("     :",{folderId:L.id,error:U})}O=()=>{I.forEach(L=>L())}}u(I=>JSON.stringify(I)!==JSON.stringify(g)?(console.log("    :",g.map(U=>({id:U.id,name:U.name}))),g):I)},3e3)})}else console.log("    -  "),T&&(T(),T=null),k&&(k(),k=null),O&&(O(),O=null),r([]),u([]),e("ko"),S("system"),R("default"),Tr(""),A(["school","work","personal","other"])});return()=>{B(),T&&T(),k&&k(),O&&O()}},[]);const Br=G.useCallback(async()=>{So(!0);try{console.log(" Google  ..."),console.log("Auth :",Gs),console.log("Google Provider :",Wa);const T=window.open("","_blank","width=1,height=1");if(!T||T.closed||typeof T.closed>"u")throw new Error(" .    .");T.close(),console.log(" signInWithPopup  ...");const k=await oF(Gs,Wa);console.log("  :",k.user.email),Ss(k.user),Ee(" Google  !"),setTimeout(async()=>{var O;try{console.log("    ...");const{doc:B,getDoc:j}=await Ds(async()=>{const{doc:c,getDoc:g}=await Promise.resolve().then(()=>Vs);return{doc:c,getDoc:g}},void 0),H=B(fe,"users",k.user.uid,"data","todos"),K=await j(H);if(K.exists()){const c=K.data();r(c.todos||[]),console.log("    :",((O=c.todos)==null?void 0:O.length)||0)}else console.log("   -    "),r([]);const X=B(fe,"users",k.user.uid,"data","settings"),W=await j(X);if(W.exists()){const c=W.data();c.language&&e(c.language),c.themeMode&&S(c.themeMode),c.isDarkMode!==void 0&&q(c.isDarkMode),c.backgroundTheme&&R(c.backgroundTheme),c.apiKey&&Tr(c.apiKey)}Ee("  !  ")}catch(B){console.error("  :",B),Ee("     ")}So(!1),setTimeout(()=>Ee(""),3e3)},500),setTimeout(()=>Ee(""),3e3)}catch(T){console.error(" Google  :",T),console.error(" :",T.code),console.error(" :",T.message);let k="   .";switch(T.code){case"auth/popup-closed-by-user":k=" .";break;case"auth/popup-blocked":k=" .    .";break;case"auth/cancelled-popup-request":k="    .";break;case"auth/network-request-failed":k="  .";break;case"auth/too-many-requests":k="   .    .";break;case"auth/user-disabled":k=" .";break;case"auth/operation-not-allowed":k="Google   .  .";break;default:k=` : ${T.message}`}T.code!=="auth/popup-closed-by-user"&&ge({title:" ",message:k,confirmText:"",onConfirm:()=>ge(null)}),So(!1)}},[]),Vf=(T,k)=>{if(T===null)return;const O=l.map(B=>B.id===T?{...B,collaborators:k}:B);u(O),Is&&Is.id===T&&ol({...Is,collaborators:k}),Ee("   "),setTimeout(()=>Ee(""),3e3)},wc=G.useCallback(async()=>{xs(!0);try{if(Q){Ee("   ...");const T=n.filter(c=>c!=null),{doc:k,setDoc:O,serverTimestamp:B}=await Ds(async()=>{const{doc:c,setDoc:g,serverTimestamp:y}=await Promise.resolve().then(()=>Vs);return{doc:c,setDoc:g,serverTimestamp:y}},void 0),j=T.map(c=>Rt(c)).filter(c=>c!==void 0),H=k(fe,"users",Q.uid,"data","todos"),K={todos:j,lastSyncTime:B(),totalGoals:j.length,syncedAt:new Date().toISOString()},X=Rt(K);X?(await O(H,X),console.log(" Todos Firestore  :",{count:j.length})):console.error(" Todos   ");const W=k(fe,"users",Q.uid,"data","settings");await O(W,{language:t,themeMode:z,isDarkMode:V,backgroundTheme:x,updatedAt:B()})}await yE(Gs),Ss(null),r([]),e("ko"),R("default"),S("system"),q(kp()==="dark"),xe(null),mn(!1),ce(!1),Ee("  "),setTimeout(()=>Ee(""),3e3),xs(!1)}catch(T){console.error(" :",T),ge({title:" ",message:"   .",confirmText:"",onConfirm:()=>ge(null)}),xs(!1)}},[Q,n,t,z,V,x]),Rs=G.useCallback(async()=>{if(!Q){ge({title:" ",message:" ",confirmText:"",onConfirm:()=>ge(null)});return}Ye(!0);try{const T=n.filter(g=>g!=null),{doc:k,setDoc:O,serverTimestamp:B}=await Ds(async()=>{const{doc:g,setDoc:y,serverTimestamp:I}=await Promise.resolve().then(()=>Vs);return{doc:g,setDoc:y,serverTimestamp:I}},void 0),j=T.map(g=>Rt(g)).filter(g=>g!==void 0),H=k(fe,"users",Q.uid,"data","todos"),K={todos:j,lastSyncTime:B(),totalGoals:j.length,syncedAt:new Date().toISOString()},X=Rt(K);if(X)await O(H,X),console.log("  Todos Firestore  :",{count:j.length});else throw new Error("Todos   ");const W=k(fe,"users",Q.uid,"data","settings"),c={language:t,themeMode:z,isDarkMode:V,backgroundTheme:x,apiKey:gi,userCategories:w,updatedAt:B()};await O(W,c);for(const g of l)try{const y=k(fe,"users",Q.uid,"folders",g.id),I={...g,ownerId:g.ownerId||Q.uid,collaborators:g.collaborators||[],updatedAt:B()};await O(y,I),console.log(`  ${g.id}  `)}catch(y){console.error(`  ${g.id}  :`,y)}Ye(!1)}catch(T){console.error(" :",T),ge({title:" ",message:T.message||"    .",confirmText:"",onConfirm:()=>ge(null)}),Ye(!1)}},[Q,n,t,z,V,x,gi]),dl=G.useCallback(async T=>{var k;try{const{doc:O,getDoc:B,collection:j,getDocs:H}=await Ds(async()=>{const{doc:g,getDoc:y,collection:I,getDocs:L}=await Promise.resolve().then(()=>Vs);return{doc:g,getDoc:y,collection:I,getDocs:L}},void 0),K=O(fe,"users",T.uid,"data","todos"),X=await B(K);if(X.exists()){const y=X.data().todos||[];r(I=>{const L=new Set(I.map(de=>de.id)),U=y.filter(de=>!L.has(de.id)),Y=[...I,...U];return console.log("   :",{:I.length,:y.length,:U.length,:Y.length}),Y})}const W=O(fe,"users",T.uid,"data","settings"),c=await B(W);if(c.exists()){const g=c.data();g.language&&e(g.language),g.themeMode&&S(g.themeMode),g.isDarkMode!==void 0&&q(g.isDarkMode),g.backgroundTheme&&R(g.backgroundTheme),g.apiKey&&Tr(g.apiKey),g.userCategories&&A(g.userCategories)}try{const g=j(fe,"users",T.uid,"folders"),y=await H(g),I=[];y.forEach(L=>{const U=L.data(),Y={id:L.id,...U,collaborators:U.collaborators||[],ownerId:U.ownerId||T.uid};I.push(Y)}),u(L=>{const U=new Set(L.map($e=>$e.id)),Y=I.filter($e=>!U.has($e.id)),de=[...L,...Y];return console.log("   :",{:L.length,:I.length,:Y.length,:de.length}),de}),console.log("   :",{count:I.length})}catch(g){console.warn("   ,   :",g)}console.log("    :",{todos:X.exists()&&((k=X.data().todos)==null?void 0:k.length)||0,folders:"",settings:c.exists()?"":""})}catch(O){console.error("    :",O)}},[]),Lf=G.useCallback(async()=>{if(!Q){ge({title:" ",message:" ",confirmText:"",onConfirm:()=>ge(null)});return}As(!0);try{await dl(Q),Ee("    !")}catch(T){console.error(" :",T),ge({title:" ",message:T.message||"    .",confirmText:"",onConfirm:()=>ge(null)})}finally{As(!1)}},[Q,dl]),ne=G.useCallback(T=>P6[t][T]||T,[t]),Cn=G.useCallback(T=>{let k=T||gi;if(_i||!k)return null;try{return k=k.trim(),/^[\x00-\x7F]*$/.test(k)?k.length===0?(console.warn(" API  ."),null):new _2({apiKey:k}):(console.error(" API      . ASCII  ."),null)}catch(O){return console.error(" AI   :",O),null}},[gi,_i]),Gr=G.useCallback(T=>{S(T)},[]),Po=G.useMemo(()=>[ne("empty_encouragement_1"),ne("empty_encouragement_2"),ne("empty_encouragement_3"),ne("empty_encouragement_4")],[ne]),Ic=G.useMemo(()=>Po[Math.floor(Math.random()*Po.length)],[Po]);G.useEffect(()=>{console.log("     - localStorage   ")},[]),G.useEffect(()=>{const T=z==="dark"||z==="system"&&kp()==="dark";T?document.documentElement.classList.add("dark-mode"):document.documentElement.classList.remove("dark-mode"),document.documentElement.setAttribute("data-bg-theme",x),console.log("  :",{themeMode:z,backgroundTheme:x,isDark:T})},[z,x]),G.useEffect(()=>{(()=>{u(k=>{const O=k.filter(B=>{if(!B.collaborators||B.collaborators.length===0)return!0;const j=B.collaborators.find(H=>H.role==="owner");return!j||!j.userId||j.userId.startsWith("owner_")?(console.warn("    :",B.name,j==null?void 0:j.userId),!1):!0});return O.length!==k.length&&console.log("     :",{:k.length-O.length,:O.length}),O})})()},[]),G.useEffect(()=>{if(ll)return;const T=async()=>{const k=new URLSearchParams(window.location.search),O=k.get("data"),B=k.get("folder_share");if(B){try{const j=Zw(B),H=JSON.parse(j);if(H.type==="folder_share"&&H.folderId){if(H.password){const X=sessionStorage.getItem(`folder_${H.folderId}_password`);if(!X||X!==H.password){ge({title:" ",message:"    .  .",confirmText:"",cancelText:"",onConfirm:()=>{const W=prompt("  :");W===H.password?(sessionStorage.setItem(`folder_${H.folderId}_password`,W),ge(null),T()):W!==null&&ge({title:" ",message:"  .",confirmText:"",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}}if(l.some(X=>X.id===H.folderId))window.history.replaceState({},document.title,window.location.pathname);else{if(H.ownerId&&!Q&&!ll){ge({title:" ",message:"        .  .",confirmText:"",cancelText:"",onConfirm:async()=>{try{await Br()}catch(g){console.error("  :",g)}},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});return}const X=H.ownerId||null;if(!X){console.error("     :",H),ge({title:"   ",message:`    .
     .`,confirmText:"",onConfirm:()=>{ge(null),window.history.replaceState({},document.title,window.location.pathname)}});return}const W={id:H.folderId,name:H.folderName,color:H.folderColor||"#007AFF",ownerId:X,collaborators:[{userId:X,email:H.sharedBy||"",role:"owner",addedAt:H.sharedAt}],createdAt:H.sharedAt,updatedAt:H.sharedAt,isShared:!0};let c=W;if(X&&Q)try{console.log("   :",{ownerUserId:X,googleUserUid:Q.uid});const g=st(fe,"users",X,"folders"),y=Ne(g,H.folderId),I=await pg(y);if(console.log("   :",{exists:I.exists()}),I.exists()){let L=I.data().collaborators||[];console.log("   :",L);const U=L.some(Y=>Y.userId===Q.uid);if(console.log("  :",{isCollaborator:U}),U)console.log("  ");else{const Y={userId:Q.uid,email:Q.email||"",role:"editor",addedAt:new Date().toISOString()};L=[...L,Y],console.log("   :",L);const de=Rt(L);de?(await gt(y,{collaborators:de,updatedAt:new Date().toISOString()},{merge:!0}),console.log("  Firestore  :",Y)):console.warn("     ")}c={...W,collaborators:L}}else console.warn("   :",H.folderId)}catch(g){console.error("   / :",g)}else console.warn("    :",{ownerUserId:X,hasGoogleUser:!!Q});if(u([...l,c]),Q)try{const{doc:g,setDoc:y}=await Ds(async()=>{const{doc:L,setDoc:U}=await Promise.resolve().then(()=>Vs);return{doc:L,setDoc:U}},void 0),I=g(fe,"users",Q.uid,"folders",c.id);await y(I,{name:c.name,color:c.color,ownerId:c.ownerId,createdAt:c.createdAt,updatedAt:c.updatedAt,isShared:c.isShared,collaborators:c.collaborators||[],collaborationSettings:c.collaborationSettings||{enabled:!0,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!1}}),console.log("   Firebase  :",c.id)}catch(g){console.error("   Firebase  :",g)}m(c.id),ge({title:"  ",message:`"${H.folderName}"  .    .`,confirmText:"",onConfirm:()=>{window.history.replaceState({},document.title,window.location.pathname)}})}}}catch(j){console.error("    :",j),window.history.replaceState({},document.title,window.location.pathname)}return}if(O)try{const j=Zw(O),H=JSON.parse(j);if(Array.isArray(H)&&(H.length===0||"wish"in H[0]&&"id"in H[0]))ge({title:ne("url_import_title"),message:ne("url_import_message"),confirmText:ne("url_import_confirm"),cancelText:ne("cancel_button"),onConfirm:()=>{r(H),Ee(ne("url_import_success")),window.history.replaceState({},document.title,window.location.pathname)},onCancel:()=>{window.history.replaceState({},document.title,window.location.pathname)}});else throw new Error("Invalid data format")}catch(j){console.error("Failed to parse data from URL",j),ge({title:ne("import_error_alert_title"),message:ne("url_import_error")}),window.history.replaceState({},document.title,window.location.pathname)}};T()},[ne,l,Q,Br,ll]),G.useEffect(()=>{if(!f||!Q)return;const T=l.find(W=>W.id===f);if(!T||!T.collaborators||T.collaborators.length===0)return;const k=T.collaborators.find(W=>W.role==="owner");if(!k)return;const O=k.userId;if(!O||O.startsWith("owner_")){console.warn(" Invalid owner UID:",k);return}const B=[],j=Ne(fe,"users",O,"folders",f),H=zr(j,W=>{if(W.exists()){const c=W.data();c.collaborators&&u(g=>g.map(y=>y.id===f?{...y,collaborators:c.collaborators}:y))}},W=>{console.warn("      (    ):",W.code)});B.push(H);const K=st(fe,"users",O,"todos");console.log(" Syncing todos from owner:",{ownerUid:O,currentFolderId:f});const X=zr(K,W=>{const c=[];W.forEach(g=>{const y=g.data();y.folderId===f&&c.push({id:parseInt(g.id),...y})}),console.log(" Owner todos received:",{count:c.length,ownerTodos:c}),r(g=>{const y=g.filter(Y=>Y.folderId!==f),I=g.filter(Y=>Y.folderId===f),L=[],U=new Set;return c.forEach(Y=>{L.push(Y),U.add(Y.id)}),I.forEach(Y=>{U.has(Y.id)||L.push(Y)}),[...y,...L]})},W=>{console.error("   :",W),W.code==="permission-denied"?(console.warn("      -   "),Ee("    -    ")):W.code==="not-found"?(console.warn("     -    "),Ee("     ")):(console.warn("     "),Ee("   -   "))});return B.push(X),()=>{B.forEach(W=>W())}},[f,Q]),G.useEffect(()=>{var W,c;if(!f||!Q)return;const T=l.find(g=>g.id===f),k=((W=T==null?void 0:T.collaborationSettings)==null?void 0:W.enabled)||(T==null?void 0:T.isShared)||!1,O=((c=T==null?void 0:T.collaborationSettings)==null?void 0:c.showPresence)??!0;if(!k||!O){D([]);return}console.log("     :",{folderId:f,showPresence:O});const B=st(fe,"folderPresence",f,"users"),j=Ne(B,Q.uid);(async()=>{try{await gt(j,{userId:Q.uid,displayName:Q.displayName||"Anonymous",photoURL:Q.photoURL||null,isOnline:!0,lastSeen:new Date,currentFolder:f},{merge:!0}),console.log("    :",Q.displayName)}catch(g){console.warn("presence set failed",g)}})();const K=setInterval(()=>{gt(j,{lastSeen:new Date,isOnline:!0},{merge:!0}).catch(()=>{})},3e4),X=zr(B,g=>{const I=g.docs.map(L=>{const U=L.data();return{userId:U.userId||L.id,displayName:U.displayName||"Anonymous",photoURL:U.photoURL||void 0,isOnline:!!U.isOnline,lastSeen:U.lastSeen?U.lastSeen.toDate?U.lastSeen.toDate():new Date(U.lastSeen):new Date,currentFolder:U.currentFolder}}).filter(L=>!!L.userId&&L.isOnline);D(I),console.log("   :",I.map(L=>L.displayName))},g=>console.warn("presence listen failed",g));return()=>{clearInterval(K),gt(j,{isOnline:!1,lastSeen:new Date},{merge:!0}).catch(()=>{}),X()}},[f,Q,l]),G.useCallback(async T=>{var j,H;if(!f||!Q)return;const k=l.find(K=>K.id===f),O=((j=k==null?void 0:k.collaborationSettings)==null?void 0:j.showEditingState)??!0;if(!(!((H=k==null?void 0:k.collaborationSettings)!=null&&H.enabled||k!=null&&k.isShared)||!O))try{const K=Ne(fe,"folderEditing",`${f}_${T}`);await gt(K,{todoId:T,userId:Q.uid,userName:Q.displayName||"Anonymous",startTime:new Date,folderId:f}),console.log("  :",{todoId:T,user:Q.displayName})}catch(K){console.warn("start editing failed",K)}},[f,Q,l]),G.useCallback(async T=>{var j,H;if(!f||!Q)return;const k=l.find(K=>K.id===f),O=((j=k==null?void 0:k.collaborationSettings)==null?void 0:j.showEditingState)??!0;if(!(!((H=k==null?void 0:k.collaborationSettings)!=null&&H.enabled||k!=null&&k.isShared)||!O))try{const K=Ne(fe,"folderEditing",`${f}_${T}`);await zt(K),console.log("  :",{todoId:T,user:Q.displayName})}catch(K){console.warn("stop editing failed",K)}},[f,Q,l]),G.useEffect(()=>{var H,K;if(!f)return;const T=l.find(X=>X.id===f),k=((H=T==null?void 0:T.collaborationSettings)==null?void 0:H.showEditingState)??!0;if(!(((K=T==null?void 0:T.collaborationSettings)==null?void 0:K.enabled)||(T==null?void 0:T.isShared)||!1)||!k){b({});return}console.log("    :",{folderId:f});const B=ql(st(fe,"folderEditing"),zl("folderId","==",f)),j=zr(B,X=>{const W={};X.docs.forEach(c=>{const g=c.data();g&&g.todoId&&(W[g.todoId]={todoId:g.todoId,userId:g.userId,userName:g.userName,startTime:g.startTime?g.startTime.toDate?g.startTime.toDate():new Date(g.startTime):new Date,folderId:g.folderId})}),b(W),console.log("   :",Object.keys(W).length+" ")},X=>console.warn("editing states listen failed",X));return()=>j()},[f,l]),G.useCallback(async T=>{var k,O;try{const B=T.ownerId||(Q==null?void 0:Q.uid);if(!B)throw new Error("No owner UID");const j=l.find(c=>c.id===f),H=((k=j==null?void 0:j.collaborationSettings)==null?void 0:k.enableConflictDetection)??!0,K=((O=j==null?void 0:j.collaborationSettings)==null?void 0:O.enabled)||(j==null?void 0:j.isShared)||!1,X=Ne(fe,"users",B,"todos",T.id.toString());if(K&&H){const c=await pg(X),g=c.exists()?c.data():null,y=(g==null?void 0:g.version)||0,I=T.version||0;if(g&&y>I&&(Qe(U=>[...U,{todoId:T.id,conflictType:"version_mismatch",localVersion:T,serverVersion:g,lastModifiedBy:g.lastModifiedBy||"unknown",lastModifiedAt:g.lastModified?g.lastModified.toDate?g.lastModified.toDate():new Date(g.lastModified):new Date}]),console.warn("  :",{todoId:T.id,localVersion:I,serverVersion:y,lastModifiedBy:g.lastModifiedBy}),!window.confirm("    . ? (  )")))return!1}const W=Rt({...T,version:(T.version||0)+1,lastModified:new Date,lastModifiedBy:(Q==null?void 0:Q.uid)||"unknown"});return W&&(await gt(X,W),console.log(" Todo  :",{todoId:T.id,version:W.version})),!0}catch(B){return console.error("attemptSaveTodo failed",B),!1}},[Q,f,l]),G.useEffect(()=>{const T=window.matchMedia("(prefers-color-scheme: dark)"),k=O=>{z==="system"&&q(O.matches)};return q(z==="system"?T.matches:z==="dark"),T.addEventListener("change",k),()=>T.removeEventListener("change",k)},[z]),G.useEffect(()=>{const T=()=>{console.log("  "),Ee("   "),setTimeout(()=>Ee(""),3e3)},k=()=>{console.log("   "),Ee("   -   "),setTimeout(()=>Ee(""),5e3)};return navigator.onLine||console.log("   "),window.addEventListener("online",T),window.addEventListener("offline",k),()=>{window.removeEventListener("online",T),window.removeEventListener("offline",k)}},[]),G.useEffect(()=>{const T=localStorage.getItem("pwa-prompt-dismissed"),k=Pp(),O=Yw();console.log("PWA Check:",{isMobileDevice:k,isInStandalone:O,isDismissed:T,userAgent:navigator.userAgent}),k&&!O&&!T&&(console.log("Showing PWA prompt immediately"),gc(!0))},[]),G.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/Nova-AI-Planer/sw.js").then(T=>{console.log("SW registered: ",T),Yw()}).catch(T=>{console.log("SW registration failed: ",T)})},[]),G.useEffect(()=>{},[z,V]);const wi=G.useRef(null);G.useEffect(()=>{if(!(!yi||!Q))return wi.current&&clearTimeout(wi.current),wi.current=setTimeout(()=>{Rs()},5e3),()=>{wi.current&&clearTimeout(wi.current)}},[n,l,t,z,V,x,gi,w,yi,Q]),G.useEffect(()=>{const T=yg.find(O=>O.id===x)||yg[0],k=V?T.darkThemeClass:T.lightThemeClass;document.body.className="",V&&document.body.classList.add("dark-mode"),k&&document.body.classList.add(k)},[x,V]),G.useEffect(()=>{if(Sn){const T=setTimeout(()=>Ee(""),3e3);return()=>clearTimeout(T)}},[Sn]);const Ii=G.useMemo(()=>{let T=[...n];return console.log("   :",{totalTodos:n.length,currentFolderId:f,filter:_,categoryFilter:E,sortType:M}),f===null?T=T.filter(k=>{if(k.isSharedTodo===!0)return!1;const O=l.find(B=>B.id===k.folderId);return O?O.isShared!==!0:!0}):f==="my-goals"?T=T.filter(k=>{const O=l.find(B=>B.id===k.folderId);return O?O.isShared!==!0:!0}):f==="all"?T=T:T=T.filter(k=>k.folderId===f),M==="deadline"?T.sort((k,O)=>!k.deadline&&!O.deadline?0:k.deadline?O.deadline?new Date(k.deadline).getTime()-new Date(O.deadline).getTime():-1:1):M==="newest"?T.sort((k,O)=>O.id-k.id):M==="alphabetical"&&T.sort((k,O)=>{const B=k.title||k.wish||"",j=O.title||O.wish||"";return B.localeCompare(j)}),_==="active"&&(T=T.filter(k=>!k.completed)),_==="completed"&&(T=T.filter(k=>k.completed)),E!=="all"&&(T=T.filter(k=>(k.category||"other")===E)),console.log("   :",{finalCount:T.length,todos:T.map(k=>({id:k.id,wish:k.wish,folderId:k.folderId,completed:k.completed}))}),T},[n,_,M,E,f]),Ps=G.useCallback(()=>{const T=Date.now();ul(T),Co&&clearTimeout(Co);const k=setTimeout(async()=>{if(console.log("    -    (  "+On/1e3+")"),!Ro&&Q)try{console.log("   : activity-based "),await Rs()}catch(O){console.error("   :",O)}},On);Mf(k)},[Co,On,Ro,Q]);G.useEffect(()=>{const T=l.find(O=>O.id===f),k=(T==null?void 0:T.isShared)&&(T==null?void 0:T.ownerId)&&(T==null?void 0:T.ownerId)!==(Q==null?void 0:Q.uid);Xe(k||!1),k?(cl("realtime"),Ti(!0),console.log("     ( )")):(cl("activity-based"),Ti(!1),console.log("     ( )"))},[f,l,Q==null?void 0:Q.uid]);const qr=T=>{const k={...T,id:Date.now(),createdAt:new Date().toISOString()};s(O=>[...O,k]),Uf(k)},Ff=T=>{s(k=>k.filter(O=>O.id!==T)),a(k=>k.filter(O=>O.assignmentId!==T))},Uf=T=>{const k=new Date,O=new Date(T.dueDate),B=Math.max(1,Math.ceil((O.getTime()-k.getTime())/(1e3*60*60*24))),j=Math.ceil(T.estimatedMinutes/B),H=[];let K=T.estimatedMinutes;for(let X=0;X<B;X++){const W=new Date;W.setDate(k.getDate()+X);const c=Math.min(j,K);if(H.push({assignmentId:T.id,date:W.toISOString().split("T")[0],allocatedMinutes:c,completed:!1}),K-=c,K<=0)break}a(X=>[...X,...H])},Sc=async(T,k,O)=>{try{const B=Cn();if(!B)return console.warn("AI instance not available"),null;const j=`  :
: ${T}
: ${k}
: ${O||" "}

  JSON :
{
  "estimatedMinutes": (, ),
  "difficulty": (1-5, ),
  "optimizedSchedule": "   ",
  "studyTips": " "
}`;console.log(" AI  ...");const K=(await B.models.generateContent({model:"gemini-2.5-flash",contents:j})).text.trim();console.log(" AI  :",K);const X=K.match(/\{[\s\S]*\}/);return X?JSON.parse(X[0]):null}catch(B){return console.error("AI  :",B),null}},Er=async T=>{try{const k=Cn();if(!k)return null;const B=`    :

${T.map(H=>`${H.name} (${H.subject}, ${H.estimatedMinutes}, ${H.difficulty}, : ${H.dueDate})`).join(`
`)}

     :
-  
-    
-   
-   

   .`;console.log("   AI ...");const j=await k.models.generateContent({model:"gemini-2.5-flash",contents:B});return console.log(" AI   :",j.text),j.text}catch(k){return console.error(" AI   :",k),null}},xc=async()=>{Mt(!0);try{const T=await Er(i);T&&Oe(T)}catch(T){console.error("AI  :",T)}finally{Mt(!1)}},ko=()=>{const T=new Date().toISOString().split("T")[0];return o.filter(k=>k.date===T).map(k=>{const O=i.find(B=>B.id===k.assignmentId);return O?{...k,assignment:O}:null}).filter(Boolean)},No=(T,k)=>{a(O=>O.map(B=>B.assignmentId===T&&B.date===k?{...B,completed:!B.completed}:B))},Cc=()=>{const T=new Date;T.setHours(0,0,0,0);const O=[...i.filter(j=>!j.completed)].sort((j,H)=>{if(!j.dueDate&&H.dueDate)return 1;if(j.dueDate&&!H.dueDate)return-1;if(!j.dueDate&&!H.dueDate)return H.estimatedMinutes!==j.estimatedMinutes?H.estimatedMinutes-j.estimatedMinutes:H.difficulty-j.difficulty;const K=Math.ceil((new Date(j.dueDate).getTime()-T.getTime())/(1e3*60*60*24)),X=Math.ceil((new Date(H.dueDate).getTime()-T.getTime())/(1e3*60*60*24));return K!==X?K-X:H.estimatedMinutes!==j.estimatedMinutes?H.estimatedMinutes-j.estimatedMinutes:H.difficulty-j.difficulty}),B=[];O.forEach(j=>{if(!j.dueDate)B.push({assignmentId:j.id,date:T.toISOString().split("T")[0],allocatedMinutes:j.estimatedMinutes,completed:!1});else{const H=new Date(j.dueDate);H.setHours(0,0,0,0);const K=Math.max(1,Math.ceil((H.getTime()-T.getTime())/(1e3*60*60*24))),X=Math.ceil(j.estimatedMinutes/K);for(let W=0;W<K;W++){const c=new Date(T);c.setDate(T.getDate()+W);const g=c.toISOString().split("T")[0];B.push({assignmentId:j.id,date:g,allocatedMinutes:X,completed:!1})}}}),a(B)};G.useEffect(()=>{i.length>0&&(Cc(),xc())},[i]);const Si=async T=>{try{Ps();const k={...T,id:Date.now(),completed:!1,lastCompletedDate:null,streak:0,folderId:f==="all"||f===null?void 0:f};if(r(O=>[k,...O]),Q){Ye(!0);try{const O=l.find(X=>X.id===f),B=(O==null?void 0:O.ownerId)||Q.uid,j=st(fe,"users",B,"todos"),H=Ne(j,k.id.toString()),K=Rt(k);K?(await gt(H,K),console.log("  Firestore :",{targetOwnerUid:B,newTodo:K})):console.warn("     ")}catch(O){console.error("  Firestore  :",O)}finally{Ye(!1)}}ce(!1)}catch(k){console.error("   :",k),Ye(!1)}},xi=async T=>{try{const k=T.map((O,B)=>({...O,id:Date.now()+B,completed:!1,lastCompletedDate:null,streak:0,folderId:f||void 0})).reverse();if(Q){Ye(!0);try{const O=l.find(j=>j.id===f),B=(O==null?void 0:O.ownerId)||Q.uid;for(const j of k){const H=st(fe,"users",B,"todos"),K=Ne(H,j.id.toString()),X=Rt(j);X?await gt(K,X):console.warn("     :",j.id)}console.log("   Firestore :",{targetOwnerUid:B,count:k.length})}catch(O){console.error("   Firestore  :",O)}finally{Ye(!1)}}r(O=>[...k,...O]),ce(!1)}catch(k){console.error("    :",k),Ye(!1)}},bo=async T=>{try{if(Ps(),Q){Ye(!0);try{const k=l.find(K=>K.id===T.folderId),O=(k==null?void 0:k.ownerId)||Q.uid,B=st(fe,"users",O,"todos"),j=Ne(B,T.id.toString()),H=Rt(T);H?(await gt(j,H),console.log("   Firestore :",{targetOwnerUid:O,updatedTodo:H})):console.warn("     ")}catch(k){console.error("   Firestore  :",k)}finally{Ye(!1)}}r(n.map(k=>k.id===T.id?T:k)),xe(null)}catch(k){console.error("   :",k),Ye(!1)}},Do=async T=>{Ps();const k=n.find(B=>B.id===T),O=n.filter(B=>B.id!==T);if(r(O),Q&&k)try{const B=l.find(X=>X.id===k.folderId),j=(B==null?void 0:B.ownerId)||Q.uid,H=st(fe,"users",j,"todos"),K=Ne(H,T.toString());await zt(K),console.log("   Firestore :",{targetOwnerUid:j,id:T});try{const X=Ne(fe,"users",j,"data","todos");await gt(X,{todos:O,lastUpdated:new Date().toISOString()},{merge:!0}),console.log("     -  ")}catch(X){console.warn("    :",X)}yi&&setTimeout(()=>{Rs()},1e3)}catch(B){console.error("  Firestore  :",B),k&&r(j=>[...j,k])}},it=async T=>{var O;if(!T.trim()){ge({title:"Error",message:"Folder name cannot be empty."});return}const k={id:Date.now().toString(),name:T,ownerId:((O=Gs.currentUser)==null?void 0:O.uid)||"unknown",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),color:"#3b82f6",collaborationSettings:{enabled:!1,showPresence:!0,showEditingState:!0,enableConflictDetection:!0,allowGuestView:!1,requireApproval:!0},isShared:!1};if(u([...l,k]),Q)try{const{doc:B,setDoc:j}=await Ds(async()=>{const{doc:K,setDoc:X}=await Promise.resolve().then(()=>Vs);return{doc:K,setDoc:X}},void 0),H=B(fe,"users",Q.uid,"folders",k.id);await j(H,{name:k.name,color:k.color,ownerId:k.ownerId,createdAt:k.createdAt,updatedAt:k.updatedAt,isShared:k.isShared,collaborators:[],collaborationSettings:k.collaborationSettings}),console.log("  Firebase  :",k.id)}catch(B){console.error("  Firebase  :",B)}return console.log("   :",{name:T,collaborationEnabled:!1}),k},hl=G.useCallback(async(T,k)=>{try{if(u(O=>O.map(B=>{if(B.id===T){const j={...B.collaborationSettings,...k};return console.log("   :",{folderId:T,settings:j}),{...B,collaborationSettings:j,updatedAt:new Date().toISOString()}}return B})),Q){const O=Ne(fe,"users",Q.uid,"folders",T);await mg(O,{collaborationSettings:{...k},updatedAt:new Date().toISOString()})}}catch(O){console.error("   :",O)}},[Q]),Of=G.useCallback(async(T,k)=>{await hl(T,{enabled:k}),k?(u(O=>O.map(B=>B.id===T?{...B,isShared:!0}:B)),console.log("   :",T)):(D([]),b({}),console.log("   :",T))},[hl]);G.useCallback(()=>{if(!f)return null;const T=l.find(k=>k.id===f);return(T==null?void 0:T.collaborationSettings)||null},[f,l]);const Ac=(T,k)=>{if(!k.trim()){ge({title:"Error",message:"Folder name cannot be empty."});return}u(l.map(O=>O.id===T?{...O,name:k,updatedAt:new Date().toISOString()}:O))},fl=async T=>{const k=l.find(B=>B.id===T);if(!k)return;const O=n.filter(B=>B.folderId===T);if(Q&&O.length>0)try{for(const B of O){const j={...B};delete j.folderId;const H=k.ownerId||Q.uid,K=st(fe,"users",H,"todos"),X=Ne(K,B.id.toString()),W=Rt(j);W?(await gt(X,W),console.log(`  ${B.id} Firebase   `)):console.warn(`  ${B.id}   `)}console.log("     Firebase  :",{count:O.length})}catch(B){console.error("      :",B)}if(Q)try{const B=Ne(fe,"users",Q.uid,"folders",T);await zt(B),console.log("  Firebase  :",T)}catch(B){console.error("  Firebase  :",B)}r(n.map(B=>{if(B.folderId===T){const j={...B};return delete j.folderId,j}return B})),u(l.filter(B=>B.id!==T)),f===T&&m(null)},pl=async T=>{if(!pt.trim()||!Q){oe("");return}try{const k={...T,name:pt.trim(),updatedAt:new Date().toISOString()},O=Ne(fe,"users",Q.uid,"folders",T.id),B=Rt(k);if(B)await gt(O,B),console.log("    Firestore  ");else throw new Error("   ");u(l.map(j=>j.id===T.id?k:j)),oe(""),console.log("    :",pt.trim())}catch(k){console.error("    :",k),oe("")}},Mo=async T=>{var k;if(!(!Ke.trim()||!Q||Ae)){Be(!0);try{if(((k=T.sharedWith)==null?void 0:k.some(X=>X.email===Ke.trim()))||T.ownerEmail===Ke.trim()){alert("  ."),Be(!1);return}const B={email:Ke.trim(),userId:"",role:In,addedAt:new Date().toISOString()},j={...T,sharedWith:[...T.sharedWith||[],B],updatedAt:new Date().toISOString()},H=Ne(fe,"users",Q.uid,"folders",T.id),K=Rt(j);if(K)await gt(H,K),console.log("   Firestore  ");else throw new Error("   ");u(l.map(X=>X.id===T.id?{...j,sharedWith:Array.isArray(j.sharedWith)?j.sharedWith.filter(W=>W&&typeof W.role=="string"&&["owner","editor","viewer"].includes(W.role)).map(W=>({...W,role:W.role})):[]}:X)),yr(""),console.log("   :",B)}catch(O){console.error("   :",O)}finally{Be(!1)}}},wr=async(T,k,O)=>{var B;if(Q)try{const j={...T,sharedWith:(B=T.sharedWith)==null?void 0:B.map(X=>X.userId===k?{...X,role:O}:X),updatedAt:new Date().toISOString()},H=Ne(fe,"users",Q.uid,"folders",T.id),K=Rt(j);if(K)await gt(H,K);else throw new Error("   ");u(l.map(X=>X.id===T.id?{...j,sharedWith:Array.isArray(j.sharedWith)?j.sharedWith.filter(W=>W&&typeof W.role=="string"&&["owner","editor","viewer"].includes(W.role)).map(W=>({...W,role:W.role})):[]}:X)),console.log("    :",{userId:k,newRole:O})}catch(j){console.error("    :",j)}},Rc=async(T,k)=>{var O;if(Q&&confirm("  ?"))try{const B={...T,sharedWith:(O=T.sharedWith)==null?void 0:O.filter(K=>K.userId!==k),updatedAt:new Date().toISOString()},j=Ne(fe,"users",Q.uid,"folders",T.id),H=Rt(B);if(H)await gt(j,H);else throw new Error("   ");u(l.map(K=>K.id===T.id?B:K)),console.log("   :",k)}catch(B){console.error("   :",B)}},Bf=T=>{const k=`${window.location.origin}${window.location.pathname}?invite=${T.id}`;navigator.clipboard.writeText(k).then(()=>{alert("  !")}).catch(()=>{alert("  .")})},ks=T=>{confirm(ne("folder_leave_confirm"))&&Pc(T)},Pc=async T=>{var k;if(Q)try{const O={...T,sharedWith:(k=T.sharedWith)==null?void 0:k.filter(H=>H.userId!==Q.uid),updatedAt:new Date().toISOString()},B=Ne(fe,"users",T.ownerId,"folders",T.id),j=Rt(O);if(j)await gt(B,j);else throw new Error("   ");u(l.filter(H=>H.id!==T.id)),f===T.id&&m(null),Ot(!1),console.log("   ")}catch(O){console.error("   :",O)}},ml=T=>{confirm(ne("folder_delete_confirm"))&&(fl(T.id),Ot(!1))},Vo=T=>{if(m(T),T&&Q){const k=l.find(O=>O.id===T);k!=null&&k.ownerId&&(async()=>{try{console.log(" Firestore   :",{folderId:T,ownerUid:k.ownerId});const O=st(fe,"users",k.ownerId,"todos"),B=ql(O,zl("folderId","==",T)),j=await Ni(B),H=[];j.forEach(K=>{H.push({id:parseInt(K.id),...K.data()})}),console.log("    :",{count:H.length,todos:H}),r(K=>{const X=K.filter(y=>y.folderId!==T),W=new Set(X.map(y=>y.id)),c=H.filter(y=>!W.has(y.id)),g=[...X,...c];return console.log("   :",{:X.length,:c.length,:g.length,:H.length-c.length}),g})}catch(O){console.error("    :",O)}})()}},kc=async()=>{if(!f||!Q){Ee("   ");return}Ye(!0);try{console.log("    ...",f);const{doc:T,getDoc:k,collection:O,query:B,where:j,getDocs:H}=await Ds(async()=>{const{doc:U,getDoc:Y,collection:de,query:$e,where:Ve,getDocs:mt}=await Promise.resolve().then(()=>Vs);return{doc:U,getDoc:Y,collection:de,query:$e,where:Ve,getDocs:mt}},void 0);let K=l.find(U=>U.id===f);if(!K||!K.collaborators||K.collaborators.length===0){console.log("    , Firebase ...");const U=T(fe,"users",Q.uid,"folders",f),Y=await k(U);if(Y.exists())K={id:f,...Y.data()},console.log("   :",K);else{console.log("    ..."),ge({title:"    ",message:`   .
    .`,confirmText:"",onConfirm:()=>ge(null)}),Ye(!1);return}}if(!K||!K.collaborators||K.collaborators.length===0){ge({title:"   ",message:`   .
   .`,confirmText:"",onConfirm:()=>ge(null)}),Ye(!1);return}const X=K.collaborators.find(U=>U.role==="owner");if(!X||!X.userId){ge({title:"   ",message:`   .
  .`,confirmText:"",onConfirm:()=>ge(null)}),Ye(!1);return}if(X.userId.startsWith("owner_")){console.warn("   ID :",X.userId),ge({title:"   ",message:`    .
     .`,confirmText:"",onConfirm:()=>ge(null)}),Ye(!1);return}console.log("   :",{folderId:f,ownerUid:X.userId});const W=n.filter(U=>U.folderId===f);console.log("    :",W.length);const c=O(fe,"users",X.userId,"todos"),g=B(c,j("folderId","==",f)),y=await H(g),I=[];y.forEach(U=>{I.push({id:parseInt(U.id),...U.data()})}),console.log("   :",I.length),W.length===I.length?(console.log("     "),Ee(`    (${I.length}  -   )`)):(console.log("     :",{local:W.length,server:I.length}),r(U=>[...U.filter($e=>$e.folderId!==f),...I]),Ee(`   (${I.length}  - ${Math.abs(I.length-W.length)}  )`)),console.log("   :",f&&Q?"":"")}catch(T){console.error("  :",T),T instanceof Error?T.message.includes("permission-denied")?Ee("  :    "):T.message.includes("not-found")?Ee("  :    "):Ee("  : "+T.message):Ee("  :    ")}finally{Ye(!1)}},Lo=async()=>{Ye(!0);try{console.log("   ..."),await Rs(),Ee("   "),console.log("   ")}catch(T){console.error("   :",T),Ee("  ")}finally{Ye(!1)}},Gf=async(T,k)=>{const O=n.find(K=>K.id===T);if(!O)return;const B=l.find(K=>K.id===k),j=(B==null?void 0:B.isShared)===!0,H={...O,folderId:k||void 0,isSharedTodo:j};if(!O.wish&&!O.outcome&&!O.obstacle&&!O.plan&&(delete H.wish,delete H.outcome,delete H.obstacle,delete H.plan),Q)try{const K=l.find(y=>y.id===(k||O.folderId)),X=(K==null?void 0:K.ownerId)||Q.uid,W=st(fe,"users",X,"todos"),c=Ne(W,T.toString()),g=Rt(H);g?(await gt(c,g),console.log("    Firestore :",{targetOwnerUid:X,goalId:T,folderId:k,isSharedTodo:H.isSharedTodo})):console.warn("     ")}catch(K){console.error("    Firestore  :",K)}r(n.map(K=>K.id===T?H:K)),Ee("   "),setTimeout(()=>Ee(""),3e3)},gl=async T=>{Ps();const k=new Date().toISOString(),O=(()=>{const B=n.find(K=>K.id===T);if(!B)return null;const j=!B.completed;let H=B.streak;return B.isRecurring&&(j?(!B.lastCompletedDate||!du(k,B.lastCompletedDate))&&(H=(B.streak||0)+1):B.lastCompletedDate&&du(k,B.lastCompletedDate)&&(H=Math.max(0,(B.streak||1)-1))),{...B,completed:j,lastCompletedDate:j?k:B.lastCompletedDate,streak:H}})();if(O){if(Q)try{const B=l.find(W=>W.id===O.folderId),j=(B==null?void 0:B.ownerId)||Q.uid,H=st(fe,"users",j,"todos"),K=Ne(H,T.toString()),X=Rt(O);X?(await gt(K,X),console.log("    Firestore :",{targetOwnerUid:j,id:T,completed:O.completed})):console.warn("     ")}catch(B){console.error("    Firestore  :",B)}r(n.map(B=>B.id===T?O:B))}},Ns=async T=>{if(T==="ai"){if(n.length<2){ge({title:ne("sort_alert_title"),message:ne("sort_alert_message")});return}Fn(!0);try{const k=Cn();if(!k){Ee(_i?"  AI    .":"AI    API  ."),Fn(!1),C("manual");return}const O=`Here is a list of goals with their details (wish, outcome, obstacle, plan, deadline). Prioritize them based on urgency (closer deadline), importance (based on outcome), and feasibility (based on plan). Return a JSON object with "sorted_ids" array and "reasoning" string explaining your prioritization logic. Goals: ${JSON.stringify(n.map(({id:g,wish:y,outcome:I,obstacle:L,plan:U,deadline:Y})=>({id:g,wish:y,outcome:I,obstacle:L,plan:U,deadline:Y})))}`,B=await k.models.generateContent({model:"gemini-2.5-flash",contents:O,config:{responseMimeType:"application/json",responseSchema:{type:$n.OBJECT,properties:{sorted_ids:{type:$n.ARRAY,items:{type:$n.NUMBER}},reasoning:{type:$n.STRING}}}}}),j=JSON.parse(B.text),H=j.sorted_ids.map(Number),K=new Map(n.map(g=>[Number(g.id),g])),X=H.map(g=>K.get(g)).filter(Boolean),W=n.filter(g=>!H.includes(Number(g.id))),c=[...X,...W].map(g=>({...g,id:Number(g.id)}));r(c),C("manual"),mc(j.reasoning||""),Ur(!0)}catch(k){console.error("AI sort failed:",k),ge({title:ne("ai_sort_error_title"),message:ne("ai_sort_error_message")})}finally{Fn(!1)}}else C(T)},Nc=T=>{const k=new Set(vr);k.has(T)?k.delete(T):k.add(T),Un(k)},_l=()=>{Lr(!1),Un(new Set)},yl=()=>{const T=new Set(Ii.map(k=>k.id));Un(T)},vl=()=>{const T=vr.size;ge({title:ne("delete_selected_confirm_title"),message:ne("delete_selected_confirm_message").replace("{count}",String(T)),isDestructive:!0,confirmText:ne("delete_selected_button_label").replace("{count}",String(T)),cancelText:ne("cancel_button"),onConfirm:()=>{r(n.filter(k=>!vr.has(k.id))),_l()}})},bc=()=>{er("exporting");const T=JSON.stringify(n,null,2),k="data:application/json;charset=utf-8,"+encodeURIComponent(T),O="nova_goals.json",B=document.createElement("a");B.setAttribute("href",k),B.setAttribute("download",O),B.click(),setTimeout(()=>{er("idle"),mn(!1)},1500)},Fo=T=>{var B;const k=(B=T.target.files)==null?void 0:B[0];if(!k)return;const O=new FileReader;O.onload=j=>{var H;try{const K=(H=j.target)==null?void 0:H.result;if(typeof K!="string")throw new Error("File content is not a string");const X=JSON.parse(K);if(Array.isArray(X)&&X.every(W=>"wish"in W&&"id"in W))ge({title:ne("import_confirm_title"),message:ne("import_confirm_message"),confirmText:ne("settings_import_data"),cancelText:ne("cancel_button"),onConfirm:()=>{er("importing"),setTimeout(()=>{r(X),Ee(ne("import_success_toast")),er("idle"),mn(!1)},1500)}});else throw new Error("Invalid file format")}catch{ge({title:ne("import_error_alert_title"),message:ne("import_error_alert_message")})}},O.onerror=()=>ge({title:ne("import_error_alert_title"),message:ne("import_error_alert_message")}),O.readAsText(k),T.target.value=""},Dc=()=>{ge({title:"   ",message:`   ?

    :

   
 Firebase  
  
   
   `,confirmText:"",cancelText:"",isDestructive:!0,onConfirm:()=>{ge(null),Mc()},onCancel:()=>{ge(null)}})},Mc=async()=>{console.log(" performDeleteAllData  "),er("deleting");try{if(Q){console.log("  :",{uid:Q.uid,email:Q.email}),console.log(" Firebase   ...");try{const W=Ne(fe,"users",Q.uid,"data","todos");await zt(W),console.log("  todos   ")}catch(W){console.warn("  todos   :",W)}try{const W=Ne(fe,"users",Q.uid,"data","settings");await zt(W),console.log("  settings   ")}catch(W){console.warn("  settings   :",W)}const T=st(fe,"users",Q.uid,"todos"),k=await Ni(T);console.log("  todos :",k.size);const O=k.docs.map(W=>zt(W.ref));await Promise.all(O),console.log("  todos  :",k.size,"");const B=st(fe,"users",Q.uid,"folders"),j=await Ni(B);console.log("  folders :",j.size);const H=j.docs.map(W=>zt(W.ref));await Promise.all(H),console.log(" folders  :",j.size,"");const K=st(fe,"sharedFolders"),X=await Ni(K);for(const W of X.docs){const c=W.data();if(c.collaborators&&Array.isArray(c.collaborators)){const g=c.collaborators.filter(y=>y.userId!==Q.uid);g.length!==c.collaborators.length&&(await mg(W.ref,{collaborators:g}),console.log("     :",W.id))}}try{for(const W of l)if(W.id){const c=Ne(fe,"folderPresence",W.id,"users",Q.uid);await zt(c)}console.log(" presence   ")}catch(W){console.warn(" presence     :",W)}try{const W=ql(st(fe,"folderEditing"),zl("userId","==",Q.uid)),g=(await Ni(W)).docs.map(y=>zt(y.ref));await Promise.all(g),console.log(" editing states  ")}catch(W){console.warn(" editing states    :",W)}try{const W=Ne(fe,"users",Q.uid);await zt(W),console.log("     ")}catch(W){console.warn("     :",W)}try{const W=st(fe,"notifications",Q.uid,"items"),g=(await Ni(W)).docs.map(I=>zt(I.ref));await Promise.all(g);const y=Ne(fe,"notifications",Q.uid);await zt(y),console.log("    ")}catch(W){console.warn("      :",W)}try{const W=st(fe,"userActivity",Q.uid,"logs"),g=(await Ni(W)).docs.map(I=>zt(I.ref));await Promise.all(g);const y=Ne(fe,"userActivity",Q.uid);await zt(y),console.log("     ")}catch(W){console.warn("       :",W)}try{const W=Ne(fe,"userMetadata",Q.uid);await zt(W),console.log("    ")}catch(W){console.warn("      :",W)}try{const W=Ne(fe,"userSessions",Q.uid);await zt(W),console.log("     ")}catch(W){console.warn("       :",W)}console.log("      -    ")}console.log("    ..."),r([]),u([]),D([]),b({}),Qe([]),m(null),Un(new Set),Lr(!1),v("all"),P("all"),console.log("   ..."),e("ko"),q(!0),R("default"),C("manual"),A(["school","work","personal","other"]),Tr(""),al(!1),vi(!0),console.log(" localStorage  ...");try{const T=Object.keys(localStorage);console.log("  localStorage :",T),T.forEach(k=>{localStorage.removeItem(k),console.log(`  : ${k}`)}),localStorage.clear(),sessionStorage.clear(),console.log(" localStorage  sessionStorage   ")}catch(T){console.error(" localStorage   :",T)}if(Q){console.log(" Firebase  ...");try{await yE(Gs),console.log(" Firebase  ")}catch(T){console.warn("   :",T)}}console.log("   ..."),Ss(null),So(!1),xs(!1),Ye(!1),As(!1),console.log("    "),Ee("    .    ."),mn(!1),setTimeout(()=>{console.log("    ..."),window.location.reload()},2500)}catch(T){console.error("    :",T);let k="  ",O="    .";T instanceof Error&&(T.message.includes("permission-denied")||T.message.includes("insufficient permissions")?(k="  ",O=`  .

   .
(Firebase      )`):T.message.includes("network-request-failed")?(k="  ",O="    ."):T.message.includes("unauthenticated")?(k="  ",O=` .
 .`):O=`    .

 : `+T.message),ge({title:k,message:O,confirmText:"",onConfirm:()=>ge(null)}),er("idle")}},rr=Z||!!he||!!Ge||Zn||!!vt||Fr||et;return G.useEffect(()=>{if(Pp()&&rr)return document.body.classList.add("modal-open"),()=>{document.body.classList.remove("modal-open")};document.body.classList.remove("modal-open")},[rr]),p.jsxs("div",{className:`main-page-layout ${Je?"calendar-view-active":""}`,children:[p.jsxs("div",{className:`page-content ${rr?"modal-open":""}`,children:[p.jsx(b6,{folders:l,currentFolderId:f,onSetCurrentFolder:Vo,onCreateFolder:it,onRenameFolder:Ac,onDeleteFolder:fl,onSetCollaboratingFolder:ol,todos:n,t:ne,onManageFolder:T=>{Yn(T),Ot(!0)},currentUserId:Q==null?void 0:Q.uid}),p.jsxs("div",{className:"content-with-sidebar",children:[p.jsx(M6,{t:ne,isSelectionMode:fi,selectedCount:vr.size,totalVisibleCount:Ii.length,onCancelSelection:_l,onDeleteSelected:vl,onSelectAll:yl,onSetSelectionMode:()=>Lr(!0),isViewModeCalendar:Je,onToggleViewMode:()=>Es(!Je),isAiSorting:on,sortType:M,onSort:Ns,filter:_,onFilter:v,onOpenSettings:()=>mn(!0),onAddGoal:()=>ce(!0),currentFolderId:f,folders:l,onSyncSharedFolder:kc,isSyncing:Cs,isSyncingData:Cs,onManualSync:Lo,activeUsers:N,onToggleCollaboration:Of,onUpdateCollaborationSettings:hl,categoryFilter:E,onCategoryFilter:P,userCategories:w,onAddCategory:T=>A([...w,T]),onRemoveCategory:T=>A(w.filter(k=>k!==T))}),p.jsxs("div",{className:"container",children:[p.jsx(D6,{t:ne,categoryFilter:E,onCategoryFilter:P,userCategories:w,onAddCategory:T=>A([...w,T]),onRemoveCategory:T=>A(w.filter(k=>k!==T))}),Je?p.jsx($6,{todos:n,t:ne,onGoalClick:sn,language:t}):p.jsxs(p.Fragment,{children:[ko().length>0&&p.jsxs("div",{className:"today-assignments",style:{marginBottom:"24px",padding:"20px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"16px",border:"1px solid var(--border-color)"},children:[p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[p.jsxs("h3",{style:{margin:0,fontSize:"1.2rem",fontWeight:"600"},children:[" ",ne("today_schedule")]}),i.length>0&&p.jsx("button",{onClick:xc,disabled:be,style:{padding:"6px 12px",borderRadius:"6px",border:"1px solid var(--primary-color)",backgroundColor:"transparent",color:"var(--primary-color)",cursor:be?"not-allowed":"pointer",fontSize:"0.8rem",fontWeight:"500",opacity:be?.6:1},children:be?" ...":" "+ne("ai_optimize_schedule")})]}),p.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:ko().map(T=>p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"var(--card-bg-color, rgba(255, 255, 255, 0.05))",borderRadius:"12px",border:"1px solid var(--border-color)",opacity:T.completed?.6:1},children:[p.jsxs("label",{className:"checkbox-container",children:[p.jsx("input",{type:"checkbox",checked:T.completed,onChange:()=>No(T.assignmentId,T.date)}),p.jsx("span",{className:"checkmark"})]}),p.jsxs("div",{style:{flex:1},children:[p.jsxs("div",{style:{fontWeight:"500",textDecoration:T.completed?"line-through":"none"},children:[T.assignment.name," (",T.assignment.subject,")"]}),p.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"4px"},children:[ne("auto_allocated"),": ",T.allocatedMinutes,ne("minutes"),"  ",ne("difficulty_level"),T.assignment.difficulty]})]}),p.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary-color)"},children:[Math.ceil((new Date(T.assignment.dueDate).getTime()-new Date().getTime())/(1e3*60*60*24)),ne("days_left")]})]},`${T.assignmentId}-${T.date}`))}),Ce&&p.jsxs("div",{style:{marginTop:"16px",padding:"16px",backgroundColor:"var(--card-bg-color, rgba(255, 255, 255, 0.05))",borderRadius:"12px",border:"1px solid var(--border-color)"},children:[p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[p.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:"600"},children:" AI   "}),p.jsx("button",{onClick:()=>Oe(""),style:{background:"none",border:"none",color:"var(--text-secondary-color)",cursor:"pointer",fontSize:"1.2rem"},children:""})]}),p.jsx("div",{style:{fontSize:"0.9rem",lineHeight:1.6,whiteSpace:"pre-wrap"},children:Ce})]})]}),p.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",borderBottom:"1px solid var(--border-color)",padding:"0 4px"},children:[p.jsx("button",{onClick:()=>Ei("todos"),style:{padding:"12px 24px",border:"none",background:Bn==="todos"?"var(--primary-color)":"transparent",color:Bn==="todos"?"white":"var(--text-color)",borderRadius:"8px 8px 0 0",cursor:"pointer",fontSize:"15px",fontWeight:"600",transition:"all 0.2s",borderBottom:Bn==="todos"?"3px solid var(--primary-color)":"3px solid transparent",marginBottom:"-1px"},children:" "}),p.jsx("button",{onClick:()=>Ei("assignments"),style:{padding:"12px 24px",border:"none",background:Bn==="assignments"?"var(--primary-color)":"transparent",color:Bn==="assignments"?"white":"var(--text-color)",borderRadius:"8px 8px 0 0",cursor:"pointer",fontSize:"15px",fontWeight:"600",transition:"all 0.2s",borderBottom:Bn==="assignments"?"3px solid var(--primary-color)":"3px solid transparent",marginBottom:"-1px"},children:"  "})]}),Bn==="todos"?p.jsxs("div",{className:"goals-split-layout",children:[p.jsx("div",{className:"woop-section",children:p.jsx(R6,{todos:Ii,onEditTodo:xe,t:ne})}),p.jsxs("div",{className:"todos-section",children:[Ii.length>0&&p.jsx("div",{className:"section-title",style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px",color:"var(--text-color)",borderBottom:"2px solid var(--primary-color)",paddingBottom:"8px",display:"inline-block",position:"relative"},children:""}),p.jsx(V6,{todos:Ii,onToggleComplete:gl,onDelete:Do,onEdit:xe,onInfo:sn,t:ne,filter:_,randomEncouragement:Ic,isSelectionMode:fi,selectedTodoIds:vr,onSelectTodo:Nc,folders:l,onMoveToFolder:Gf})]})]}):p.jsxs("div",{className:"assignments-view",children:[p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[p.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:"600"},children:"  "}),p.jsx("button",{onClick:()=>{Ct(!0)},style:{padding:"10px 20px",backgroundColor:"var(--primary-color)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",gap:"6px"},children:"   "})]}),i.length===0?p.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"var(--text-secondary-color)"},children:[p.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),p.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px"},children:"  "}),p.jsx("p",{style:{margin:0,fontSize:"14px"},children:'"  "    '})]}):p.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:i.map(T=>p.jsxs("div",{style:{padding:"16px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"12px",border:"1px solid var(--border-color)",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[p.jsxs("div",{style:{flex:1},children:[p.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"4px",color:"var(--text-color)"},children:T.name}),p.jsxs("div",{style:{fontSize:"13px",color:"var(--text-secondary-color)",marginBottom:"8px"},children:[" ",T.subject]}),T.dueDate&&p.jsxs("div",{style:{fontSize:"13px",color:"var(--text-secondary-color)"},children:[" : ",T.dueDate]})]}),p.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"4px"},children:[p.jsxs("span",{style:{padding:"4px 12px",backgroundColor:"var(--primary-color)",color:"white",borderRadius:"16px",fontSize:"13px",fontWeight:"600"},children:[" ",T.estimatedMinutes,""]}),p.jsxs("span",{style:{fontSize:"13px",color:"var(--text-secondary-color)"},children:[": ","".repeat(T.difficulty)]})]})]}),p.jsxs("div",{style:{display:"flex",gap:"8px"},children:[p.jsx("button",{onClick:()=>{alert("    ")},style:{flex:1,padding:"10px",backgroundColor:"var(--bg-color)",color:"var(--text-color)",border:"1px solid var(--border-color)",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:" "}),p.jsx("button",{onClick:()=>{window.confirm(`"${T.name}"  ?`)&&Ff(T.id)},style:{flex:1,padding:"10px",backgroundColor:"#ff4444",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:" "})]})]},T.id))})]})]})]})]}),Pp()&&!Je&&p.jsx("button",{onClick:()=>ce(!0),className:"mobile-fab-button","aria-label":ne("add_new_goal_button_label"),title:ne("add_new_goal_button_label"),children:we.add})]}),Z&&p.jsx(Np,{onClose:()=>ce(!1),onAddTodo:Si,onAddMultipleTodos:xi,onAddAssignment:qr,analyzeAssignmentWithAI:Sc,t:ne,language:t,createAI:Cn,userCategories:w}),he&&gg(he)&&p.jsx(Np,{onClose:()=>xe(null),onEditTodo:bo,existingTodo:he,t:ne,language:t,createAI:Cn}),he&&!gg(he)&&p.jsx(j6,{todo:he,onClose:()=>xe(null),onSave:bo,t:ne}),Ge&&p.jsx(O6,{todo:Ge,onClose:()=>sn(null),t:ne,createAI:Cn,onDeleteGoal:T=>{sn(null),Do(T)},userCategories:w,onUpdateGoal:bo,onToggleComplete:T=>{sn(null),gl(T)}}),Me&&p.jsx(Np,{onClose:()=>Ct(!1),onAddTodo:Si,onAddMultipleTodos:xi,onAddAssignment:qr,analyzeAssignmentWithAI:Sc,t:ne,language:t,createAI:Cn,userCategories:w,initialMode:"assignment"}),Is!==void 0&&p.jsx(B6,{folder:Is,onClose:()=>ol(void 0),t:ne,googleUser:Q,onUpdateCollaborators:Vf,setAlertConfig:ge}),Zn&&p.jsx(G6,{onClose:()=>mn(!1),isDarkMode:V,onToggleDarkMode:()=>q(!V),themeMode:z,onThemeChange:Gr,backgroundTheme:x,onSetBackgroundTheme:R,onExportData:bc,onImportData:Fo,setAlertConfig:ge,onDeleteAllData:Dc,dataActionStatus:xn,language:t,onSetLanguage:e,t:ne,todos:n,setToastMessage:Ee,onOpenVersionInfo:()=>ae(!0),onOpenUsageGuide:()=>pi(!0),apiKey:gi,onSetApiKey:Tr,isOfflineMode:_i,onToggleOfflineMode:()=>al(!_i),googleUser:Q,onGoogleLogin:Br,onGoogleLogout:wc,onSyncDataToFirebase:Rs,onLoadDataFromFirebase:Lf,isGoogleLoggingIn:vc,isGoogleLoggingOut:xo,isSyncingData:Cs,isLoadingData:Or,isAutoSyncEnabled:yi,setIsAutoSyncEnabled:vi,notificationPermission:Pf,setNotificationPermission:tr}),Fr&&p.jsx(q6,{onClose:()=>ae(!1),t:ne}),et&&p.jsx(z6,{onClose:()=>pi(!1),t:ne}),ws&&p.jsx(Ts,{onClose:()=>Ur(!1),isClosing:!1,className:"ai-sort-reason-modal",children:p.jsxs("div",{style:{padding:"24px"},children:[p.jsx("h2",{style:{marginBottom:"16px",fontSize:"1.3rem",fontWeight:600},children:ne("ai_sort_reason_modal_title")}),p.jsx("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)",lineHeight:"1.6",color:"var(--text-secondary-color)"},children:Bt}),p.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:p.jsx("button",{onClick:()=>Ur(!1),className:"primary",children:ne("close_button")})})]})}),vt&&p.jsx(H6,{title:vt.title,message:vt.message,onConfirm:()=>{var T;(T=vt.onConfirm)==null||T.call(vt),ge(null)},onCancel:vt.onCancel?()=>{var T;(T=vt.onCancel)==null||T.call(vt),ge(null)}:void 0,confirmText:vt.confirmText,cancelText:vt.cancelText,isDestructive:vt.isDestructive,t:ne}),Sn&&p.jsx("div",{className:"toast-notification",children:Sn}),mi&&p.jsx(A6,{onClose:()=>gc(!1)}),Ut&&wn&&p.jsx("div",{className:"modal-backdrop",onClick:()=>Ot(!1),children:p.jsxs("div",{className:"modal-content large-modal",onClick:T=>T.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h3",{children:ne("folder_manage_title")}),p.jsx("button",{onClick:()=>Ot(!1),children:""})]}),p.jsx("div",{className:"modal-body",children:(()=>{var B,j,H;const T=l.find(K=>K.id===wn);if(!T)return null;const k=T.ownerId===(Q==null?void 0:Q.uid),O=k?"owner":((j=(B=T.sharedWith)==null?void 0:B.find(K=>K.userId===(Q==null?void 0:Q.uid)))==null?void 0:j.role)||"viewer";return p.jsxs("div",{className:"folder-manage-content",children:[p.jsxs("div",{className:"folder-info-section",children:[p.jsx("h4",{children:ne("folder_manage_info")}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[ne("folder_name"),":"]}),pt?p.jsxs("div",{className:"inline-edit",children:[p.jsx("input",{type:"text",value:pt,onChange:K=>oe(K.target.value),onKeyPress:K=>{K.key==="Enter"&&pl(T)}}),p.jsx("button",{onClick:()=>pl(T),children:""}),p.jsx("button",{onClick:()=>oe(""),children:""})]}):p.jsxs("div",{className:"folder-name-display",children:[p.jsx("span",{children:T.name}),k&&p.jsx("button",{className:"edit-btn",onClick:()=>oe(T.name),children:""})]})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[ne("folder_owner"),":"]}),p.jsx("span",{children:T.ownerEmail||T.ownerId})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[ne("role"),":"]}),p.jsx("span",{children:ne(O==="owner"?"folder_role_owner":O==="editor"?"folder_role_editor":"folder_role_viewer")})]}),p.jsxs("div",{className:"folder-info-item",children:[p.jsxs("label",{children:[ne("created_date"),":"]}),p.jsx("span",{children:new Date(T.createdAt).toLocaleDateString()})]})]}),p.jsxs("div",{className:"collaborators-section",children:[p.jsx("h4",{children:ne("folder_manage_collaborators")}),p.jsxs("div",{className:"collaborator-list",children:[p.jsx("div",{className:"collaborator-item owner",children:p.jsxs("div",{className:"collaborator-info",children:[p.jsx("span",{className:"email",children:T.ownerEmail||T.ownerId}),p.jsx("span",{className:"role owner-role",children:ne("folder_role_owner")})]})}),((H=T.sharedWith)==null?void 0:H.map((K,X)=>p.jsxs("div",{className:"collaborator-item",children:[p.jsxs("div",{className:"collaborator-info",children:[p.jsx("span",{className:"email",children:K.email||K.userId}),p.jsx("span",{className:`role ${K.role}`,children:K.role==="editor"?ne("folder_role_editor"):ne("folder_role_viewer")})]}),k&&p.jsxs("div",{className:"collaborator-actions",children:[p.jsxs("select",{value:K.role,onChange:W=>wr(T,K.userId,W.target.value),children:[p.jsx("option",{value:"editor",children:ne("folder_role_editor")}),p.jsx("option",{value:"viewer",children:ne("folder_role_viewer")})]}),p.jsx("button",{className:"remove-btn",onClick:()=>Rc(T,K.userId),children:""})]})]},X)))||[]]}),(k||O==="editor")&&p.jsxs("div",{className:"invite-section",children:[p.jsx("h5",{children:ne("folder_invite_new")}),p.jsxs("div",{className:"invite-form",children:[p.jsx("input",{type:"email",placeholder:ne("folder_invite_email"),value:Ke,onChange:K=>yr(K.target.value)}),p.jsxs("select",{value:In,onChange:K=>Xn(K.target.value),children:[p.jsx("option",{value:"editor",children:ne("folder_role_editor")}),p.jsx("option",{value:"viewer",children:ne("folder_role_viewer")})]}),p.jsx("button",{onClick:()=>Mo(T),disabled:!Ke||Ae,children:Ae?" ...":ne("folder_invite_button")})]})]})]}),p.jsxs("div",{className:"folder-settings-section",children:[p.jsx("h4",{children:ne("folder_manage_settings")}),p.jsxs("div",{className:"share-link-section",children:[p.jsx("label",{children:ne("folder_share_link")}),p.jsx("p",{className:"share-link-desc",children:ne("folder_share_link_desc")}),p.jsxs("div",{className:"share-link-input",children:[p.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}${window.location.pathname}?invite=${T.id}`}),p.jsx("button",{onClick:()=>Bf(T),children:ne("folder_copy_link")})]})]}),p.jsxs("div",{className:"folder-actions",children:[!k&&p.jsx("button",{className:"leave-folder-btn",onClick:()=>ks(T),children:ne("folder_leave")}),k&&p.jsx("button",{className:"delete-folder-btn",onClick:()=>ml(T),children:ne("folder_delete")})]})]})]})})()})]})})]})},b6=({folders:t,currentFolderId:e,onSetCurrentFolder:n,onCreateFolder:r,onRenameFolder:i,onDeleteFolder:s,onSetCollaboratingFolder:o,todos:a,t:l,onManageFolder:u,currentUserId:f})=>{var z;const[m,_]=G.useState(!1),[v,E]=G.useState(""),[P,M]=G.useState(null),[C,w]=G.useState(""),[A,V]=G.useState(null),q=()=>{v.trim()&&(r(v),E(""),_(!1))};return p.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-color)",overflowX:"auto",display:"flex",gap:"8px",alignItems:"center",backgroundColor:"var(--card-bg-color)"},children:[p.jsxs("button",{onClick:()=>n("my-goals"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="my-goals"?"var(--primary-color)":"transparent",color:e==="my-goals"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:[" ",l("all_goals_label")||"All"]}),p.jsx("button",{onClick:()=>n("all"),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e==="all"?"#ff6b6b":"transparent",color:e==="all"?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",minWidth:"80px",textAlign:"center"},children:l("all_goals_button")}),t.length>0&&t.filter(S=>e===null?!S.isShared||S.isShared&&S.ownerId===f:!0).map(S=>{const x=a.filter(R=>R.folderId===S.id).length;return p.jsxs("div",{style:{position:"relative",display:"inline-flex",alignItems:"center",gap:"2px"},children:[p.jsxs("button",{onClick:()=>n(S.id),style:{padding:"6px 12px",borderRadius:"8px",border:"none",backgroundColor:e===S.id?S.color||"var(--primary-color)":`${S.color}20`||"transparent",color:e===S.id?"white":"var(--text-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",position:"relative"},title:S.isShared?" ":" ",children:[S.isShared?"":""," ",S.name," (",x,")"]}),e===S.id&&p.jsxs("div",{style:{display:"flex",gap:"2px"},children:[p.jsx("button",{onClick:()=>o(S),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""}),p.jsx("button",{onClick:()=>u(S.id),style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""}),p.jsx("button",{onClick:()=>{M(S.id),w(S.name)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--button-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"  ",children:""}),p.jsx("button",{onClick:()=>{V(S.id)},style:{width:"24px",height:"24px",padding:"0",borderRadius:"4px",border:"none",backgroundColor:"var(--danger-color)",color:"white",cursor:"pointer",fontSize:"0.8rem",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:" ",children:""})]})]},S.id)}),m?p.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[p.jsx("input",{type:"text",value:v,onChange:S=>E(S.target.value),onKeyPress:S=>{S.key==="Enter"&&q(),S.key==="Escape"&&(_(!1),E(""))},placeholder:" ...",autoFocus:!0,style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.9rem",outline:"none",width:"120px"}}),p.jsx("button",{onClick:q,style:{padding:"4px 12px",borderRadius:"8px",border:"none",backgroundColor:"var(--primary-color)",color:"white",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:""}),p.jsx("button",{onClick:()=>{_(!1),E("")},style:{padding:"4px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"transparent",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",transition:"all 0.2s"},children:""})]}):p.jsx("button",{onClick:()=>_(!0),style:{padding:"6px 12px",borderRadius:"8px",border:"2px solid var(--primary-color)",backgroundColor:"transparent",color:"var(--primary-color)",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,whiteSpace:"nowrap",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},children:" "}),A&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:l("folder_delete")}),p.jsxs("p",{style:{fontSize:"0.9rem"},children:['"',(z=t.find(S=>S.id===A))==null?void 0:z.name,'" ',l("folder_delete_confirm")]})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:()=>V(null),className:"secondary",children:l("cancel_button")}),p.jsx("button",{onClick:()=>{s(A),V(null)},className:"destructive",children:""})]})]})}),P&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"  "}),p.jsx("p",{style:{fontSize:"0.9rem",marginBottom:"16px"},children:"   "}),p.jsx("input",{type:"text",value:C,onChange:S=>w(S.target.value),onKeyPress:S=>{S.key==="Enter"&&C.trim()&&(i(P,C),M(null),w(""))},placeholder:" ...",autoFocus:!0,style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.95rem",outline:"none",boxSizing:"border-box"}})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:()=>{M(null),w("")},className:"secondary",children:""}),p.jsx("button",{onClick:()=>{C.trim()&&(i(P,C),M(null),w(""))},className:"primary",children:""})]})]})})]})},D6=({t,categoryFilter:e,onCategoryFilter:n,userCategories:r,onAddCategory:i,onRemoveCategory:s})=>{const[o,a]=G.useState(!1),[l,u]=G.useState(!1),[f,m]=G.useState(""),_=G.useRef(null);G.useEffect(()=>{const P=M=>{_.current&&!_.current.contains(M.target)&&a(!1)};return document.addEventListener("click",P),document.addEventListener("touchstart",P),()=>{document.removeEventListener("click",P),document.removeEventListener("touchstart",P)}},[]);const v=()=>{const P=f.trim();P&&!r.includes(P)&&(i(P),m(""),u(!1))},E=()=>{m(""),u(!1)};return p.jsxs(p.Fragment,{children:[p.jsx("header",{className:"goals-header",children:p.jsx("div",{className:"header-title-group",children:p.jsx("h1",{children:t("my_goals_title")})})}),l&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"  "}),p.jsx("input",{type:"text",value:f,onChange:P=>m(P.target.value),placeholder:"  ",style:{width:"100%",padding:"12px",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"16px",marginTop:"16px"},onKeyPress:P=>{P.key==="Enter"&&v()},autoFocus:!0})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:E,className:"secondary",children:""}),p.jsx("button",{onClick:v,className:"primary",disabled:!f.trim()||r.includes(f.trim()),children:""})]})]})})]})},M6=({t,isSelectionMode:e,selectedCount:n,totalVisibleCount:r,onCancelSelection:i,onDeleteSelected:s,onSelectAll:o,onSetSelectionMode:a,isViewModeCalendar:l,onToggleViewMode:u,isAiSorting:f,sortType:m,onSort:_,filter:v,onFilter:E,onOpenSettings:P,onAddGoal:M,currentFolderId:C,folders:w,onSyncSharedFolder:A,isSyncing:V,isSyncingData:q,onManualSync:z,activeUsers:S,onToggleCollaboration:x,onUpdateCollaborationSettings:R,categoryFilter:N,onCategoryFilter:D,userCategories:F,onAddCategory:b,onRemoveCategory:Se})=>{const[Qe,Fe]=G.useState(!1),[Te,Z]=G.useState(!1),[ce,he]=G.useState(!1),[xe,Me]=G.useState(!1),[Ct,be]=G.useState(""),Mt=G.useRef(null),Ce=C?w.find(oe=>oe.id===C):null,Oe=Ce==null?void 0:Ce.collaborationSettings,Ut=(Oe==null?void 0:Oe.enabled)||(Ce==null?void 0:Ce.isShared)||!1;G.useEffect(()=>{const oe=()=>{Fe(!1),Z(!1)};return document.addEventListener("click",oe),document.addEventListener("touchstart",oe),()=>{document.removeEventListener("click",oe),document.removeEventListener("touchstart",oe)}},[]);const Ot=oe=>{oe.stopPropagation()},wn=()=>{const oe=Ct.trim();oe&&!F.includes(oe)&&(b(oe),be(""),Me(!1))},Yn=()=>{be(""),Me(!1)},pt=(t("selection_summary_label")||"{count}/{total}").replace("{count}",String(n)).replace("{total}",String(r));return p.jsxs("aside",{className:"app-sidebar",children:[e?p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:pt}),p.jsxs("div",{className:"sidebar-selection-buttons",children:[p.jsx("button",{onClick:o,className:"sidebar-button",children:t("select_all_button_label")}),p.jsx("button",{onClick:i,className:"sidebar-button",children:t("cancel_selection_button_label")}),n>0&&p.jsx("button",{onClick:s,className:"sidebar-button destructive",children:t("delete_selected_button_label").replace("{count}",String(n))})]})]}):p.jsxs(p.Fragment,{children:[p.jsxs("button",{onClick:M,className:"sidebar-primary-button","aria-label":t("add_new_goal_button_label"),children:[we.add,p.jsx("span",{children:t("add_new_goal_button_label")})]}),p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:t(l?"list_view_button_aria":"calendar_view_button_aria")}),p.jsxs("button",{onClick:u,className:"sidebar-button","aria-label":t(l?"list_view_button_aria":"calendar_view_button_aria"),children:[l?we.list:we.calendar,p.jsx("span",{children:t(l?"list_view_button_aria":"calendar_view_button_aria")})]})]}),p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:t("filter_sort_button_aria")}),p.jsxs("div",{className:"filter-sort-container",children:[p.jsxs("button",{onClick:oe=>{oe.stopPropagation(),Fe(Ke=>!Ke)},onTouchStart:oe=>{oe.stopPropagation(),Fe(Ke=>!Ke)},className:"sidebar-button","aria-label":t("filter_sort_button_aria"),children:[f?p.jsx("div",{className:"spinner"}):we.filter,p.jsx("span",{children:t("filter_sort_button_aria")})]}),Qe&&p.jsxs("div",{className:"profile-popover filter-sort-popover",onClick:Ot,onTouchStart:Ot,children:[p.jsx("div",{className:"popover-section",children:p.jsx("button",{onClick:()=>{a(),Fe(!1)},className:"popover-action-button",children:p.jsx("span",{children:t("select_button_label")})})}),p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{children:t("filter_title")}),p.jsxs("button",{onClick:()=>{E("all")},className:`popover-action-button ${v==="all"?"active":""}`,children:[p.jsx("span",{children:t("filter_all")}),v==="all"&&we.check]}),p.jsxs("button",{onClick:()=>{E("active")},className:`popover-action-button ${v==="active"?"active":""}`,children:[p.jsx("span",{children:t("filter_active")}),v==="active"&&we.check]}),p.jsxs("button",{onClick:()=>{E("completed")},className:`popover-action-button ${v==="completed"?"active":""}`,children:[p.jsx("span",{children:t("filter_completed")}),v==="completed"&&we.check]})]}),p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{children:t("sort_title")}),p.jsxs("button",{onClick:()=>{_("manual")},className:`popover-action-button ${m==="manual"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_manual")}),m==="manual"&&we.check]}),p.jsxs("button",{onClick:()=>{_("deadline")},className:`popover-action-button ${m==="deadline"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_deadline")}),m==="deadline"&&we.check]}),p.jsxs("button",{onClick:()=>{_("newest")},className:`popover-action-button ${m==="newest"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_newest")}),m==="newest"&&we.check]}),p.jsxs("button",{onClick:()=>{_("alphabetical")},className:`popover-action-button ${m==="alphabetical"?"active":""}`,children:[p.jsx("span",{children:t("sort_label_alphabetical")}),m==="alphabetical"&&we.check]}),p.jsxs("button",{onClick:()=>{_("ai")},className:"popover-action-button with-icon",children:[p.jsx("span",{className:"popover-button-icon",children:we.ai}),p.jsx("span",{children:t(f?"ai_sorting_button":"sort_label_ai")})]}),p.jsx("button",{onClick:()=>{_("ai"),Fe(!1)},className:"popover-action-button",style:{backgroundColor:"rgba(88, 86, 214, 0.1)",marginTop:"8px",color:"var(--icon-color-indigo)"},children:p.jsx("span",{children:"   "})})]})]})]})]}),C&&(Ce==null?void 0:Ce.isShared)&&p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:""}),p.jsxs("div",{className:"collaboration-settings",children:[p.jsx("button",{onClick:oe=>{oe.stopPropagation(),Z(Ke=>!Ke)},className:`sidebar-button ${Ut?"collaboration-active":""}`,"aria-label":" ",children:Ut?"":""}),Te&&C&&p.jsx("div",{className:"profile-popover collaboration-popover",onClick:Ot,onTouchStart:Ot,children:p.jsxs("div",{className:"popover-section",children:[p.jsx("h4",{style:{marginBottom:"12px"},children:" "}),p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[p.jsx("span",{children:" "}),p.jsx("button",{onClick:()=>x(C,!Ut),style:{background:Ut?"var(--primary-color)":"#ccc",border:"none",borderRadius:"12px",width:"44px",height:"24px",position:"relative",cursor:"pointer",transition:"background 0.2s"},children:p.jsx("div",{style:{background:"white",borderRadius:"50%",width:"20px",height:"20px",position:"absolute",top:"2px",left:Ut?"22px":"2px",transition:"left 0.2s"}})})]}),Ut&&S.length>0&&p.jsxs("div",{style:{marginBottom:"16px"},children:[p.jsxs("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:["  (",S.length,")"]}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:S.map(oe=>p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(var(--primary-color-rgb), 0.1)",padding:"4px 8px",borderRadius:"12px",fontSize:"0.8rem"},children:[oe.photoURL&&p.jsx("img",{src:oe.photoURL,alt:"",style:{width:"16px",height:"16px",borderRadius:"50%"}}),p.jsx("span",{children:oe.displayName}),p.jsx("div",{style:{width:"6px",height:"6px",background:oe.isOnline?"#34C759":"#ccc",borderRadius:"50%"}})]},oe.userId))})]}),Ut&&p.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:"16px"},children:[p.jsx("h5",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:" "}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:" "}),p.jsx("input",{type:"checkbox",checked:(Oe==null?void 0:Oe.showPresence)??!0,onChange:oe=>R(C,{showPresence:oe.target.checked})})]}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:"  "}),p.jsx("input",{type:"checkbox",checked:(Oe==null?void 0:Oe.showEditingState)??!0,onChange:oe=>R(C,{showEditingState:oe.target.checked})})]}),p.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer"},children:[p.jsx("span",{style:{fontSize:"0.8rem"},children:" "}),p.jsx("input",{type:"checkbox",checked:(Oe==null?void 0:Oe.enableConflictDetection)??!0,onChange:oe=>R(C,{enableConflictDetection:oe.target.checked})})]})]})]})})]})]}),p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:""}),C&&(Ce==null?void 0:Ce.isShared)&&p.jsx("button",{onClick:A,disabled:V,className:"sidebar-button","aria-label":"",children:V?p.jsx("div",{className:"spinner",style:{width:"20px",height:"20px"}}):"  "}),p.jsx("button",{className:"sync-status-indicator clickable",onClick:()=>{q||(C&&(Ce!=null&&Ce.isShared)?A():z())},disabled:q,title:q?" ...":"  ",children:q?p.jsx("span",{style:{fontSize:"12px"},children:""}):p.jsx("span",{style:{fontSize:"12px"},children:""})})]}),p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:" "}),p.jsxs("div",{className:"category-dropdown-container",ref:Mt,children:[p.jsxs("button",{onClick:oe=>{oe.stopPropagation(),he(Ke=>!Ke)},className:"category-dropdown-button",style:{width:"100%",justifyContent:"space-between"},"aria-label":t("category_filter_button_aria"),children:[p.jsx("span",{children:N==="all"?t("category_all"):N}),p.jsx("span",{className:"dropdown-arrow",children:""})]}),ce&&p.jsxs("div",{className:"category-dropdown-menu",onClick:oe=>oe.stopPropagation(),children:[p.jsxs("div",{className:"dropdown-header",children:[p.jsx("span",{children:t("filter_category")}),p.jsx("button",{onClick:oe=>{oe.stopPropagation(),Me(!0),he(!1)},className:"add-category-button",title:"  ",children:"+"})]}),p.jsxs("div",{className:"dropdown-items",children:[p.jsxs("button",{onClick:()=>{D("all"),he(!1)},className:`dropdown-item ${N==="all"?"active":""}`,children:[p.jsx("span",{children:t("category_all")}),N==="all"&&p.jsx("span",{className:"check-icon",children:""})]}),F.map(oe=>p.jsxs("div",{className:"dropdown-item-container",children:[p.jsxs("button",{onClick:()=>{D(oe),he(!1)},className:`dropdown-item ${N===oe?"active":""}`,children:[p.jsx("span",{children:oe}),N===oe&&p.jsx("span",{className:"check-icon",children:""})]}),!["school","work","personal","other"].includes(oe)&&p.jsx("button",{onClick:()=>Se(oe),className:"remove-category-button",title:" ",children:""})]},oe))]})]})]})]}),p.jsxs("div",{className:"sidebar-card",children:[p.jsx("p",{className:"sidebar-section-title",children:t("settings_title")}),p.jsxs("button",{onClick:P,className:"sidebar-button","aria-label":t("settings_title"),children:[we.settings,p.jsx("span",{children:t("settings_title")})]})]})]}),xe&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:"  "}),p.jsx("input",{type:"text",value:Ct,onChange:oe=>be(oe.target.value),placeholder:"  ",style:{width:"100%",padding:"12px",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"16px",marginTop:"16px"},onKeyPress:oe=>{oe.key==="Enter"&&wn()},autoFocus:!0})]}),p.jsxs("div",{className:"modal-buttons",children:[p.jsx("button",{onClick:Yn,className:"secondary",children:""}),p.jsx("button",{onClick:wn,className:"primary",disabled:!Ct.trim()||F.includes(Ct.trim()),children:""})]})]})})]})},V6=({todos:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,filter:o,randomEncouragement:a,isSelectionMode:l,selectedTodoIds:u,onSelectTodo:f,folders:m,onMoveToFolder:_})=>{if(t.length===0){const v=`empty_message_${o}`;return p.jsx("div",{className:"empty-message",children:p.jsx("p",{children:s(v)})})}return p.jsx("ul",{children:t.map(v=>p.jsx(L6,{todo:v,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:l,isSelected:u.has(v.id),onSelect:f,folders:m,onMoveToFolder:_},v.id))})},L6=dI.memo(({todo:t,onToggleComplete:e,onDelete:n,onEdit:r,onInfo:i,t:s,isSelectionMode:o,isSelected:a,onSelect:l,folders:u,onMoveToFolder:f})=>{var E;const m=()=>{o&&l(t.id)},_={school:"",work:"",personal:"",other:""},v=P=>P?{school:s("category_school"),work:s("category_work"),personal:s("category_personal"),other:s("category_other")}[P]||P:"";return p.jsx("li",{className:`${t.completed?"completed":""} ${o?"selection-mode":""} ${a?"selected":""}`,onClick:m,children:p.jsxs("div",{className:"swipeable-content",children:[p.jsxs("label",{className:"checkbox-container",onClick:P=>P.stopPropagation(),children:[p.jsx("input",{type:"checkbox",checked:t.completed,onChange:()=>e(t.id)}),p.jsx("span",{className:"checkmark"})]}),p.jsxs("div",{className:"todo-text-with-streak",children:[p.jsx("span",{className:"todo-text",children:t.title||t.wish}),t.isRecurring&&t.streak>0&&p.jsxs("div",{className:"streak-indicator",children:[we.flame,p.jsx("span",{children:t.streak})]})]}),p.jsxs("div",{className:"todo-actions-and-meta",children:[p.jsxs("div",{className:"todo-meta-badges",children:[t.category&&p.jsxs("span",{style:{backgroundColor:"rgba(88, 86, 214, 0.1)",color:"var(--icon-color-indigo)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginRight:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[_[t.category]||""," ",v(t.category)]}),t.deadline&&p.jsx("span",{className:"todo-deadline",children:k6(t.deadline,s)}),t.collaborators&&t.collaborators.length>0&&p.jsxs("span",{style:{backgroundColor:"rgba(52, 199, 89, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.85rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px"},children:[" ",t.collaborators.length]}),t.folderId&&p.jsxs("span",{style:{backgroundColor:"rgba(100, 150, 200, 0.15)",color:"var(--primary-color)",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",marginLeft:"4px",display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[" ",((E=u.find(P=>P.id===t.folderId))==null?void 0:E.name)||"Unknown"]})]}),p.jsxs("div",{className:"todo-buttons",children:[p.jsxs("select",{onClick:P=>P.stopPropagation(),onChange:P=>{f(t.id,P.target.value==="root"?null:P.target.value)},defaultValue:t.folderId||"root",style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--card-bg-color)",color:"var(--text-color)",cursor:"pointer",fontSize:"0.85rem",fontFamily:"inherit"},title:" ",children:[p.jsx("option",{value:"root",children:"  "}),u.map(P=>p.jsx("option",{value:P.id,children:P.name},P.id))]}),p.jsx("button",{onClick:P=>{P.stopPropagation(),r(t)},className:"info-button edit-button","aria-label":s("edit_button_aria"),children:we.edit}),p.jsx("button",{onClick:P=>{P.stopPropagation(),n(t.id)},className:"delete-button","aria-label":s("delete_button"),children:we.delete}),p.jsx("button",{onClick:P=>{P.stopPropagation(),i(t)},className:"info-button","aria-label":s("info_button_aria"),children:we.info})]})]})]})})}),Ts=({onClose:t,children:e,className:n="",isClosing:r,size:i="large"})=>{const s={small:"modal-content-small",medium:"modal-content-medium",large:"modal-content-large"}[i];return p.jsx("div",{className:`modal-backdrop ${r?"is-closing":""}`,onClick:t,children:p.jsx("div",{className:`modal-content ${s} ${n} ${r?"is-closing":""}`,onClick:o=>o.stopPropagation(),children:e})})},Io=t=>{const[e,n]=G.useState(!1);return[e,()=>{n(!0),setTimeout(t,500)}]},F6=({step:t,t:e,createAI:n,...r})=>{const{wish:i,setWish:s,outcome:o,setOutcome:a,obstacle:l,setObstacle:u,plan:f,setPlan:m,isRecurring:_,setIsRecurring:v,recurringDays:E,setRecurringDays:P,deadline:M,setDeadline:C,noDeadline:w,setNoDeadline:A,category:V,setCategory:q,userCategories:z,errors:S,language:x}=r,[R,N]=G.useState(!1),[D,F]=G.useState(""),[b,Se]=G.useState(""),Qe=async(Fe,Te)=>{if(Te){N(!0),F(""),Se("");try{const Z=n();if(!Z){Se("AI    API  ."),N(!1);return}const ce=`Provide concise, actionable feedback on this part of a WOOP goal: ${Fe} - "${Te}". The feedback should be helpful and encouraging, in ${x==="ko"?"Korean":"English"}. Keep it to 1-2 sentences.`,he=await Z.models.generateContent({model:"gemini-2.5-flash",contents:ce});F(he.text)}catch(Z){console.error("AI Feedback Error:",Z),Se("Failed to get AI feedback.")}finally{N(!1)}}};switch(t){case 1:return p.jsxs("div",{children:[p.jsx("h3",{children:e("wish_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("wish_tip")}),p.jsx("p",{className:"example",children:e("wish_example")})]}),p.jsx("textarea",{value:i,onChange:Te=>{s(Te.target.value),F(""),Se("")},placeholder:e("wish_label"),className:S.wish?"input-error":"",rows:3}),S.wish&&p.jsxs("p",{className:"field-error-message",children:[we.exclamation," ",e("error_wish_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Qe("Wish",i),disabled:!i.trim()||R,className:"ai-feedback-button",children:[R?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),D&&p.jsx("div",{className:"ai-feedback-bubble",children:D}),b&&p.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 2:return p.jsxs("div",{children:[p.jsx("h3",{children:e("outcome_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("outcome_tip")}),p.jsx("p",{className:"example",children:e("outcome_example")})]}),p.jsx("textarea",{value:o,onChange:Te=>{a(Te.target.value),F(""),Se("")},placeholder:e("outcome_label"),className:S.outcome?"input-error":"",rows:3}),S.outcome&&p.jsxs("p",{className:"field-error-message",children:[we.exclamation," ",e("error_outcome_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Qe("Outcome",o),disabled:!o.trim()||R,className:"ai-feedback-button",children:[R?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),D&&p.jsx("div",{className:"ai-feedback-bubble",children:D}),b&&p.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 3:return p.jsxs("div",{children:[p.jsx("h3",{children:e("obstacle_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("obstacle_tip")}),p.jsx("p",{className:"example",children:e("obstacle_example")})]}),p.jsx("textarea",{value:l,onChange:Te=>{u(Te.target.value),F(""),Se("")},placeholder:e("obstacle_label"),className:S.obstacle?"input-error":"",rows:3}),S.obstacle&&p.jsxs("p",{className:"field-error-message",children:[we.exclamation," ",e("error_obstacle_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Qe("Obstacle",l),disabled:!l.trim()||R,className:"ai-feedback-button",children:[R?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),D&&p.jsx("div",{className:"ai-feedback-bubble",children:D}),b&&p.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 4:return p.jsxs("div",{children:[p.jsx("h3",{children:e("plan_label")}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("plan_tip")}),p.jsx("p",{className:"example",children:e("plan_example")})]}),p.jsx("textarea",{value:f,onChange:Te=>{m(Te.target.value),F(""),Se("")},placeholder:e("plan_label"),className:S.plan?"input-error":"",rows:3}),S.plan&&p.jsxs("p",{className:"field-error-message",children:[we.exclamation," ",e("error_plan_required")]}),p.jsxs("div",{className:"ai-feedback-section",children:[p.jsxs("button",{onClick:()=>Qe("Plan",f),disabled:!f.trim()||R,className:"ai-feedback-button",children:[R?p.jsx("div",{className:"spinner-small"}):"",p.jsx("span",{children:e(R?"ai_analyzing":"ai_coach_suggestion")})]}),D&&p.jsx("div",{className:"ai-feedback-bubble",children:D}),b&&p.jsx("div",{className:"ai-feedback-bubble error",children:b})]})]});case 5:const Fe=Te=>{const Z=[...E],ce=Z.indexOf(Te);ce>-1?Z.splice(ce,1):Z.push(Te),P(Z)};return p.jsxs("div",{children:[p.jsxs("h3",{children:[e("recurrence_label")," & ",e("deadline_label")," & ",e("category_label")]}),p.jsxs("div",{className:"step-guidance",children:[p.jsx("p",{className:"tip",children:e("recurrence_tip")}),p.jsx("p",{className:"example",children:e("recurrence_example")})]}),p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:500},children:e("recurrence_option_daily")}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:_,onChange:Te=>v(Te.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),_&&p.jsx("div",{className:"day-picker",children:e("day_names_short_picker").map((Te,Z)=>p.jsx("button",{onClick:()=>Fe(Z),className:`day-button ${E.includes(Z)?"selected":""}`,children:Te},Z))}),S.recurringDays&&p.jsxs("p",{className:"field-error-message",children:[we.exclamation," ",e("error_day_required")]}),p.jsx("hr",{}),p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:e("deadline_tip")})}),p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:500},children:e("deadline_option_no_deadline")}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:w,onChange:Te=>A(Te.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),!w&&p.jsx("input",{type:"date",value:M,onChange:Te=>C(Te.target.value),className:S.deadline?"input-error":"",style:{marginTop:"12px"}}),S.deadline&&p.jsxs("p",{className:"field-error-message",children:[we.exclamation," ",e("error_deadline_required")]}),p.jsx("hr",{}),p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:e("category_label")})}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:z&&z.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:z&&z.map(Te=>p.jsx("button",{onClick:()=>q(Te),className:`category-button ${V===Te?"active":""}`,children:Te},Te))})]});default:return null}},U6=({onGenerate:t,t:e,onCancel:n})=>{const[r,i]=G.useState(""),[s,o]=G.useState(""),[a,l]=G.useState(""),[u,f]=G.useState(""),[m,_]=G.useState(""),{endDate:v,generatedCount:E}=G.useMemo(()=>{const M=parseInt(s,10),C=parseInt(a,10);if(!u||!M||M<=0||!C||C<=0)return{endDate:"",generatedCount:0};const w=Math.ceil(M/C),A=new Date(u),V=new Date(A);return V.setDate(A.getDate()+w-1),{endDate:V.toISOString().split("T")[0],generatedCount:w}},[s,a,u]),P=()=>{const M=parseInt(s,10),C=parseInt(a,10);if(!r.trim()||!u||!M||M<=0||!C||C<=0){_(e("automation_error_all_fields"));return}const w=[],A=Math.ceil(M/C),V=new Date(u);for(let q=0;q<A;q++){const z=new Date(V);z.setDate(V.getDate()+q);const S=q*C+1,x=Math.min((q+1)*C,M),R=`${r.trim()} ${S}`+(x>S?` - ${x}`:"");w.push({wish:R,outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:z.toISOString().split("T")[0],category:"personal"})}_(""),t(w)};return p.jsxs("div",{className:"automation-form-container",children:[p.jsx("h3",{children:e("automation_title")}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_base_name_label")}),p.jsx("input",{type:"text",value:r,onChange:M=>i(M.target.value),placeholder:e("automation_base_name_placeholder")})]}),p.jsxs("div",{className:"automation-form-grid",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_total_units_label")}),p.jsx("input",{type:"number",value:s,onChange:M=>o(M.target.value),placeholder:e("automation_total_units_placeholder")})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_units_per_day_label")}),p.jsx("input",{type:"number",value:a,onChange:M=>l(M.target.value),placeholder:": 5"})]})]}),p.jsxs("div",{className:"automation-form-grid",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_start_date_label")}),p.jsx("input",{type:"date",value:u,onChange:M=>f(M.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:e("automation_end_date_label")}),p.jsx("input",{type:"date",value:v,readOnly:!0})]})]}),m&&p.jsxs("p",{className:"field-error-message",style:{justifyContent:"center"},children:[we.exclamation," ",m]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:n,className:"secondary",children:e("cancel_button")}),p.jsx("button",{onClick:P,className:"primary",disabled:E===0,children:E>0?`${E} `:e("automation_generate_button").replace("{count}",String(E))})]})]})},Np=({onClose:t,onAddTodo:e,onAddMultipleTodos:n,onEditTodo:r,existingTodo:i,t:s,language:o,createAI:a,userCategories:l=["personal"],onAddAssignment:u,analyzeAssignmentWithAI:f,initialMode:m="woop"})=>{const[_,v]=Io(t),[E,P]=G.useState(m),[M,C]=G.useState(1),[w,A]=G.useState("forward"),[V,q]=G.useState((i==null?void 0:i.wish)||""),[z,S]=G.useState((i==null?void 0:i.outcome)||""),[x,R]=G.useState((i==null?void 0:i.obstacle)||""),[N,D]=G.useState((i==null?void 0:i.plan)||""),[F,b]=G.useState((i==null?void 0:i.isRecurring)||!1),[Se,Qe]=G.useState((i==null?void 0:i.recurringDays)||[]),[Fe,Te]=G.useState((i==null?void 0:i.deadline)||""),[Z,ce]=G.useState(!(i!=null&&i.deadline)),[he,xe]=G.useState((i==null?void 0:i.category)||"personal"),[Me,Ct]=G.useState({}),[be,Mt]=G.useState(""),[Ce,Oe]=G.useState(""),[Ut,Ot]=G.useState(""),[wn,Yn]=G.useState("personal"),[pt,oe]=G.useState(""),[Ke,yr]=G.useState(""),[In,Xn]=G.useState(""),[Ae,Be]=G.useState(""),[Ge,sn]=G.useState(3),[Zn,mn]=G.useState(""),[on,Fn]=G.useState(!1),[Je,Es]=G.useState(!1),[vt,ge]=G.useState(""),fi=5,Lr=ae=>{const et={};return ae===1&&!V.trim()&&(et.wish=!0),ae===2&&!z.trim()&&(et.outcome=!0),ae===3&&!x.trim()&&(et.obstacle=!0),ae===4&&!N.trim()&&(et.plan=!0),ae===5&&(!Z&&!Fe&&(et.deadline=!0),F&&Se.length===0&&(et.recurringDays=!0)),Ct(et),Object.keys(et).length===0},vr=()=>{Lr(M)&&(M<fi?(A("forward"),C(ae=>ae+1)):Ee())},Un=()=>{M>1&&(A("backward"),C(ae=>ae-1))},Sn=ae=>{ae==="quick"&&(q(""),S(""),R(""),D("")),ae==="assignment"&&(oe(""),yr(""),Xn(""),Be(""),sn(3),mn(""),ge("")),P(ae)},Ee=async()=>{if(E==="quick"){console.log("    handleSubmit  - handleQuickTaskSubmit "),xn();return}if(!Lr(5))return;const ae={wish:V,outcome:z,obstacle:x,plan:N,isRecurring:F,recurringDays:Se,deadline:Z?"":Fe,category:he};console.log(" WOOP  :",ae);try{i&&r?await r({...i,...ae}):e&&await e(ae)}catch(et){console.error("   :",et)}v()},xn=()=>{if(be.trim()){if(e){const ae={title:be.trim(),wish:"",outcome:"",obstacle:"",plan:"",isRecurring:!1,recurringDays:[],deadline:Ce,category:wn};console.log("   :",ae),e(ae)}Mt(""),Oe(""),Ot(""),Yn("personal"),v()}},er=async()=>{if(!(!pt.trim()||!Ke.trim())){Es(!0);try{if(f){let ae=In;if(Zn&&!on){const pi=`
: ${Zn}`;ae=In?`${In}${pi}`:pi}const et=await f(pt,Ke,ae);et&&(Be(et.estimatedMinutes.toString()),sn(et.difficulty),ge(et.studyTips||et.optimizedSchedule||""))}}catch(ae){console.error("AI  :",ae)}finally{Es(!1)}}},Fr=()=>{!pt.trim()||!Ke.trim()||!Ae||!on&&!Zn||(u&&u({name:pt.trim(),subject:Ke.trim(),estimatedMinutes:parseInt(Ae),difficulty:Ge,dueDate:on?"":Zn,completed:!1}),oe(""),yr(""),Xn(""),Be(""),sn(3),mn(""),Fn(!1),ge(""),v())};return p.jsxs(Ts,{onClose:v,isClosing:_,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"goal-assistant-header",children:[p.jsx("div",{className:"goal-assistant-header-left"}),p.jsx("h2",{children:E==="woop"?" ":E==="quick"?" ":E==="assignment"?"  ":E==="automation"?" ":s("goal_assistant_title")}),p.jsx("div",{className:"goal-assistant-header-right",style:{width:"40px"}})]}),!i&&p.jsx("div",{className:"modal-mode-switcher-container",children:p.jsxs("div",{className:"modal-mode-switcher",children:[p.jsx("button",{onClick:()=>Sn("woop"),className:E==="woop"?"active":"",children:s("goal_assistant_mode_woop")}),p.jsx("button",{onClick:()=>Sn("quick"),className:E==="quick"?"active":"",children:" "}),u&&p.jsx("button",{onClick:()=>Sn("assignment"),className:E==="assignment"?"active":"",children:" "}),p.jsx("button",{onClick:()=>Sn("automation"),className:E==="automation"?"active":"",children:s("goal_assistant_mode_automation")})]})}),"            ",p.jsx("div",{className:"goal-assistant-body",children:E==="woop"?p.jsxs(p.Fragment,{children:[p.jsxs("div",{style:{padding:"24px 16px",flex:1,overflowY:"auto"},children:[p.jsx("div",{className:"progress-bar-container",children:p.jsx("div",{className:"progress-bar",style:{width:`${M/fi*100}%`}})}),p.jsx("div",{className:`goal-assistant-step-content-animator ${w}`,children:p.jsx(F6,{step:M,t:s,createAI:a,wish:V,setWish:q,outcome:z,setOutcome:S,obstacle:x,setObstacle:R,plan:N,setPlan:D,isRecurring:F,setIsRecurring:b,recurringDays:Se,setRecurringDays:Qe,deadline:Fe,setDeadline:Te,noDeadline:Z,setNoDeadline:ce,category:he,setCategory:xe,userCategories:l,errors:Me,language:o})},M)]}),p.jsxs("div",{className:"goal-assistant-nav",children:[M>1?p.jsx("button",{onClick:Un,className:"secondary",children:s("back_button")}):p.jsx("button",{onClick:v,className:"secondary",children:s("cancel_button")}),p.jsx("button",{onClick:vr,className:"primary",children:s(M===fi?i?"save_button":"add_button":"next_button")})]})]}):E==="quick"?p.jsxs(p.Fragment,{children:[p.jsxs("div",{style:{padding:"24px 16px",flex:1,overflowY:"auto"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:" "}),p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"  "})}),p.jsx("textarea",{value:be,onChange:ae=>Mt(ae.target.value),placeholder:":  ",rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},onKeyPress:ae=>{ae.key==="Enter"&&ae.ctrlKey&&xn()}})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:"  ()"})}),p.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[p.jsx("span",{style:{fontWeight:"500"},children:" "}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:!!Ce,onChange:ae=>Oe(ae.target.checked?new Date().toISOString().split("T")[0]:"")}),p.jsx("span",{className:"slider round"})]})]}),Ce&&p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginTop:"12px"},children:[p.jsxs("div",{children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:""}),p.jsx("input",{type:"date",value:Ce,onChange:ae=>Oe(ae.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]}),p.jsxs("div",{children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"4px"},children:" ()"}),p.jsx("input",{type:"time",value:Ut,onChange:ae=>Ot(ae.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})]})]})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"24px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:s("category_label")})}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:l&&l.length>2?"repeat(2, 1fr)":"repeat(1, 1fr)",gap:"8px",marginTop:"12px"},children:l&&l.map(ae=>p.jsx("button",{onClick:()=>Yn(ae),className:`category-button ${wn===ae?"active":""}`,children:ae},ae))})]})]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:v,className:"secondary",children:s("cancel_button")}),p.jsx("button",{onClick:xn,className:"primary",disabled:!be.trim(),children:s("add_button")})]})]}):E==="assignment"?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"goal-assistant-step-content",children:[p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:s("subject")}),p.jsx("input",{type:"text",value:Ke,onChange:ae=>yr(ae.target.value),placeholder:": ",disabled:Je,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:Je?.6:1,cursor:Je?"not-allowed":"text"}})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:s("assignment_name")}),p.jsx("input",{type:"text",value:pt,onChange:ae=>oe(ae.target.value),placeholder:":   3",disabled:Je,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:Je?.6:1,cursor:Je?"not-allowed":"text"}})]}),p.jsxs("div",{className:"info-section",children:[p.jsxs("h4",{children:[s("assignment_description")," ()"]}),p.jsx("textarea",{value:In,onChange:ae=>Xn(ae.target.value),placeholder:s("assignment_description_placeholder"),rows:3,disabled:Je,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",resize:"vertical",opacity:Je?.6:1,cursor:Je?"not-allowed":"text"}})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:s("due_date")}),p.jsx("input",{type:"date",value:Zn,onChange:ae=>mn(ae.target.value),min:new Date().toISOString().split("T")[0],disabled:on,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:on?.5:1,cursor:on?"not-allowed":"text"}}),p.jsxs("div",{style:{marginTop:"12px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",userSelect:"none"},onClick:()=>{Fn(!on),on||mn("")},children:[p.jsx("div",{style:{width:"44px",height:"24px",borderRadius:"12px",backgroundColor:on?"var(--primary-color)":"var(--border-color)",position:"relative",transition:"background-color 0.2s",cursor:"pointer"},children:p.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"white",position:"absolute",top:"2px",left:on?"22px":"2px",transition:"left 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}})}),p.jsx("span",{style:{fontSize:"0.9rem",color:"var(--text-color)"},children:" "})]})]}),pt.trim()&&Ke.trim()&&Je&&p.jsx("div",{style:{padding:"16px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"12px",border:"1px solid var(--primary-color)",marginBottom:"16px",textAlign:"center"},children:p.jsxs("p",{style:{fontSize:"0.95rem",color:"var(--primary-color)",margin:0},children:[" ",s("ai_analyzing"),"..."]})}),vt&&p.jsxs("div",{style:{padding:"16px",backgroundColor:"var(--bg-secondary-color)",borderRadius:"12px",border:"1px solid var(--border-color)",marginBottom:"16px"},children:[p.jsxs("h4",{style:{marginBottom:"8px",fontSize:"0.9rem"},children:[" ",s("ai_suggestion")]}),p.jsx("p",{style:{fontSize:"0.9rem",lineHeight:"1.5",color:"var(--text-secondary-color)",margin:0},children:vt})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:s("difficulty")}),p.jsx("div",{style:{display:"flex",gap:"8px",justifyContent:"space-between"},children:[1,2,3,4,5].map(ae=>p.jsx("button",{onClick:()=>!Je&&sn(ae),disabled:Je,style:{flex:1,padding:"12px",borderRadius:"8px",border:Ge===ae?"2px solid var(--primary-color)":"1px solid var(--border-color)",backgroundColor:Ge===ae?"var(--primary-color)":"var(--bg-secondary-color)",color:Ge===ae?"white":"var(--text-color)",cursor:Je?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:Ge===ae?"600":"500",opacity:Je?.6:1},children:ae},ae))})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:s("estimated_time")}),p.jsx("input",{type:"number",value:Ae,onChange:ae=>Be(ae.target.value),placeholder:"",min:"1",disabled:Je,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",opacity:Je?.6:1,cursor:Je?"not-allowed":"text"}})]})]}),p.jsxs("div",{className:"goal-assistant-nav",style:{display:"flex",gap:"8px"},children:[p.jsx("button",{onClick:v,className:"secondary",children:s("cancel_button")}),p.jsx("button",{onClick:er,className:"secondary",disabled:!pt.trim()||!Ke.trim()||Je,style:{flex:1},children:Je?"  ...":" AI "}),p.jsx("button",{onClick:Fr,className:"primary",disabled:!pt.trim()||!Ke.trim()||!Ae||!on&&!Zn,style:{flex:1},children:s("add_assignment")})]})]}):n&&p.jsx(U6,{onGenerate:n,t:s,onCancel:v})})]})},O6=({todo:t,onClose:e,t:n,createAI:r,onDeleteGoal:i,userCategories:s,onUpdateGoal:o,onToggleComplete:a})=>{const[l,u]=Io(e),[f,m]=G.useState(""),[_,v]=G.useState(!1),[E,P]=G.useState(!1),M=async()=>{v(!0),m(""),P(!1);try{const w=r();if(!w){m("AI    API  ."),v(!1);return}const A=`Based on the WOOP method, provide a concise and encouraging suggestion for the following goal: Wish: "${t.wish}", Best Outcome: "${t.outcome}", Obstacle: "${t.obstacle}", Plan: "${t.plan}". Focus on strengthening the plan or reframing the obstacle.`,V=await w.models.generateContent({model:"gemini-2.5-flash",contents:A});m(V.text)}catch(w){console.error(w),P(!0)}finally{v(!1)}},C=gg(t);return p.jsxs(Ts,{onClose:u,isClosing:l,className:"info-modal",children:[p.jsxs("div",{className:"info-modal-content",children:[p.jsx("h2",{children:n(C?"goal_details_modal_title":"todo_details_title")}),C?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("wish_label")}),p.jsx("p",{children:t.wish})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("outcome_label")}),p.jsx("p",{children:t.outcome})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("obstacle_label")}),p.jsx("p",{children:t.obstacle})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("plan_label")}),p.jsx("p",{children:t.plan})]})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("task_title_label")}),p.jsx("p",{children:t.title})]}),t.date&&p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("due_date_label")}),p.jsx("p",{children:new Date(t.date).toLocaleDateString()})]}),t.time&&p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("time_label")}),p.jsx("p",{children:t.time})]}),p.jsxs("div",{className:"info-section",children:[p.jsx("h4",{children:n("completion_status_label")}),p.jsx("p",{children:t.completed?n("completed"):n("pending")})]})]}),s&&s.length>0&&o&&p.jsxs("div",{className:"info-section",style:{borderTop:"1px solid var(--border-color)",paddingTop:"16px",marginTop:"16px"},children:[p.jsx("h4",{style:{marginBottom:"12px"},children:n("category_label")}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:s.map(w=>p.jsx("button",{onClick:()=>{o({...t,category:w}),u()},className:`category-button ${t.category===w?"active":""}`,style:{padding:"8px 16px",borderRadius:"20px",border:t.category===w?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:t.category===w?"var(--primary-color)":"transparent",color:t.category===w?"white":"var(--text-color)",cursor:"pointer",fontSize:"14px",fontWeight:t.category===w?"600":"500",transition:"all 0.25s ease",whiteSpace:"nowrap",display:"inline-block",boxShadow:t.category===w?"0 2px 8px rgba(88, 86, 214, 0.2)":"none"},children:w},w))})]}),C&&p.jsxs("div",{className:"ai-analysis-section",children:[p.jsx("h4",{children:n("ai_coach_suggestion")}),_?p.jsx("p",{children:n("ai_analyzing")}):f?p.jsx("p",{children:f}):E?p.jsx("p",{className:"ai-error",children:n("ai_sort_error_message")}):p.jsx("button",{onClick:M,className:"feedback-button",children:n("ai_coach_suggestion")})]})]}),p.jsxs("div",{className:"modal-buttons",children:[a&&p.jsx("button",{onClick:()=>{a(t.id),u()},className:`secondary ${t.completed?"destructive":""}`,children:t.completed?"  ":"  "}),i&&p.jsxs("button",{onClick:()=>{i(t.id)},className:"secondary destructive",children:[" ",n("delete_button")]}),p.jsx("button",{onClick:u,className:"primary",children:n("close_button")})]})]})},B6=({folder:t,onClose:e,t:n,googleUser:r,onUpdateCollaborators:i,setAlertConfig:s})=>{const[o,a]=Io(e),[l,u]=G.useState(""),[f,m]=G.useState(!1),[_,v]=G.useState(""),[E,P]=G.useState(!1),M=async()=>{if(!(!t||!r)){m(!0);try{if(!_||_.trim().length===0){s({title:"  ",message:"      .",confirmText:"",onConfirm:()=>{}}),m(!1);return}const V={type:"folder_share",folderId:t.id,folderName:t.name,folderColor:t.color,goals:[],sharedBy:r==null?void 0:r.email,ownerId:r==null?void 0:r.uid,sharedAt:new Date().toISOString(),password:_},q=st(fe,"users",r.uid,"folders"),z=Ne(q,t.id),S=t.collaborators||[];await gt(z,{collaborators:S,shareInfo:{password:_,createdAt:new Date().toISOString()},updatedAt:new Date().toISOString()},{merge:!0});const x=_g(JSON.stringify(V)),R=`${window.location.origin}${window.location.pathname}?folder_share=${encodeURIComponent(x)}`,N=await nR(R);u(N),s({title:"   ",message:" .  !",confirmText:"",onConfirm:()=>{navigator.clipboard.writeText(N)}})}catch(V){console.error("   :",V),s({title:" ",message:"   .  .",confirmText:"",onConfirm:()=>{}})}finally{m(!1)}}},C=()=>{l&&navigator.clipboard.writeText(l).then(()=>{s({title:" ",message:"  .",confirmText:"",onConfirm:()=>{}})})},w=async V=>{if(!(!t||!r))try{const q=st(fe,"users",r.uid,"folders"),z=Ne(q,t.id),S=(t.collaborators||[]).filter(x=>x.userId!==V);await gt(z,{collaborators:S,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,S),s({title:" ",message:" .",confirmText:"",onConfirm:()=>{}})}catch(q){console.error("  :",q),s({title:" ",message:"  .",confirmText:"",onConfirm:()=>{}})}},A=async(V,q)=>{if(!(!t||!r))try{const z=st(fe,"users",r.uid,"folders"),S=Ne(z,t.id),x=(t.collaborators||[]).map(R=>R.userId===V?{...R,role:q}:R);await gt(S,{collaborators:x,updatedAt:new Date().toISOString()},{merge:!0}),i(t.id,x),s({title:"  ",message:`  ${q==="editor"?"":""} .`,confirmText:"",onConfirm:()=>{}})}catch(z){console.error("  :",z)}};return t?p.jsxs(Ts,{onClose:a,isClosing:o,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"goal-assistant-header",children:[p.jsx("div",{className:"goal-assistant-header-left"}),p.jsxs("h2",{children:[t.name,"  "]}),p.jsx("div",{className:"goal-assistant-header-right",children:p.jsx("button",{onClick:a,className:"close-button",children:we.close})})]}),p.jsx("div",{className:"goal-assistant-body",children:p.jsxs("div",{style:{padding:"24px 16px"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:" "}),t.collaborators&&t.collaborators.length>0?p.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:t.collaborators.map(V=>p.jsxs("div",{className:"settings-item",style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[p.jsxs("div",{style:{flex:1},children:[p.jsx("div",{style:{fontWeight:"500",fontSize:"0.95rem"},children:V.email}),V.role==="owner"?p.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary-color)",marginTop:"2px"},children:""}):p.jsxs("select",{value:V.role,onChange:q=>A(V.userId,q.target.value),style:{fontSize:"0.85rem",padding:"4px 8px",marginTop:"4px",borderRadius:"4px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",cursor:"pointer"},children:[p.jsx("option",{value:"editor",children:""}),p.jsx("option",{value:"viewer",children:""})]})]}),V.role!=="owner"&&p.jsx("button",{onClick:()=>w(V.userId),style:{padding:"4px 12px",backgroundColor:"var(--danger-color)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.8rem",marginLeft:"12px",whiteSpace:"nowrap"},children:""})]},V.userId))}):p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:" .    ."})})]}),p.jsx("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid var(--border-color)"}}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"12px"},children:"   "}),p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:"    ,      ."})}),l?p.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsx("div",{style:{padding:"12px",backgroundColor:"var(--card-bg-color)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:p.jsx("input",{type:"text",readOnly:!0,value:l,onClick:V=>V.target.select(),style:{width:"100%",padding:"10px",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"0.85rem",boxSizing:"border-box",fontFamily:"monospace"}})}),p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[p.jsx("button",{onClick:C,className:"primary",children:" "}),p.jsx("button",{onClick:()=>{u(""),v(""),P(!1)},className:"secondary",children:" "})]})]}):p.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[p.jsxs("label",{className:"settings-item standalone-toggle",children:[p.jsx("span",{style:{fontWeight:"500"},children:"  "}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:E,onChange:V=>{P(V.target.checked),V.target.checked||v("")}}),p.jsx("span",{className:"slider round"})]})]}),E&&p.jsx("input",{type:"password",placeholder:" ",value:_,onChange:V=>v(V.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontFamily:"inherit",fontSize:"14px",boxSizing:"border-box"}}),p.jsx("button",{onClick:M,disabled:f||!_.trim(),className:"primary",style:{width:"100%",padding:"14px 0",backgroundColor:"var(--primary-color)",color:"white",border:"none",borderRadius:"24px",boxShadow:"0 2px 8px rgba(88,86,214,0.08)",fontWeight:700,fontSize:"16px",letterSpacing:"0.01em",cursor:f||!_.trim()?"not-allowed":"pointer",opacity:f||!_.trim()?.6:1,transition:"all 0.2s"},children:f?"  ...":"  "})]})]})]})}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("div",{}),p.jsx("button",{onClick:a,className:"primary",children:""})]})]}):null},G6=({onClose:t,isDarkMode:e,onToggleDarkMode:n,themeMode:r,onThemeChange:i,backgroundTheme:s,onSetBackgroundTheme:o,onExportData:a,onImportData:l,setAlertConfig:u,onDeleteAllData:f,dataActionStatus:m,language:_,onSetLanguage:v,t:E,todos:P,setToastMessage:M,onOpenVersionInfo:C,onOpenUsageGuide:w,apiKey:A,onSetApiKey:V,isOfflineMode:q,onToggleOfflineMode:z,googleUser:S,onGoogleLogin:x,onGoogleLogout:R,onSyncDataToFirebase:N,onLoadDataFromFirebase:D,isGoogleLoggingIn:F=!1,isGoogleLoggingOut:b=!1,isSyncingData:Se=!1,isLoadingData:Qe=!1,isAutoSyncEnabled:Fe,setIsAutoSyncEnabled:Te,notificationPermission:Z,setNotificationPermission:ce})=>{const[he,xe]=Io(t),[Me,Ct]=G.useState("appearance"),[be,Mt]=G.useState(""),[Ce,Oe]=G.useState(!1),[Ut,Ot]=G.useState("medium"),[wn,Yn]=G.useState(null),pt=G.useRef(null),oe=[{id:"appearance",label:E("settings_section_background"),icon:we.background},{id:"general",label:E("settings_section_general"),icon:we.settings},{id:"data",label:E("settings_section_data"),icon:we.data}],Ke=()=>u({title:E("delete_account_header"),message:E("delete_account_header_desc"),isDestructive:!0,confirmText:E("delete_all_data_button"),cancelText:E("cancel_button"),onConfirm:f,onCancel:()=>{}}),yr=async()=>{if(!P||P.length===0){Yn(E("no_data_to_share"));return}Oe(!0);try{const Ae=eI(P),Be=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(Ae)}`,Ge=await nR(Be);Mt(Ge),Ge!==Be&&Ge.length<Be.length?M(E("short_url_created")):M(E("share_link_created"))}catch(Ae){console.error("Failed to create share link",Ae);const Be=eI(P),Ge=`${window.location.origin}${window.location.pathname}?data=${encodeURIComponent(Be)}`;Mt(Ge),M(E("short_url_failed"))}finally{Oe(!1)}},In=()=>{be&&navigator.clipboard.writeText(be).then(()=>{M(E("link_copied_toast"))})},Xn=()=>{switch(Me){case"appearance":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:E("settings_theme_mode")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("light"),children:[p.jsxs("div",{children:[p.jsx("span",{children:E("theme_mode_light")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("theme_mode_light_desc")})]}),r==="light"&&we.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("dark"),children:[p.jsxs("div",{children:[p.jsx("span",{children:E("theme_mode_dark")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("theme_mode_dark_desc")})]}),r==="dark"&&we.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>i("system"),children:[p.jsxs("div",{children:[p.jsx("span",{children:E("theme_mode_system")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("theme_mode_system_desc")})]}),r==="system"&&we.check]})]}),p.jsx("div",{className:"settings-section-header",children:E("settings_background_header")}),p.jsx("div",{className:"settings-section-body",children:yg.map(Ae=>p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>o(Ae.id),children:[p.jsx("span",{children:E(e?Ae.darkNameKey:Ae.lightNameKey)}),s===Ae.id&&we.check]},Ae.id))})]});case"general":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:E("settings_language")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("ko"),children:[p.jsx("span",{children:""}),_==="ko"&&we.check]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:()=>v("en"),children:[p.jsx("span",{children:"English"}),_==="en"&&we.check]})]}),p.jsx("div",{className:"settings-section-header",children:E("settings_api_key")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{className:"settings-item",children:p.jsx("input",{type:"password",placeholder:E("settings_api_key_placeholder"),value:A,onChange:Ae=>V(Ae.target.value),style:{width:"100%",padding:"8px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--input-bg)"}})}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:E("settings_offline_mode")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("settings_offline_mode_desc")})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:q,onChange:z}),p.jsx("span",{className:"slider round"})]})]})]}),p.jsx("div",{className:"settings-section-header",children:E("settings_section_info")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsxs("div",{className:"settings-item nav-indicator",onClick:C,children:[p.jsx("span",{children:E("settings_version")}),p.jsxs("div",{className:"settings-item-value-with-icon",children:[p.jsx("span",{children:"2.0"}),we.forward]})]}),p.jsxs("div",{className:"settings-item nav-indicator",onClick:w,children:[p.jsx("span",{children:E("usage_guide_title")}),p.jsx("div",{className:"settings-item-value-with-icon",children:we.forward})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:E("settings_developer")}),p.jsx("span",{className:"settings-item-value",children:E("developer_name")})]}),p.jsxs("div",{className:"settings-item",children:[p.jsx("span",{children:E("settings_copyright")}),p.jsx("span",{className:"settings-item-value",children:E("copyright_notice")})]})]})]});case"data":return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:""}),p.jsx("div",{className:"settings-section-body",children:S?p.jsxs("div",{children:[p.jsxs("div",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:"Google "}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:S.email}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:S.displayName})]}),p.jsx("span",{style:{color:"var(--success-color, #4CAF50)"},children:""})]}),p.jsx("button",{className:"settings-item action-item",onClick:R,disabled:b,style:{opacity:b?.6:1},children:p.jsx("span",{className:"action-text",children:b?"  ...":""})})]}):p.jsx("div",{children:p.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"12px 0"},children:p.jsxs("button",{onClick:x,disabled:F,style:{backgroundColor:F?e?"#2A2A2A":"#E0E0E0":e?"#1F1F1F":"white",border:`1px solid ${e?"#404040":"#D3D3D3"}`,borderRadius:"24px",padding:"8px 20px",fontSize:"14px",fontWeight:"500",cursor:F?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",color:F?e?"#666":"#999999":e?"#E0E0E0":"#1F2937",transition:"all 0.2s",opacity:F?.6:1},children:[e?p.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}):p.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),F?" ...":"Google "]})})})}),S&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:E("settings_cloud_sync_header")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("button",{className:"settings-item action-item",onClick:N,disabled:Se,children:p.jsx("span",{className:"action-text",children:E(Se?"settings_syncing":"settings_sync_data")})}),p.jsx("button",{className:"settings-item action-item",onClick:D,disabled:Qe,children:p.jsx("span",{className:"action-text",children:E(Qe?"settings_loading":"settings_load_from_cloud")})}),p.jsxs("label",{className:"settings-item",children:[p.jsxs("div",{children:[p.jsx("span",{children:E("settings_auto_sync")}),p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"4px"},children:E("settings_auto_sync_desc")})]}),p.jsxs("div",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:Fe,onChange:Ae=>Te(Ae.target.checked)}),p.jsx("span",{className:"slider round"})]})]})]})]}),p.jsx("div",{className:"settings-section-header",children:E("settings_data_header")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:E("settings_data_header_desc")}),p.jsx("button",{className:"settings-item action-item",onClick:a,disabled:m!=="idle",children:p.jsx("span",{className:"action-text",children:E(m==="exporting"?"data_exporting":"settings_export_data")})}),p.jsxs("button",{className:"settings-item action-item",onClick:()=>{var Ae;return(Ae=pt.current)==null?void 0:Ae.click()},disabled:m!=="idle",children:[p.jsx("span",{className:"action-text",children:E(m==="importing"?"data_importing":"settings_import_data")}),p.jsx("input",{type:"file",ref:pt,onChange:l,accept:".json",style:{display:"none"}})]})]}),P.length>0&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"settings-section-header",children:E("settings_share_link_header")}),p.jsxs("div",{className:"settings-section-body",children:[!be&&p.jsx("button",{className:"settings-item action-item",onClick:yr,disabled:Ce,children:p.jsx("span",{className:"action-text",children:Ce?" URL  ...":E("settings_generate_link")})}),be&&p.jsxs("div",{className:"share-link-container",children:[p.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px",opacity:.7},children:[be.length<100?" URL":" "," (",be.length,")"]}),p.jsx("input",{type:"text",readOnly:!0,value:be,onClick:Ae=>Ae.target.select()}),p.jsx("button",{onClick:In,children:E("settings_copy_link")})]})]})]}),p.jsx("div",{className:"settings-section-header",children:E("settings_delete_account")}),p.jsxs("div",{className:"settings-section-body",children:[p.jsx("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"12px",padding:"8px",backgroundColor:"var(--bg-color-secondary)",borderRadius:"8px"},children:S?"         .     .":"    ."}),p.jsx("button",{className:"settings-item action-item",onClick:Ke,disabled:m!=="idle",children:p.jsx("span",{className:"action-text destructive",children:E(m==="deleting"?"data_deleting":"settings_delete_account")})})]})]});default:return null}};return p.jsxs(Ts,{onClose:xe,isClosing:he,className:"settings-modal",size:Ut,children:[p.jsxs("div",{className:"settings-modal-header",children:[p.jsx("div",{style:{width:"40px"}}),p.jsx("h2",{children:E("settings_title")}),p.jsx("div",{className:"settings-modal-header-right",style:{width:"40px"}})]}),p.jsxs("div",{className:"settings-modal-body",children:[p.jsx("div",{className:"settings-tabs",children:oe.map(Ae=>p.jsxs("button",{className:`settings-tab-button ${Me===Ae.id?"active":""}`,onClick:()=>Ct(Ae.id),"aria-label":Ae.label,children:[p.jsx("div",{className:"settings-tab-icon",children:Ae.icon}),p.jsx("span",{children:Ae.label})]},Ae.id))}),p.jsx("div",{className:"settings-tab-content-container",children:p.jsx("div",{className:"settings-tab-content",children:Xn()},Me)}),p.jsxs("div",{className:"goal-assistant-nav",style:{padding:"16px 24px",borderTop:"1px solid var(--border-color)"},children:[p.jsx("div",{style:{width:"1px"}}),p.jsx("button",{onClick:xe,className:"primary",style:{minWidth:"120px"},children:E("settings_done_button")})]})]}),wn&&p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:""}),p.jsx("p",{children:wn})]}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:()=>Yn(null),className:"primary",children:""})})]})})]})},q6=({onClose:t,t:e})=>{const[n,r]=Io(t),i="2.0.0 (25.10.24)",s=[{icon:"",title:" ",desc:"Step-by-step  . , (), (),  , ,  "},{icon:"",title:" / ",desc:" ,        "},{icon:"",title:"WOOP  ",desc:"5  (Wish  Outcome  Obstacle  Plan  /)   "},{icon:"",title:"AI  ",desc:"Gemini API     AI   "},{icon:"",title:"Google ",desc:"Google OAuth      "},{icon:"",title:"Firebase  ",desc:", ,     Firebase Firestore  "},{icon:"",title:"  ",desc:"       "},{icon:"",title:"  & ",desc:"//     8   "},{icon:"",title:"PWA & ",desc:" PWA   ,  ,   "},{icon:"",title:" ",desc:"3//      "},{icon:"",title:" /",desc:"JSON       "},{icon:"",title:" ",desc:",     "}];return p.jsxs(Ts,{onClose:r,isClosing:n,className:"version-info-modal",children:[p.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[p.jsxs("div",{className:"version-info-header",style:{flexShrink:0,paddingBottom:"16px",borderBottom:"1px solid var(--border-color)"},children:[p.jsx("h2",{children:" Nova AI Planner v2.0"}),p.jsxs("p",{children:[e("build_number"),": ",i]})]}),p.jsx("div",{className:"version-info-body",children:s.map((o,a)=>p.jsxs("div",{className:"changelog-item",children:[p.jsx("div",{className:"changelog-icon",style:{"--icon-bg":"var(--primary-color)"},children:o.icon}),p.jsxs("div",{className:"changelog-text",children:[p.jsx("h3",{children:o.title}),p.jsx("p",{children:o.desc})]})]},a))})]}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},z6=({onClose:t,t:e})=>{const[n,r]=Io(t),i=o=>{const a=/(https?:\/\/[^\s]+)/g;return o.split(a).map((u,f)=>a.test(u)?p.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"guide-link",children:u},f):u)},s=[{titleKey:"usage_basic_title",descKey:"usage_basic_desc"},{titleKey:"usage_ai_setup_title",descKey:"usage_ai_setup_desc"},{titleKey:"usage_ai_use_title",descKey:"usage_ai_use_desc"},{titleKey:"usage_share_title",descKey:"usage_share_desc"},{titleKey:"usage_theme_title",descKey:"usage_theme_desc"},{titleKey:"usage_calendar_title",descKey:"usage_calendar_desc"},{titleKey:"usage_offline_title",descKey:"usage_offline_desc"}];return p.jsxs(Ts,{onClose:r,isClosing:n,className:"usage-guide-modal",children:[p.jsx("div",{className:"version-info-header",children:p.jsx("h2",{children:e("usage_guide_title")})}),p.jsx("div",{className:"version-info-body",children:s.map((o,a)=>p.jsxs("div",{className:"usage-guide-item",children:[p.jsx("h3",{children:e(o.titleKey)}),p.jsx("p",{children:o.titleKey==="usage_ai_setup_title"?i(e(o.descKey)):e(o.descKey)})]},a))}),p.jsx("div",{className:"modal-buttons",children:p.jsx("button",{onClick:r,className:"primary",children:e("settings_done_button")})})]})},$6=({todos:t,t:e,onGoalClick:n,language:r})=>{const[i,s]=G.useState(new Date),[o,a]=G.useState("week"),l=_=>{const v=new Date(i);o==="month"?v.setMonth(v.getMonth()+_):o==="week"?v.setDate(v.getDate()+_*7):v.setDate(v.getDate()+_*3),s(v)},u=G.useMemo(()=>{const _=[];let v,E;if(o==="month"){const P=new Date(i.getFullYear(),i.getMonth(),1);v=Xw(P,r==="ko"?1:0),E=42}else o==="week"?(v=Xw(i,r==="ko"?1:0),E=7):(v=new Date(i),v.setDate(v.getDate()-1),E=3);for(let P=0;P<E;P++){const M=new Date(v);M.setDate(M.getDate()+P),_.push(M)}return _},[i,o,r]),f=G.useMemo(()=>{if(o==="month"){const _=i.getFullYear(),v=e("month_names")[i.getMonth()],E=e("calendar_header_month_format");return E&&typeof E=="string"&&E!=="calendar_header_month_format"?E.replace("{year}",String(_)).replace("{month}",v):`${v} ${_}`}return`${i.getFullYear()}.${i.getMonth()+1}`},[i,o,e]),m=G.useMemo(()=>{const _=e("day_names_short");if(r==="ko"&&Array.isArray(_)){const[v,...E]=_;return[...E,v]}return _},[r,e]);return p.jsxs("div",{className:"calendar-view-container",children:[p.jsxs("div",{className:"calendar-header",children:[p.jsx("button",{onClick:()=>l(-1),children:we.back}),p.jsx("h2",{children:f}),p.jsx("button",{onClick:()=>l(1),children:we.forward})]}),p.jsxs("div",{className:"calendar-view-mode-selector",children:[p.jsx("button",{onClick:()=>a("day3"),className:o==="day3"?"active":"",children:e("calendar_view_day3")}),p.jsx("button",{onClick:()=>a("week"),className:o==="week"?"active":"",children:e("calendar_view_week")}),p.jsx("button",{onClick:()=>a("month"),className:`calendar-view-button-month ${o==="month"?"active":""}`,children:e("calendar_view_month")})]}),(o==="week"||o==="month")&&p.jsx("div",{className:"calendar-days-of-week",children:Array.isArray(m)&&m.map(_=>p.jsx("div",{children:_},_))}),p.jsx("div",{className:`calendar-grid view-mode-${o}`,children:u.map(_=>{const E=du(_,new Date),P=_.getMonth()===i.getMonth(),M=t.filter(C=>{if(C.isRecurring){const w=(_.getDay()+6)%7;return C.recurringDays.includes(w)}return C.deadline&&du(_,C.deadline)});return p.jsxs("div",{className:`calendar-day ${!P&&o==="month"?"not-current-month":""} ${E?"is-today":""}`,"data-day-name":e("day_names_long")[_.getDay()],children:[p.jsx("div",{className:"day-header",children:p.jsx("span",{className:"day-number",children:_.getDate()})}),p.jsx("div",{className:"calendar-goals",children:M.map(C=>p.jsx("div",{className:`calendar-goal-item ${C.completed&&C.lastCompletedDate&&du(_,C.lastCompletedDate)?"completed":""}`,onClick:()=>n(C),children:C.title||C.wish},C.id))})]},_.toISOString())})})]})},j6=({todo:t,onClose:e,onSave:n,t:r})=>{const[i,s]=Io(e),[o,a]=G.useState(t.title||""),[l,u]=G.useState(t.deadline||""),[f,m]=G.useState(t.isRecurring||!1),[_,v]=G.useState(t.recurringDays||[]),[E,P]=G.useState(!t.deadline),M=()=>{const w={...t,title:o.trim(),deadline:E?"":l,isRecurring:f,recurringDays:_};n(w),s()},C=w=>{v(A=>A.includes(w)?A.filter(V=>V!==w):[...A,w].sort())};return p.jsxs(Ts,{onClose:s,isClosing:i,className:"goal-assistant-modal",children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:r("edit_todo_title")}),p.jsx("button",{onClick:s,className:"close-button","aria-label":r("close_button"),children:""})]}),p.jsxs("div",{className:"goal-assistant-body",children:[p.jsxs("div",{style:{padding:"24px 16px",flex:1,overflowY:"auto"},children:[p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",children:p.jsx("p",{className:"tip",children:r("todo_title_label")})}),p.jsx("textarea",{value:o,onChange:w=>a(w.target.value),placeholder:r("todo_title_placeholder"),rows:2,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"14px",fontFamily:"inherit",resize:"none",marginTop:"12px"},autoFocus:!0})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsxs("p",{className:"tip",children:[r("deadline_label")," ()"]})}),p.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[p.jsx("span",{style:{fontWeight:"500"},children:" "}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:!E,onChange:w=>{P(!w.target.checked),w.target.checked&&!l&&u(new Date().toISOString().split("T")[0])}}),p.jsx("span",{className:"slider round"})]})]}),!E&&p.jsx("div",{style:{marginTop:"12px"},children:p.jsx("input",{type:"date",value:l,onChange:w=>u(w.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--input-bg-color)",color:"var(--text-color)",fontSize:"13px"}})})]}),p.jsx("hr",{}),p.jsxs("div",{style:{marginBottom:"20px"},children:[p.jsx("div",{className:"step-guidance",style:{marginTop:"16px"},children:p.jsx("p",{className:"tip",children:r("recurring_label")})}),p.jsxs("label",{className:"settings-item standalone-toggle",style:{marginTop:"12px"},children:[p.jsx("span",{style:{fontWeight:"500"},children:" "}),p.jsxs("label",{className:"theme-toggle-switch",children:[p.jsx("input",{type:"checkbox",checked:f,onChange:w=>m(w.target.checked)}),p.jsx("span",{className:"slider round"})]})]}),f&&p.jsxs("div",{style:{marginTop:"12px"},children:[p.jsx("label",{style:{fontSize:"12px",opacity:.7,display:"block",marginBottom:"8px"},children:r("recurring_days_label")}),p.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"8px"},children:["","","","","","",""].map((w,A)=>p.jsx("button",{type:"button",onClick:()=>C(A),style:{padding:"8px 4px",borderRadius:"6px",border:_.includes(A)?"2px solid var(--primary-color)":"2px solid var(--border-color)",backgroundColor:_.includes(A)?"var(--primary-color)":"transparent",color:_.includes(A)?"white":"var(--text-color)",fontSize:"12px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},children:w},A))})]})]})]}),p.jsxs("div",{className:"goal-assistant-nav",children:[p.jsx("button",{onClick:s,className:"secondary",children:r("cancel_button")}),p.jsx("button",{onClick:M,className:"primary",disabled:!o.trim(),children:r("save_button")})]})]})]})},H6=({title:t,message:e,onConfirm:n,onCancel:r,confirmText:i,cancelText:s,isDestructive:o,t:a})=>{const l=typeof r=="function";return p.jsx("div",{className:"modal-backdrop alert-backdrop",children:p.jsxs("div",{className:"modal-content alert-modal",children:[p.jsxs("div",{className:"alert-content",children:[p.jsx("h2",{children:t}),p.jsx("p",{dangerouslySetInnerHTML:{__html:e}})]}),p.jsxs("div",{className:"modal-buttons",children:[l&&p.jsx("button",{onClick:r,className:"secondary",children:s||a("cancel_button")}),p.jsx("button",{onClick:n,className:o?"destructive":"primary",children:i||a("confirm_button")})]})]})})},W6=bp.createRoot(document.getElementById("root"));W6.render(p.jsx(dI.StrictMode,{children:p.jsx(N6,{})}));
